uer spiegel 30 uecemder 2013 httpwwwspiegeldenetzweltnetzpolitikquantumtheorvwiediensaweltweitrechnerhackta941149html httpwwwspiegeldefotostreckensadokumentesouedernimmtdergeheimdienstfremderechnerfotostrecke105329html tssirel only rt analysts can submit quantumtheory tasking to the quantum team topi analysts can submit quantumnation tasking through target profiler the biggest difference is quantumtheory deploys stagel implant called validator soon to be commondeer and quantumnation deploys stageo implant called seasonedmoth smoth smoths die within 30 days of deployment unless requested to extend the life tssirel this presentation does not cover faa quantum but if you identify an active selector compare the sigad in marina to the sigad on the go quantum wiki page to see if faa quantum is an option tssirel this presentation is geared towards targets seen at us if you are unfamiliar with this sigad it is equivalent to tsnf sigad that cannot be mentioned in this powerpoint you can contact the poc of this brief for more information web browsing exploit with quantum the concept manontheside quantum is manontheside capability if your target has selector that is active in the last 14 days vulnerable to the quantum technique and seen by an sso site that has quantum capabilities then there might be the opportunity to detect that communication in realtime and piggy back with the requested content back into the targets network and implant the host quantumtheory can be used only if tao project is set up must coordinate with your rt analyst quantumnation can be used regardless of tao project topi does the tasking in target profiler the biggest difference is quantumtheory deploys stagel implant called validator soon to be commondeer and quantumnation deploys stageo implant called seasonedmoth smoth smoths die within 30 days of deployment unless requested to extend the life the exploit technique is the same top secretcomintrel to usa fvey 3 what is quantum quantum generic animation high level of how it works 1 target togs into his yahoo account target yahoos web server sso site what is quantum quantum generic animation high level of how it works 1 target fogs into his yahoo account internet route r m r yahoos target web servi v sso site 2 sso site sees the quantum tasked yahoo selectors packet and forwards it to taos foxacid server quantum capabilities nsa tssirel nsa quantum has the greatest success against yahoo facebook and static tp addresses new quantum realms are often changing so check the go quantum wiki page or the quantum spyspace page to get more uptodate news n5a quantum is capable of targeting the following realms ipv4_public mailrumrcu alibabaforumuser msnmailtoken64 doubleclickid qq emailaddr facebook rocketmail simbaruuid hisuid twitter hotmaiicid yahoo linkedin yahoobcookie mail ymail mailrumrcu youtube msnmailtoken64 watcherld ntw allan f 11fyn linn t 1 li m 1 ìhvelwiji1 i 1jj1 top secretïcomintrel to usa fvey 5 quantumtheory gchq if partnering agreement form paf is set up with gchq for the cno project then the rt analyst can utilize gchq quantumtheory to include additional capabilities such as alibaba aol bebo_email double_click facebookcuser googleprefid gmail hi5 hotmail linkedin mail ru w microsoft_muid microsoft_anona rambler radius simbar twitter yahoob yahoo_ly yandex_ema1l youtube ip address more information on httpswikigchq quantumbiscuit if you cannot get to the link try http topsecretocominwriltousa fvev 16 quantum sigdev qfds tssirel find all selectors associated to vour tarqet yaho your target yahoo yahoo b cookies facebook hotmail etc using marina nsa or gchq qfds nsa satc qfds alterego qfd u ipi gchc i queried selector atuel64 ituel64 atuel64 alternate selector f4cebook isi ynboo dogcollar qfd selector f6cebook tpe mspiat m enrichment value oueried selector degree alternate selector degree 4 6 6 5 2 439 intersection 2 2 61 score 111001 40 60 59 observations first seen date last seen date 429 20120524 20130327 skip to step 5 once you have all of your selectors top secretcomintrel to usa fvey 6 quantum sigdev marina st6p ll skip to step 5 if you used the qfds to identify alternate selectors 4 tssirel if you do not use the gchq or nsa qfds you can use marina run marina selectoridentifier profile federated search for 3 month range to look for additional selectors ofartna c mow vuacfi jt krtorlr c t ly rmtad stt miic icflal inrk v jj mntihmw lihphhi xjefictoori 8 _attwumr 1 foy _iftvtv 8 _attwumr 1 foy _iftvtv sfwttut 201111x0 1 0000 00 v erricmt 20120210 239959 v 3 months hi 8 _attwumr 1 foy _iftvtv sctnlor 8 _attwumr 1 foy _iftvtv sctnlor _jmmjf jm dnm ocncm snmi 2 idvtn to hx pi j_jtmf kit xct utm arm mart if 1 iwtfilltvcmv mtfrr ovkt0f pro jl mrto minorsy mffi 4 5crtmcrvt 4 cjsvranary m hkm j mattht tarty budiaw tssirel once the query finishes look at the equivalent ids section this will show you other selectors that your target is using this is determined by linking content loginsemail registrationsetc it is worth verifying that these are indeed selectors associated to your target nsa quantum works best against yahoo and facebook although it is worth making note of gmail selector for possible gchq quantum support or for your own notes scwtor summary lb web cam photo 0 equivalent ids 5 page 1 01 1 new selector known selector fef none layout defout vlsualire m save as feob load complete application entity 4 9 activity entity b 1 email 4 kasad yahoo 2 email has display name 3 email grftaicomgo0e 0 has d yahoo 4 jm sjcypeoser has id skypemaficen 4 tssirel if your search was on yahoo email address then click on machine ids and look for recent yahoobcookie yahoobcookies are unique to specific computer and can hold other yahoo addresses that are being logged into on that computer as long as the user does not clear browser cookies if you see multiple yahoobcookie pick the most recent last heard date also higher the num heard is the more likely that selector does not change recpnfii mrnvort 21 login 7 0 mhane ids 18 pape 1 oil q ferndn lovailder vojalreh sare m be statu lam new selector aipiin afiivp ihcr mjirhtn w 1 q 5yah maefajio ccrctia rft so wrdmsnt 2d11uis 13s2q3î 201ij2w lojsstt z ft patooeooote 201112 tolnk 20i7iixî5 10iw22 3 niw m yah afxitctae 2ô1ïî2kiooilî2 20111x6 1c022 q wkbeyhco j nci lmbydhsi rrœlaj0 ccrrfwstcie rue 55 annus 135212 20111205ic0123z 20111116 1333157 20111205 1c01j62 6 qirtt yhoa rrœlaj0 ccrrfwstcie rue 55 201111151352cez iolll2c6cncc 7 mai v3n0bfcltil 20iiuî5cs1scm7 0iiii2sc63w unique selectors found i yahoo known selector 7 gmailcomgoogle new selector 3 yahoobcookie new selector top secretsirel usa aush can gbr nzl j qiifvitlr rt h new gtoglti selector applii juticiri fnmy 5 m awivtty mitrp g nmjp 5ii ji7ilsj i i 1 l itj n 2 q eml hit chfdtay riww jl iji 1 n luhi yi jh1 ij m_ hi jdij 4 nm pnjiir iw fll sh ts5irel since gmailcomgoogie is new selector you will want to do marina selector profile query on it to see if there are additional accounts associated io the target remember nsa quantum cannot target the googie selector equivalent iup i 1 tss1rel you can do this by clicking on the selector scroll down to selector profile and click range h of 1 2 nr ivf rilirllir viiublc fcf save as t trolst 1 ftppllcatkjn fniity 1 email byjalijainagpnleji 2 n 3 mid io1 jb nm dkmusvi r jjiiij ftwirjtuglr fiifwrirjriirilrtlu 3 ftcversc lantactn b bent meisafles fifictstved yiefsiis ehjirn s22 pjsnwub u l ssktrtor oetflis ji lawlidgt treittes charts vi nil pinn rvdd to ifkjuty lfcer atfjtty fvkinefl havel lirjl tin ok ocmr by b vjtlm iesri1 iear flcngs fnd n tssirel change the query to search for the last 3 months and click submit selector profile search selector profile search name setector profile gmalcomgoc3le xetflcation ml clh b hi start dato selectors 20111110 000000 v fnddatr 20120210 235959 v add remove tj correlale identifier sigmailcom n _ h mm mm qi mm tremai can 3qinòilcom reafti googie skypemaltofcen qooqte skypemaifcfcen skypemattoken skypemaffoken google ouiefc add tk or trcrc selector separate by ccmmo aro fit enter authority filter xj add remove ir parameters parameters parameters parameters parameters parameters par meters sesee foday yesterday this week lasi week this month last month 1 day 2 days 3 days 5 days 7 days 14 days 3 month 3 months 6 months 1 year l 4 tssirel once the query finishes look at the equivalent ids section and make note of any new yahoo hotmail yahoobcookie and facebook selectors and do the same process to identify additional selectors i rjiiivolrnt idt 16 page 1 of 1 frtc inbne layout dclaiit visunfiieh stweas statu oadnjemcfcnustt woitng fer swve restflruc application entity à j fit activity fntity b 1 n cfi3 ljcrroi com qooqto has jscwy nar 2 jpcrm corr ocoçk hasdtstèsy nama 3 mil ijryi cotr jcoçh has tepov nom 4 com hos desin none 5 efrw 5smal cw gçoe bàsdépfovnerie 6 mai kjiçrnal corncgcoçie 11 il j new facebook selector 7 qemal h ai fcptay narre 8 m n içrrcorr ioçte ijigrivwcor yoçh haîdispaynarns h i yohco 10 i_i emol hosrtid faccboolo rn fonjm facbock remuer edwth 12 mal bornaicofngeoçj ad cyahoo 13 emal spqrvarf cyr qcock hasàtid 9mk all unique selectors found from both searches i b yahoo known selector z gmailcomgoogle new selector phlyahoobcookie new selector hbitacebook new selector tssirel once you have list of your selectors you will want to look at each one separately to check for the likelihood of successfully exploiting your tarqet via nsa quantum we are checking to see if the target itself is seen at us and if it is active tssirel first we want to run marina active userpresence federated search on facebook for the past 14 days active utcrprcsence federated 14 days acpv uierpmencv atttv useiprrce foie cd scohq w evvnt bv ssjcr jl artwry jtl frjfus i charts jl_ charig detetmon dcp3c m l_ reirtor ton m ljspoirhepony cjsuwvry uset toovty scfagtorldantfar actrv cj wlrfti n vaditshop ficabook id teuton ilil stufati 20130319 1 000000 end dot 20130401 235959 14 days t3 strkt loadcxato cwr t ada rarove ccrrtìete faeiren eeit tn tiected saettali1 wort rtata input facet ock quck aiw er c i i i r by c vnr ardii ente j ada efwb ay rmkn authonty filler atm v rasavo authority murtili troth options mar fityas to litoc tnteftgence rcpcttcroo if you have ovsc1700 check this box to search gchq databases sigpjr ovtitt suxr res open new mmow tssirel you will either have results or not have results the key is to look at the sigad for the results and if the sigad is capable of doing quantum then you most likely have vulnerable target to check for sigads that nsa and gchq quantum can target type go quantum in your browser if gchq quantum is needed then work with your rt analyst to follow the appropriate steps on the wiki to set up par tssirel you will want to ook at the marina results and make note of the most frequent si gadip cidr for each active userpresence federated query 1 selector sigad b active user ip cidr the cidr will be added to the tlns whitelist tlnrs whitelist is list containing the ip cidrs your target uses it is where the foxacid server will only continue with exploitation if the external ip address of the targetredirection is on the whitelist for the tln your rt analyst requests is my selector tasked for if you sent your rt analyst selector to task for quantumtheory and you want to see if it has been tasked yet you can enter the selector in target profiler and if you see tasked for survey and the technique to be quantumtheory or quantum nation then it is tasked you can also see when the last foxacid redirection took place mffyahoo retfved email fr ui3aur ui l 3 j vullrnrtblq tasked fr r tr tasked for survey technique quajhrjmtheorv 20 26 ifl lhtjattkinft z013mihui ts activity yalioo ltffvt onuitl nj 1 flnrul uilj l itflted fia ajvvy talked for slirtrey is activity w hni q i if 5 uhtu nti oh fan lmt auemplilolifilli fdutlf in top cretilco ntfr l to usa fvev quantumnation quantum nation uses new tao cne tradecraft and automation to drive broad scale initial access specifically an ssg cloudanafytic to identify selectors in sso passive collection that are viable for endpoint access and the use of lightweight cne implants to obtain initial access and survey data delivered to the topi offices via corporate segint repositories for more information on quantumnatfon check the quantumnation wiki page target profiler now shows if selector is vulnerable to quantum exploit if your target is valid for quantumnatfon vulnerabee11 link in target profiler will appear simply click the link that sends an email to request quantumnation tasking faeebook1 reijiitiilij willi 2u1 j vk2 2 i i vlilnrbk d tari vulnerabilities i ki i 13 jit yws unriifltflmljsill50 fipad cpu 5_0_1 lika m appliwobkiy5s446 khtml cka vriiw5l mibili aj05 note quantumnation and standard quantum tasking results in the same exploitation technique the main difference is quantumnation deploys stage 0 implant and is able to be submitted by the topi any ios device will aiways get validator deployed top secrettfcomlnttfrel to usa fvey 17 tssirel once you have selector 5igad and ip cidrt you are ready to start the process for foxacfd tln and tag request tssirel depending on the teams either an rt analyst or the branch chief can create tln twisty lobby number contact your branch chief for information on creating tln for each selector you want to target tssirel note you will need 1 tln and 1 foxacid tag per selector you task with quantum step 8 tssirel once you have tln you will need to submit foxacid tag request 4 tssirel go to hups nsacgibin and fill out the appropriate information in the top and within the body of the ticket update this information accordingly here is an example ctor nqnct nonct second partypartnering country regiqntypg fisa target type of op quantum utilising wptt project name tln 12345 d insert your tln ip range d insert your active user ip cidr i whitelist mac addresses unknown payioad request vai pocsim msq support tssirel once the ticket is completed you will receive an email with the foxacid tag for your tln tssirel go to https nsaicgov indexphp and fill out the appropriate information in the form to task your selector and tag for quantum tssirel once your selector is tasked for quantum you will see the status changed to complete tssirel the last step it to monitor the tln in foxsearch httpspn ftnsa to look for redirections and update the plugins or whitelist if needed tssirel detask your quantum request when you hook your target