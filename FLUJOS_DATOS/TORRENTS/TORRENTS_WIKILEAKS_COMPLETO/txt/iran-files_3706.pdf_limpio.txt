retina identiﬁcation based on the pattern of blood vessels using angular and radial partitioning mehran deljavan amiri fardin akhlaqian tab and wafa barkhoda department of electrical and computer engineering university of kurdistan sanandaj iran deljavanieeeorg fakhlaqianuokacir wbarkhodaieeeorg abstract this paper presents new human identiﬁcation system based on fea tures obtained from retina images using angular and radial partitioning of the images the proposed algorithm is composed of two principal stages including feature extraction and decision making in the feature extraction stage ﬁrst all of the images are normalized in preprocessing step then the blood vessels pattern is extracted from retina images and morphological thinning process is applied on the extracted pattern after thinning two feature vectors based on the angular and radial partitioning of the pattern image are extracted from the blood vesselspatterntheextractedfeaturesarerotationandscaleinvariantandrobust against translation in the next stage the extracted feature vectors are analyzed using1ddiscretefouriertransformandthemanhattanmetricisusedtomeasure the closeness of the feature vectors to have compression on them experimen tal results on database including 360 retina images obtained from 40 subjects demonstrated an average true identiﬁcation accuracy rate equal to 9875 percent for the proposed system 1 introduction the recent advances in digital technology and increasing security concerns cause requirement to use intelligent person identiﬁcation systems based on the humans bio logical features biometric is the science of recognizing the identity of person based on the physical or behavioral attributes of the individual the popular used biometric features in identiﬁcation purposes are ﬁngerprint face facial thermogram iris retina palm print hand geometry gait ear voice signature teeth hand vein etc these fea turesareuniqueineveryindividualandcanbeusedasidentiﬁcationtools14among these features retina may provide higher level of security due to its indigenous robust ness against imposture uniqueness of retina comes from uniqueness of blood vessels pattern distribution at the retina from the other hand the retina pattern of each person undergoes less modiﬁcation during his life therefore we can say that the retina pat tern is good candidate to be used in identiﬁcation systems the retina pattern of each person can be identiﬁed even among genetically identical twins 5 severalresearchesonretinaidentiﬁcationhavebeenreportedintheliterature68 theﬁrstretinabasedidentiﬁcationsystemnamedeyedentiﬁcation75wasintroduced by eyedentify company in 1976 6 in 7 xu et obtained vector curve of blood vessels skeleton using the green channel grayscale retina images they deﬁned setoffeaturevectorsforeachimageincludingfeaturepointsdirectionsandscalingfactor although they have reached good recognition result but the major drawback of their method is its computational cost since number of rigid motion parameters should be computed for all possible correspondences between the query and enrolled images in the database ortega et 8 used fuzzy circular hough transform to localize the optical disk in the retina image then they deﬁned feature vectors based on the ridgeendingsandbifurcationsfromvesselsobtainedfromacreasemodeloftheretinal vessels inside the optical disk for matching they used similar approach as in 7 to compute the parameters of rigid transformation between feature vectors which givesthehighestmatchingscorethisalgorithmiscomputationallymoreefﬁcientwith respect to the algorithm presented in 7 however the performance of the algorithm has been evaluated using very small database including only 14 subjects recently tabatabaee et 9 presented new approach for human identiﬁcation using retina images by localizing the optical disk using haar wavelet and active contour model and they used it for rotation compensation then they used fouriermellin transform coefﬁcients and complex moment magnitudes of the rotated retinal image for feature deﬁnition finally they applied fuzzy cmeans clustering for recognition and tested their approach on database including 108 images of 27 different subjects chalechale et have introduced sketchbased method for image similarity mea surementusingangularpartitioningap1011intheirmethodahanddrawnrough black and white query sketch is compared with an existing database of full color im ages although this method have been proposed for natural and handdrawn images retrieval but it could be modiﬁed to be used in other image matching systems in this paper we are going to propose new approach for identifying retina images based on angular and radial partitioning rp of images the identiﬁcation task in the proposed system is invariant form the most of the common afﬁne transformations eg rotation scale changes and translation the proposed system eliminates any constraint regard ing the shape of the objects and the existence of any background also segmentation andobjectextractionarenotneededinthisapproachsothecomputationalcomplexity of the image matching algorithm is low and the proposed system is suitable for secure human identiﬁcation especially in realtime applications the rest of this paper is organized as follows section 2 introduces the angular and radial partitioning brieﬂy section 3 presents the proposed system the feature extrac tion procedure and decision making process is discussed in this section in section 4 somedetailsaboutthesimulationoftheproposedalgorithmaregivenandexperimental results of are presented inthis section finally section 5 concludes the paper 2 angular and radial partitioning chalechale et 1011 have deﬁned angular partitions slices in the surrounding circle of the image i the angle between adjacent slices is ϕ 2πk where kis the number of angular partitions in the image see figure 1 any λslices rotation of given image with respect to its center moves pixel at slice sito new position at slice sjwhere j iλmod k fori λ 012 k 1 they used the number of edge points at each sliceof the image to represent the slice featurefig1angular partitioning partitions the image into ksuccessive slices fig2radial partitioning partitions the image into mconcentric circles fi i 12 π ksummationdisplay θi2π krsummationdisplay ρ0iρ θ ris the radius of surrounding circle of the rotated image the feature extracted above will be circularly shifted when the image iis rotated τl2πkradians in counterclockwise direction l 012 itcanbeshownthatforanimage iandarotatedversionofit iτusing 1ddiscrete fourier transform dft of fiandfτiand based on the property fufτu we can use the fuandfτuas the rotation invariant features in images i andiτ1011 theradialpartitioningpartitionsagivenimage iintothemultipleconcentricradial partitionscirclesthenumberofcirclescouldbeadjustedintheapplicationstoreach thebestperformanceseefigure2duringtherotationprocessforagivenimagewith respect to its center the local information of the image at each circle eg the number ofedgepointsgraylevelshistogramneighborhoodinformationetcarenotchangedto increase the delicacy of the extracted features in this paper combination of the ap and the rp was used in feature extraction the details of the feature extraction process will be discussedin section 3 3 the proposed system similar to the most of the pattern recognition algorithms the identiﬁcation task in the proposed system can be divided into two stages 1 feature extraction 2 decision making the following subsections describe the details of steps 31 feature extraction the overview of feature extraction process in the proposed system is depicted in fig ure 3 this process is done for every enrolled and query images as figure 3 shows the feature extraction stage consists of some steps in the preprocessing step ﬁrst to achieve translation invariant features the extra margins of the input image are cropped and the bounding box of retina is extracted from the input image also to achieve the scale invariancy the cropped image is normalized to jjpixels see figure 4 b at the next step the pattern of the blood vessels in the retina image should be tectedthereareseveralvesselspatterndetectionalgorithmsintheliteratureherewe adopted similar approach as in 12 to reach the vessels pattern see figure 4 c morphological thinning procedure 13 is employed for thinning the vessels pattern in the pattern image see figure 4 d this task is based on the fact that usually there are thick lines in the pattern and thinning these lines helps to increase the performance of the system at the next steps two modes of feature extraction based on ap and rp are applied to the thinned pattern image in parallel see figures 4 and 4 f at each mode ﬁrst the thinned pattern image is partitioned using the related partitioning methodaporrpandthenumberofpatternpointsiscountedateachpartitionslices in ap and circles in rp as the partition feature the results of these two parallel pro cessesaretwofeaturevectorsapfeaturevectorandrpfeaturevectorforeachimage the resulting two vectors are the feature set of each image 32 decision making similaritymeasurementisakeypointinpatternrecognitionalgorithmsoneofthemost important tasks in image based identiﬁcation systems is search the image database to ﬁndanimageorsomeimagessimilartoagivenqueryimagetocomparethedatabases images and the query image the feature vectors extracted from the databases images and from the query image are passed through distance measurement metric to ﬁnd out the degree of closeness there are several metrics in the literature to measure the closeness of two feature vectors the most common metrics among this family are the manhattan and euclidean metrics 1416 the weighted manhattan and weighted euclidean metrics are widely used for ranking in image retrieval 1719 as described in section 31 in the proposed system two feature vectors are ex tracted from every image ap based and rp based feature vectors to compare thefig3the overview of the feature extraction process in the proposed system feature vectors ﬁrst 1d dft is applied on each feature vector and the absolute value abs of each dft vector is calculated as described in section 2 this action is done to stultify the effect of rotation on the feature vectors and consequently results ro tation invariant identiﬁcation system then the manhattan metric is used to measure thedistanceoffeaturevectorsbecauseoftheexistenceoftwofeaturevectorsforeach image two manhattan distances will be produce here to have total distance the two manhattan distances are combined with simple summation see figure 5 distance t otal distance ap distance rp the closest image in database to the query image is the one that have the minimum distance from the query image 4 experimental results theproposedsystemwasfullysoftwareimplementedandhasbeentestedonadatabase including 40 retina images from drive database 12 to do the following experi mentsthesizeofthepreprocessedimageswassetto 512512j512toapplythe aponimagestheangleofeachpartitionwassetto5othereforeachimageisdivided into 72 360o5o slices and the ap feature vector have 72 elements features the number of circles in rp waschosen to be 8 so the rp feature vector has 8 elements to produce test images query images each image in the database was rotated 8 times using various degrees to obtain 320 new query images table 1 shows the results of identiﬁcation of the queryimages in the proposed system as the table 1 shows the proposed system has an average accuracy equal to 985 percenta b c d f fig4a sample retina image b preprocessed image c the blood vessels pattern d morphological thinned pattern angular partitioning of the thinned pattern f radial parti tioning of the thinned patternfig5overview of the decision making stage table 1results for identifying query images in the proposed system rotation degree 51015304590180270mean accuracy percent 100975975951001001001009875 5 conclusion in this paper novel human identiﬁcation system based on retina images was intro ducedtoidentifyaretinaimageafternormalizingitinapreprocessingsteptheblood vesselspatternwasextractedfromtheretinaimageandamorphologicalthinningpro cess is applied on the extracted pattern two feature vectors were extracted from the thinned pattern using angular and radial partitioning to match the query image with the database the feature vectors were analyzed using 1d discrete fourier transform the similarity between feature vectors was measured by manhattan distance the per formanceoftheproposedsystemwasevaluatedusingadatabasecontaining360images from40objectsexperimentalresultsdemonstratedanaveragetrueaccuracyrateequal to 9875 percent for the proposed system simplicity low computational complexity robustness against rotation scaling and translation and high accuracy ration of the pro posedapproachmakeitattractiveforsecurehumanidentiﬁcationsystemsandrealtime applicationsfurtherresearchwillstudytheperformanceoftheproposedidentiﬁcation approach against differentgeometric and nongeometric distortions and attacks references 1 k jain p flynn ross handbook of biometrics springer 2008 2 jain r bolle and s pankanti biometrics personal identiﬁcation in networked soci ety kluwer academic publishers dordrecht the netherlands 1999 3 d zhang automated biometrics technologies and systems kluwer academic publishers dordrecht the netherlands 2000 4 s nanavati m thieme and r nanavati biometrics identity veriﬁcation in networked world john wiley and sons inc 20025 p tower the fundus oculi in monozygotic twins report of six pairs of identical twins archives of ophthalmology vol 54 2 pp 225239 1955 6 rbhill retinalidentiﬁcation inbiometricspersonalidentiﬁcationinnetworkedsociety jain r bolle and s pankati eds p 126 springer berlin germany 1999 7 z w xu x x guo x hu and x cheng the blood vessel recognition of ocular fundusin proceedings of the 4th international conference on machine learning and cy bernetics icmlc 05 pp 44934498 guangzhou china august 2005 8 mortegacmarinomgpenedomblancoandfgonzalez biometricauthentication using digital retinal images in proceedings of the 5th wseas international conference on applied computer science acos 06 pp 422427 hangzhou china april 2006 9 h tabatabaee milanifard and h jafariani novel human identiﬁer system using retinaimageandfuzzyclusteringapproach inproceedingsofthe2ndieeeinternational conference on information and communication technologies ictta 06 pp 10311036 damascus syria april 2006 10 chalechale g naghdy and mertins sketchbased image matching using angular partitioning in ieee trans on systems man and cyberneticspart systems and humans vol 35 1 jan 2005 11 achalechalegnaghdyandamertins sketchbasedimageretrievalusingangularpar titioning in proc 3rd ieee international symposium on signal processing and information technology isspit 2003 pp 668671 dec 2003 12 jstaalmdabramoffmniemeijermaviergeverandbvanginneken ridgebased vesselsegmentationincolorimagesoftheretina ieeetransactionsonmedicalimaging vol 23 4 pp 501509 2004 13 r c gonzalez and r woods digital image processing addisonwesley 1992 14 gpassandrzabih histogramreﬁnementforcontentbasedimageretrieval inproc3rd ieee workshop on applications of computer vision 1996 pp 96102 15 bimbo visual information retrieval morgan kaufmann publishers 1999 16 c jacobs finkelstein and d h salesin fast multiresolution image querying in proc acm computer graphics siggraph 95 usa 1995 pp 277286 17 m bober mpeg7 visual shape describtion ieee trans circuits and systems for video technology vol 11 6 pp 716719 june 2001 18 chalechale and mertins an abstract image representation based on edge pixel neighborhood information epni lecture notes in computer science vol 2510 pp 67 74 2002 19 c s won d k park and s park efﬁcient use of mpeg7 edge histogram descriptor etri journal vol 24 1 pp 2330 feb 2002