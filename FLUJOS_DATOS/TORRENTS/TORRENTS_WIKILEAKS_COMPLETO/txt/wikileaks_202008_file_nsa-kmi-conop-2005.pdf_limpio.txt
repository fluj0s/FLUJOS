unclassifiedfor official use only unclassifiedfor official use only technical report u concept of operations for the key management infrastructure capability increment two version 14 e001 iamac technical task order 2104 information assurance mission attainment iamac contract mda90403c1074 900 elkridge landing road linthicum maryland 21090 30 september 2005 unclassifiedfor official use only i unclassifiedfor official use only this page intentionally left blank unclassifiedfor official use only ii unclassifiedfor official use only key management infrastructure 30 september 2005 version 14 u kmi2212 concept of operations conop for the key management infrastructure kmi capability increment two ci2 u this document states provides system overview and also specifies functions for ordering distributing and other managing prod ucts and services i56 kmi program management team national security agency 9800 savage road ste 6751 ft meade md 207556751 not releasable to the defense technical information center per dod instruction 320012 this document contains information exempt from mand atory disclosure under the foia exemption 3 unclassifiedfor official use only iii unclassifiedfor official use only table of contents page number 1 u scope 13 11 u identification 13 12 u document overview 13 13 u system overview 13 2 u reference documents 15 3 u current system 15 31 u background objectives and scope 15 32 u operational policies and constraints 16 33 u description of the current system 17 34 u current key management user roles 17 341 u cmcs ekms roles 18 4 u justification for and nature of changes 19 41 u justification of changes 19 42 u description of desired changes 19 5 u concept for the proposed system 20 51 u background objectives and scope 20 52 u operational policies and constraints 24 53 u description of the proposed system 24 531 u kmi basic architecture 24 532 u client nodes and transfer devices 25 5321 u clientcreation components 25 5322 u kmi manager clients 26 5323 u deliveryonly clients 27 5324 u embedded mpmss clients 28 5325 u fill devices and ecus 28 533 u ci2 functions 28 5331 u registration 28 5332 u privilege management 29 unclassifiedfor official use only iv unclassifiedfor official use only 5333 u enrollment 29 5334 u key ordering 30 5335 u distribution management 31 5336 u key generation and production 31 5337 u key distribution and ecu fill 31 5338 u rekey services 33 5339 u tracking accounting and auditing 34 53310 u status reporting 34 53311 u ekms translator 35 53312 u destruction 35 534 u kmi operating accounts 35 5341 u overview 35 5342 u makeup of koa 36 5343 u koa manager and koa agent privileges 37 535 u ci2 communications 39 5351 u communications backbones 39 5352 u kmi protected channels 39 54 u modes of operation for the proposed system 39 541 u kmi access control concepts 39 5411 u rolebased access control 40 5412 u rulebased access control 40 5413 approvalbased access control 40 542 u interoperability considerations 41 5421 u interoperability with us legacy key man agement systems 41 5422 u foreign interoperabilitykmi access 43 55 u kmi roles 44 551 u external operational management roles 45 5511 u ordering and distribution managers 46 5512 u registration management roles 47 5513 u enrollment manager 48 5514 u serviceagency help desk manager 4 8 552 u external administrative management roles 49 5521 u client platform administrator 49 5522 u client platform system security officer sso 49 553 u internal operational management roles 49 unclassifiedfor official use only v unclassifiedfor official use only 5531 u access control service managers 49 5532 u user support service managers 50 5533 u event services manager 50 5534 u catalog manager 50 554 u internal administrative management roles 50 5541 u security administration ssos 50 5542 u client node administrators 51 555 u nonmanagement roles 51 5551 u koa agent 51 56 u support environment 51 561 u personnel support 51 562 u communications support 52 563 u logistical support 53 5631 u training 53 5632 u status monitoring and system maintenanc 53 5633 u help desk 54 6 operational scenarios 54 61 manager activation process 55 611 u register kmi manager 57 6111 u summary 57 6112 u sequence diagram 57 6113 u kmi roles involved 57 6114 u kmi nodes involved 57 6115 u prerequisites 57 6116 u sequence of events 58 612 u enrollment of manager 59 6121 u summary 59 6122 u sequence diagram 59 6123 u kmi roles involved 59 6124 u kmi nodes involved 59 6125 u prerequisites 59 6126 u sequence of events 60 613 u initialization of token 61 6131 u summary 61 6132 u sequence diagram 61 unclassifiedfor official use only vi unclassifiedfor official use only 6133 u kmi roles involved 61 6134 u kmi nodes involved 61 6135 u prerequisites 61 6136 u sequence of events 62 614 u endorsement of token 63 6141 u summary 63 6142 u sequence diagram 63 6143 u kmi roles involved 63 6144 u kmi nodes involved 63 6145 u prerequisites 64 6146 u sequence of events 64 615 u activation of token 65 6151 u summary 65 6152 u sequence diagram 65 6153 u kmi roles involved 65 6154 u kmi nodes involved 65 6155 u prerequisites 66 6156 u sequence of events 66 616 u deregister manager from kmi 67 6161 u summary 67 6162 u sequence diagram 67 6163 u kmi roles involved 67 6164 u kmi nodes involved 68 6165 u prerequisites 68 6166 u sequence of events 68 617 u change enrollment of kmi manager 69 6171 u summary 69 6172 u sequence diagram 69 6173 u kmi roles involved 69 6174 u kmi nodes involved 70 6175 u prerequisites 70 6176 u sequence of events 70 62 kmi operating account koa registration proces s 71 621 u registration of kmi operating account koa 72 6211 u summary 72 6212 u sequence diagram 72 6213 u kmi roles involved 72 unclassifiedfor official use only vii unclassifiedfor official use only 6214 u kmi nodes involved 73 6215 u prerequisites 73 6216 u sequence of events 73 63 kmiaware device activation process 75 631 u register kmi aware device 76 6311 u summary 76 6312 u sequence diagram 76 6313 u kmi roles involved 76 6314 u kmi nodes involved 77 6315 u prerequisites 77 6316 u sequence of events 77 632 u endorsement of kmi aware device 78 6321 u summary 78 6322 u sequence diagrams 78 6323 u kmi roles involved 79 6324 u kmi nodes involved 79 6325 u prerequisites 79 6326 u sequence of events 80 633 u activation of kmi aware device 82 6331 u summary 82 6332 u sequence diagram 82 6333 u kmi roles involved 82 6334 u kmi nodes involved 83 6335 u prerequisites 83 6336 u sequence of events 83 64 product ordering and retrieval process symmet ric key 84 641 u establishment of new product requirement for s ymmetric key 85 6411 u summary 85 6412 u sequence diagram 85 6413 u kmi roles involved 85 6414 u kmi nodes involved 86 6415 u prerequisites 86 6416 u sequence of events 86 642 u account distribution profile adp management 87 6421 u summary 87 6422 u sequence diagram 87 unclassifiedfor official use only viii unclassifiedfor official use only 6423 u kmi roles involved 87 6424 u kmi nodes involved 87 6425 u prerequisites 88 6426 u sequence of events 88 643 u device distribution profile ddp management 89 6431 u summary 89 6432 u sequence diagram 89 6433 u kmi roles involved 89 6434 u kmi nodes involved 90 6435 u prerequisites 90 6436 u sequence of events 90 644 u ordering of symmetric keys other than standin g orders 91 6441 u summary 91 6442 u sequence diagram 91 6443 u kmi roles involved 91 6444 u kmi nodes involved 91 6445 u prerequisites 92 6446 u sequence of events 92 65 product ordering and distribution process asy mmetric key 93 651 u establishment of partitiondao code privileges for asymmetric key ordering 94 6511 u summary 94 6512 u sequence diagram 94 6513 u kmi roles involved 94 6514 u kmi nodes involved 94 6515 u prerequisites 95 6516 u sequence of events 95 652 u ordering of asymmetric key 96 6521 u summary 96 6522 u sequence diagram 96 6523 u kmi roles involved 96 6524 u kmi nodes involved 96 6525 u prerequisites 96 6526 u sequence of events 97 653 u credential upload 98 6531 u summary 98 unclassifiedfor official use only ix unclassifiedfor official use only 6532 u sequence diagram 98 6533 u kmi roles involved 98 6534 u kmi nodes involved 98 6535 u prerequisites 98 6536 u sequence of events 99 654 u generation and production 100 6541 u summary 100 6542 u sequence diagram 100 6543 u kmi roles involved 100 6544 u kmi nodes involved 100 6545 u prerequisites 101 6546 u sequence of events 101 655 u electronic product retrieval 102 6551 u summary 102 6552 u sequence diagram 102 6553 u kmi roles involved 102 6554 u kmi nodes involved 102 6555 u prerequisites 103 6556 u sequence of events 103 656 u physical product distribution 105 6561 u summary 105 6562 u sequence diagram 105 6563 u kmi roles involved 105 6564 u kmi nodes involved 105 6565 u prerequisites 106 6566 u sequence of events 106 7 u summary of impacts 106 71 u ci2 and legacy key management systems 106 72 u operational impacts 107 73 u kmi ci2 transition philosophy 108 74 u kmi ci2 transition implementation 108 741 u ekms tier 1 system 109 742 u comsec account transition options 109 75 u organizational impacts 110 unclassifiedfor official use only x unclassifiedfor official use only 76 u transition of privileges from ekms to kmi 110 761 ufouo firefly management and privileging 110 762 u traditional key management and privileging 111 763 ufouo comsec account privileges 111 77 u accounting 111 8 u analysis of the proposed system 112 81 u summary of improvements 112 82 u disadvantages and limitations 113 u glossary 114 u acronyms 118 appendix ekms transactions 121 list of tables table 1 u kmi r oles 45 table 2 u k ey management entities in ci2 52 unclassifiedfor official use only xi unclassifiedfor official use only list of figures figure 1 u f uture kmi perational view 14 figure 2 u c urrent key management systems 16 figure 3 ufouo kmi ci2 s ystem architecture sv1 23 figure 4 u kmi n odal architecture 24 figure 5 u h uman user client interactions with prsn 26 figure 6 u t ypes of fill ports in user devices 32 figure 7 ufouo types of kmi d istribution paths 33 figure 8 u m anager activation process 56 figure 9 u r egister kmi m anager 57 figure 10 u nrollment of manager 59 figure 11 u i nitialization of token 61 figure 12 u ndorsement of token 63 figure 13 u ctivation of token 65 figure 14 u d eregister manager from kmi 67 figure 15 u c hange enrollment of kmi m anager 69 figure 16 u koa r egistration process 71 figure 17 u r egistration of kmi perating account koa 72 figure 18 u kmia ware device activation process 75 figure 19 u r egister kmi ware device 76 figure 20 u ndorsement kmi ware device networked 78 figure 21 u ndorsement kmi ware device disconnected 79 figure 22 u ctivation provisioning kmi ware device 82 figure 23 u p roduct ordering and retrieval 84 figure 24 u stablishment of new product requirement for symmetric key85 figure 25 u ccount distribution profile adp m anagement 87 figure 26 u d evice distribution profile ddp m anagement 89 figure 27 u rdering of symmetric keys 91 figure 28 u p roduct ordering and distribution process asymmetric key93 figure 29 u stablishment of partition dao c ode privileges for asymmetric key ordering 94 figure 30 u rdering of asymmetric key 96 figure 31 u c redential upload 98 figure 32 u g eneration and production 100 figure 33 u lectronic product retrieval 102 figure 34 u p hysical product distribution 105 unclassifiedfor official use only xii unclassifiedfor official use only this page intentionally left blankkmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 13 unclassifiedfor official use only 1 u scope 1 u this document presents the concept of operation s conop for the department of 2 defense dod key management infrastructure kmi capability increment 2 ci2 it 3 provides an overview of the concepts and functional ity for ci2 and useroriented 4 operational view of the system illustrating common system operations in storyboard 5 form 6 11 u identification 7 u this document is kmi 2212 this is revision 1 4 8 12 u document overview 9 u this document is divided into eight sections this section provides administrative 10 information document overview and very brief system overview 11 u section 2 lists reference documents 12 u section 3 describes the existing operational vironment into which the 13 capabilities provided by kmi ci2 will be introduce d 14 u section 4 presents the justification for develo ping and fielding kmi ci2 15 capabilities 16 u section 5 provides description of the propose d kmi ci2 system and 17 capabilities 18 u section 6 presents operational scenarios for km i ci2 in the form of 19 storyboards 20 u section 7 summarizes the impacts that the devel opment and fielding of kmi 21 ci2 are expected to have on the user community 22 u section 8 presents brief analysis of the bene fits and limitations of ci2 23 13 u system overview 24 u the target kmi1 will be single automated networkaccessible lectronicbased 25 key management and predominantly electronic cryptog raphic product delivery 26 infrastructure this new infrastructure will provi means for the secure ordering 27 generation production distribution management an d auditing of cryptographic products 28 eg asymmetric key traditional symmetric keys manual cryptographic systems and 29 cryptographic applications figure 1 provides an operational overview of the target 30 kmi kmi ci2 will be the initial fielding of capa bilities for network based management 31 of cryptographic products and services along deve lopment path toward the target kmi 32 1 target kmi is phrase that refers to the archit ecture and capabilities that kmi development effort s are intended to realize over time each capability in crement should move the current kmi closer to the target architecture the initial kmi target archit ecture was defined during 19992000 it is the inte nt of the kmi program that the target architecture be per iodically revisited and updated in this conop k refers to the capabilities described by the conop nd should be considered equivalent to kmi ci2 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 14 unclassifiedfor official use only common kmi processescommon kmi processescentral kmiidms products servicescentral kmiidms products servicesallied ops communityallied ops community niprnet siprnet public internet pstn isdnniprnet siprnet public internet pstn isdn kmi usersdoctrine policydoctrine policy jwicsjwicscommon kmi processescommon kmi processescentral kmiidms products servicescentral kmiidms products servicesallied ops communityallied ops community niprnet siprnet public internet pstn isdnniprnet siprnet public internet pstn isdn kmi usersdoctrine policydoctrine policy jwicsjwics 33 figure 1 u future kmi operational view 34 u it is important to note that successful impleme ntation of kmi requires more than 35 transferring cryptographic products from point to point b because of their sensitive 36 nature cryptographic products are strictly control led from cradle to grave kmi will 37 accomplish these control and management processes f aster and with less user burden than 38 current systems through secure automation kmi wil l use common networks such as the 39 nonclassified internet protocol routing network n iprnet and the secret internet 40 protocol routing network siprnet to the maximum xtent allowed by policy and 41 doctrine access to some kmi services such as bla ck key delivery is expected to be 42 through generalpurpose computers not dedicated to kmirelated uses more sensitive 43 kmi services however will continue to require ded icated workstations in the ci2 44 timeframe 45 u kmi will create levels of management including central services eg creation of 46 key security operations storage and audit tacti cal management eg distribution of key 47 in communicationchallenged environments and local management eg requesting and 48 receiving key for local weapon systems the targe t kmi will consolidate existing stove 49 pipe key management capabilities ci2 will provi networkoriented key management 50 and delivery capabilities and begin to provide pa th for transition away from the existing 51 physical and electronic communications security co msec material systems as 52 supporting infrastructure for the global informatio n grid gig the kmi will provide 53 products used by end cryptographic units ecus ci2 will both support legacy ecus 54 and provide the foundation that will evolve to supp ort the modern key management 55 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 15 unclassifiedfor official use only concepts being developed for ecu management as part of the national security 56 agencys nsas cryptographic modernization initia tive cmi additionally kmi is 57 intended to enable approved mission planningmanage mentsupport systems mpmss 58 to integrate key distribution with other informatio n management functions required for 59 the system the mpmss supports 60 u kmi will also support help desks operated by th military services and other kmi 61 customer agencies and electronic key distribution f or other systemsdevices eg stand 62 alone command and control c2 systems data transf er devices etc additionally 63 kmi will support services associated with security applications in the common operating 64 environment eg operating system security softw are downloading auditing intrusion 65 detection and password management 66 2 u reference documents 67 the following documents are referenced herein 68 1 u kmi ci2 cdd draft for flag level coordination version 2 apr il 14 2005 69 2 u concept for the kmi kmi 1001 16 june 1999 70 3 u kmi 2200 u system description and require ments specification 71 sdrs for key management infrastructure kmi capa bility increment 2 ci 72 2 volume 1 key management functions and related r equirements v 22 30 73 september 2005 74 4 u kmi 2200 u system description and require ments specification 75 sdrs for key management infrastructure kmi capa bility increment 2 ci 76 2 volume 2 system security policy and related req uirements v 22 30 77 september 2005 78 5 u kmi 2200 u system description and require ments specification 79 sdrs for key management infrastructure kmi capa bility increment 2 ci 80 2 volume 3 system security architecture and relat ed requirements v 22 81 30 september 2005 82 3 u current system 83 u this section summarizes the existing key manage ment infrastructure implementation 84 capabilities and user roles 85 31 u background objectives and scope 86 ufouo the current key management environment is made up of separate and 87 independent infrastructures that provide and manage their own set of security products 88 these systems will become increasingly cumbersome nd costly as new technology and 89 their attendant security solutions continue to adva nce and the resources available to 90 operate them decline this key management environme nt depicted in figure 2 is 91 composed of several unique solutions built for spec ific product lines while the solutions 92 satisfy unique security needs they each require di fferent tools and training in order to 93 obtain their respective products and services impo sing an unwarranted strain on 94 resources 95 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 16 unclassifiedfor official use only ufouo adding new key management capability s frequently meant creating 96 new independent system to support it continuing this approach will increasingly tax 97 resources throughout the community 98 u several of the systems in figure 2 have been in existence for number of years and 99 are in need of upgrade to take advantage of modern communication technology this 100 technology area has advanced significantly in recen t years providing the market place 101 with many new and worthwhile capabilities that woul d greatly improve efficiency and 102 performance 103 u kmi ci2 will focus on moving electronic key ma nagement system ekms and 104 physical key toward more networkoriented method this new method will have 105 impact on the dod public key infrastructure pki r on the missi pki the kmi 106 cdd discusses the dependencies between the dod pki and kmi ci2 107 cpsc online ekms missi pki dod pki comm pki manual systemsmanual systemselectronically keyed systemselectronically keyed systemsx509based systemsx509based systemspc appspc apps pc appscawlmd kpnsa iad disa commercial physical cpsc online was formerly known as kso exchange k seodtd 2000 plus dtd dtd 2000 108 figure 2 u current key management systems 109 32 u operational policies and constraints 110 u dod comsec operations and the ekms are operated under the guidance of the 111 following policy documents 112 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 17 unclassifiedfor official use only ekms comsec material control system cmcs policy documents 113 u nstissi 4005 safeguarding communications secur ity comsec 114 facilities and materials august 1997 115 u nstissi 4006 controlling authorities for comse c material 116 2 december 1991 117 u ekms 103a security policy for the electronic k ey management system 118 ekms 22 january 1997 ekms phase 3 baseline 119 u information assurance directorate iad policy statement 17 120 cryptographic key protection policy 16 july 2002 121 u nstissi 4005 annex f safeguarding comsec mate rial in electronic 122 form draft 123 33 u description of the current system 124 ufouo the nsa today operates key management inf rastructures in support of the 125 information assurance needs of its customer communi ty providing cryptographic key 126 products symmetric public and private keys and s ecurity services for military 127 intelligence allied government contractor and bu siness customers worldwide this 128 support is provided either by the creation and dist ribution of physical product or 129 creation and distribution of product in an electr onic format through the ekms 130 ufouo ekms has been evolving since its inceptio n in 1989 and is built on model 131 of multiple distributed elements using messaging ov er dialup or dedicated 132 communication paths the military services have id entified number of improvements 133 and changes they desire to see in ekms 134 ufouo the physical comsec material control syst em cmcs used to provision 135 hard copy cryptographic products eg printed ke manual systems is time consuming 136 and inefficient in comparison to its electronic cou nterpart considerable leadtime and 137 resources are required to support these products an d assure their availability when 138 needed 139 ufouo it is anticipated that requirements for s upport of classified applications will 140 continue to grow as new cryptographic solutions ch as secure wireless and global 141 positioning system modernization are implemented it is the intent of the kmi to 142 enhance the dods capability to support these missi oncritical requirements 143 34 u current key management user roles 144 u the existing systems that constitute the set of current operational key management 145 infrastructures include number of implicit or exp licit user roles ie job functions 146 depending on variety of factors these roles may be fulltime job or an additional duty 147 as assigned for the individual performing them in some circumstances single user 148 performs multiple roles which taken together consti tute fulltime position the user 149 roles that have been identified for the existing sy stems are described here they are related 150 to the roles proposed for kmi ci2 in section 56 151 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 18 unclassifiedfor official use only 341 u cmcs ekms roles 152 ufouo the roles commonly recognized in the cmcs developed over time based on 153 mixture of operations and policy many of these roles were incorporated into ekms 154 sometimes under different names in addition the development of fireflykeyed 155 devices during the 1980s led to the creation of rol related to the management of 156 firefly key the needs of these roles are also supp orted under ekms 157 ufouo controlling authority conauth official responsible for 158 directing the operation of cryptonet and for mana ging the operational use and 159 control of keying material assigned to the cryptone t conauth may have 160 responsibility for single cryptonet or for lar ge number of such nets key is 161 distributed to the comsec accounts supporting the c ommunications stations in 162 the net at the direction of the conauth the conau th typically manages 163 key distribution to ensure the cryptonet membership is consistent with operational 164 direction received from the communications planning elements in most cases 165 conauths are not participants in the cryptonets the manage personnel at the 166 service authorities often assist conauths in carryi ng out their responsibilities 167 serving as facilitators for the conauth in interact ions with nsas key 168 production elements eg ensuring that all of the necessary information is 169 provided to nsa 170 ufouo central office of record cor cor is the office of federal 171 department or agency that keeps records of accounta ble comsec material held 172 by elements subject to its oversight each militar service currently operates its 173 own cor in the future the services will convert t use the ekms tier 1 system 174 as the cor consolidating cor functions to the tier 1 facilities at san antonio 175 and fort huachuca 176 ufouo comsec custodian comsec manager comsec 177 custodian is the individual designated by proper au thority to be responsible for 178 the receipt transfer accounting safeguarding an d destruction of comsec 179 material assigned to comsec account key materia l and accountable 180 cryptographic equipment is distributed to and local ly controlled and managed by 181 comsec accounts the individual responsible for th operations of comsec 182 account is known variously as comsec custodian or comsec manager if 183 an account is equipped with an ekms local managemen t devicekey processor 184 lmdkp the custodian manager is the operator of the lmdkp 185 ufouo command authority the command authority is responsible for 186 the appointment of user representatives for depar tment agency or organization 187 and their key ordering privileges the command aut hority verifies the identities 188 of user representatives designated by various parts of the organization to order 189 key determines the ordering privileges of each use r representative and 190 communicates that privileging information to the fi refly key production 191 system operated by nsa 192 ufouo registration authority ra the ekms registration process 193 provides the administrative and technical means by which key management 194 entity kme is established and the information re garding the kme recorded in 195 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 19 unclassifiedfor official use only the ekms directory the term kme applies to any ac countelementorganization 196 that can perform key management functions ekms ra s are located at tier 0 197 for civil agency and nsa accounts and tier 1 for service accounts the ra 198 is responsible for registering kmes and managing th eir status as part of the 199 registration process the ra ensures that kmes kms identifier id and 200 associated attributes eg clearance level couri er address for comsec 201 accounts are assigned and maintained in the ekms d irectory 202 ufouo user representative user representative is authorized by an 203 organization to order firefly key and interface wit h the keying system provide 204 information to key users and ensure the correct ty pe of key is ordered the user 205 representative acts within the privileges establish ed for that individual by the 206 command authority who appointed him or her 207 ufouo local element local elements are separate entities units or 208 commands internal or external to the parent comsec account that requires 209 comsec material receive their electronic coms ec material from parent 210 comsec account or subaccount and never directly fro m tier 1 or tier 0 211 are normally issued material for immediate use in cus but some are 212 responsible for routinely issuing material to other the local element concept 213 is known by other organizationspecific names such as comsec responsible 214 officer in the air force 215 4 u justification for and nature of changes 216 u this section summarizes the factors that motiva changing key management 217 infrastructure operations from the current approach to that planned for ci2 and beyond 218 41 u justification of changes 219 ufouo the kmi cdd identifies the shortcomings f existing capabilities and 220 drivers for change in how key management and key pr ovisioning are performed while 221 those documents should be consulted for specifics areas of concern with the current 222 systems include 223 1 u slow response to changing operational requir ements and conditions 224 2 ufouo incompatibility between ekms and widel yused military 225 communications systems 226 3 u inability to integrate key distribution into mpmss 227 4 u poor support for tactical operations and all ied interoperability 228 5 u desire to support modern and indevelopment cryptographic devices and 229 management techniques 230 6 u difficult user interfaces and manpower inten sive operations 231 42 u description of desired changes 232 u in the development of the kmi target architectu re and the kmi cdd along with 233 various meetings with the military service and civi l agency customer community 234 representatives number of desired changes to the existing key management 235 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 20 unclassifiedfor official use only infrastructures have been identified in addition the ongoing development of 236 cryptographic modernization concepts has identified other features needed in the kmi to 237 support the next generation of ecus number of g oals have been identified for key 238 management infrastructure modernization and the co ncepts for kmi ci2 include 239 number of features that move toward achieving those goals 240 u goals 241 u reduce the manpower required for kmi operation and use 242 u minimize the requirement for computer workstati ons dedicated to kmi 243 operations 244 u use commonopenstandard computer platforms 245 u provide communications flexibility and permit use of widely used 246 backbone network and tactical communications system s 247 u support autonomous operations within combatant commander areas of 248 responsibility 249 u scalability 250 u transparency 251 u releasability and interoperability 252 u graceful evolution 253 ufouo key delivery direct to ecus 254 u develop commonopenstandard applications and i nterface standards for 255 kmi products 256 u develop reusable kmi software applications 257 u features 258 u modular architecture with logical division of f unctions 259 ufouo network connectivity to niprnet siprnet internet 260 ufouo type 1 support for tokens 261 u flexibility of client implementation and config uration 262 u improved more usable human machine interface hmi 263 u ready availability of status information 264 u catalog of products and services 265 u accounting automation 266 u autonomous operations 267 u designed for interoperability and releaseabilit 268 5 u concept for the proposed system 269 u this section presents brief description of th proposed ci2 system and provides 270 context for the operational storyboards presented i n section 6 271 51 u background objectives and scope 272 ufouo the focus of ci2 is to build the foundat ion for the future management of 273 key material in generalpurpose networking enviro nment given the risks inherent in 274 such an environment ci2 will have correspondingly stringent security requirements 275 u the ci2 development will focus on achieving th following objectives 276 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 21 unclassifiedfor official use only i ufouo establish secure net presence for kmi for key man agement this 277 includes complete development of the prsn filters access control role 278 management virtual private network vpn user int erface services net 279 management services directory services etc neede d to provide this capability 280 there will be kmi network presence on the niprnet siprnet and public 281 internet2 kmi network interactions will be based on common internetstandard 282 communications protocols for world wide web email file transfer and similar 283 functions 284 ii u enable customer transition from ekms to kmi this objective encompasses 285 two major aspects 286 1 ufouo establishing translator between the prsn and ekms messaging 287 system to facilitate transition of ekms users to km i ci2 the translator will 288 enable ekms functions and transactions to be transf erred between the ekms 289 messaging system and the prsn to permit ordering fr om tier 1 tier 1 x1 tier 290 2 accounting transactions all tier 1 x1 tier 2 distribution transactions all tier 291 2 x1 tier 2 distribution transactions movement of dire ctory information etc 292 2 ufouo developing kmi client set that ekms users can transition to 293 the client set must support some or all of the ekms based 294 functionstransactions listed above and interface with the prsn via the 295 networkbased user interface services the prsn prov ides eg web 296 iii ufouo provide webbased key ordering for all key types ci2 will provide 297 kmi customers the means to order all forms of key including symmetric 298 traditional key asymmetric modern key and man ual systems in variety of 299 electronic and physical form factors 300 iv ufouo provide over the network keying otnk directly to ecus part 301 of the kmi vision is to provide key distribution fr om prsn to network 302 connected ecus registered in the kmi and capable of direct interactions with the 303 kmi the high assurance internet protocol encrypto r haipe family of ecus 304 will be the first products prepared to make use of this capability ci2 will 305 provide an otnk capability based on the kmi access protocol specifications 306 currently being drafted 307 v ufouo enable the integration of key distribution function s into dedicated 308 mission management systems many existing and new systems require dedicated 309 mission management systems examples include aircra ft and satellite communica 310 tions terminals these systems typically include mpmss component to collect 311 organize and distribute data that is required for t he other system components to 312 function ci2 provides tools that can be used to nable mpmss to retrieve 313 black or benign key from prsn product delivery clave pde acting as 314 kmi operating account koa agent in the ci2 tim eframe ordering and 315 2 niprnet is separated from the internet here based on the expectation that in the future dod pki certificate will be required for niprnet access m any allied and coalition partner kmi users with the need to retrieve key material from the kmi will not have such certificates necessitating direct conne ctions to both internet and niprnet kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 22 unclassifiedfor official use only management of key will be performed using kmi manag er clients or ekms 316 capabilities 317 vi ufouo provide access to nonus users to manage and ret rieve 318 interoperable key management products and services todays operational 319 environment mandates effective interoperability acr oss the dod and us federal 320 communities including homeland security and when operational needs dictate 321 with allies and coalition partners to this end the kmi must provide controlled 322 access to authorized nonusers to request and obtai n interoperable key 323 management products and services in the ci2 timef rame authorized nonus 324 users will be granted appropriate management and pr oduct retrieval privileges 325 necessary to ensure mission interoperability addit ionally registered nonus 326 kmi aware devices will also be granted kmi access f or retrieval of benign 327 interoperable key 328 vii ufouo provide hardware token support for kmi ma nagement functions 329 kmi ci2 will support hardware tokens loaded with type 1 pki certificates 330 331 u figure 3 depicts the ci2 system architecture 332 333 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 23 unclassifiedfor official use only 333 figure 3 ufouo kmi ci2 system architecture s v1 334 335 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 24 unclassifiedfor official use only 335 52 u operational policies and constraints 336 ufouo the kmi ci2 sdrs volume 2 covers the curity policies and 337 requirements for ci2 that document integrates th requirements imposed by the new 338 dod 8500series documents relevant policy stateme nts from that document are 339 captured in the individual storyboards 340 u nstissi 4005 annex f discusses policy and proc esses to be used when generating 341 and delivering electronic key material 342 53 u description of the proposed system 343 u this section describes the proposed kmi ci2 sy stem including basic architecture 344 central and client nodes and system functions fea tures and capabilities 345 531 u kmi basic architecture 346 u the kmi consists of number of nodes that pro vide unified infrastructure for 347 providing key management products and services sup porting wide variety of users in 348 the kmi users are either consumers that depend on the kmi for products and services or 349 managers that allocate and control resources within the kmi customer organizations will 350 typically have mixture of users and managers l ogical configuration of kmi node 351 types along with the functions allocated to each type is shown in figure 4 352 akp dod commonuse and public networkskmi private networks ecukmi ci2 central services node csn catalog management and distribution data archive and analysis center security and operations oversight product source nodes psns cryptographic material generation product packaging product vault rekey conversion of seed key primary services nodes prsns user registration roles privileges request processing distribution tracking customer support kmiekms interface client nodes productservice request retrieval use productcrypto device management operating account managementekms translator reenveloping of transactions defined by ekms standards csn ecu ecupsns psns client nodes for managementclient nodes for distributionclient nodes for managementclient nodes for distribution fill devicehumanfill devicehumanekms translator prsns prsns prsns prsns 353 figure 4 u kmi nodal architecture 354 ufouo four types of functional nodes comprise t he kmi 355 ufouo prsn 356 ufouo central services nodes csns 357 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 25 unclassifiedfor official use only ufouo production sources nodes psns and 358 ufouo client nodes 359 ufouo the prsns are central to the kmi and pro vide services to the client nodes 360 over one or more communications networks the psns are responsible for generating 361 cryptographic products and the csn oversees system security operations provides 362 oversight of storage and replication of common data for prsn and psn use and 363 manages the content and distribution of the kmi pro duct catalog to prsns and psns 364 ufouo client nodes cover broad category of co mponents andor software 365 applications that provide user access to the prod ucts and services of the kmi they can 366 take variety of forms including security devices eg ecus applications installed on 367 workstations eg kmi client node to clients mbedded in enterprise systems eg an 368 mpmss clients can securely interface with the pr sn and allow users to perform 369 management functions or request and receive product s and services from the kmi 370 ufouo the nodes that comprise the kmi may be wi dely distributed or collocated 371 within central or regional sites such sites may be connected by variety of dod and 372 commercial communications networks 373 532 u client nodes and transfer devices 374 u the kmi ci2 architecture includes number of different clients intended to address 375 spectrum of kmi user needs the client types des cribed here are proposed set based 376 on kmi operating concepts developed by the ci2 eng ineering team feedback from the 377 customer community regarding the utility of each ty pe is expected to influence the 378 characteristics and quantities of each client 379 5321 u clientcreation components 380 u three components are envisioned to serve as bu ilding blocks for the creation of 381 kmi clients computing platform key management software applications and the 382 advanced key processor akp 383 53211 u advanced key processor 384 ufouo the akp is successor to the ekms kp wi th similar functionality 385 enhanced performance and modular architecture to provide configurability and 386 simplify evolution of the akps capabilities the kps modular architecture allows 387 capabilities to be included or omitted as necessary to match the needs of kmi 388 customers mission it also supports the need to pr ovide version of the akp releasable to 389 allies capabilities that can be configured into n akp will include 390 symmetric key generation 391 cooperative creation of key encryption keys 392 key wrapping and unwrapping 393 digital signature creation and verification 394 establishment of secure channel from client node to prsn 395 identification and authentication of kmi managers 396 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 26 unclassifiedfor official use only source authentication and integrity protection of k transactions 397 support for secure local storage of electronic key 398 interactions with fill devices 399 53212 u key management software applications 400 u given the varying needs of the kmi user communi ty kmi clients may need one or 401 more of collection of key management applications examples of such applications 402 would be modules to 403 u support accounting for physical key products 404 u assist in ordering and managing modern key 405 u assist in managing files containing download crypted keys and loading 406 appropriate files into transfer devices for ecu loa ding 407 u the specific set of key management applications software modules for ci2 will be 408 determined as part of the client engineering effort 409 5322 u kmi manager clients 410 ufouo figure 5 illustrates the basic types of c lient configurations and their 411 connections to the prsn manager clients mgcs co nnect to prsn ordering and 412 management enclaves omes to conduct functions rel ated to registration enrollment 413 ordering and koa operations 414 figure 5 u human user client interactions with p rsn 415 ufouo an mgc is kmi client equipped with an kp and is used when 416 performing management functions such client is dedicated to kmi management 417 purposes due to the sensitivity of the kmi capabili ties is can access when used for 418 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 27 unclassifiedfor official use only operation at koa see section 534 the mgc is the kmi analog to the ekms 419 lmdkp it is capable of operating independently f prsn for many functions and 420 includes cryptographic processing support using its akp characteristics of mgcs 421 include 422 u supports all kmi functions that can be performe d with nonakpequipped 423 client 424 ufouo incorporates haipecompliant inline ne twork encryptor ine to 425 establish protected communications channels between the client and the prsn 426 ufouo provides local capability to unwrap and r ewrap black key material 427 received from other kmi nodes or ekms elements 428 ufouo provides capability to wrap key material for benign delivery to ecus 429 ufouo provides local capability to wrap key mat erial for transfer to other 430 akpequipped clients via the prsn or to ekms lmdk ps via the prsn and 431 the ekms translator 432 u provides the ability to sign messages and verif signatures on received 433 messages 434 ufouo locally generates key material using the akp 435 u maintains local data stores consistent with its operational needs synchronizes 436 its local data stores with the prsn when connectivi ty is available 437 ufouo implements security services necessary to protect kmi information 438 and interactions enforces access control privile ge restrictions based on 439 information propagated from prsn or established t the client by an 440 appropriately privileged kmi manager 441 ufouo unwraps key encrypted for transfer or sto rage and outputs key in red 442 format for emergency fill capability use of this c apability should be restricted to 443 urgent situations with benign fill from the client to the ecu or the use of 444 transfer device that outputs red key being the pref erred modes of operation 445 ufouo the specific capabilities of an akpequip ped manager client are dependent 446 on the configuration of the akp and the set of key management software applications 447 loaded on the client 448 5323 u deliveryonly clients 449 ufouo deliveryonly client docs are not equip ped with akps they interface to 450 the pdes of kmi prsns to retrieve wrapped key mater ial 451 u docs are oriented toward the needs of kmi users with need to unwrap rewrap 452 or locally generate key material the essential co mponents of doc are general 453 purpose computer with web browser application ope rated by registered user with pki 454 credentials or username and password for identifi cation and authentication ia 455 such user is known as koa agent characteristi cs of docs include 456 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 28 unclassifiedfor official use only u receives key wrapped for delivery to ecus assoc iated with the koa 457 u uploads credentials for ecus and that will be r eceiving key to prsn to 458 supporting recipientspecific key wrapping 459 u includes local data storage or management ot her than for downloaded 460 black or benign key material and ecu credentials an dor tracking information 461 awaiting upload dependent on connectivity to prsn and on data stored at those 462 service nodes 463 5324 u embedded mpmss clients 464 ufouo many existing and especially new system s require the supply of various 465 information items to the end user device eg an aircraft satellite communications 466 terminal in order to function such systems typic ally have mpmss to collect the 467 relevant data from various sources eg systems t hat provide meteorological data or 468 frequency allocations organize it appropriately f or the using systems components and 469 distribute it for use goal of kmi is to enable the integration of key distribution with 470 the other functions performed by an mpmss when key is handled in black or benign 471 form it can be distributed like any other mission data the system requires consequently 472 ci2 includes the concept of embedding doc into n mpmss and permitting that 473 embedded mpmss client to interact directly with the kmi to receive wrapped key 474 material for distribution and use within the custom er system the mpmss operators who 475 employ this capability must be registered with the kmi and enrolled as koa agents 476 5325 u fill devices and ecus 477 ufouo while nsa is working on new generation of ecus capable of direct 478 interaction with the kmi in many cases ecus that need to be supported by kmi ci2 479 will not be network connected last mile transpo rt of black or benign key material 480 from kmi client to an ecu will need to be handled by fill device of some sort the 481 fill devices available in the ci2 timeframe will i nclude the secure dtd2000 system 482 sds the simple key loader skl and the data ma nagement device dmd which 483 all utilize the kov21 comsec card legacy ancyz 10 data transfer devices may 484 also still be available ci2 will support the use of the fill devices to move encrypted key 485 material from kmi clients to ecus in order to wra p key for ecus it will be necessary 486 to register them with the kmi and upload credential s eg ecu benign fill firefly 487 credentials to the kmi the kmi client nodes and the fill devices will support this 488 upload function ecus that are capable of direct k interaction will be able to upload 489 their credential directly the different ways for an ecu to receive key products are 490 described in the key distribution and ecu fill ction 491 533 u ci2 functions 492 u this section describes the functions performed by kmi ci2 493 5331 u registration 494 u ci2 requires the registration of kmi users and managers and of range of devices 495 that includes ecus and akps 496 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 29 unclassifiedfor official use only ufouo kmi managers kmi ci2 will register kmi managers and issue 497 them type 1 identification and authentication crede ntials for use with the akp 498 ufouo kmi operating accounts kmi ci2 will introduce the concept of 499 koa while koa is similar in principle to coms ec account its real 500 purpose is to serve as an organizing construct for the set of key destinations eg 501 ecus akps associated with particular organizati on or unit for ci2 all 502 koas will also be comsec accounts at some future p oint in the evolution of 503 the kmi that may longer be required 504 ufouo devices kmi ci2 will support the registration of devices akps 505 ecus and manager identity tokens devices may be registered with the prsn 506 general devices and supported with key wrapped by psn or registered only 507 with the client node of koa limited devices and supported with key wrapped 508 by the client nodes akp all devices will be asso ciated when registered with 509 an owning koa each device that will receive key m aterial generated and 510 wrapped by the kmi eg by psn or akp must sup ply credentials that can be 511 used by the kmi to create key encryption keys to wr ap key for delivery to that 512 device 513 5332 u privilege management 514 ufouo in order to manage the security of the k and regulate access to kmi 515 products and services and detect and deter unautho rized attackers ci2 will incorporate 516 robust privilege management capability 517 u ci2 access control will use rolebased access control robac concepts 518 augmented by rulebased access control rubac capa bilities basic set of 519 roles has been defined and these roles can be spec ialized to meet operational and 520 security needs 521 u the robac system for ci2 will permit appropria tely privileged kmi 522 managers to manage the set of the kmi roles and the privileges associated with 523 each in order to fit the robac approach to mesh wit h customer organizational 524 and operational concepts 525 u ci2 access control will also incorporate rubac features that take into 526 account attributes of the users and products in volved when determining if 527 particular action is permitted 528 u where necessary controlling authorities will lso be able to require 529 independent approval of requested actions such as changes in the distribution of 530 key product 531 u given the risks inherent in operating in netw orked environment access control is 532 critical security feature of kmi ci2 the basic c i2 access control concepts are 533 summarized in section 54 of this conop and descri bed in detail in the ci2 sdrs 534 volume 3 535 5333 u enrollment 536 ufouo the enrollment process is used to establi sh kmi users as kmi managers and 537 koa agents and determine the specific roles and pr ivileges those managers will be able 538 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 30 unclassifiedfor official use only to use nsa envisions that each customer organizat ion will have small number of 539 individuals who can act as enrollment managers reg ulating the kmi manager privileges 540 of users within their organization ci2 will enab an enrollment manager to 541 u identify individuals who should have kmi manage r privileges 542 u determine which kmi manager roles those individ uals can access 543 u manage the attributes associated with those ind ividuals 544 u remove attributes associated with individuals 545 u remove kmi manager roles user can access 546 u remove an individual from the role of kmi manag er 547 u have privileges themselves but not be able to assign privileges greater than 548 those they have been designated for 549 5334 u key ordering 550 ufouo primary ci2 objective is to provide ne tworkbased including both web 551 oriented and transactionoriented interfaces order ing of all key material3 the access 552 control and privileging features of the prsn will p lay an important role in enabling this 553 ordering capability while minimizing the potential for abuse the ci2 prsn will 554 u maintain product ordering catalog poc of pr oducts and services 555 available from the infrastructure the poc is distr ibuted to the prsn from the 556 csn 557 u allow kmi users and managers to view the subset of the poc that is 558 consistent with their roles privileges and attrib utes 559 u allow kmi managers to request new instances of kmi products eg new 560 short title these new products are added to the p oc consistent with the 561 requesting managers roles privileges and attribu tes 562 u allow kmi managers to manage the characteristic s of products for which 563 they are responsible consistent with their roles privileges and attributes 564 ufouo accept orders for symmetric traditional key asymmetric modern 565 key and manual systems and route those orders to t he appropriate psn in 566 accordance with the characteristics of the product and the directions of the 567 ordering manager 568 u provide for either automated or manual approval of product management 569 actions based on the attributes of the products involved and the roles and 570 attributes of the user or manager requesting the ac tion 571 ufouo allow controlling authorities or product requestors to request 572 copies of specific products and route those reques ts for approval to kmi 573 manager with the necessary approval authority eg controlling authority 574 3 while this primarily refers to type 1 key the exi sting kmi also supplies type 0 and type 2 key mater ial ci2 will be able to supporting ordering of those s well kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 31 unclassifiedfor official use only 5335 u distribution management 575 ufouo ci2 will provide features to manage the distribution of physical and 576 electronic key 577 u allow the responsible kmi manager eg cont rolling authority to view 578 and edit the account distribution profiles for the physical and electronic key they 579 control 580 ufouo add and delete recipient koas kmes and other recipient 581 comsec accounts 582 u modify copy counts for traditional key 583 u modify inplace dates and reserveonhand quant ities for traditional key 584 u allow the responsible kmi manager to establish subscriptions ie standing 585 orders and account distribution profiles of tradit ional key for those kmi users 586 that should receive the key regularly 587 u allow the responsible kmi manager to view the d istribution status 588 information for key products they control 589 u allow product recipients to view the distributi on status of products they are 590 scheduled to receive 591 u allow koa managers to view and edit the device distribution profiles and 592 manage the key wrapping for the electronic key thei r koas receive adding and 593 deleting key recipients eg akp ecus to the vice distribution profile for 594 each product 595 5336 u key generation and production 596 ufouo kmi ci2 will generate keys based on the orders it receives ci2 will 597 generate broad range of key types including 598 ufouo type 012 symmetric key 599 ufouo type 01 asymmetric key eg enhanced f irefly 600 ufouo manual systems 601 5337 u key distribution and ecu fill 602 ufouo ci2 will distribute the keys it generat based on the parameters of the key 603 order and any subsequent distribution management in structions from appropriate kmi 604 managers keys generated at psn will be wrapped for the end recipient eg an akp 605 an ecu and are inaccessible to the prsn and other intermediate points along the 606 distribution path 607 ufouo figure 6 illustrates that user device m ay be equipped with one or more of 608 the three logical types of fill ports through which the device can receive kmi products 609 these three types are identified here as logical types in order to avoid making 610 assumptions about the actual physical implementatio n of future devices 611 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 32 unclassifiedfor official use only b cwfp wrappedfill portnfp networkfill port rfp redfill portaccepts otnk ekms 217 or black filleach user device has one or more logical fill portsprsn pdes client nodes portable media including fill devices fill devicesaccepts otnk fill accepts red fill figure 6 u types of fill ports in user devices 612 ufouo networkfill port nfp the networkfill port is the devices interface 613 through which it can be filled using otnk otnk is benign method of filling 614 device but is distinguished from benign techniques as defined in ekms 217 by the use 615 of new formats and protocols that can be used acros s network backbones between user 616 devices and prsn pdes network fill is performed cross network connection 617 ufouo wrappedfill port wfp the wrappedfill port is the devices interface 618 through which wrapped ie encrypted key materia l can be delivered directly to the 619 device this port is used to conduct benign fill t ransactions as defined in ekms 217 620 and to load key material in black form said materi having been wrapped by 621 supporting client node using key encryption key kek previously loaded into the 622 device in red form wrapped fill is may be performe d via media or fill device transport 623 of the information to and from the device some dev ices capable of using network fill 624 port may also be able to accept product fill via th wrappedfill port 625 ufouo redfill port rfp the redfill port is the devices interface thro ugh 626 which red ie unencrypted key can be delivered directly to the device red fill is 627 always performed using fill device 628 ufouo figure 7 illustrates the different types of distribution paths through which 629 user devices can receive kmi products 630 ufouo figure 7 shows that distribution paths ma be separated into five basic cases 631 and provides details about the variations of each t ype that may exist in cases 1 2 and 3 632 the product is generated by the psn and wrapped the re uniquely for the destination 633 device in case 4 the source of the product may b psn another client node or key 634 source somewhere within ekms and the product is wra pped for the receiving client 635 nodes akp in case 5 the key is locally generat ed by the client nodes akp in both 636 case 4 and case 5 the product is wrapped for deliv ery to the user device by the supporting 637 client nodes akp 638 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 33 unclassifiedfor official use only prsn 2a nfpportable media pass thruprsn product delivery enclave 2b wfp 1a nfp 3a nfp 3b wfp 3c rfp 4a nfp 4b wfp 4c rfp 5a nfp 5b wfp 5c rfp 3 management client with akp passes wrapped product through portable media pass thru5 management client with akp akp generates and wraps product fill device unwraps gd with fronting haipe ecufill device unwraps 2c rfp ci2 does not support this caseci2 does not support this caseportable media pass thruportable media pass thru fill device unwraps4 management client with akp akp unwraps and rewraps product clients push to devices gd akp ecugd akp ecugd akp eculd gd fd ecugd akp eculd gd fd eculd gd fd eculd gd fd ecu2 deliveryonly client of koa agent passes wrapped product through fill device unwrapspsn does not wraps for fill devicepsn does not wraps for fill device ld gd with fronting haipe ecutypes of devices expected to be supported in each c ase1 device acts as client ld gd with fronting haipe ecu 639 figure 7 ufouo types of kmi distribution paths 640 ufouo the figure also shows how each of the pat hs uses one or more of the three 641 logical types of fill ports some of the combinati ons are special cases ci2 does not 642 support paths 2c and 3c which would use redfill port on user device because 643 psn never wraps product for distribution to fil l device 644 ufouo for each supported path the box at the b ottom of the figure lists the basic 645 types of user devices that are supported on the pat h akp ecu and fill device fd the 646 box also lists the type of identity registration th at user device must have to use the path 647 gd indicates general device and ld indicat limited device these two 648 registrations types for user devices are defined an d described in the registered users 649 section of the ci2 sdrs volume 2 in summary g eneral device is registered globally 650 and products can be wrapped for it by psn wherea s limited devices registration is 651 only relevant at the client node supporting that vice in addition to gd and ld some 652 paths are shown as supporting gd ie gd in p arentheses this is meant to indicate 653 that the path can support user devices that are tre ated by the management client as 654 limited device even though they are also registere d as general device for example 655 there may be operational circumstances where it is necessary to fill general device with 656 product that was generated and wrapped at the sup porting client node rather than the 657 psn 658 5338 u rekey services 659 ufouo ci2 will provide online and staged g in accordance with haipe 660 concepts seed key conversion and rekey services fo r 661 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 34 unclassifiedfor official use only ufouo ecus keyed with basic or enhanced firefly key 662 ufouo akps 663 ufouo this range of capabilities will support r ekey for devices compliant with 664 ekms 218 devices compliant with ekms 217 store forward using ekms 665 transactions and devices compliant with forthcomi ng otnk specifications 666 5339 u tracking accounting and auditing 667 ufouo kmi ci2 will automatically record infor mation regarding events as they 668 occur within the system some of these events will be captured to provide information 669 useful for status reporting to kmi users and manage r development and monitoring of 670 performance metrics etc information recorded for these purposes is called tracking 671 data and is retained on temporary basis 672 ufouo information regarding other events is ca ptured because it is important for 673 deterring kmi managers and others from deliberately compromising cryptographic 674 material information recorded for these purposes is called accounting data and is 675 retained indefinitely this information will also be used to perform investigations and 676 damage assessments when it is suspected or determin ed that kmi manager in the kmi 677 product ordering or distribution processes has been involved in deliberate compromise 678 of cryptographic material events that directly or indirectly involve or affect exposing 679 key in red form or encrypting key for kmi user r set of kmi users are regarded as 680 accountable events 681 ufouo finally some kmi events are important f rom security perspective but do 682 not directly involve generation or distribution of cryptographic material examples of 683 these events are registration and enrollment thes events create audit data which is also 684 used to deter wrongdoing by kmi managers and recov er from malicious actions 685 committed by them 686 ufouo the kmi will rely on ekmscmcs accountin g functionality for ci2 687 transactions that traverse the kmiekms translator will be recorded by existing ekms 688 accounting functions tracking and audit informati on generated by kmi components 689 will be recorded and maintained by kmi ci2 690 53310 u status reporting 691 u ci2 will provide the ability for kmi users and managers to request status 692 information regarding product orders and distributi on status reporting is based on 693 information gathered by the kmis tracking function status information available will 694 include but not be limited to 695 u approval status eg pending approved rejec ted of submitted requests that 696 require approval 697 u distribution status of kmi products individua l users will be able to see the 698 status of products they are scheduled to receive kmi managers will be able to 699 see the status with regard to all recipients of pro ducts they control 700 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 35 unclassifiedfor official use only 53311 u ekms translator 701 ufouo in the ci2 timeframe interoperability w ith ekms will be supported using 702 translator see section 542 for more details on the translator capabilities 703 ufouo this translation functionality will 704 ufouo permit the exchange of accounting transac tions electronic key 705 packages and formatted plain text messages between kmi and ekms as required 706 ufouo provide the kmi user community with the bility to communicate 707 with ekms utilizing kmi client node 708 ufouo facilitate the transition of ekms users t kmi ci2 709 ufouo the ekms translator will reside between t he prsn and the ekms message 710 server infrastructure the ekms translator will re cord an audit trail for the exchange of 711 information between the two systems kmi and ekms will be able to review translator 712 audit data as needed for more information on the concepts for kmi ekms 713 interoperability see section 54211 714 53312 u destruction 715 ufouo cryptographic products must be destroyed upon reaching their expiration 716 date to facilitate timely destruction of supersede d cryptographic material the kmi will 717 automatically notify the koa manager at the end of the crypto period for the material 718 the kmi will securely destroy in accordance with pplicable destruction standards all 719 sensitive cryptographic material in its possession upon command by an authorized kmi 720 manager with the necessary privileges an interface will be provided on the client nodes 721 for operators to specify key material to be destroy ed to prevent the inadvertent 722 destruction of material the kmi will always ask th operator if they are sure they want to 723 destroy the material any kmi component ie prsn psn fd akp and mgc that 724 has the ability to store classified or sensitive ke will also have the ability to zeroize those 725 keys the kmi will accept destruction reports for ll accountable items through 726 electronic or physical mechanisms 727 534 u kmi operating accounts 728 5341 u overview 729 ufouo kmi ci2 will introduce the concept of koa while koa is similar in 730 principle to comsec account its real purpose is to serve as an organizing construct 731 for the set of key destination eg ecus akps nd transfer devices associated with 732 particular organization or unit in the ci2 timef rame all koas will also be comsec 733 accounts as the population of kmiaware ecus supp orted by otnk grows in the 734 future some koas may longer need to be comsec ac counts if for example all of 735 the koas ecus are not comsecaccountable and they are benignly keyed with key 736 products that are tracked but not comsecaccountabl since an akp provides the 737 capability to reroute or expose key material any k oa equipped with an akp will be 738 comsec account for the foreseeable future 739 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 36 unclassifiedfor official use only ufouo hardware accountability like comsec ac count the koa is the 740 organizing construct for ecu ownership the kmi recognizes only one koa as the 741 owner of an ecu and will allow additional koas to receive key for that ecu only with 742 the permission of the owning koa ecus will be reg istered with classification and 743 community attributes and can be assigned only to ko as having the corresponding 744 attributes 745 ufouo like comsec account the koa is the org anizing construct for key 746 distribution profiles conauth or product reques tor places koas on the account 747 distribution profile for key product and thereby specifies which koas will receive that 748 key the koa manager manages device distribution p rofiles for the key products the 749 koa receives the kmi will wrap the keys so that i t can be unwrapped by the ecus on 750 the device distribution profile keys will be labe led with classification and community 751 attributes and can be distributed only to koas havi ng the corresponding attributes 752 similarly within koa keys can only be assigned to ecus having appropriate security 753 attributes 754 5342 u makeup of koa 755 u koa is 756 u logical entity for organizing kmi support to set of users devices andor 757 systems in many cases the users and devices are ssociated with an owning 758 organization eg military unit in other cas the users and devices may be 759 the operators of system that requires kmi product s to operate 760 u associated with unit or organization of some sort that is the source of the 761 requirement for the koa and responsible for its ope rations 762 u an entity that other kmi and ekms community mem bers can specify as 763 destination to which key products can be sent 764 u koa is the kmi equivalent to an ekms tier 2 lement it has an identity with 765 associated administrative and technical information and also has personnel and 766 equipment associated with it this collection of k oa attributes can be illustrated 767 hierarchically 768 ufouo information similar to ekms common accou nt data plus the 769 following specifics likely some overlap with commo n account data 770 ufouo koa number would be usable in the ekms vironment but 771 ekms might only see subset of number depending n whether we need 772 more identifying information for koas 773 ufouo personnel 774 ufouo koa managers primary 1st alternate one or more additional 775 working koa managers the organization that creat ed the koa the 776 parent enrollment domain is responsible for assign ing the primary and 1st 777 alternate and identifying their successors as perso nnel change 778 ufouo koa agent associated with the koa koa agents are 779 responsible for getting key from the koa to ecus if the key is moved in fill 780 devices 781 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 37 unclassifiedfor official use only x1x2ufouo koa manager has the privilege to add an d delete kmi 782 users from the list of koa agents that can retrieve key associated 783 with this koa 784 x1x2ufouo koa agents are not kmi managers and do n ot require 785 kmi manager credentials 786 x1x2ufouo any given kmi user may appear on the list of koa 787 agents for multiple koas 788 x1x2ufouo kmi customer organization may implement process for 789 approving basic users to be koa agents koa manage rs must 790 follow their organizations policies when identifyi ng koa agents for 791 their koa the kmi does not maintain master list of approved 792 koa agents 793 ufouo equipment ecus and fds associated with the koa ecus and 794 fds are destinations for key in order to ensure t hat key is not improperly 795 directed to an unsuitable ecu or fd ecus and fds n eed associated rubac 796 attributes to enable the kmi to make informed decis ions permitting or denying 797 requested key distribution actions categories of equipment that may be 798 associated with koa are 799 ufouo benignfill capable devices such device s will have firefly 800 credentials associated with them benign fill cred entials will be held 801 x1x2ufouo locally if koa has an akpequipped client 802 x1x2ufouo at the prsns for otnk ecus 803 ufouo blackfill capable devices such devices will have keks 804 associated with them copies of black fill keks wi ll be available locally if 805 koa has an akpequipped client 806 ufouo legacy red fill ecus there is reason to register such ecus 807 or associate them with the koa technically but such ecus may be associated 808 with the koa for purposes of accountability 809 ufouo fill groups fill groups are virtual destinations for key pro ducts 810 they are created and managed by the koa manager an d comprise collections of 811 functionally or operationally equivalent ecus or fd s associated with the koa 812 characteristics of fill groups include 813 ufouo fill group is locally ie within t he koas mgc determined 814 and maintained group of ecus or fill devices 815 ufouo fill groups should have convenience lab unique with the koa 816 for which the fill group is established 817 5343 u koa manager and koa agent privileges 818 ufouo there are certain privilege kmi functions available to koa managers it is 819 conceivable that not all koa managers for koa sho uld be able to exercise all 820 privileges koa agents also requires set of priv ileges but they are not kmi managers 821 53431 u koa manager privileges 822 ufouo in addition to the specific koa manager p rivileges identified here koa 823 manager can exercise all of the privileges associat ed with koa agent 824 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 38 unclassifiedfor official use only ufouo maintain koa administrative information i n kmi except for 825 centrally managed data element like highest class ification indicator 826 ufouo request the cognizant enrollment manager to add or remove koa 827 managers from the list of koa managers for the koa at least the primary and 828 1st alternate koa manager should be able to exercis this function to manage the 829 set of working koa managers that assist them with koa operations 830 ufouo add remove koa agents from the list of koa managers for the 831 koa primary and 1st alternate koa manager 832 u add remove ecus from the device distribution profile ddp associated 833 with the koa 834 u add remove ecus fds from the locally mainta ined fill group 835 u assign key product to ecus fds in the locally maintained fill group 836 u cancel key product for ecus fds in the locall maintained fill group 837 assignment 838 u activate ecu for seed key conversion 839 u upload new credentials for ecu in the appropria ddp to prsn 840 u identify new kek for an ecu in ddp 841 ufouo associate short title with an otnk ecu for ecuinitiated key 842 retrievals 843 u cancel short title ecu association 844 ufouo associate short title with benign fil l black fill ecu for 845 automated wrapping of routinely superceded key venience feature 846 ufouo download black key into fill device this fill device could 847 then be given to koa agent but in this case whe re the fill device could expose 848 the key in red form the involvement of koa manag er in the process is 849 needed to ensure that key is not distributed in an uncontrolled manner 850 u view tracking reports of tracked and accountabl events associated with the 851 koa 852 u review device distribution profiles by viewing the assignment of ecus and 853 key products to fill groups 854 53432 u koa agent privileges 855 ufouo koa agent can exercise the following pr ivileges when connected to 856 prsn 857 u download benign key for an ecu associated wit h the koa agents koa 858 u upload benign fill credentials for an ecu 859 u upload fill device tracking audit information including ecu 860 acknowledgements of keys loaded 861 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 39 unclassifiedfor official use only 535 u ci2 communications 862 u consistent with objective 1 of section 51 ci 2 will move kmi communications 863 away from the current ekms dependence on dialup co nnections to primarily use 864 tcpipbased network communications 865 5351 u communications backbones 866 ufouo ci2 will provide network access points to request and receive kmi 867 products and services on the niprnet siprnet and public internet kmi clients and 868 nodes will be designed and implemented with the int ent of operating across standard 869 networks in addition to the use of widearea tran smission control protocol internet 870 protocol tcpip networks kmi communications will also be possible across campus 871 area networks on military posts camps bases and s tations shipboard networks and other 872 networks connected to the backbone widearea networ ks 873 ufouo in addition to networkbased communicatio ns between the kmi and various 874 kmi clients and ecus the communications between pr sns the psns from which they 875 obtain products and the csn will also be handled v ia tcpip networks with strong vpn 876 protection applied to those communications interact ions 877 5352 u kmi protected channels 878 ufouo because kmi communications will be flowin g across general purpose dod 879 networks there is need to provide ia of the end points of these communications and 880 protect the integrity and confidentiality of the in formation flowing between them that 881 protection will come through the use of virtual pri vate networking transport layer 882 security tls and other security protocols to est ablish kmi protected channels 883 kpcs the specific security services security m echanisms and level of assurance of 884 kpc depend on the channels purpose and environment consequently kpcs may be 885 established using range of devices and strengths of mechanism appropriate to the need 886 with stronger mechanisms being used for example t protect the submission of orders to 887 the kmi than would be needed when protecting the re trieval of key material that is 888 benignly wrapped for specific recipient device 889 ufouo for mgcs used for sensitive kmi functions such as use by an enrollment 890 manager or koa manager the node will need to be dicated to kmi functions in 891 addition to being protected by strong kpc based n haipe capabilities integrated into 892 the akp 893 54 u modes of operation for the proposed system 894 541 u kmi access control concepts 895 ufouo privileging and access control are centr to the kmi mission and pervasive 896 throughout the kmi concept of operations these co ncepts are integrated into each of the 897 concept of operations storyboards 898 ufouo the kmi access control framework uses th ree different access control 899 models in ways intended to complement each other r ole rule and approvalbased 900 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 40 unclassifiedfor official use only access control these concepts are summarized in t his section the topic of kmi 901 access control is dealt with at length in volume 3 of the sdrs 902 ufouo kmi utilizes several identification and uthentication ia concepts 903 ranging from type 1 ia certificates to user name and passwordpin kmi will use 904 type 1 ia mechanism to establish the identity for device and nondevice entities for the 905 purpose of authenticating kmiaware devices and ide ntifying and authenticating kmi 906 managers in most instances dod pki certificate or user name and passwordpin will 907 be used to identify and authenticate personnel serv ing in nonmanagement roles ie 908 koa agent 909 5411 u rolebased access control 910 ufouo robac is used to grant broad kmi functio ns to certain groups of kmi 911 managers kmi managers who have been conferred role are thereby granted the 912 ability to perform the functions associated with that role additional privileges will be 913 granted to kmi entities using the enrollment proces s for example kmi has defined 914 product requestor role kmi managers granted the product requestor role have 915 access to the kmi automated functions necessary to request generation and distribution 916 of kmi products the process of granting kmi use r kmi role is called enrollment 917 so we say that kmi user has been enrolled as product requestor the only non 918 manager role in the kmi is koa agent 919 5412 u rulebased access control 920 ufouo kmi productsespecially key productsare used to protect information 921 that ranges from unclassified to top secret compart mented there is more 922 important mission for the kmi than ensuring that cl assified cryptographic products are 923 not released to entities that are not cleared to re ceive them the large number of special 924 accesses used within the cryptologic community make s use of an access control approach 925 specially designed for processing of clearances curity categories and related access 926 control rules such as country releasability goo d choice for kmi rubac will be used 927 in combination with robac to provide this dimension of kmi access control where 928 robac is concerned with matching kmi managers with broad groupings of kmi 929 functions rubac is strictly concerned with ensurin g that access to information is 930 limited to those kmi managers who hold the privileg associated with the informations 931 sensitivities in the kmi application privileges associated with kmi managers will 932 generally be clearances security category accesses and national affiliation sensitivities 933 associated with kmi products will be the correspond ing classifications security 934 categories and national releasability determinatio ns 935 5413 approvalbased access control 936 ufouo the combination of broad allocation of f unctions based on roles and rule 937 based privileges based on clearances security cate gories and national affiliation will not 938 always provide sufficient granularity of control fo r the kmi key distribution is 939 controlled on need to know basis with specific koas authorized to receive specific 940 key in addition some kmi operations may need to be regulated for other than security 941 related reasons for example where logistical cons iderations apply in determining 942 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 41 unclassifiedfor official use only whether or not an order can be filled this sort f control need the finegrained access 943 controls that only humans using their judgment can provide in the kmi controlling 944 access to information or functions based on human j udgment is referred to as approval 945 based access control but the accepted technical t erm for this kind of technology is 946 identity based access control or simply access control lists 947 542 u interoperability considerations 948 5421 u interoperability with us legacy key man agement systems 949 ufouo the kmis evolution is primarily targeted at providing onestop key 950 management support for the evolving cryptographic d evices components and systems 951 hereafter referred to as ecus that will result fr om the cmi the cmi will introduce 952 new key management techniques and methods that util ize modern technology new 953 cryptographic algorithms and networkcentric commun ications kmi ci2 establishes the 954 foundation for the ordering generation delivery nd tracking of key management 955 products and services that will be needed in suppor t of cmi ecus 956 ufouo in the long term it is expected that lega cy ecus with be replaced by cmi 957 compliant ecus and supporting legacy key managemen t systems like ekms and the 958 defense message system dms pki will be retired w hile this is an admirable goal it 959 will take years to accomplish there are several po tential approaches to defining the 960 relationship between kmi and these existing systems and to supporting legacy devices 961 u kmi could be built to provide products and serv ices to legacy devices along 962 with evolving cmi required products and services 963 u kmi could be operated as another stovepipe syst em or 964 u kmi could be interoperable with existing system s and provide common 965 front door for all user community access 966 ufouo the kmi ci2 designers are taking the thi rd approach kmi common 967 front door that will provide the user community w ith single access point for all key 968 management products and services provided by existi ng and future kmi increments 969 this common access point will sustain compatibility with existing manual operations and 970 electronic mechanisms and will also provide onlin access for direct ecu interaction 971 and for interactions between kmi and mpmss 972 54211 u ci2 ekms interoperability 973 ufouo in the ci2 timeframe interoperability wi th ekms and the traditional key 974 management activities will be supported using the kms translator described in 975 section 5312 this translator concept is based up on the following presumptions 976 ufouo distribution will be done in accordance w ith the ekms supplemental 977 ordering and distribution agreement that is in effe ct at the time of ci2 fielding 978 ufouo all movement of accounting transactions distribution management 979 transactions electronic key packages and formatted plain text messages between 980 ekms and kmi will occur via the translator eg t here will be ci2 client to 981 ekms lmdkp direct connections 982 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 42 unclassifiedfor official use only ufouo registration and ff credential data excha nge will exist between the 983 ekms directory server and its kmi equivalent to mai ntain data consistency 984 each system will only maintain its own directory ement synchronization will 985 be bidirectional 986 ufouo all data exchanged between kmi and ekms w ill occur between 987 system elements of the same classification level 988 ufouo the kmi akp will be cryptographically com patible with the ekms 989 kp for key exchange 990 ufouo major hardwaresoftware changes will b required to ekms to 991 accommodate interoperability with the kmi ci2 992 ufouo key generated at psn must be able to be distributed to ekms 993 users kmi users or mixture 994 ufouo the koa numbering scheme will be compatib with the operational 995 ekms numbering scheme 996 ufouo it is important to note that key materia l can be ordered with the resulting key 997 products delivered to both ekms and kmi users using the following options 998 ufouo via prsn for psn generation using k client 999 ufouo via an ekms lmd or ekms lmdkp for tier 0 generation 1000 ufouo received and manually entered at tier 1 f or tier 0 or tier 1 1001 generation 1002 u the translator enables interactions between ekm s and kmi including 1003 ufouo key generated and wrapped at an ekms lmd kp can be sent to and 1004 unwrapped by kmi akp and vice versa with the key material transfer routed 1005 through the ekms messaging system translator and kmi prsn 1006 ufouo kmi accounting information can be receive d and processed by tier 0 1007 tier 1 and tier 2 elements kmi clients will suppl the accounting information 1008 expected by ekms to ensure the success of distribut ion transactions 1009 ufouo ekms accounting transactions can be recei ved and processed by 1010 kmi client node 1011 ufouo ekms distribution transactions can be rec eived and processed by 1012 kmi client node 1013 ufouo ekms plain text message transactions can be received and processed 1014 by kmi client node4 1015 ufouo kmi formatted plain text message transact ions can be received and 1016 processed by tier 0 tier 1 and tier 2 elements 1017 ufouo translator audit data can be reviewed and analyzed by ekms and 1018 kmi 1019 4 this would occur between kmi and ekms elements of the same classification as stated in the presumptions listed earlier kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 43 unclassifiedfor official use only u specific translator capabilities that will not be supported are 1020 ufouo key order and privileging information bet ween kmi client and 1021 ekms lmdkp 1022 ufouo data exchange between kmi and ekms elemen ts with different 1023 classifications 1024 ufouo parentsub relationship support between k and ekms 1025 ufouo explicitly controlled key exchange betwee n kmi and ekms 1026 ufouo single encrypted key5 exchange between kmi and ekms note key 1027 exchanges utilizing an ekms bulk encryption transac tion bet are possible 1028 ufouo ekms user application software uas tran sactions between kmi 1029 and ekms 1030 5422 u foreign interoperabilitykmi access 1031 ufouo in the ci2 timeframe there is direct connection ie system to system 1032 planned to achieve interoperability with allied or coalition key management 1033 infrastructures for classified products and service s interoperability with alliedcoalition 1034 pkis will be accomplished through certification uthority bridge in the ci2 timeframe 1035 eg the federal bridge certification authority 1036 ufouo todays operational environment mandates effective interoperability across 1037 the dod community and when operational needs dictat with an often dynamically 1038 changing set of allies and coalition partners in addition to its support for the dod 1039 community kmi is designed to provide allies and co alition partners access to 1040 appropriate products and services to support ecu in teroperability 1041 ufouo kmi ci2 will establish segregated encla ves to accommodate access to kmi 1042 for various communities of interest cois the ci 2 architecture provides for two 1043 distinct enclave types one for ordering and managi ng products and service and one for 1044 delivery of benign products and services 1045 ufouo omes will be deployed for the us nato nd cceb communities 1046 members of these enclaves will be enrolled as kmi m anagers and use type 1 ia pki 1047 certificate for identity verification these manage rs will utilize an mgc that connects to 1048 an ome product ordering and management for any co alition cois through the kmi 1049 will be handled by an appropriatelyprivileged kmi manager who is us citizen in all 1050 cases kmi manager who is appropriately privilege d and member of one of the ome 1051 cois can only authorize ci2 products and services for distribution in ci2 1052 ufouo ci2 will provide pdes for retrieval of b enign products and services these 1053 enclaves are viewed as database and web server impl ementations that allow authorized 1054 users from any community to access and download the ir designate products and services 1055 separate pdes will support the us nato and cceb c ommunities additional pdes 1056 will be deployed as needed in support of coalition communities access to specific pdes 1057 for retrieval of products will be based on verifica tion of ia data each pde will be 1058 5 this is reference to ekms transaction 109 key dis tribution the tier 2 only implements this transaction kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 44 unclassifiedfor official use only configured to use an ia mechanism suitable for the coi that it supports eg 1059 certificatebased user name and passwordpin use rs retrieving benign products will 1060 require pc running kmi compatible browser and using an approved ia 1061 mechanism the minimum acceptable ia mechanism is passwordpin recognized by 1062 the kmi 1063 55 u kmi roles 1064 u this section describes the set of roles that ve been defined to operate kmi ci2 1065 role identifies job that needs to be performed and groups together access to the 1066 system functions needed to perform that job the need for role does not correspond to 1067 the need for person depending on the nature of t he role and the workload at particular 1068 operational location role may be one of many ts worn by single person or it may 1069 require several people to perform the job some ro will require very little time and can 1070 be an assigned duty for suitable individual wher eas in large comsec operations some 1071 roles may require several fulltime people to accom plish the mission for security 1072 reasons certain roles must be assigned to separate individuals for example registration 1073 and issuance of type 1 pki certificate to user requires at least two separate authorized 1074 individuals one performing the role of the personn registration manager and one 1075 performing the role of the local t1 registration au thority within constraints set by 1076 kmi to preclude certain combinations of roles the allocation of roles to people is left to 1077 the determination of each organization using the km i 1078 u management roles can divided into both internal and external classes this division 1079 of roles is depicted in table 1 the management ro also can be divided into 1080 operational and administrative operational manage rs use kmiissued type 1 credentials 1081 to authenticate their identity to the system and t hey obtain authorizations for their actions 1082 through kmis rolebased rulebased and approval based access control mechanisms 1083 1084 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 45 unclassifiedfor official use only table 1 u kmi roles 1085 role types role names external operational management roles orderinganddistribution managers user registration managers controlling authority command authority product requester koa manager registration managers koa registration manager personnel registration manager device registration manager includes klif mgr local type 1 registration authority access control managers enrollment manager user support managers serviceagency help desk manager external administrative management roles client node administrators client platform administrator client platform security officer internal operational management roles access control service managers role manager toplevel enrollment manager user support service managers library manager help desk manager event service manager catalog service managers catalog manager internal administrative management roles security administrators aka system security of ficers aswr manager audit data manager security configuration manager incident response manager core node administrators platformnetwork manager archive manager backup manager database managers accounting data manager tracking data manager nonmanagement roles nonmanagement users koa agent 551 u external operational management roles 1086 ufouo external operational management roles are assigned mainly to managers in 1087 customer organizations these managers are primaril concerned with registration 1088 enrollment and product management functions in p articular customer organization or 1089 some subunit of such an organization 1090 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 46 unclassifiedfor official use only ufouo external management roles are assigned to kmi operational managers in 1091 customer organizations who 1092 u connect to the kmi exclusively across network i nterfaces 1093 u receive their privileges through the kmi manage r enrollment process 1094 ufouo authenticate themselves to the kmi using kmi manager credentials 1095 u have their access to the kmi mediated by the ro rule and approvalbased 1096 access controls described in the kmi access contro l concepts section 1097 u the one exception to this description is for cl ient administration roles described in 1098 section 552 external operational managers are p rimarily concerned with registration 1099 enrollment and product management functions in ddition to external operational 1100 managers there are also internal operational and dministrative managers described 1101 below who deal with both the security of the kmi and the internal operation of kmi 1102 central nodes 1103 5511 u ordering and distribution managers 1104 ufouo the roles in this category are oriented t oward product management functions 1105 approvalbased access control involves the four man agement roles that deal directly with 1106 product ordering and distribution conauth command authority product requester 1107 and koa manager enrollment managers in kmi custome r organizations assign 1108 identities to these four roles through the rolebas ed access control process users are 1109 expected to be selected for these roles based on or ganizational affiliation geographical 1110 location and other operational factors 1111 55111 u controlling authority 1112 ufouo the controlling authority role is assigne d to external managers responsible 1113 for determining what key products are operationally needed and optionally identifying 1114 the individuals responsible for more detailed manag ement of those products controlling 1115 authorities perform the following functions 1116 controlling authority defines new product contro lling authority can define 1117 new product eg product the controlling uthority also can place orders 1118 for generating and distributing that product or th controlling authority can 1119 delegate responsibility for ordering by appointing product requesters 1120 controlling authority appoints product requesters the controlling authority 1121 for product can optionally select one or more use r identities that have been 1122 enrolled as product requesters and authorize them t place orders for the product 1123 the selections are not constrained by enrollment d omains the controlling 1124 authority can require that orders placed by produ ct requester receive per 1125 edition approval before the product is generated an d distributed if such approval 1126 is required the controlling authority acts as the approver 1127 ufouo controlling authority or product requeste r orders products for 1128 operating accounts controlling authority or an authorized product requester 1129 can order product ie can request that product be generated and be 1130 distributed to devices under the control of selecte d koas 1131 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 47 unclassifiedfor official use only 55112 u command authority 1132 for each specific kmi asymmetric product relations hips are established among the 1133 managers command authority requests the assignme nt of partition codes and 1134 departmentagencyorganization dao codes for the symmetric products the 1135 command authoritys organization requires the comm and authority identifies which 1136 partition codes and dao codes may be ordered by eac h product requester 1137 55113 u product requestor 1138 ufouo product requester is an external manage r that is responsible for requesting 1139 products and services product requesters must be nrolled as managers and their 1140 privileges with regard to ordering specific kmi pro ducts are then defined by the product 1141 manager either controlling authority or command au thority responsible for those 1142 products using kmis approvalbased access control process product requesters who 1143 order asymmetric products perform function equiva lent to user representatives in 1144 existing firefly key management processes 1145 55114 u koa manager 1146 ufouo koa manager is an external manager who is responsible for the operation 1147 of one or more koas koa managers are the kmi equiv alent of comsec custodians 1148 comsec managers in the existing system koa manag er manages the distribution of 1149 kmi products to the ecus fill devices and akps th at are assigned to the managers 1150 koa the koa manager is also responsible for design ating and registering koa 1151 agents 1152 5512 u registration management roles 1153 u registration managers are the external manager responsible for making people 1154 devices and koas known to the kmi each of thos three registration functions is 1155 distinctive and is addressed with distinct regist ration manager role 1156 55121 u koa registration manager 1157 u koa registration manager is the role assigned t individuals responsible for 1158 maintaining registration information about koas t his information is retained in data 1159 store eg possibly directory internal to the kmi information elements common to 1160 both kmi and ekms are synchronized between the kmi registration data store and the 1161 ekms directory server 1162 ufouo since all koas will also be comsec accoun ts in ci2 there is need for 1163 close coordination between ekms registration author ities and the koa registration 1164 manager the ci2 concept is that these duties wil l be assigned to the same persons 1165 for the military services the ekms registration au thority is located with the tier 1 1166 system the persons performing that function will be enrolled as koa registration 1167 manager and provided with kmi client node and manag er credentials so that they can 1168 perform both functions u personnel registration manager 1169 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 48 unclassifiedfor official use only 55122 personnel registration manager 1170 ufouo personnel registration managers are respo nsible for registering human users 1171 to the kmi this role will fall under separation of duties considerations in particular 1172 personnel registration manager cannot also be loc type 1 registration authority 1173 the basic functions of personnel registration man ager include 1174 u registration of kmi users 1175 u ability to add modify update and delete regis tration data 1176 u works with local sponsorauthority to obtain in formation required to establish 1177 an individuals type 1 identity 1178 u independently verifies the need for the identit 1179 u enters the required registration information i nto kmi using kmi manager 1180 55123 u device registration manager 1181 u device registration manager is the role assigne d to individuals responsible for the 1182 registration of devices ie equipment such as ec us in the kmi device registration 1183 managers register and initialize ecus type 1 ia t okens and any other kmi devices 1184 into the kmi request initial ecu key material eg seed key 1185 55124 u local type 1 registration authority 1186 u local t1 registration authority is the role ass igned to individuals responsible for the 1187 endorsement and provisioning of cmi kmi aware and kmi manager tokens the 1188 basic functions of local type 1 registration auth ority include 1189 u performs the face to face check of the user rec eiving the type 1 certificate 1190 and token 1191 u processes the individual to obtain their type 1 token 1192 u uses kmi manager client to process certif icate request and download 1193 type 1 certificate onto token 1194 5513 u enrollment manager 1195 u enrollment manager is the role assigned to thos individual responsible for assigning 1196 kmi user identities to management roles the enroll ment manager also assigns rule 1197 based attributes to kmi manager identities and assi gns privileges to type 1 identity that 1198 has been issued for use in kmi the enrollment man ager is particularly security 1199 sensitive role as this managers actions determine what other kmi managers may do 1200 consequently this role will fall under separation of duties considerations in particular 1201 an enrollment manager cannot also be personnel re gistration manager 1202 5514 u serviceagency help desk manager 1203 u help support for kmi users will be provided by mixture of customer organization 1204 specific help staff external and kmiwide help st aff internal serviceagency help 1205 desk manager is the role assigned to external perso nnel providing customer 1206 organizationspecific help services 1207 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 49 unclassifiedfor official use only 552 u external administrative management roles 1208 u client administration roles are associated with the need to provide operational and 1209 security management and administration for client n odes while these functions are 1210 external taking place at the client location rathe r than within central kmi nodes such as 1211 the prsn or psn these are not operational manager roles in the kmi and therefore do 1212 not require kmi manager token access control fo r these roles is provided by the client 1213 platform operating systems user access control g name and password login to the 1214 platform combined with physical limitations on acc ess to the client these roles will 1215 normally be assigned to information technology supp ort staff at the customers 1216 operational facility 1217 5521 u client platform administrator 1218 u client platform administrators are responsible for establishing and assigning 1219 platformbased user accounts for which the authent ication material typically is 1220 password including platform operators and for tting their privileges and also for 1221 operating system maintenance and updating etc 1222 5522 u client platform system security officer sso 1223 u client platform ssos are responsible for securi ty monitoring and administration of 1224 the client platform including audit data review an d archiving etc 1225 553 u internal operational management roles 1226 ufouo internal kmi roles are roles assigned to personnel operating within the 1227 physical security perimeter of centralized or reg ional kmi component such as prsn 1228 or psn nsa personnel will typically staff internal roles for the csn prsn and psn 1229 the roles listed in subsequent sections are indepen dent roles some separation of duties 1230 requirements will apply to the security administrat ion roles for example it is 1231 inappropriate for the same individual that reviews audit data to check for potential 1232 security violations to also be able to control audi t collection data rules 1233 5531 u access control service managers 1234 55311 u role manager 1235 ufouo role manager is the role assigned to indi viduals who manage the set of roles 1236 available in the kmi the role managers function is to maintain the set of roles defined 1237 within the kmi including the creation of new roles the removal of unnecessary roles 1238 and the management ie addition and deletion of the privileges accorded to roles as 1239 appropriate to the job functions of individuals who would be enrolled in those roles 1240 55312 u kmi toplevel enrollment manager 1241 u the kmilevel enrollment manager for the kmi is responsible for enrolling the 1242 highestlevel enrollment manager within each kmi cu stomer organization those 1243 enrollment managers in turn can either perform l enrollment functions for their 1244 organization or enroll subordinate enrollment mana gers within their organization who 1245 will perform the enrollment of other kmi managers w ithin the organization when 1246 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 50 unclassifiedfor official use only enrolling other managers the kmilevel enrollment manager is enabled to enroll all 1247 roles and is able to assert all rulebased access control privileges within the kmi 1248 5532 u user support service managers 1249 u the user support manager roles are related to k functions that need to be publicly 1250 accessible ie kmi library help desk 1251 5533 u event services manager 1252 u event services manager is the role assigned to individuals responsible for the kmi 1253 capability that tracks securityrelevant events and informs or reminds kmi users of 1254 necessary actions related to those events the kmi provides an event management 1255 capability that tracks securityrelevant events and informs or reminds users of necessary 1256 user actions to respond to those events events to be managed shall include the routine 1257 and emergency supersession of keys pending expirat ion of users certificate and 1258 mandatory modifications to equipment 1259 5534 u catalog manager 1260 u catalog manager is the role assigned to individ uals responsible for managing the 1261 kmi product catalog the kmi product catalog is th basis for presenting product 1262 information to users the information presentation is tailored for the recipient catalog 1263 managers are responsible for defining and maintaini ng filter criteria for the presentation 1264 of the catalog 1265 554 u internal administrative management roles 1266 ufouo internal management roles are assigned to personnel operating within the 1267 physical security perimeter of centralized or reg ional kmi component such as prsn 1268 csn or psn internal management roles include both operational and administrative 1269 mangers administrative managers are responsible fo r managing the security and 1270 operations of the kmi 1271 5541 u security administration ssos 1272 ufouo each site or facility that houses set f kmi components may need one or 1273 more people assigned to sso roles these roles gro up the functions related to 1274 establishing monitoring and maintaining the secur ity of the kmi 1275 55411 u aswr manager 1276 u aswr manager is the role assigned to individual s responsible for controlling attack 1277 sensors in kmi components and for initiating resp onse to alerts and warnings 1278 55412 u audit data manager 1279 u audit data manager is the role assigned to individu als responsible for setting audit 1280 data collection and recording parameters in kmi com ponents and for maintaining and 1281 analyzing the kmi audit trail 1282 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 51 unclassifiedfor official use only 55413 u security configuration manager 1283 u security configuration manager is the role assigned to individuals responsible for 1284 establishing and monitoring the security configurat ion parameters in kmi components 1285 5542 u client node administrators 1286 u system administration managers perform function s that ensure the smooth operation 1287 of the kmi these roles handle network and compute r platform administration 1288 archiving backup and restoration database managem ent and other functions necessary 1289 for kmi operation 1290 555 u nonmanagement roles 1291 u nonmanagement roles are assigned by koa manage rs to individuals that support 1292 last mile distributions activities for the koa t hese individuals are referred to as koa 1293 agents 1294 5551 u koa agent 1295 ufouo koa agent is not kmi management role koa agents are enrolled by 1296 an enrollment manager but do not need manager crede ntials to perform their duties 1297 koa agent is designated by koa manager to access prsn pdes for the purpose of 1298 retrieving wrapped products that have been ordered for user devices that are assigned to 1299 that koa koa manager can designate registered us ers to be koa agents for any 1300 koa to which that manager is assigned additionally koa managers are always koa 1301 agents for their own koas 1302 ufouo koa agent that is designated by koa manager can perform the 1303 following functions when connected to pde of pr sn 1304 x1x2ufouo download benignly wrapped product for device held by the 1305 koa 1306 x1x2ufouo upload benign fill credentials for devi ce held by the koa 1307 x1x2ufouo upload tracking audit and accounting in formation including 1308 device acknowledgements of products loaded from fill device 1309 56 u support environment 1310 561 u personnel support 1311 ufouo participants in the existing cmcs and ekm s are known as kmes and are 1312 each assigned ekms identifiers information about kmes is recorded in the ekms 1313 directory for use throughout ekms 1314 ufouo the set of ekms ids provides single na space within which all 1315 kmes are identified kme can be an individual or an organization since 1316 interoperability must be maintained between kmi ek ms and cmcs kmes it is 1317 necessary that identifiers for entities registered in kmi be able to be mapped uniquely to 1318 ekms ids and viceversa the following table ident ifies different types of kmes 1319 summarizes the function they play in key management and explains how they are 1320 handled within kmi ci2 1321 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 52 unclassifiedfor official use only table 2 u key management entities in ci2 1322 kme type kme function kmi ci2 concept central office of record maintain central accountability for comsec materials continue to operate as currently defined kmi ci2 is neither replacing nor replicating cor functionality but will support transfer of accounting information as described in the kmi support to cmcs accounting section firefly point of contact the entity that is responsible for appointing command authorities for his organization continue to operate as currently defined firefly pocs are assigned ekms ids and recorded in the ekms directory but the functions they perform are conducted offline firefly command authority defines firefly ordering privileges for user representatives registered as manager and enrolled as kmi command authority command authority functions are privileges within t he kmi command authority role controlling authorities will delegate specific firefly key ordering privileges to product requestors firefly user representative orders firefly key with limits of ordering privileges defined by associated command authority registered as manager and enrolled as kmi product requestor specific ordering privileges of product requestors for firefly key are defined by command authority using kmi approvalbased access control mechanisms comsec account organizational element designated to receive store and control comsec material directed to an organization registered as kmi operating account the identifie r for koa must be able to be mapped to an ekms id and viceversa in order to maintain backward compatibility with existing kmi systems koas will have an associated primary koa manager and one or more supplemental koa managers controlling authority define the characteristics for and direct distribution of cryptographic key especially symmetric key registered as manager and enrolled as controlli ng authority 562 u communications support 1323 ufouo ci2 will provide networkoriented key ma nagement and delivery 1324 capabilities and establish path for transition aw ay from the existing physical and 1325 electronic comsec material systems the ci2 desig n requires the interconnection of 1326 the kmi csn psns prsns and client nodes over v ariety of dod and commercial 1327 communications networks with an emphasis on common user tcpip widearea 1328 networks wans as the primary means of communicati ons the design of ci2 will 1329 address needed improvements in the communications pproach of the ekms allowing 1330 dialup connections and dedicated communications pa ths to be replaced by tcpip 1331 network connections over variety of communication s mediums owned by variety of 1332 organizations 1333 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 53 unclassifiedfor official use only ufouo to accomplish the system and design goals ci2 will rely on mixture of 1334 dod nondod governmental and commercial communicat ions systems and networks 1335 the networks and communications systems that may be used by ci2 include 1336 u tcpip widearea networks 1337 ufouo niprnet 1338 ufouo siprnet 1339 u internet 1340 u customerowned local tactical networks 1341 ufouo postcampbasestationfacility networks connected to the 1342 niprnet or siprnet 1343 ufouo tactical military communications systems connected to the 1344 niprnet or siprnet 1345 u each of the above systems may be used as vehi cle to provide ci2 services to ci2 1346 users and the kmi will depend upon their availabili ty and their ability to support tcpip 1347 communications such as web connections ftp email and other electronic exchanges 1348 ufouo ci2 is designed to be able to rely on th communication systems owned 1349 and managed by variety of organizations for reli ability of kmi operations and user 1350 access to the kmi multiple communications paths ac ross these backbone networks are 1351 needed by using cryptographically protected traff ic wrapped in normal tcpip 1352 communications packets ci2 is able to pass black data over these communication 1353 systems without fear of compromise the ability to support this feature enables ci2 to 1354 remain flexible and become more available to the us er community 1355 563 u logistical support 1356 u kmi ci2 will provide number of features to ssist the user in the operation 1357 maintenance and life cycle support of the system in cluding training online availability 1358 of data in the kmi library help desk and help f eatures integrated into the hmi 1359 5631 u training 1360 u the kmi will provide training programs includi ng both classroom and computer 1361 based online training it is important that kmi us ers and managers receive the necessary 1362 indoctrination and become familiar with the kmi sec urity practices before accessing the 1363 kmi whenever possible existing training courses materials and other devices eg 1364 commercially offered training courses and manuals will be used to satisfy kmi training 1365 requirements 1366 5632 u status monitoring and system maintenanc 1367 u the kmi supports worldwide customer community and must maintain operations 1368 24 hours day 7 days week the kmi will employ the mechanisms necessary to make 1369 its processes data and systems as reliable as pos sible within the bounds of cost 1370 effectiveness and established system performance t meet this operational availability it 1371 is necessary to know the status of the kmi the kmi will automatically collect and 1372 record any information regarding the current mainte nance state and operational 1373 availability of the major kmi components and the co mmunications links that service 1374 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 54 unclassifiedfor official use only them this information will be made available to au thorized kmi managers upon 1375 command 1376 u maintenance of the various components of the km i will be mix of warranty and 1377 service contracts for commercial offtheshelf cot s products and maintenance of the 1378 akp will follow traditional government support poss ibly taking advantage of existing 1379 serviceagency interservicing procedures the devel oper will be responsible for the 1380 maintenance of the psn csn and the prsns 1381 5633 u help desk 1382 u the kmi will provide support to staffed help desk to provide users assistance in 1383 system operation resolution of error conditions nd general information on products and 1384 services offered by the system the help desk funct ion will be performed by existing 1385 ekms phase 4 help desk personnel residing at tier 0 and servicespecific help desks 1386 located at service facilities to address servicere lated support functions some of the 1387 features to be provided are 1388 troubleshooting assistance 1389 list of addresses for access to kmi services that can be configured into kmi 1390 aware ecu 1391 list of frequently asked questions 1392 u the kmi help desk manager will provide support in terms of all kmi policy 1393 operational and procedural issues to support this role the kmi will provide the help 1394 desk manager access to all kmi customer information and functions through query 1395 capability provide decision tree to guide in ans wering user requests and provide 1396 capability to add delete update and determine ac cess to contents of the online help desk 1397 u the kmi help desk web page will contain at nimum list of frequently asked 1398 questions faqs the help desk telephone number nd an email link to the kmi help 1399 desk manager the web page will also supply the lephone number and web address of 1400 each servicespecific help desk directing users wit h servicespecific issues andor 1401 problems to these points of contact 1402 u when an initial call is received or problem r eport or query arrives it is placed on 1403 tracking ticket which remains open until the issue or query has been answered or 1404 resolved the help desk determines the kind of tec hnical help and information the 1405 customer may receive based on his identity and assi gned role within kmi to aid in 1406 reducing response time from help desk to users k nowledge database is accessible 1407 containing issue and query information from prior r esolutions 1408 6 operational scenarios 1409 u this section depicts common operating scenarios for kmi ci2 in the form of 1410 storyboards the storyboards focus on the kmi user s managers interactions with the 1411 system and do not attempt to describe internal ope rating details of the kmi the 1412 scenario set presented here covers number of comm on important aspects of kmi 1413 operation but does not attempt to address every km i capability or user operation it is 1414 intended rather to capture the intended nature of kmi operations 1415 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 55 unclassifiedfor official use only u several highlevel processes have been depicted that group the defined operational 1416 scenarios with the appropriate process they belong to these highlevel processes will 1417 help to clarify the relationship between operationa l scenarios the specific processes 1418 include manager activation koa registration kmi aware device activation 1419 product ordering and retrieval for symmetric keys and product ordering and 1420 distribution for asymmetric keys 1421 u the legend key for the sequence diagrams in th operational scenarios 1422 1423 mgcinformation being passed via an outofband method cryptographic association not yet determinedkmi actor componentexternal actor to kmi manager client computing platform kmi application software akpkmi device or token being passed doc conditional actiondeliveryonly client mgcinformation being passed via an outofband method cryptographic association not yet determinedkmi actor componentexternal actor to kmi manager client computing platform kmi application software akpkmi device or token being passed doc conditional actiondeliveryonly client 1424 61 manager activation process 1425 1426 u there are several steps necessary to activate kmi manager as shown in figure 8 1427 as prerequisite to this process new token mus t be initializedregistered by kmi 1428 device registration manager using klif that will later be activated for the prospective 1429 kmi manager 1430 1431 u upon authorization by commandcontrolling aut hority the prospective kmi 1432 manager is registered by the personnel registration manager at the same time the 1433 initialized token is endorsed by the local type 1 r egistration authority lt1ra at 1434 this stage the token receives an identity certific ate and an infrastructure key which will 1435 be used in the activation process 1436 1437 u after registration sponsoring organization r equests that newly registered manager 1438 be enrolled in kmi by the kmi enrollment manager m during this process the new 1439 kmi manager is assigned appropriate roles and privi leges in the same timeframe the 1440 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 56 unclassifiedfor official use only token is activated and personalized for the new kmi manager by the lt1ra the kmi 1441 manager is then activated and ready to complete its kmi mission 1442 1443 2 lt1ratoken manufacturer 3 211 0 sponsoring organizationtriggertrigger authorityauthority to actto actpersonnel rmdevice rm token initialization manager registrationlt1ra token endorsement emmanager enrollment emmanager enrollmentactive ci2 kmi managerprsn registration enrollment data store facetoface verification token issued notice of enrollment token registered prospective mgr registered roles assigned to registered mgrstoken manager id boundinitialized tokentoken activation token with identity certificate 1444 figure 8 u manager activation process 1445 1446 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 57 unclassifiedfor official use only 611 u register kmi manager 1446 6111 u summary 1447 u this scenario follows several related activitie s that lead to new kmi manager 1448 within kmi potential manager is identified and submitted as candidate they are 1449 subsequently registered within the kmi creating manager identity ready for 1450 enrollment and issuances of an identity token 1451 6112 u sequence diagram 1452 1453 prsnregistration manager mgceligibility sponsor new kmi manager request validates request and verifies data login to prsnlogin to prsn verify id and privileges provide registration data uploads prospective man ager biometric notify registration completednotify registration completedstore registration data and biometriclogin to mgc 1454 figure 9 u register kmi manager 1455 6113 u kmi roles involved 1456 u eligibility sponsor 1457 u personnel registration manager 1458 6114 u kmi nodes involved 1459 u manager client 1460 u prsn 1461 6115 u prerequisites 1462 u valid need for access as kmi manager exists 1463 u the candidate has not previously been registere d within kmi 1464 u personnel registration manager is valid and has rights within the appropriate 1465 domain 1466 u photograph of prospective manager has been capt ured 1467 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 58 unclassifiedfor official use only 6116 u sequence of events 1468 1 u the eligibility sponsor identifies the need for kmi manager and valid 1469 candidate fills out form requesting the registra tion and enrollment of new 1470 kmi manager the sponsor gathers the required iden tity and clearance 1471 information and biometric eg photo for the candidate and submits the data 1472 via authorized channels 1473 2 u the personnel rm receives request to regis ter new kmi manager along 1474 with clearance verification information via out of band method from sponsor 1475 the personnel rm validates the request and confirms the citizenship clearance 1476 and organization of the candidate manager according to the type 1 certificate 1477 policy 1478 3 u the personnel registration manager rm logs into the mgc 1479 4 u the personnel rm connects and authenticates to the prsn using manager 1480 client mgc 1481 5 u the personnel rm provides the manager candid ates registration data and 1482 biometric to the prsn 1483 6 u the prsn stores the registration data and bi ometric 1484 7 u the personnel rm notifies the appropriate tity sponsor candidate of the 1485 registration 1486 1487 1488 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 59 unclassifiedfor official use only 612 u enrollment of manager 1488 6121 u summary 1489 u this scenario follows several related activitie s that lead to new kmi manager 1490 within kmi registered manager is given the privi leges they need to perform their job 1491 as kmi manager through enrollment 1492 6122 u sequence diagram 1493 1494 prsnsponsoring organizationenrollment manager mgc new kmi manager request validates request and verifies data verify id and privileges notify enrollment completedassign roles and rulebased attributeslogin to prsn update enrollment datalogin to mgc 1495 figure 10 u enrollment of manager 1496 6123 u kmi roles involved 1497 u sponsoring organization 1498 u enrollment manager 1499 6124 u kmi nodes involved 1500 u manager client mgc 1501 u prsn 1502 6125 u prerequisites 1503 u valid need for access as kmi manager exists 1504 u the candidate is registered within kmi 1505 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 60 unclassifiedfor official use only u participating kmi managers are valid and have r ights within the appropriate 1506 domain 1507 6126 u sequence of events 1508 1 u the enrollment manager receives request to enroll new kmi manager 1509 via out of band method from sponsor 1510 2 u the enrollment manager confirms the need for the candidate managers 1511 requested proposed role and the validity of the req uest 1512 3 u the enrollment manager logs into the mgc 1513 4 u the enrollment manager connects and authenti cates to the prsn using 1514 mgc 1515 5 u the enrollment manager assigns the roles nd rulebased attributes to the 1516 candidate manager 1517 6 u the prsn updates the enrollment data for the candidate manager 1518 7 u the enrollment manager notifies the appropri ate entity sponsor candidate 1519 of the enrollment 1520 1521 1522 1523 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 61 unclassifiedfor official use only 613 u initialization of token 1523 6131 u summary 1524 u this section describes the initial registration of token token has its own 1525 identity within the kmi and key can be wrapped spe cifically for that token by kmi 1526 psn using credentials stored as part of the token s registration information in the kmi 1527 6132 u sequence diagram 1528 1529 device registration manager login to mgcprsn interact with dans to gain unique dod device identitymgc login request registration of tokentoken upload manufacturers id and random component from tokenpsn request seed key seed key sent to drm via prsn pde wrapped in akp credentials load seed key into tokencredentialing data stored in kmi database token shipped to sponsoring organization koa for future endorsementprovisioningpsn generates seed keydans 1530 figure 11 u initialization of token 1531 6133 u kmi roles involved 1532 u device registration manager 1533 6134 u kmi nodes involved 1534 u manager client mgc 1535 u prsn 1536 u psn 1537 6135 u prerequisites 1538 u the device registration manager has manager c lient mgc 1539 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 62 unclassifiedfor official use only u the token has software baseline from the fact ory 1540 u the token has been designed in compliance with kmi standards 1541 u the device registration manager is valid and s rights within the 1542 appropriate domain 1543 6136 u sequence of events 1544 1 u device registration manager drm logs into mgc and authenticates to 1545 kmi using type 1 identitytoken 1546 2 u drm uploads electronically or physically manufacturers id and random 1547 component from the token being initialized 1548 3 u drm logs into prsn and requests registration of new token 1549 4 u prsn interacts with dod authoritative naming source dans to gain 1550 unique dod device identity aka device distinguis hed name 1551 5 u prsn requests from the psn seed key that embeds the dansprovided 1552 identity and the random component from the new toke n the seed key is linked 1553 to the dod identity and the tokengenerated random component 1554 6 u the psn generates the seed key 1555 7 u the seed key is delivered to the drm via the prsn pde wrapped in the 1556 akps credentials 1557 8 u this credentialing data is stored in the kmi database at the prsn for the 1558 endorsement process 1559 9 u drm retrieves and loads seed key and electro nic identity into the new token 1560 the token is now registered in kmi 1561 10 u the token is shipped to sponsoring organi zation koa and eventually to 1562 mission location for endorsement provisioning 1563 1564 1565 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 63 unclassifiedfor official use only 614 u endorsement of token 1565 6141 u summary 1566 u this section describes the endorsement of tok this process establishes 1567 sponsor for the token completes the establishment of the type 1 token identity and 1568 converts the seed key to an infrastructure key for the token 1569 6142 u sequence diagram 1570 1571 lt1ra prsn mgc login assign sponsor and issue request for token type 1 identitytoken seed key conversion request validate token integri ty psn login to mgc transfer token id data from registration dbconvert seed key to infrastructure key deliver infrastructure key store infrastructure credentials establish cryptographic association with psn coope ratively generate publicprivate key pairs that bin d distinguished name to token deliver token identity certificategenerate token identity certificate associate certificate id with token registration datarequests key conversionconnects to psrn 1572 figure 12 u endorsement of token 1573 6143 u kmi roles involved 1574 u local type 1 registration authority lt1ra so enrolled as product 1575 requester 1576 u sponsor 1577 6144 u kmi nodes involved 1578 u manager client mgc 1579 u prsn 1580 u psn 1581 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 64 unclassifiedfor official use only 6145 u prerequisites 1582 u the token has been initialized registered and shipped to lt1ra 1583 u prsn has captured token registration data to be used in the endorsement 1584 process 1585 u lt1ra is valid and has rights within the approp riate domain 1586 6146 u sequence of events 1587 1 u lt1ra receives the token out of band proces s not shown in figure 1588 2 u lt1ra logs into mgc 1589 3 u lt1ra logs into the prsn assigns sponsor to the token and issues 1590 request for type 1 token identity note the ide ntity request is built from the 1591 kmi knowledge of the token serial numbertoken dist inguished name that 1592 occurred during the initialization process and info rmation provided by the 1593 lt1ra 1594 4 u the token sends seed key conversion reques t 1595 5 u the prsn connects to the psn and forwards th seed key conversion request 1596 for the token 1597 6 u psn converts seed key to infrastructure key 1598 7 u psn delivers infrastructure key to the token 1599 8 u the infrastructure credential information is stored within the prsn 1600 9 u the token establishes cryptographic associ ation with the psn and they 1601 cooperatively generate the public and private key p airs that bind the tokens 1602 distinguished name to the token 1603 10 u prsn sends token id data from the registrat ion data store to the psn 1604 11 u psn generates type 1 certificate for the to ken 1605 12 u the type 1 token certificate is associated with the token registration data 1606 at the prsn 1607 13 u token receives the identity certificate fro m the psn 1608 1609 1610 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 65 unclassifiedfor official use only 615 u activation of token 1610 6151 u summary 1611 u this section describes the provisioning of to ken the provisioning process 1612 transitions the token to an operational state thi s is done by requesting operational 1613 mission keys using the infrastructure key genera ted from the endorsement process 1614 6152 u sequence diagram 1615 1616 lt1ra prsn mgc login issue request for managers type 1 identity certificatetoken psn login to mgc transfer certificate datacooperatively generate publicprivate key pairs tha t bind manager distinguished name to token request and issue pin deliver manager identity certificateprsn holds identity information of candidate manager generate manager identity certificatemanager candidate token delivered to managerpresent id credentials obtain manager candidates in person info associate certificate id with token registration data 1617 figure 13 u activation of token 1618 6153 u kmi roles involved 1619 u local type 1 registration authority lt1ra so enrolled as product 1620 requester 1621 manager candidate 1622 6154 u kmi nodes involved 1623 u manager client mgc 1624 u prsn 1625 u psn 1626 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 66 unclassifiedfor official use only 6155 u prerequisites 1627 u the token has been initialized registered and endorsed 1628 u valid need for access as kmi manager exists 1629 u the candidate is registered within kmi 1630 u lt1ra is valid and has rights within the approp riate domain 1631 6156 u sequence of events 1632 1 u lt1ra logs into mgc 1633 2 u the manager candidate presents his id creden tials to the lt1ra for 1634 verification 1635 3 u the lt1ra collects the inperson information from the manager candidate 1636 4 u lt1ra logs into the prsn and requests manage rs type 1 identity 1637 certificate 1638 5 u the manager identity information is stored w ithin the prsn 1639 6 u the token establishes cryptographic associ ation with the psn they 1640 cooperatively generate the public and private key p airs that bind the managers 1641 distinguished name to the token and pin is reque sted and issued 1642 7 u prsn sends the certification data to the psn 1643 8 u psn generates manager identity certificate 1644 9 u the psn delivers the manager identity certif icate to the token 1645 10 u the prsn associates the certificate id wit h the token registration data 1646 11 u the token is delivered to the manager and i s now ready to operate 1647 1648 1649 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 67 unclassifiedfor official use only 616 u deregister manager from kmi 1649 6161 u summary 1650 u this scenario describes the activities that enc ompass deregistration of kmi 1651 manager within kmi in deregistration you are rem oving the presence of manager 1652 from kmi trigger begins the process of deregiste ring kmi manager the trigger is 1653 validated and the process is completed by the regis tration manager interacting with the 1654 prsn the process is completed when deregistration has been accomplished and 1655 acknowledgement has been received at the user level 1656 6162 u sequence diagram 1657 1658 prsnregistration manager mgc verify id and privilegesvalidates request and verifies data login to prsn request deregistration of kmi manager id deactivate kmi manager id inactive state set acknowledgement of kmi manager id removaltrigger for deregistration notify source of trigger of deregistration of kmi managerexternal authority deregistration conflict check resolutionkmi manager being deregistered collect type 1 token from kmi manager conditional purge type 1 token of manager type 1 idlogin to mgc request revocation of manager type 1 id notificationdeenroll managerpsn revoke manager type 1 id 1659 figure 14 u deregister manager from kmi 1660 6163 u kmi roles involved 1661 u external authority 1662 u registration manager 1663 u kmi manager being deregistered 1664 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 68 unclassifiedfor official use only 6164 u kmi nodes involved 1665 u manager client mgc 1666 u prsn 1667 6165 u prerequisites 1668 u kmi manager has been enrolled with personal ized type 1 token 1669 u valid need for deregistration within kmi exis ts 1670 u participating kmi managers are valid and have r ights within the appropriate 1671 domain 1672 6166 u sequence of events 1673 1 u user identity that is assigned to kmi ma nager role will be identified for 1674 deregistration by an external authority that has th right to do so 1675 2 u the registration manager validates the reque st and verifies the identity of the 1676 external authority to ensure that they have the rig ht to request this 1677 3 u the registration manager logs onto the prsn 1678 4 u the registration manager requests the prsn t deregister user 1679 5 u check is performed by the prsn to ensure that deregistration conflicts 1680 will arise and if so they are resolved 1681 6 u the kmi manager id is deactivated by the prs n an inactive state is set 1682 7 u the kmi manager id is deenrolled by the prs n 1683 8 u the prsn send request to revoke the kmi ma nagers type 1 id to the 1684 psn 1685 9 u the psn revokes the managers type 1 id 1686 10 u an acknowledgement is sent to the registrat ion manager that the kmi 1687 manager id has been deregistered 1688 11 u the type 1 token is collected from the kmi manager being deregistered 1689 conditional 1690 12 u the registration manager purges the type 1 token of its manager type 1 1691 id 1692 13 u an acknowledgement is sent to the external authority whom requested the 1693 deregistration of the kmi manager 1694 1695 1696 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 69 unclassifiedfor official use only 617 u change enrollment of kmi manager 1696 6171 u summary 1697 u this scenario describes the activities that enc ompass changing the enrollment of 1698 kmi manager within kmi trigger begins the proce ss of requesting change of 1699 enrollment for kmi manager the trigger is valid ated and the process is completed by 1700 the enrollment manager interacting with the prsn t he process is completed when 1701 enrollment has been changed and acknowledgement of the change has been received at 1702 the user level 1703 6172 u sequence diagram 1704 1705 prsnenrollment manager mgc verify id and privilegesvalidates request verifies data login to prsn change enrollment for kmi manager idtrigger for enrollment change notify source of trigger of change of enrollment of kmi manager iddetermine role andor attribute modifications based on triggerexternal authority enrollment data updatedlogin to mgc review managers current roles attributes notification 1706 figure 15 u change enrollment of kmi manager 1707 6173 u kmi roles involved 1708 u external authority 1709 u enrollment manager 1710 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 70 unclassifiedfor official use only 6174 u kmi nodes involved 1711 u manager client mgc 1712 u prsn 1713 6175 u prerequisites 1714 u kmi manager has been enrolled with personal ized type 1 token 1715 u valid need for change of enrollment within km i exists 1716 u participating kmi managers are valid and have r ights within the appropriate 1717 domain 1718 6176 u sequence of events 1719 1 u user identity that is assigned to kmi ma nager role will be nominated for 1720 change of enrollment by an external authority that has the right to do so 1721 2 u the enrollment manager will validate the req uest and verify the identity of 1722 the external authority to ensure that they have the right to request this 1723 3 u the enrollment manager will login to the prs n 1724 4 u the enrollment manager will review the manag ers current roles attributes 1725 5 u the enrollment manager will determine role ndor attribute modifications 1726 based on the trigger 1727 6 u the enrollment manager will change the enrol lment data assigned to the user 1728 identity for the kmi manager role 1729 7 u the enrollment data will be updated at the p rsn 1730 8 u an acknowledgement will be sent to the exter nal authority whom requested 1731 the change of enrollment for the kmi manager 1732 1733 1734 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 71 unclassifiedfor official use only 1734 62 kmi operating account koa registration proces s 1735 1736 u there are several steps necessary to register kmi operating account koa as 1737 shown in figure 16 the koa is first registered by the koa registration manager 1738 rm the koa rm may also have the role of the ekm s registration authority ra 1739 the registration information is then sent to both t he ekms directory and prsn 1740 registration data store the ekms directory synchr onizes the koa registration data 1741 with the prsn registration data store finally notice of registration is sent to the 1742 koa manager from which point the koa is active 1743 1744 1745 32 1 sponsoring organizationtriggertrigger authorityauthority to actto actkoa rmekms rakoa registrationekms directory active koaprsn registration data store notice of registrationadditional registration data required by kmikoa registeredkoa registration data synchronization koa manager 1746 1747 figure 16 u koa registration process 1748 1749 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 72 unclassifiedfor official use only 621 u registration of kmi operating account koa 1749 6211 u summary 1750 u this scenario describes the registration of k operating account the koa is 1751 assumed to be military service account supporting kmiaware devices and is assumed 1752 to have mgc with an akp to provide identification and authentication for its prsn 1753 interactions and security protection for the mgc t his configuration is the equivalent of 1754 an lmpkpequipped comsec account in the current sy stem at the completion of this 1755 process the koa is capable of receiving key to be unwrapped by its akp and filed into 1756 the benign and red fill ecus and its kmiaware ecu s are registered with the kmi and 1757 prepared to accept key via otnk 1758 6212 u sequence diagram 1759 1760 koa registration managerprsnekms directoryexternal authority login to prsn register account provide account registration info ensure conflict with ekms vet account info acknowledge registration results active state setmgc initiates request for new koa verify id and privileges establish account inactive state set acknowledge account established associate koams associate akplogin to mgcekms ratier 1 system register kme registration data capturedekms id assigned set comsec indicator to true synchronize directory data to kmi synchronize directory data with ekms notification of registration 1761 figure 17 u registration of kmi operating accoun t koa 1762 6213 u kmi roles involved 1763 u external authority 1764 u koa registration manager ekms registration aut hority could be same 1765 person 1766 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 73 unclassifiedfor official use only 6214 u kmi nodes involved 1767 u manager client mgc 1768 u prsn 1769 6215 u prerequisites 1770 u koa registration manager must be enrolled with appropriate privileges and 1771 must have privileges for the domain in which the ko will be registered 1772 u administrative physical actions to create the comsec accountkoa and 1773 appoint the koa manager must be complete ie pol icy prerequisites must be 1774 satisfied 1775 u koa must have kmi client and akp 1776 6216 u sequence of events 1777 1 u an external authority identifies need for koa the external authority 1778 will initiate request and provide account informa tion to the koa registration 1779 manager and ekms registration authority 1780 2 u the ekms ra will register the new kme using the tier 1 system as 1781 result the kme will have an ekms id and basic admi nistrative information will 1782 be captured and stored in the ekms directory 1783 3 u the ekms ra sets the comsec account indicato r for the new account to 1784 true and enters other administrative data specific to comsec accounts 1785 4 u the directory data is synchronized to kmi 1786 5 u once the registration request has been autho rized by the appropriate authority 1787 the koa registration manger will log into the mgc 1788 6 u the registration manager provides the accoun t registration information to the 1789 prsn for registration into the system 1790 7 u the prsn will verify that conflict does t exist by comparing the data 1791 with the ekms directory data 1792 8 u once check is complete the koa is establish ed the account is instantiated 1793 but has status of inactive 1794 note the account will remain inactive until all co nstraints are met 1795 koa manager needs to be enrolled which first r equires registration to 1796 the kmi 1797 koa manager must first be identified and an akp needs to be 1798 associated with the account 1799 koa manager needs to be assigned to koa 1800 9 u the directory data is then synchronized with ekms 1801 10 u once these two constraints have been met t he account status will be set to 1802 active 1803 11 u an acknowledgement is sent to the koa regis tration manager that the 1804 account has been established 1805 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 74 unclassifiedfor official use only 12 u the koa registration manager associates the key operating account 1806 managers koams 1807 13 u the koa registration manager associates the akp 1808 14 u notification is sent back to the external authority that registration of koa is 1809 complete active state set 1810 1811 1812 1813 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 75 unclassifiedfor official use only 63 kmiaware device activation process 1813 1814 u there are several steps necessary to make kmi aware device operational as 1815 shown in figure 18 the kmiaware device must firs t be initialized registered with 1816 kmi by the device registration manager rm the r egistration process provides the 1817 kmiaware device with an initial seed key the kmi aware device is then endorsed 1818 by the local type 1 registration authority lt1ra 1819 1820 u in the endorsement process the kmiaware devic receives sponsor type 1 1821 identity certificate and converts the initial seed key to an infrastructure key the kmi 1822 aware device is then activated by the koa manager at which time the device 1823 downloads the mission keys the kmiaware device i s then ready to operate and begin 1824 its mission 1825 1826 51 device registration manager klifdevice registrationlt1ra device endorsement mission key request eff seed key electronic identity sponsor assignment type 1 identity request device activation provisioning eef seed key request koa registration identity certificate mission key initialized kmi aware device3 24 6 7 kmiaware device ready to operate initialized endorsed kmi aware device 1827 figure 18 u kmiaware device activation process 1828 1829 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 76 unclassifiedfor official use only 631 u register kmi aware device 1829 6311 u summary 1830 u this section describes the initial registration of kmiaware device kmiaware 1831 device has its own identity within the kmi and key can be wrapped specifically for that 1832 device by kmi psn using credentials stored as pa rt of the devices registration 1833 information in the kmi this storyboard assumes th use of mgc klif capabilities in 1834 the registration of kmiaware device as this is expected to be typical scenario with 1835 future devices it also assumes that the device be ing registered is capable of overthe 1836 network interactions with the kmi 1837 6312 u sequence diagram 1838 1839 deliver seed key to prsn pde wrapped in akp credentialdevice registration manager login to mgcprsn interact with dans to gain unique dod device identity mgc login request registration of kmiaware devicekmiaware device upload manufacturers id and random component from devicepsn request seed key load seed key into kmiaware devicecredentialing data stored in kmi database kmiaware device shipped to service koa for future endorsementprovisioningdans psn generates seed key wrapped seed key retrieved by registration manager 1840 figure 19 u register kmi aware device 1841 6313 u kmi roles involved 1842 u device registration manager 1843 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 77 unclassifiedfor official use only 6314 u kmi nodes involved 1844 u manager client mgc 1845 u prsn 1846 u psn 1847 6315 u prerequisites 1848 u klif is registered as koa most likely at the device manufacturers site 1849 u the device registration manager has manager c lient mgc 1850 u device has software baseline from the factory 1851 u device has been designed in compliance with kmi standards to permit being 1852 kmiaware 1853 u klif knows nationality but not mission for t he new device 1854 6316 u sequence of events 1855 1 u device registration manager rm logs into m gc and authenticates to kmi 1856 using type 1 identitytoken 1857 2 u device rm uploads electronically or physica lly manufacturers id and 1858 random component from the kmiaware device 1859 3 u device rm logs into prsn and requests regist ration of kmiaware device 1860 4 u prsn interacts with dod authoritative naming source dans to gain 1861 unique dod device identity aka device distinguis hed name 1862 5 u prsn requests from the psn seed key that embeds the dans identity 1863 and the random component of the kmiaware device t he seed key is linked to 1864 the dod identity and the kmiaware device random ge nerated component 1865 6 u the psn generates the seed key 1866 7 u the seed key is delivered to the prsn pde w rapped in the akps 1867 credentials 1868 8 u this credentialing data is stored in the kmi database at the prsn for the 1869 endorsement process 1870 9 u the prsn delivers the wrapped seed key to th device rm 1871 10 u device rm retrieves and loads seed key and electronic identity into kmi 1872 aware device the device is now registered in kmi 1873 11 u the kmiaware device is shipped to service and eventually is shipped to 1874 koa account or mission location for endorsement and activation 1875 1876 1877 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 78 unclassifiedfor official use only 632 u endorsement of kmi aware device 1877 6321 u summary 1878 u this section describes the endorsement of kmi aware device this process 1879 establishes sponsor for the kmiaware device com pletes the establishment of type 1 1880 identity and converts the seed to an infrastructure key for the kmiaware device this 1881 process can occur for both networked or disconnec ted kmiaware device 1882 6322 u sequence diagrams 1883 1884 lt1ra prsn mgc login assign sponsor and issue request for type 1 identitykmiaware device connects to prsn with seed keyinitialized kmiaware devicepsn ready for mission loadlogin to mgc transfer registration dataconvert seed key to infrastructure key deliver infrastructure key store infrastructure credentials establish cryptographic association with psn coope ratively generate publicprivate key pairs that bin d distinguished name to device deliver kmiaware device identity certificategenerate kmiaware device identity certificateconnect to psn request key conversionvalidate device integrityconfigure device for prsn interactions via network trigger device connection to prsn associate certificate id with device registration data 1885 figure 20 u endorsement kmi aware device networ ked 1886 1887 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 79 unclassifiedfor official use only lt1ra prsn mgc login assign sponsor and issue request for type 1 identitykmiaware device connects to prsn with seed keyinitialized kmiaware devicepsn ready for mission loadlogin to mgc transfer registration dataconvert seed key to infrastructure key deliver infrastructure key store infrastructure credentials establish cryptographic association with psn coope ratively generate publicprivate key pairs that bind distinguished na to device deliver kmiaware device identity certificategenerate kmiaware device identity certificateconnect to psn request key conversionvalidate device integrityconfigure device for prsn interactions via network trigger device connection to prsn fill device associate certificate id with device registration data 1888 figure 21 u endorsement kmi aware device discon nected 1889 1890 6323 u kmi roles involved 1891 u local type 1 registration authority lt1ra so enrolled as product 1892 requestor 1893 6324 u kmi nodes involved 1894 u manager client mgc 1895 u prsn 1896 u psn 1897 6325 u prerequisites 1898 u device has been initialized registered and sh ipped to the lt1ra 1899 u prsn has captured device registration data to b used in the endorsement 1900 process 1901 u device has been designed in compliance with kmi standards to permit being 1902 kmi aware 1903 u mgc serves as the intermediary device 1904 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 80 unclassifiedfor official use only 6326 u sequence of events 1905 for networked kmiaware device 1906 1 u lt1ra receives the initialized kmiaware dev ice out of band process 1907 2 u lt1ra logs into mgc 1908 3 u lt1ra configures the kmiaware device for pr sn interactions via 1909 network 1910 4 u lt1ra logs into the prsn assigns sponsor to the kmiaware device and 1911 issues request for type 1 identity note the identity request is built from the 1912 kmi knowledge of the device serial numberdevice di stinguished name that 1913 occurred during the initialization process and info rmation provided by the 1914 lt1ra 1915 5 u kmiaware device is triggered for prsn conne ction 1916 6 u the kmiaware device connects with the prsn using seed key prsn 1917 validates device integrity 1918 7 u prsn connects to the psn and requests seed k ey conversion 1919 8 u psn converts seed key to infrastructure key 1920 9 u psn delivers infrastructure key to kmiaware device via prsn 1921 10 u the infrastructure credential information i s stored within the prsn 1922 11 u the psn and kmiaware device cooperatively generate the public and 1923 private key pairs that bind the distinguished name to the device 1924 12 u prsn sends kmi aware devices registration data to the psn 1925 13 u psn generates type 1 certificate for the km iaware device 1926 14 u kmiaware device receives the identity cert ificate from the psn 1927 15 u the prsn associates the certificate id with the device registration data 1928 16 u the kmiaware device is now ready for its m ission load 1929 1930 for disconnected kmiaware device 1931 1 u lt1ra receives the initialized kmiaware device ou t of band process 1932 2 u lt1ra logs into mgc 1933 3 u lt1ra configures the kmiaware device for prsn inte ractions via 1934 network 1935 4 u lt1ra logs into the prsn assigns sponsor to the kmiaware device and 1936 issues request for type 1 identity note the identity request is built from the 1937 kmi knowledge of the device serial numberdevice di stinguished name that 1938 occurred during the initialization process and info rmation provided by the 1939 lt1ra 1940 5 u kmiaware device is triggered for prsn connection 1941 6 u the kmiaware device via fill device and mgc conn ects with the prsn 1942 using seed key prsn validates device integrity 1943 7 u prsn connects to the psn and requests seed key conv ersion 1944 8 u psn converts seed key to infrastructure key 1945 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 81 unclassifiedfor official use only 9 u psn delivers infrastructure key to kmiaware device via prsn mgc and 1946 fill device 1947 10 u the infrastructure credential information is stored within the prsn 1948 11 u the psn and kmiaware device via mgc cooperativel generate the 1949 public and private key pairs that bind the distingu ished name to the device 1950 12 u prsn sends kmi aware devices registration data to the psn 1951 13 u psn generates type 1 certificate for the kmiaware device 1952 14 u kmiaware device receives the identity certificate from the psn via mgc 1953 and fill device 1954 15 u the prsn associates the certificate id with the device registration data 1955 16 u the kmiaware device is now ready for its mission l oad 1956 1957 1958 1959 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 82 unclassifiedfor official use only 633 u activation of kmi aware device 1959 6331 u summary 1960 u this section describes the activationprovision ing process of kmiaware device 1961 this process transitions the kmiaware device to an operational state this is done by 1962 requesting operational mission keys using the in frastructure key generated from the 1963 endorsement process this process can occur for bo th networked and disconnected 1964 devices 1965 6332 u sequence diagram 1966 1967 deliver mission key to kmi aware device via interme diary device mgc and fill devicekoa managerprsn mgckmiaware device kmi aware device ready to operate login to mgc login to prsn via intermediary device mgc using akps infrastructure key request mission key if networked kmi aware device if disconnected kmi aware devicefill device securely connect to prsn using infrastructure key request mission key deliver mission key to kmi aware devicewrapped mission key available at prsntrigger device connection to prsn 1968 figure 22 u activationprovisioning kmi aware vice 1969 6333 u kmi roles involved 1970 u koa manager also enrolled as product request or 1971 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 83 unclassifiedfor official use only 6334 u kmi nodes involved 1972 u manager client mgc 1973 u prsn 1974 u psn 1975 6335 u prerequisites 1976 u device has been initialized registered and dorsed 1977 u product for device has been defined by controll ing authority 1978 u koa sponsoring the device has been placed on ac count distribution profile 1979 for product 1980 u koa manager has placed the device on the device distribution profile for 1981 the product 1982 u product has been generated by psn and wrapped f or receiving device using 1983 the devices credential supplied by prsn 1984 u mgc serves as the intermediary device could so be doc operated by 1985 koa agent 1986 6336 u sequence of events 1987 1988 if the kmiaware device is networked 1989 1 the kmiaware device is triggered to connect to the prsn 1990 2 the kmiaware device connects with the pde porti on of the prsn using the 1991 infrastructure key to create secure connection an d requests mission key 1992 3 once the devices type 1 identity is authenticat ed the prsn delivers the mission 1993 key to the kmiaware device the mission keys are u nwrapped and loaded into 1994 mission storage locations within the kmiaware devi ce 1995 4 the kmiaware device is now ready to operate 1996 1997 if the kmi aware device is disconnected 1998 1 the koa manager logs into the manager client mg c the mgc will serve as 1999 the intermediary device 2000 2 the mgc connects with the prsn pde using the akp s infrastructure key to 2001 create secure connection and request mission key 2002 3 once the mgcs type 1 identity is authenticated by the prsn the mgc 2003 transfers the mission keys from the prsn to fill device from which the keys are 2004 transferred to the kmiaware device the mission ke ys are unwrapped by the 2005 kmiaware device and loaded into mission storage cations within the device 2006 4 the kmiaware device is now ready to operate 2007 2008 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 84 unclassifiedfor official use only 64 product ordering and retrieval process symmet ric key 2009 u there are several steps of the product orderin g and retrieval process for symmetric 2010 keys as shown in figure 23 the first step is fo r the controlling authority to establish 2011 the product in which product requirements and an ccount distribution profile adp 2012 are established this data is updated in the cata log at the prsn product requirement 2013 data store and also passed to the koa manager the koa manager takes the new 2014 product requirements and the adp to establish the d evice distribution profile ddp 2015 which is updated in the data store catalog 2016 2017 u when ready to order the product requestor req uests the product ordering catalog 2018 from the prsn product requirement data store afte r requesting the required products 2019 this process enters the generation and production p hase here the products are generated 2020 and produced in the wrapping credentials the prod ucts are then distributed either 2021 electronically or physically to their appropriate d estinations 2022 2023 2024 43 52 1 koa manager koa agent ecucontrolling authority product establishment product retrievalkoa managerdistribution profile management generation productionprsn product requirement data store production request catalog update ddp established controlling authority product requesterproduct ordering new product requirement adp established electronic key product product ordering catalog adp update 5 physical product distribution physical key product koa managercredential upload wrapping credential 2025 2026 figure 23 u product ordering and retrieval 2027 2028 2029 2030 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 85 unclassifiedfor official use only 641 u establishment of new product requirement for 2031 symmetric key 2032 6411 u summary 2033 u when product is added to the ordering catalog the requirements for the product 2034 also need to be defined this process allows the co ntrolling authority to request the 2035 products view the requirements for that product nd modify them as necessary this 2036 scenario includes the case where the controlling au thority is establishing new 2037 requirement for known product type that will be h andled as standing order for 2038 regularly superseded operational key requiring kmi to periodically generate the product 2039 and make it available for retrieval 2040 6412 u sequence diagram 2041 2042 koa managercontrolling authority verify id and privileges confirm establishment of new product requirementlogin to prsn establish account distribution profile optional w mandatory prior to generationprsn mgc mgc request catalog present tailored catalogdetermine tailored catalog based on manager privilegesexternal authority establish short title update product requirementsschedule for catalog manager approval if required for product typedefine product characteristics ie short title classification crypto period use supersession characteristics etc authorize product requesters to order product opti onallogin to mgc login to mgcinitiate new product requirement notify koa managers of new productvalidate product characteristics against product type and manager privileges login to prsn 2043 figure 24 u establishment of new product require ment for symmetric key 2044 6413 u kmi roles involved 2045 u external authority 2046 u controlling authority 2047 u koa manager 2048 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 86 unclassifiedfor official use only 6414 u kmi nodes involved 2049 u manager client mgc 2050 u prsn 2051 6415 u prerequisites 2052 u product type has been previously established 2053 6416 u sequence of events 2054 1 u an external authority will initiate reques t for product new instance and 2055 provides product requirements to the controlling au thority via out of band 2056 methods 2057 2 u the controlling authority logs into the mgc 2058 3 u the controlling authority connects and authe nticates to the prsn ome 2059 using mgc 2060 4 u the controlling authority requests the catal og 2061 5 u the prsn determines the tailored catalog bas ed on the privileges of the 2062 controlling authority 2063 6 u the catalog is sent to the controlling autho rity 2064 7 u controlling authority defines new product ch aracteristics ie short title 2065 classification crypto period use supersession ch aracteristics etc 2066 8 u the prsn validates the product characteristi cs against the product type and 2067 manager privileges 2068 9 u the prsn confirms establishment of the new p roduct requirement 2069 10 u the controlling authority establishes account d istribution profile adp 2070 optional this may occur while establishing the n ew product or at later time 2071 but must be done prior to generation 2072 11 u the controlling authority identifies author ized product requesters to order 2073 product optional this may occur while establishing the new produc t or at 2074 later time 2075 12 u the prsn assign new and unique nomenclature appropriate for the 2076 cryptographic product type and performs product req uirements updates 2077 13 u if required for product type the prsn sche dules the request for catalog 2078 manager approval 2079 14 u when koa manager of koa on the account distribution profile logs in 2080 the prsn notifies the koa manager of availability f new symmetric product 2081 2082 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 87 unclassifiedfor official use only 642 u account distribution profile adp management 2082 6421 u summary 2083 u to ensure that products are delivered to the ap propriate ecus the kmi will keep an 2084 account distribution profile adp which is coll ection of information that defines 2085 which koas are authorized to receive that product there is an adp for each 2086 instantiation of product this scenario shows the steps for developing and modifying an 2087 account distribution profile 2088 6422 u sequence diagram 2089 controlling authority or product requester login to prsn present requirement characteristics manage adp verify id and privilegesprsn mgc request requirement establish initial adp associate koa with product requirement validate changes and update adpcreation of initial adp manage existing adppresent adprequest adp for requirementlogin to mgc validate changes and update adp 2090 figure 25 u account distribution profile adp m anagement 2091 6423 u kmi roles involved 2092 u controlling authority 2093 u product requestor 2094 6424 u kmi nodes involved 2095 u manager client mgc 2096 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 88 unclassifiedfor official use only u prsn 2097 6425 u prerequisites 2098 u product requirements have been previously estab lished 2099 6426 u sequence of events 2100 1 u the controlling authority product requeste r logs into the mgc 2101 2 u the controlling authority product requeste r logs into the prsn 2102 3 u the controlling authority product requeste r requests the requirements for 2103 given product from the prsn 2104 4 u the prsn sends back the requirements to the controlling authority product 2105 requester 2106 2107 if creating initial account distribution profile 2108 1 u the controlling authority product requeste r requests the creation of new 2109 adp identifying the koas to be included in the n ew profile 2110 2 u the prsn associates the selected koas with t he product requirement 2111 3 u the prsn validates and updates the adp chang 2112 2113 if managing existing account distribution profile 2114 1 u the controlling authority product requeste r requests the adp from the 2115 prsn for given product 2116 2 u the prsn sends back the appropriate adp 2117 3 u the controlling authority product requeste r adds or removes koas as 2118 necessary 2119 4 u the prsn validates and updates the adp chang 2120 2121 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 89 unclassifiedfor official use only 643 u device distribution profile ddp management 2121 6431 u summary 2122 u to ensure that products are delivered to the ap propriate ecus the kmi will keep 2123 device distribution profile ddp for each product there is ddp for each koa that is 2124 specified to receive the given product this scena rio shows the steps for developing and 2125 modifying the device distribution profiles 2126 note ddps only apply to products being delivered t kmiaware devices if 2127 there is ddp for given product the default is to wrap product for the koas 2128 akp for the given product 2129 6432 u sequence diagram 2130 koa manager login to prsn present ddpverify id and privilegesprsn mgc manage ddp add remove kmiaware devices establish initial ddp for requirement validate changes and update adp validate changes and update adprequest ddp for requirementcreation of initial ddp manage existing ddpadd kmiaware devices to ddplogin to mgc 2131 figure 26 u device distribution profile ddp ma nagement 2132 6433 u kmi roles involved 2133 u koa manager 2134 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 90 unclassifiedfor official use only 6434 u kmi nodes involved 2135 u manager client mgc 2136 u prsn 2137 6435 u prerequisites 2138 u product requirements have been previously estab lished 2139 u account distribution profile adp has been pre viously established 2140 6436 u sequence of events 2141 1 u the koa manager logs into the mgc 2142 2 u the koa manager logs into the prsn 2143 2144 if creating initial device distribution profile 2145 1 u the koa manager requests the creation of new ddp 2146 2 u the koa manager adds kmiaware devices to the ddp 2147 3 u the prsn validates and updates the adp changes 2148 2149 if managing existing device distribution profile 2150 1 u the koa manager requests the ddp for the managers koa from the 2151 prsn 2152 2 u the prsn sends back the appropriate ddp 2153 3 u the koa manager adds or removes kmiaware devices 2154 4 u the prsn validates and updates the adp changes 2155 2156 2157 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 91 unclassifiedfor official use only 644 u ordering of symmetric keys other than standin g 2157 orders 2158 6441 u summary 2159 u designated controlling authority or product r equester can order products on 2160 productbyproduct basis this ordering method will most likely be used for key products 2161 such as irregularly superseded operational key tes t key and contingency key in the this 2162 scenario product requester orders product that requires secondary approval and the 2163 controlling authority approves the order 2164 6442 u sequence diagram 2165 product requester login to prsn request catalog present tailored ordering catalog based on privileg browse catalog and select product interactively develop product order transaction submit product order retrieve messagesnotificationscontrolling authority login to prsn approve orderverify id and privileges verify id and privilegesdetermine if approval is required acknowledgement of order received and requires appr ovalprsn mgc mgc approval notification alert login to mgclogin to mgc sign product order transaction secondary approval 2166 figure 27 u ordering of symmetric keys 2167 6443 u kmi roles involved 2168 u controlling authority 2169 u product requestor 2170 6444 u kmi nodes involved 2171 u manager client mgc 2172 u prsn 2173 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 92 unclassifiedfor official use only 6445 u prerequisites 2174 u the key material being ordered is in the produc t ordering catalog poc 2175 u the product requester has been granted the nece ssary privileges to order the 2176 product 2177 6446 u sequence of events 2178 1 u the product requester logs into the mgc 2179 2 u the product requester authenticates to the p rsn 2180 3 u the mgc requests the product catalog from th prsn on behalf of the 2181 product requester 2182 4 u the product requester requests the catalog 2183 5 u the prsn determines the products that the gi ven product requester has the 2184 authority to order based on the product requester s privileges and tailors the 2185 catalog appropriately 2186 6 u the tailored catalog is transmitted to the m gc where it is presented to the 2187 product requester 2188 7 u the product requester browses the tailored rdering catalog for the desired 2189 product to be ordered 2190 8 u the product requester and prsn interactively develop the product order 2191 transaction 2192 9 u the product requester signs the product orde r transaction 2193 10 u the product requester submits the order to the prsn 2194 11 u the prsn determines if the product order re quires approval 2195 12 u the prsn acknowledges the order is received and determines that the order 2196 requires secondary approval 2197 13 u the prsn provides notification alert for the controlling authority when 2198 they next log in 2199 14 u the controlling authority logs into the mgc 2200 15 u the controlling authority authenticates to the prsn 2201 16 u the controlling authority receives approval notification 2202 17 u the controlling authority reviews and appro ves the product order 2203 2204 2205 2206 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 93 unclassifiedfor official use only 65 product ordering and distribution process as ymmetric key 2206 2207 u there are several steps of the product orderin g and retrieval process for 2208 asymmetric keys as shown in figure 28 the first step is for the command authority 2209 to establish the product in which the partition an d dao codes are established this data 2210 is updated in the catalog at the prsn product requi rement data store 2211 2212 u when ready to order the product requestor req uests the product ordering catalog 2213 from the prsn product requirement data store afte r requesting the required products 2214 this process enters the generation and production p hase here the products are generated 2215 and produced in the wrapping credentials the prod ucts are then distributed either 2216 electronically or physically to their appropriate d estinations 2217 2218 43 42 1 koa manager koa agent ecucommand authorityproduct establishmentproduct requester product ordering electronic product retrievalprsn product requirement data store production request catalog update product ordering catalog generation production partition codes dao codes established electronic key product physical product distribution physical key productkoa manager credential upload wrapping credential 2219 2220 figure 28 u product ordering and distribution process as ymmetric key 2221 2222 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 94 unclassifiedfor official use only 651 u establishment of partitiondao code privileges for 2222 asymmetric key ordering 2223 6511 u summary 2224 u this scenario describes the events associated w ith the establishment of 2225 partitiondao code privileges for asymmetric key or dering the scenario includes 2226 command authority establishing partition code and or dao code and assigning 2227 ordering privileges to product requester 2228 6512 u sequence diagram 2229 command authority login to prsn request dao descriptionrequest for partition andor dao codes assignment prsn mgcexternal authority request catalog present tailored catalogdetermine tailored catalog based on manager privileges request partition code assignment designate product requesters who may use partition and dao codeverify id and privileges process partition code assignment process dao assignment requestlogin to mgc notification of assignment 2230 figure 29 u establishment of partitiondao code privileges for asymmetric key 2231 ordering 2232 6513 u kmi roles involved 2233 u command authority 2234 6514 u kmi nodes involved 2235 u manager client mgc 2236 u prsn 2237 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 95 unclassifiedfor official use only 6515 u prerequisites 2238 u product type has been previously been establish ed 2239 6516 u sequence of events 2240 1 u the external authority sends notice to th command authority typically 2241 outofband that new dao code or partition code is needed 2242 2 u the command authority logs into the mgc 2243 3 u the command authority connects and authentic ates to the prsn using the 2244 mgc 2245 4 u the command authority requests the catalog 2246 5 u the prsn determines the tailored catalog bas ed on the privileges of the 2247 command authority 2248 6 u the catalog is sent to the command authority 2249 7 u the command authority requests partition c ode assignment 2250 8 u the prsn processes the partition code assign ment 2251 9 u the command authority requests new dao des cription 2252 10 u the prsn processes the dao code assignment request 2253 11 u the command authority designates product re questers who may use 2254 specific partition and dao codes 2255 12 u the command authority notifies the external authority 2256 2257 2258 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 96 unclassifiedfor official use only 652 u ordering of asymmetric key 2258 6521 u summary 2259 u this scenario describes the events associated w ith ordering asymmetric key 2260 6522 u sequence diagram 2261 product requester login to prsn submit product order retrieve messagesnotificationscommand authority login to prsn approve orderverify id and privilegesvalidate dao and partition codesprsn mgcdetermine if approval is required approval notification alertlogin to mgc login to mgcmgcrequest for key with device identitydevice user request catalog present tailored ordering catalog based on privileg browse catalog and select product interactively develop product order transaction sp ecifying product characteristics partition code dao code classification inplace date destination koa and device etc sign product order transaction 2262 figure 30 u ordering of asymmetric key 2263 6523 u kmi roles involved 2264 u command authority 2265 u product requestor 2266 6524 u kmi nodes involved 2267 u manager client mgc 2268 u prsn 2269 6525 u prerequisites 2270 u product type has been previously been establish ed 2271 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 97 unclassifiedfor official use only u the command authority must have assigned along with other product 2272 specific data partition and dao codes if applicab to designated product 2273 requestor 2274 6526 u sequence of events 2275 1 u the device user sends request for key for the device identity to the product 2276 requester 2277 2 u the product requester logs into the mgc 2278 3 u the product requester authenticates to the p rsn 2279 4 u the mgc requests the product catalog from th prsn on behalf of the 2280 product requester 2281 5 u the prsn determines the products that the gi ven product requester has the 2282 authority to order based on the product requester s privileges and tailors the 2283 catalog appropriately 2284 6 u the tailored catalog is presented to the pro duct requester 2285 7 u the product requester browses the tailored c atalog for the desired product to 2286 be ordered 2287 8 u the product requester and prsn interactively develop the product order 2288 transaction specifying product characteristics pa rtition code dao code 2289 classification inplace date destination koa and device etc 2290 9 u the product requester signs the product orde r transaction 2291 10 u the product requester submits the order to the prsn 2292 11 u the prsn validates the dao and partition co des 2293 12 u the prsn determines if the product order re quires approval 2294 13 u the prsn provides notification alert for the command authority when 2295 they next log in 2296 14 u the command authority logs into the mgc 2297 15 u the command authority authenticates to the prsn 2298 16 u the command authority receives approval not ification 2299 17 u the command authority reviews and approves the product order 2300 2301 2302 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 98 unclassifiedfor official use only 653 u credential upload 2302 6531 u summary 2303 u this scenario describes the process for credent ial upload of networked kmiaware 2304 ecus nonnetworked kmiaware ecus and akps as ap propriate to the prsn to 2305 support key wrapping 2306 6532 u sequence diagram 2307 prsnkoa managernonnetworked kmiaware ecumgcnetworked kmiaware ecu upload ecu credentialconnect to prsn upload ecu credential upload ecu credential upload akp credentialconnect to prsn connect to prsnstore credentialstore credential store credentialif networked kmiaware ecu if non networked kmiaware ecu if akplogin to mgc login to mgc 2308 figure 31 u credential upload 2309 6533 u kmi roles involved 2310 u koa manager 2311 6534 u kmi nodes involved 2312 u manager client mgc 2313 u prsn 2314 6535 u prerequisites 2315 u credentials have been generated and are availab for upload 2316 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 99 unclassifiedfor official use only 6536 u sequence of events 2317 2318 if credential upload for networked kmiaware ecu 2319 1 the ecu connects to the prsn 2320 2 the ecu uploads its credential to the prsn 2321 3 the prsn stores the credential 2322 2323 if credential upload for nonnetworked kmiaware ec u 2324 1 the koa manager logs into the mgc 2325 2 the ecus credential is uploaded to the koas mg c 2326 3 the koa manager connects to the prsn 2327 4 the koa manager uploads the ecu credential to th prsn 2328 5 the prsn stores the credential 2329 2330 if credential upload for akp 2331 1 the koa manager logs into the mgc 2332 2 the koa manager connects to the prsn 2333 3 the koa manager uploads the akp credential to th prsn 2334 4 the prsn stores the credential 2335 2336 2337 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 100 unclassifiedfor official use only 654 u generation and production 2337 6541 u summary 2338 u this scenario describes the process where an or der request is triggered by 2339 provisioning schedule or an ondemand order and the resulting electronic andor physical 2340 key material is generated and produced 2341 6542 u sequence diagram 2342 wrap key materialforward new product request send wrapped electronic key make wrapped key available to koas koa agents andor devicesselect wrapping credentials based on ddp compose production requesttrigger for order request on demand or provisioning scheduleprsn psn g p dpsn g p d produce physical key material deliver physical key materialmove to production move to distributiongenerate needed key material prepare working aiddetermine koas from adp if electronic if physical 2343 figure 32 u generation and production 2344 6543 u kmi roles involved 2345 u none 2346 6544 u kmi nodes involved 2347 u psn 2348 u prsn 2349 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 101 unclassifiedfor official use only 6545 u prerequisites 2350 u requested product has been approved by the pr sn 2351 u standing order has been established 2352 u wrapping credentials have been uploaded to the prsn 2353 6546 u sequence of events 2354 1 u trigger for an order request on demand or provisioning schedule occurs 2355 at the prsn 2356 2 u the prsn checks the products account distri bution profile to determine 2357 which koas should receive the product 2358 3 u the prsn evaluates the product order select s the appropriate wrapping 2359 credentials based on the device distribution prof iles and composes 2360 production request 2361 4 u the prsn forwards the production request in cluding the wrapping 2362 credentials to the psn 2363 5 u the psn generates and produces the needed ma terial to fill the production 2364 request 2365 2366 if electronic key 2367 1 u the electronic key is wrapped by the psn acc ording to the production 2368 request 2369 2 u the wrapped electronic key is returned to th prsn from the psn if there 2370 are multiple recipients of the key separate indiv iduallywrapped key copies will 2371 be returned 2372 3 u the wrapped keys is stored in the pde for retrieval by an appropriate 2373 entitys eg koa manager koa agent kmi device 2374 2375 if physical key 2376 1 u the physical key is moved to production usin g working aid 2377 2 u the physical key is transferred to the appro priate format eg floppy cd 2378 rom etc 2379 3 u the physical key is moved to distribution fo r physical delivery 2380 2381 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 102 unclassifiedfor official use only 655 u electronic product retrieval 2381 6551 u summary 2382 u this scenario describes the processes used by cus and kmi clients to retrieve key 2383 products for use the scenario will present options for key retrieval options for 2384 1 networked kmiaware ecus 2 nonnetworked kmi aware ecus and 3 akps 2385 6552 u sequence diagram 2386 ecu fill devicekoa manager koa agent also login to prsn send list of available productsidentify koa request product list select products request download send requested productload fill device media with selected products fill ecu with selected productprsn prepare products for ecu fill akp unwraps repackages for ecu if requiredkoa agent doc mgc fill ecu over network through fill device or nkm with selected products login to prsn send list of available productsidentify koa request product list select products request download send requested productdistribute product to ecuinitiate connection to prsn product pickup request verify product pickup request syntaxauthenticate ecu identityif networked ecu if non networked kmi aware device if wrapped for akplogin to doc login to mgc 2387 figure 33 u electronic product retrieval 2388 6553 u kmi roles involved 2389 u koa agent 2390 6554 u kmi nodes involved 2391 u ecu 2392 u fill device 2393 u manager client mgc 2394 u deliveryonly client doc 2395 u prsn 2396 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 103 unclassifiedfor official use only 6555 u prerequisites 2397 u koa manager must be registered or koa manager m ust have designated 2398 koa agent 2399 u one or more key products have been requested an d directed to the koa by 2400 appropriately privileged kmi managers 2401 u ecu is associated with koa 2402 u key product for ecu must have been generated an d made available at the 2403 prsn for retrieval 2404 6556 u sequence of events 2405 2406 by ecu directly 2407 1 u the ecu initiates connection to the prsn 2408 2 u the prsn verifies that the product pickup re quest syntax is correct 2409 3 u the prsn authenticates the identity of the cu 2410 4 u the prsn delivers all products authorized an d available for the requesting 2411 ecu 2412 2413 by koa agent for relay to ecu 2414 1 u the koa agent logs into the doc 2415 2 u the koa agent logs into the prsn 2416 3 u the koa agent identifies the koa for which t hey wish to retrieve key the 2417 koa agent requests the product list for the identif ied koa from the prsn 2418 4 u the prsn sends the list of available product s to the mgc 2419 5 u the koa agent selects the products they wi sh to download and the request 2420 is sent to the prsn 2421 6 u the prsn sends the requested products to t he mgc 2422 7 u if ecu loading is performed later the koa m anager logs into the mgc 2423 8 u the product is prepared for the ecu it is stined for note this does not 2424 include any unwrapping or rewrapping of the product 2425 9 u the mgc loads the product into fill device or other portable media 2426 10 u the fd or portable media loads the key into the ecu 2427 2428 by koa manager for further processing distributio n 2429 1 u the koa manager logs into the mgc 2430 2 u the koa manager logs into the prsn 2431 3 u the koa manager identifies the koa for which they wish to retrieve key 2432 the koa manager requests the product list for the i dentified koa from the 2433 prsn 2434 4 u the prsn sends the list of available product s to the mgc 2435 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 104 unclassifiedfor official use only 5 u the koa manager selects the products they wish to download and the 2436 request is sent to the prsn 2437 6 u the prsn sends the requested products to t he mgc 2438 7 u if ecu loading is performed later the koa m anager logs into the mgc 2439 8 u the mgcs akp unwraps the package and repac kages it for the destined 2440 ecu if required 2441 9 u the mgc fills the ecu with the selected prod uct over the network through 2442 fill device or via the net key management 2443 2444 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 105 unclassifiedfor official use only 656 u physical product distribution 2444 6561 u summary 2445 u this scenario shows the process for the deliver of finished kmi products from the 2446 production segment storing them and preparing shi pment of orders aggregating 2447 products which are packaged and transferred to c arrier or courier and accounting 2448 actions that take place internally and externally t kmi 2449 6562 u sequence diagram 2450 2451 psn dcs fedex usps d p g physical distribution via fedex uspsphysical distribution via dcskmi product received and storedkoa transfer report initiating physical key product physical key productcor dcs receipt accounting receipt for productprsn dcs tracking data aggregated transfer report initiatingdcs tracking numbersif distributed by dcs if distributed by fedexuspsaccounting receipt for productaccounting receipt for product 2452 figure 34 u physical product distribution 2453 6563 u kmi roles involved 2454 u prsn 2455 u recipient koa 2456 u cor 2457 6564 u kmi nodes involved 2458 u prsn 2459 u psn 2460 u koa 2461 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 106 unclassifiedfor official use only 6565 u prerequisites 2462 u kmi products have been received from the produc tion segment of the psn 2463 u products have been authorized for shipment 2464 6566 u sequence of events 2465 2466 1 u the psn distribution enclave physically rece ives products from the 2467 production enclave of the psn 2468 2 u the psn distribution enclave stores these pr oducts until they are ready for 2469 shipment 2470 2471 if distribution by dcs 2472 1 u the psn sends transfer report initiating to the recipient koa and the 2473 koas cor 2474 2 u the psn distribution enclave ships product v ia dcs defense courier 2475 service 2476 3 u the psn sends dcs tracking numbers to the pr sn 2477 4 u the physical key product is delivered to the recipient koa via dcs 2478 5 u dcs receives delivery confirmation from th recipient koa 2479 6 u the recipient koa sends an accounting receip t back to the psn and to the 2480 cor 2481 7 u the prsn collects tracking data aggregate from dcs 2482 note this step does not happen in sync with the r eal time distribution of physical 2483 products via dcs 2484 2485 if distribution by fedex usps 2486 1 u the psn sends transfer report initiating to the recipient koa and the 2487 cor 2488 2 u the psn distribution enclave ships product v ia fedex usps 2489 3 u the physical key product is delivered to the recipient koa via fedex 2490 usps 2491 4 u the recipient koa sends an accounting receip t back to the psn and to the 2492 cor 2493 7 u summary of impacts 2494 71 u ci2 and legacy key management systems 2495 ufouo one of the goals of capability increment 2 of the kmi is to move the 2496 infrastructure closer to the kmi target architectur it should be kept firmly in mind 2497 however that ci2 is just that an increment after decades of development and 2498 operation of the current set of legacy components policies and procedures it is neither 2499 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 107 unclassifiedfor official use only possible nor desirable to replace everything that h as been deployed with something new 2500 in one step 2501 ufouo ci2 has to find balance between implem enting features of the target kmi 2502 such as providing webbased capabilities and imple menting logical split between 2503 customer interfaces and the key generation componen ts providing backward 2504 compatibility with existing components such as the ability to use lmdkps to receive 2505 encrypted keys and order material so as not to hav to transition away from those 2506 components immediately and enhancing ease of use such as minimizing duplication of 2507 data entry 2508 ufouo major difference between the concepts f the target and the concepts in 2509 use today is that the target is largely human user oriented while the current key 2510 management system is kmeoriented the ekms id of the group of users and 2511 components at any particular location is the identi ty used as the basis for decisions in the 2512 current system whereas the target architecture foc uses on individual identity as the basis 2513 for privileging and decisionmaking one of the li nes that had to be drawn for ci2 is 2514 how much of each type of focus would be maintained the result is concept of tying 2515 roles and privileges to human user identities but then additionally linking the human 2516 users to the collection of users and components tha t share an ekms id bridging the two 2517 paradigms in this interim stage 2518 ufouo the following subsections highlight some of the impacts that balancing the 2519 various goals will have operationally and organiza tionally two of the more complex 2520 areas of the ci2 system and impacts are those of ccess controlprivilege management 2521 and accounting and those issues will be addressed as well 2522 72 u operational impacts 2523 ufouo one of the critical pieces of maintaining continuity with the various new and 2524 legacy infrastructure components and subsystems wil l be the use of the ekms id 2525 though in ci2 as today having an ekms id does n ot imply use of ekms 2526 components use of these ids has variety of imp lications especially when coupled 2527 with the need for backward compatibility for inst ance in ekms there is onetoone 2528 relationship between kp comsec account and an ekms id kp cannot 2529 support more than one comsec accountid and more t han one kp cannot support 2530 single comsec accountid this paradigm implies th at there must be one akp per 2531 koacomsec account that is somehow identified as th primary akp the peer to the 2532 kpprimary akp at other accounts 2533 ufouo ci2 will provide transition path for perational key management support 2534 to move from ekms lmdkps to kmi client nodes whi the goal is to minimize need 2535 for parallel ekms and kmi workstations for userlev operations it may prove 2536 necessary to have multiple workstations at certain locations eg registration 2537 authority at the ekms tier 1 system might need both tier 1 and kmi workstations in 2538 order to perform all of their registration duties 2539 ufouo transition both at the longterm system level moving from cmcsekms 2540 to the kmi target architecture and at the user lev moving from legacy automation or 2541 automation at all to ci2 clients is at the he art of many of the biggest challenges of 2542 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 108 unclassifiedfor official use only ci2 additional information on specific transitio n issues is included in the remaining 2543 subsections 2544 73 u kmi ci2 transition philosophy 2545 ufouo the initial focus of ci2 transition woul d be to migrate key ordering and 2546 management functions to operate via the prsn so t he approach taken when ci2 2547 capabilities initially become available would be to 2548 u encourage rapid transition to kmi for those j ob functions and personnel 2549 whose mission can be conducted using client node without an akp 2550 ufouo begin transition of paperbased6 and lmdonly comsec accounts 2551 to kmi client nodes 2552 ufouo continue using the ekms lmdkp at comsec accounts where it 2553 is operating effectively this may be the phase 4 l mdkp or an updated version 2554 depending on ekms development activities between w and ci2 ioc 2555 ufouo continue ekms tier 1 operations 2556 ufouo once the transition of ordering and manag ement functions is accomplished 2557 then the focus of transition activities will shift to comsec accounts activities at this 2558 point would be 2559 ufouo continue efforts to transition paperbase d and lmdonly comsec 2560 accounts to kmi client nodes 2561 ufouo begin transitioning comsec accounts away from lmdkps to the 2562 use of kmi client nodes 2563 u over time more and more comsec account activit will be moved to koa 2564 operating with kmi client nodes however there wi ll likely be considerable period of 2565 time where mixture of ekms and kmi equipment and processes are used to perform 2566 the overall key management mission 2567 74 u kmi ci2 transition implementation 2568 u specific actions to implement the transition ph ilosophy described above include 2569 ufouo at ci2 ioc enroll controlling authoriti handling traditional key 2570 as kmi controlling authorities and equip them with kmi manager clients 2571 ufouo at ci2 ioc enroll command authorities f or firefly key as kmi 2572 command authorities and equip them with kmi manager clients 2573 ufouo at ci2 ioc enroll user representatives for firefly key as 2574 product requestors and equip them with kmi manager clients unless the user 2575 rep is using an lmd or lmdkp for ordering 2576 6 paperbased refers to any comsec account not usi ng ekms technology for its operation it is inclusive of accounts operating with nonekms autom ation packages developed over time by number of customer organizations kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 109 unclassifiedfor official use only ufouo to support this approach the following i nformation needs to be installed in 2577 the prsn at ioc 2578 ufouo product ordering catalog containing all physical and electronic 2579 products currently being produced by tier 0 centr facility finksburg and fort 2580 meade as well all electronic products being produc ed by the ekms tier 1 2581 system 2582 ufouo privileging information for controlling uthorities command 2583 authorities and user representatives as described in section 76 2584 741 u ekms tier 1 system 2585 u under ci2 ekms tier 1 operations and personne l should be to continue operating 2586 as they have prior to ci2 except that 2587 ufouo ekms registration authorities are the log ical candidates to perform 2588 koa registration manager functions for koas conse quently personnel 2589 serving as ekms registration authorities will have to be enrolled as koa 2590 registration managers and will need kmi client in addition to their ekms 2591 tools 2592 ufouo tier 1 should be configured to accept ord ers submitted via the prsn 2593 in electronic form such orders will originate fro m the ekms translator and 2594 should be easily distinguished from orders originat ing at ekms lmd or 2595 lmdkp workstations 2596 742 u comsec account transition options 2597 u there are number of options that may be consi dered for the transition of an existing 2598 comsec account to operations under ci2 the paren t organization responsible for 2599 each account will need to define their overall appr oach to operating with kmi and then 2600 make an corresponding determination of the appropri ate transition approach for each of 2601 their comsec accounts 2602 ufouo lmdkpequipped accounts potentially have several transition paths 2603 depending on the operational requirements and commu nications situation of the 2604 account 2605 ufouo convert from the lmdkp to an akpequippe d kmi client node 2606 this replaces the lmdkp with functionally analog ous kmi element and 2607 account operations should be able to continue in similar manner to operating 2608 under ekms 2609 ufouo convert from the lmdkp to kmi client n ode depending on 2610 the needs of the account this client could be empl oyed in one of two ways 2611 x1x2ufouo the koa could receive its cryptographic s upport directly 2612 from the kmi prsn using the kmi client node to dow nload 2613 blackbenign key wrapped for the accounts ecus 2614 ufouo the technical details of supporting each of the transition paths from 2615 lmdkp or paper operations to an appropriately conf igured kmi client node will be 2616 determined as part of the kmi client development ac tivities 2617 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 110 unclassifiedfor official use only 75 u organizational impacts 2618 ufouo customer agencies will need to develop cr iteria for the appropriate koa 2619 kmi client node configurations for current comsece kms accounts and other kmes 2620 things to be considered include the capabilities pr ovided by each clienttype and 2621 application the roles and privileges to be held by the human users of the client nodes the 2622 communications environment and the local organizat ional structure some kmes that 2623 are currently supported by lmdkps eg smaller c omsec accounts might be able to 2624 move to lighterweight client node without crypto graphic support while some kmes 2625 that currently dont have any automated components eg many controlling authorities 2626 will benefit from the use of ci2 client node 2627 ufouo it should be noted again that despite the use of new terminology which is 2628 meant to bring together the various key management stovepipes that exist today ci2 is 2629 not expected to increase the workload of the custom er or impose new staffing 2630 requirements on the customer goal of ci2 is to provide the customer with the tools 2631 needed to carry out the necessary functions in the way best suited to the individual 2632 customer therefore there should not be significa nt organizational impact caused by the 2633 development and deployment of ci2 2634 76 u transition of privileges from ekms to kmi 2635 761 ufouo firefly management and privileging 2636 ufouo one component of the infrastructure which is not currently slated for major 2637 retooling in the ci2 timeframe is the central faci lity finksburg cff firefly 2638 management and generation system retention of tha t component more or less asis has 2639 implications for the whole life cycle of modern asy mmetric key from creation of new 2640 dao and partition codes to the privileging of user representatives to the ordering of the 2641 material the existing command authority and user representative structure and 2642 ordering capabilities will be left intact which ets the goal of backward compatibility 2643 but does not move toward the target or provide new features 2644 ufouo therefore new interface to the existing capability needs to be implemented 2645 in ci2 command authorities will be able to carry out their modern key management 2646 tasks either through existing means or via ci2 m anager client when using ci2 2647 manager client the command authorities must additi onally hold the relevant command 2648 authority role and approvals so that the ci2 prsn can perform the necessary kmi 2649 validations translation of the kmistyle requests into cffstyle requests is then the task 2650 of the prsn andor ekms translator likewise user reps will be able to order modern 2651 key via the existing mechanisms or via ci2 manag er client 2652 ufouo to minimize duplication of effort in gran ting the appropriate privileges to 2653 command authorities and user reps ci2 will have t have the capability to share data 2654 between the prsn and the cff backend system on priv ileges for instance when an 2655 existing command authority with an ekms id becomes ci2 human user that 2656 command authority will need to be enrolled through the appropriate kmi process as 2657 command authority but the association of that huma n user with hisher ekms id will 2658 enable the prsn to translate and associate all the existing privileges at the cff to that 2659 human user as command authority privileges main tained via the existing methods 2660 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 111 unclassifiedfor official use only will flow through the cff to the prsn and privileg maintained via the new ci2 2661 mechanisms will similarly reside in both places 2662 ufouo this approach requires small amount of additional work to transition 2663 existing command authorities and user reps to comma nd authorities and product 2664 requestors respectively for those who choose to m ake use of the new ci2 clients but 2665 the maintenance of those users privileges should b able to be done via either the old or 2666 new mechanisms with the duplication of the privileg ing data handled by the cff and the 2667 prsn rather than by those establishing the privileg additionally this approach has 2668 the advantage of meeting both legacy and target req uirements and will make it easier to 2669 transition completely away from the existing mechan isms for privilege establishment and 2670 enforcement in the future 2671 762 u traditional key management and privilegin g 2672 ufouo privileging for the management and orderi ng of traditional symmetric key 2673 should in many cases be less complex than that for asymmetric key management because 2674 more of the existing legacy systems will be rebuilt also in many cases those doing 2675 management of traditional material today are not hi ghly automated and not dependent on 2676 electronic privilege enforcement mechanisms howev er ci2 can be expected to make 2677 transitioning those symmetric key privileges that xist electronically in ekms today as 2678 seamless as possible 2679 763 ufouo comsec account privileges 2680 ufouo in the ekms phase 4 timeframe kmes are g iven ekms ids to represent 2681 them in any key management role they might play ne of the roles that can be given to 2682 kme is that of comsec account the ekms director is the mechanism by which 2683 the details of kmes comsec account privileges ar shared with those other kmes 2684 that need to make use of that information for privi lege enforcement decisions such as 2685 whether certain key can be shipped to that kme 2686 ufouo the concept of the comsec account is not one that will disappear in the 2687 ci2 era kmes that need to be comsec accounts wil l still be assigned ekms ids 2688 have comsec account privilege information associate d with them and be placed in the 2689 ekms directory additionally data on those comsec accountprivileged kmes will 2690 be kept synchronized with the ci2 prsn for use in new kmi functions the 2691 assumption behind this approach is that the ekms re gistration authority and central 2692 office of record functions that have been built int tier 0 and tier 1 will not be able to 2693 be retooled to perform these registration functions new way in the ci2 timeframe 2694 however the intention is not to constrain the serv ices and agencies from using kmi 2695 tools to accomplish registration functions should i t be desirable to make the necessary 2696 changes to the existing systems to support the new functionality 2697 77 u accounting 2698 ufouo the area of accounting is one where what is defined in the target 2699 architecture referred to as control and what ex ists today referred to for convenience 2700 in this section as traditional accounting are co nsiderably different in terms of 2701 implementation if not intent 2702 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 112 unclassifiedfor official use only ufouo the new tracking concepts apply to new p ure ci2 functions there is 2703 already system in place today for handling tradit ional accounting with the central 2704 offices of record at tiers 0 and 1 and accounting t ransactions implemented both 2705 physically and electronically where the new kmi f unctions and the legacy functions 2706 come together for instance when sending key from an lmdkp to an akpequipped 2707 kmi client node or using client to manage physic comsec assets the accounting 2708 questions become much more complicated 2709 ufouo the legacy accounting systems are some of the most complex pieces of the 2710 entire key management infrastructure and to comple tely replace them with new 2711 functionality is simply not possible in the ci2 meframe therefore the balancing of 2712 the various system goals in this area has led to an approach which reuses ekms 2713 accounting transaction body definitions as well as the existing cor implementations at 2714 tiers 0 and 1 for the traditional accounting of mat erial which requires accounting back to 2715 cor physical or electronic key and equipment in accordance with the relevant 2716 policies while adding targettype tracking for ne w kmi transactions to include key 2717 encrypted for kmiaware ecus 2718 ufouo one of the client applications that can b run locally on client node will 2719 support traditional accounting functionality for those clients that need it clients that 2720 need to exchange traditional accounting data with their cor will be able to pass 2721 ekms transaction bodies through the prsn and the ek ms translator to their cor and 2722 back 2723 ufouo implementation of accounting and tracking as defined for ci2 will involve 2724 modification to variety of existing policies and procedures the definition of concepts 2725 in ci2 assumes certain outcomes to these policy qu estions encrypted key is 2726 unclassifiedfor official use only ie longe r unclassified crypto key encrypted 2727 for an ecu is not traditionally accountable etc significant work to make these policy 2728 changes happen is necessary at all levels 2729 8 u analysis of the proposed system 2730 u this section provides brief analysis of the p roposed ci2 with respect to existing 2731 key management systems and operations 2732 81 u summary of improvements 2733 u ability to conduct key management operations us ing common user tcpip 2734 backbones 2735 u improved support for controlling authority key ordering and management 2736 functions over that available through ekms 2737 ufouo replacement of complex and difficulty to support lmd workstation 2738 with webbased user interface on commonly used hard ware platforms 2739 u easier to maintain update and improve user int erface 2740 u eliminates need to support unique operating j ust for the lmd 2741 u support for overthenetwork keying to nextgen eration ecus that support 2742 that feature 2743 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 113 unclassifiedfor official use only u support for integrating kmi client features int customerdevelopedoperated 2744 mpmss to simplify providing key distribution suppor t to complex systems 2745 u architecture designed to simplify providing int eroperable key management 2746 support for cceb nato and other allied coalitio n partners 2747 u next generation akp to build on concepts and ca pabilities of existing ekms 2748 kp while addressing some of its shortcomings 2749 82 u disadvantages and limitations 2750 u some dedicated workstations still required 2751 u certain sensitive functions must be kept secure 2752 u must maintain separation of material at differe nt classifications 2753 mls 2754 u will require purchase configuration support f highassurance ines 2755 and cooperation with managers of customerprovided networks to develop 2756 acceptable operating configurations 2757 u dependent on availability of communications net works not under kmi 2758 control 2759 u uncertain impact on communications network band width goal is to 2760 minimize impact but lacking good models of network loading and given potential 2761 for shifts in how comsec operations are conducted w ith new technology it is 2762 very difficult to predict the actual impact 2763 u need separate token and registration enrollme nt processes for kmi 2764 managers responsible for cryptographic activities 2765 ufouo kmi client nodes used at koas will in ge neral continue to operate 2766 at the secret level systemhigh 2767 ufouo last mile solutions for ci2 are based on existing fill devices ie 2768 kov21 family ancyz10 2769 2770 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 114 unclassifiedfor official use only u glossary 2770 access the ability and the means to communicate with or otherwise interact with systems resources in order to either 1 handle da ta held by the system or 2 control system components and their functions access control service that protects against unauthorized acces s to system resources including protecting against use of re source in an unauthorized manner by user that is authorized to use the resource in some other manner account distribution profile structured formatted information regarding whic h kmi accounts are authorized to receive specific pro ducts account distribution profiles are maintain at the prsn on the basis of rders provided by controlling authorities and product requestors accounting also called product accounting or comsec accounti ng the process of collecting recording and managing information that describes the status and custody of designated key management products durin g each products lifecycle kmi definition advanced key processor akp cryptographic device for use with kmi clients capable of performing key management functions such as key generation key distribution and key redistribution authorization right or permission that is granted to user or other system entity to access system resource for specific purpose basic user role that enables registered user to receive and consume certain kmi products and services in addition to those gran ted to public users and including those services necessary to maintain the products r eceived client node device that is capable of interacting with km i primary services node via computer network to obtain needed kmi pr oducts and services or to perform kmi operational or administrative managemen t functions component collection of system resources that form physi cal or logical part of the kmi system that 1 has specified functions and interfaces and 2 is treated by policies or requirement statements as existing ind ependently of the other parts comsec incident analysis report report generated by the prsn on the basis of request from controlling authority that indicates which products within the controlling authoritys purview have been encrypted for specific ecu or set of ecus in addition the report will describe which products are known to have been delivered to specific ecu via direct interactions with the prsn the comsec incident analysis report will also provide any addi tional tracking and auditing information that may assist in assessing the damage associated with loss of control of the ecu the comsec incident analysis report assis ts the controlling authority in determining which products eg short title an d editions may have been compromised when an ecu is the subject of comsec incident kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 115 unclassifiedfor official use only common account data information stored in the ekms directory about key management entity common account data includes km especific information such as identification number attributes eg ad ministrative data role restrictions etc and equipment configurations this informati on is initially identified during the account registration process and maintained by the kme and its ekms ra as appropriate credentials information supplied by key recipient eg an ecu that permits sender eg the kmi prsn to authenticate the rec ipient and encrypt key uniquely for that recipient domain set of kmi users for which defined set of acc ess control attributes may be added modified and withdrawn by specific rela ted named set of kmi managers kmi user may belong to several domains associate d with access control attributes conferred by several different kmi managers end cryptographic unit ecu device normally component of larger system that provides security services to the larger syste m and from the viewpoint of supporting security infrastructure is the lowest i dentifiable component with which management transaction can be conducted enrollment the kmi process that assigns kmi user identity t kmi manager role event an occurrence within the kmi that causes an event record to be generated event records are generated automatically during ro utine operations of all types by kmi components when necessary an event can be re corded through the manual entry of information such as accounting events for physical items proposed update to kmi glossary definition from tca study event record set of data corresponding to traceable or acc ountable occurrence that is retained within the kmi group identity an user identity that is registered for user t for which the kmi does not maintain record of the members of the t ie the kmi does not have knowledge of the user persons or user devices tha t belong to the set information integrity the property that ensures that information has t been changed destroyed or lost in an unauthorized or ccidental manner this property is concerned with the constancy of data values ie information content that is encoded in data and not with how accurately the informatio n was recorded or how trustworthy the information source was key loading and initialization facility klif facility designed to support registration of user devices with kmi and orders r eceives loads any kmi products needed to initialize those devices kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 116 unclassifiedfor official use only key management infrastructure kmi all partscomputer hardware firmware software and other equipment and its documentation facilities that house the equipment and related functions and companion stan dards policies procedures and doctrinethat form the system that manages and sup ports the ordering and delivery of cryptographic material and related information p roducts and services to users key recovery an intentional alternate ie secondary proces s for learning the value of cryptographic key that was previously us ed to perform cryptographic operation specifically production of copy of n escrowed key and delivery of that key to an authorized requestor kmi aware an application or device that contains the necess ary protocols and supports kmi interface specifications kmi management role role that has privileges that are greater than the privileges of basic user and that enable user t direct control or regulate some set of kmi system resources kmi manager user that directs controls or regulates some s et of kmi system resources kmi operating account koa kmi operating account is the registered k user associated with an organizational unit koa has associated ecus and kmi managers is the kmi corollary to comsec account and provides mechanism for bridging between the ekms and kmi implementatio ns of registration and privileging kmi token users individual cryptographic device that carr ies the users pki private keys and associated publickey certificates algorithms and related material kmi protected channel kpc kmi communication channel that provides information integrity service either information rigin authentication service or peer entity authentication service as is appropriate to the mode of communication and optionally information confidentiality service kmi role user job title within the kmi system that 1 in corporates specific set of capabilities 2 can be assigned privileges an d 3 can be assigned to users device distribution profile structured formatted information regarding which ecus fill devices fill groups andor the akps wi thin an account that are authorized to receive specific products device distribution profiles are generated by koa manager for the products their account receives an d are maintained at the prsns operational compromise notification message email message released by controlling authority in response to compromise t hat describes how kmi account managers should respond to compromise of particul ar kmi product operational recovery product service request product service request released by controlling authority that requests product neces sary to recover from compromise kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 117 unclassifiedfor official use only privilege an positivelystated authorization ie permi ssion that 1 can be assigned to role and 2 enables user acting in that role to handle one or more specific kmi system resources usually in the form of products services and operational and administrative functions and mechan isms product catalog the product catalog will include all currently av ailable kmi products the kmi shall provide via common user interface kmi user tailored version of that catalog that gives descriptive info rmation on cryptographic products the user is authorized to order and receive product ordering the process by which kmi users request products services and related information resources from the kmi registered user user that accesses the kmi by invoking an ident ity that has been registered in the system sponsor user identity of user person who 1 requests that new user identity be registered for user device or user set and 2 officially represents the government organization that is accountable for use of the new identity subscription standing cryptographic product order and accoun t distribution list established and maintained in the kmi by the produc t requestor subscription prompts the kmi to periodically generate wrap and post key for delivery system integrity security service that protects system component s in verifiable manner against unauthorized change throughout their lifetime template compromise notification message email message composed in advance of compromise that describes how kmi account mana gers should respond to compromise of particular kmi product the templa compromise notification message is generally modified by controlling auth ority prior to release as an operational compromise notification message template recovery product service request product service request composed in advance of compromise that requests product neces sary to recover from compromise the template compromise recovery produ ct service request is generally modified by controlling authority prior to release as an operational compromise recovery product service request tracking the kmi function that provides current status s tate information about products and requests across the system to kmi user s and events leading to their current state based on the users role and privile ges proposed update to kmi glossary definition from tca study transaction the sequence of events that transpires from the t ime cryptographic materials are ordered until they are delivered to t he end user or ecu proposed new definition from tca study user kmi system entity that accesses kmi products an d services user set set that consists either 1 entirely of human users or 2 entirely of device users kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 118 unclassifiedfor official use only unregistered user user that accesses the kmi without invoking re gistered identity user authentication security service that verifies user identity that is claimed by or for system entity that attempts to access t he kmi user device an automated client processa specific hardware unit with specific software running on itthat is registered to act as kmi user user identity registration state user identity is in the active state if the identity is currently authorized to be used to access the kmi otherwise the identity is in the inactive state user identity the collective aspect of set of attribute value s ie characteristics by which an identity ie specific individualit of kmi user is recognized or known by the kmi and which is sufficient to disting uish that identity 1 from all other identities of that same user and also 2 fro m all identities of all other registered users user number kmiunique value that kmi assigns to user and that is used in kmis internal database as an index label or shor t name for associating data elements pertaining to that user user registration data the set of attribute values acquired by and stor ed and maintained in the kmi to establish and describe user 2771 u acronyms 2772 2773 adp account distribution profile akp advanced key processor bet bulk encrypted transactions c2 command and control cdd capability development document cff central facility finksburg alc accounting legend code ci capability increment cmcs comsec material control system cmi cryptographic modernization initiative coi community of interest comsec communications security conauth controlling authority conop concept of operations kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 119 unclassifiedfor official use only cor central office of records cots commercial offtheshelf csn central services node dao departmentagencyorganization ddp device distribution profile dmd data management device dn distinguished name dod department of defense ecu end cryptographic unit fnbdt future narrowband digital terminal ekms electronic key management system faq frequently asked questions fd fill device fouo for official use only gd general device gig global information grid gps global positioning system haipe high assurance internet protocol encryptor hmi human machine interface ia integrity and authentication id identifier ine inline network encryptor ioc initial operating capability kek key encryption key klif key loading and initialization facility kme key management entity kmi key management infrastructure koa kmi operating account kp key processor kpc kmi protected channel ld limited device local element lmd local management device lt1ra local type 1registration authority kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 120 unclassifiedfor official use only mpmss mission planningmanagementsupport systems nfp networkfill port niprnet nonclassified internet protocol routing ne twork nsa national security agency nstissi national security telecommunications and informatio n systems security instruction ome ordering and management enclave otnk over the network keying pc personal computer pde product delivery enclave pki public key infrastructure pin personal identification number poc product ordering catalog pstn public switched telephone network prsn primary services node psn product source node ra registration authority rfp redfill port robac rolebased access control rubac rulebased access control saasm selective availability antispoof module sdrs system description and requirements specificat ion sds secure dtd2000 system siprnet secret internet protocol routing network skl simple key loader tcpip transmission control protocol internet pro tocol tls transport layer security u unclassified uas user application software vpn virtual private network wan widearea network wfp wrappedfill port iad information assurance directorate 2774 2775 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 121 unclassifiedfor official use only appendix ekms transactions 2775 u list of supported ekms transaction includes but is not limited to 2776 u accounting transactions 2777 ufouo conversion report used for communicatio ns between cor and 2778 client node 2779 ufouo destruction report used by client node to notify cor of 2780 destruction of product 2781 ufouo generation report used by client node when centrally 2782 accountable material is generated report is sent to the cor 2783 ufouo inventory report used for communication s between cor and 2784 client node 2785 ufouo key conversion notice from tier 10 to notify client node that 2786 seed firefly key has been converted to operational key 2787 ufouo possession report used client node to n otify cor of 2788 possession 2789 ufouo cancel distrtrans used to cancel tran saction can be sent 2790 from client node to cor or between client node and lmd 2791 ufouo relief accountability report used by cor to notify client 2792 node of its relief from accountability for an item 2793 ufouo tracer notice used when the cor does n ot receive receipt of 2794 product can be sent from cor to client node or b etween client node and 2795 lmd 2796 ufouo transfer report initiating sent from client node to the element 2797 receiving the key and its cor for centrallyaccoun table material giving the 2798 details of the shipment 2799 ufouo transfer report receipt all sent from client node to the cor 2800 or between client nodes and lmd to notify receipt f product 2801 ufouo transfer report receipt exception sent from client node to 2802 the cor or between client nodes and lmd to notify r eceipt of product 2803 ufouo transfer report receipt individual sent from client node to 2804 the cor or between client nodes and lmd to notify r eceipt of product 2805 ufouo inventory reconciliation status list of unreconciled items 2806 sent from the client node to the cor 2807 ufouo request inventory sent by cor to an ccount or parent 2808 account to subaccount requesting an inventory re port 2809 ufouo issue report initiating sent from par ent account to an 2810 automated subaccount when issuing material 2811 ufouo issue report receipt all sent from an utomated subaccount to 2812 parent account to receipt for issued key 2813 ufouo issue report receipt exception sent fro m an automated 2814 subaccount to parent account to receipt for issue d key 2815 kmi 2212 unclassifiedfor official use only 30 sept 2005 concept of operations for kmi ci2 version 14 122 unclassifiedfor official use only u distribution transactions 2816 ufouo bulk encrypted transbody used to send m ultiple encrypted 2817 keys 2818 ufouo key distribution used to send single encrypted key 2819 u nonstandard messages 2820 ufouo freeform text free form text between ek ms element and 2821 client node usually in the form of an email 2822 ufouo response trans the translator must supp ort this transaction for 2823 communication between ekms elements and kmi client nodes 2824 2825 u detailed information on ekms transactions can b found in the volume 1 of the 2826 ci2 sdrs 2827 2828