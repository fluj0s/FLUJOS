this briefing is classified top secretcomintrel usa fvey analytic challenges from activepassive integration s324 this briefing is classified top secretcomintrel usafvey derived from nsacss manual 152 dated 20070108 declassify on 20320108 derived from nsacssm 152 dated 20070108 declassify on 20320108 frel lif61iation technology _ directorate itd define shaping working definition active implant copies traffic and directs copy past passive collector issues arise when collector is also processing passive traffic simultaneously current implants on network infrastructure devices not user endpoints two types physicallink layer an implant copies and shapes an entire link stm1 without selection passive midpoint does selection network layer an implant performs targeted copying based on ip or application parameters and exfils only the targeted traffic passive collector may or may not do further selection top secretcomintrel usa fvey frel lif61iation technology link layer bravenickel project optical muxes copied link is not disguised just routed on an unused layer 2 path that passive collector can monitor selection happens in the passive collector network layer apex for hammermill routers router is tasked to select and exfil targeted traffic perhaps all of particular protocol exfil is disguised munged encrypted to avoid detection passive collector looks for ip sourcedestination address in order to detect the traffic if further selectionprocessing is to be done in collector the exfil must be unwrapped unmunged decrypted exfil can be directed to passive or to tao by changing the destination address top secretcomintrel usa fvey wntrel fifffflsiation technology directorate itd tao implants have collection parameters that are put on exfil received thru tao backend case notation sigad pddg classificationlegal authority the passive collector has another set of these site has sigad collector has pddg the link it sees the traffic on has case notation and the access has classification floorlegal authority current backend repositories and presenters werent designed to expect two of these which gets put on the data and where and drum roil how do we solve this problem consistently across the enterprise top secretcomintrel usa fvey tops flfmintrel ation techn ipsec vpn first packets between the devices establish the parameters and encryption keys ike following this setup content packets are encrypted and transmitted packet by packet esp ces wants the ike exchange and maybe the esp content turmoil passive capability passive capability to detect ike and esp metadata record produced for every ike exchange ike for targeted vpn forwarded directly to ces database for targeted vpn realtime decryption is performed if ces can provide key in time decrypted ip traffic is processed by turmoil apps for normal selection voip webmail etc etc top secretcomintrel usa fvey mintrel lfrffôation technology tvrbvlesggwëpg turmoil intercepts link key exchange encrypted data ike full take metadata turmoil app metadata content to other repositories metadatal i extractor i ìsp decryp 14 turmoil apps app metad selected ita send ike ask for keys decrypted cchtent imi 4 nsa neu lu ca resources ii 11 i présswr wave full take ike metadata to toyg rippe toygrippe toygrippe top secretcomintrel usa fvey mintrel lfrffôation technology tvrbvlesggwëpg turmoil intercepts link key exchange encrypted data ike full take metadata turmoil app metadata content to other repositories metadatal i extractor i ìsp decryp 14 turmoil apps app metad selected ita send ike ask for keys decrypted cchtent imi 4 nsa neu lu ca resources ii 11 i présswr wave full take ike metadata to toyg rippe toygrippe toygrippe top secretcomintrel usa fvey top mintrel fiffsibi ation technology turbullfefsrai explrf hammerstein 1 key exchange encrypted data to other repositories top secretcomintrel usa fvey rel fitifflffiiation techn _ directorate sounds m now app streams voip webmail etc extracted from the tunnel carry two case notations which gets put into metadata records both can be carried to pwv but what happens after that not to mention metadata records about vpn being stored in toygrippe ces database storing ike exchange top secretcomintrel usa fvey current fields casenotation searchable field sourceld the sigad of the site that provided the data apex proposed extension add agent casenotation agent id uuid passive casenotation which casenotation goes into searchable field passive records wont have the apex block taocollected records returned via tao not passive wont have the apex block mintrel fifffflsiation technology ittnrthmiim ntmtmijf top secretcomintrel usa fvey mintrel ation technology hammerchant targeted voip content exfilled content w tao metadata and turmoil metadata apex packet bundler imi nia nsa net voip signaling voip content tao wrapped exfil of targeted voip fascia record ftesswr wave metrotube apex voip analytic top secretcomintrel usa fvey technology directorate itd shaping is hap operational or coming soon shaping hammerstone tcp traffic to fornsat soon sso turmoil involvement bravenickel one operational flow past sso site apex vpn metadata by end of june independent decisions being made about how to stuff the double metadata into legacy databases top secretcomintrel usa fvey wntrel fifffflsiation technology _ directorate itdj how do you want to identify the source of your data does casenotation still make sense in this new world you need to drive processes systems databases toward consistent answer transformed systems and tools metawave marina etc need to be designed to do more than accommodate do the right thing whatever you the analysts think that is let guess you want everything dont you top secretcomintrel usa fvey information technology directorate itd vwiw ffläwnufm rffcavw j information technology j directorate itd ji i 1 wm 14001 av