page 1 cofee version 1 1 runner and nw3c profiles validation study 9022009 written and tested by charles matt weir cissp sriharsha angara graduate research students florida state university page 2 ecrime investigative technologies laboratory background ecit the crime investigative technologies laboratory ecit is part of florida state universitys computer science department its focus is to conduct research in support of digital forensics investigations by developing new technologies and forensic tools to address real world problems related to electronic andor digital crime ecit often works closely with the florida department of law enforcement and with the national white colla r crime center what ecit does ecit collaborates closely with the florida department of law enforcement and the national white collar crime center and partners such as the accessdata corporation the goal is to build novel systems for crime investigatio ns the mechanism of developing projects is 1 brainstorming with law enforcement agents and others to determine law enforcement investigative needs 2 exploring novel technologies to be used in support of the resulting requirements and 3 developing prototype systems and tools that can be used in investigations this has resulted in the development of several computer forensics applications such as the dna project dedicated to the cryptanalysis of passwords the unmask project which addresses the issue of automated support for investigation of phishing attacks and the papa project which was designed to capture interactions with cyber stalkers and perform sting operations research by the ecit laboratory has been presented at numerous peer revie wed conferences such as the 2009 ieee security and privacy conference the 23rd computer security applications conference the 2009 dod cybercrime conference and more page 3 table of contents ecrime investigative technologies laboratory background 2 table of contents 3 introduction 4 purpose and scope 4 test result summary 4 test assertions 5 testing environmen t 5 test computer 5 support software used 6 additional i nformation 6 test results 7 test results report key 7 report not 40 additional references 40 glossary 40 page 4 introduction the purpose of this report is to document the validation of computer online forensic evidence extractors cofee generated thumb drives which were created using the two nw3c collection profiles nw3c volatile data and nw3c incident response tool tested computer online forensic evidence extractor version 11 run environments windows xp service pa ck 2 and windows xp service pack 3 supplier microsoft nw3c purpose and scope cofees primary purpose is to create thumb drive which contains pre determined set of applications which are set to run on suspects live machine upon connecting cofee generated thumb drive to suspects machine the investigator executes runnerexe program located on the thumb drive which in turn executes all of the programs specified by cofee and stores the data collected on the investigators thumb drive the programs placed on the generated thumb drives are identified by profile loaded into cofee while any user can create their own profile this validation study will focus only on the profiles created by nw3c nw3c volatile data and nw3c incident response this validation study was conducted to ensure that when runnerexe is executed all of the programs identified by the profile are executed that the collected data is stored on the investigators thumb drive that applications were run from the suspects machine and that unacceptable writes were made to the suspects machine cofee is currently only supported on the microsoft windows xp operating system other operating system was tested during this validation study test result sum mary overall result testing conducted on runner and the nw3c profiles verified that both the runnerexe application as well as the selected programs functioned as expected and are well within acceptable practices for data collection on live system nw3 c volatile data profile there were writes to the suspect drives file system using this profile there were updates made to the windows registry on the suspect s machine however none of the registry updates were of obvious forensic value for specifi c informatio n on what keys were written to see test results page 5 nw3c incident response profile this profile attempted to make five writes to the target computers file system three of the writes were caused by the program handleexe and were made to the file procexp100sys the reference to the file procexp100sys is hard coded into handleexe product of sysinternals and as such it is not possible to restrain handleexe from writing to this file however this file is specifically written as par t of the sysinternals toolset and is unlikely to be of any evidentiary interest the other two attempted writes were made to network shares on the target computer and were also unlikely to be of any evidentiary interest there were also updates made to t he windows registry on the suspects machine however none of the registry updates were of obvious forensic value for specific information on what keys were written to see test results test assertions the following assertions were based upon the liste d features of cofee as well as adherence to accepted forensic practices on live machine 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine testing environment test com puter 1 asus p5ld2 ecit 01 serial number 492000411072 b processor intel pentium d cpu 301 ghz 300ghz c ram 1 gb ram d hard drive 80gb 2 asus p5ld2 ecit 02 serial number 492000411074 b processor intel pentium d cpu 301 ghz 300ghz c ram 1 gb ram d hard drive 80gb 3 dell optiplex 745 ecit 03 serial number 492000408775 b processor inter core cpu 6400 213 ghz 213 ghz c ram 2 gb ram d hard drive 250 gb page 6 support software used 1 process monitor was used to record all processes and writes made during the testing of the generated thumb drives process monitor is free windows sysinternals tool written by mark russinovich and bryce cogswell this software was downloaded from httptechnetmicrosoftcomen ussysinternalsbb896645aspx additional info rmation the operating system was not listed in the descriptions above as they were unique part of testing while all the machines were running windows xp they were not all running on the same service pack the service pack used on any given test will be listed on the specific test page page 7 test results this section contains details on all tests conducted during the validation study test results report key test results report key test name 0001 date 23 july 2009 description to determine if xyz does abc tester name jwykes test machine dave1 assertions tested xyz does xyz does b xyz does c unique setup information non universal stuff new partition scheme etc could also include pre hash values etc results by assertion xyz does xyz does b xyz does c as expected as expected anomalies detected tester notes any additional information the tester wants to addprobably in paragraph form could include hash information overall success as expected or anomalies detected page 8 test results report key test name runnertest nw3c volatiledata format 0001 date 29 august 2009 descripti on running cofeee generated thumb drive with the nw3c volatile data profile sp2 tester name cweir sangara test machine ecit 02 assertion s tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup informati on the system was loaded with microsoft windows xp service pack 2 4gb thumbdrive with the nw3c volatile data profile loaded results by assertion 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any dire ct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected as expected anomaly detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 02 after the target system had finished bo oting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one process monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1617 est end time 1618 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assert ions listed above the results of the analysis are detailed below assertion 1 an examination of the thumb drives file system ind icated that all of the programs associated with the nw3c volatile data profile were successfully copied to the disk each program had been given unique four digit file name such as 2134exe each program was verified by either the internal file name or execution of it on the cofee gui page 9 machine which created the thumb drives ecit 03 an examination of the process moni tor logs indicates that all of the programs associated with the nw3c volatile data profile w ere successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assertion 3 an examination of the process monitor logs indicates that there were direct writes made to the suspect drive by runner or any of its processes to include all of the prog rams within the selected profile this test was done by filtering the process monitor log results to show only file system information excluding the drive which contained the cofee usb drive and searching for any writefile operation assertion 4 total of 117 writesupdatesdeletions were made to the registry by runner and its processes to include all the programs within the selected profile these results will also include attempts to change the registry that were not allowed ie an atte mpt was made to delete key that did not exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation there were 105 writes made to the registry key below the breakdown of the programs that updated this registry key are as follows runnerexe 8 ipconfig 8 net 8 pslist 2 quser 1 netstat 16 sclist 1 showgrps 1 systeminfo 8 cmd 52 hklmsoftware microsoftcryptography rngseed in addition to any writes listed above ipconfig made writes to the following 5 registry keys hklmsoftware microsoft esentprocess3116debugtrace level hklmsystemcurrentcontrolset services enventlog application esentev entmessagefile hklmsystemcurrentcontrolset services enventlog application esentca tegorymessagefile hklmsystemcurrentcontrolset services enventlog application esentca tegorycount hklmsystemcurrentcontrolset services enventlog application esentty pessupported one delete was attempted by ipconfig to the following registry key hklmsoftware microsoft esentprocess3116debugtrace level pslistexe attempted to delete the followin g 4 registry keys page 10 hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcon trolsetservices perfproc performance error count netstat attempted to make 2 writes to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs assertion 5 an examination of the process monitor gs ind icates that the programs run as part of the profile were run from the thumb drive and not from the suspect s hard drive this was done using the filters operation is loadimage and path ends with dll then exclude note dll files were loaded f rom the targets computer and used by runnerexe and programs invoked by runnerexe additional tester notes while there were several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were result of running these tools on live machine and could not be avoided while there were slight changes to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the verall rating for this test will be listed as expected overall success as expected page 11 test results report key test name runnertest nw3c incidentresponseformat 0002 date 31 august 2009 descriptio n running cofeee generated thumb drive with the nw3c incident response profile sp2 tester name cweir sangara test machine ecit 02 assertion s tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup informati on the system was loaded with microsoft windows xp service pack 2 4gb thumbdrive with the nw3c incident response profile loaded results by assertion 1 all programs identified in the profile were executed 2 results of the tools were prop erly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected anomaly detected anomaly detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 02 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one process monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1051 est end time 1053 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assertions listed above the results of the analysis are detailed below assertion 1 an examination of the thumb drives file system indicated that all of the programs associated with the nw3c incident response profile were successfully copied to the disk each program had been given unique four digit file name such as 2134exe each program was verified by either the internal file name or execution of it on the cofee gui machine which created the thumb drives ecit 03 page 12 an examination of the process monitor logs indicates that all of the programs associated with the nw3c incident response profile were successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assertion 3 an examination of the process monitor logs indicates that there were 5 atte mpted writes to the suspects machine this test was performed by filtering the process monitor log results to show only file system information excluding the drive which contained the cofee usb drive and searching for any writefile operation handleexe made three writes to the following file cwindowssystem32 driversprocexp100sys srvcheckexe made one write to the following file 127001 pipewinreg showgrpsexe attempted to make the following write but it failed due to bad network path ecit02mailslot netnetlogon these file writes are coded into the tools and are unlikely to be of evidentiary interest assertion 4 total of 262 writesupdatesdeletions were made to the registry by runner and its processes to include all the programs within the selected profile these results will also include attempts to change the registry that were not allowed ie an attempt was made to delete key that did not exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation there were 239 writes made to the regist ry key below the breakdown of the programs that updated this registry key are as follows runnerexe 8 sclistexe 1 showgrpsexe 1 netstatexe 16 autorunscexe 8 getmacexe 8 netexe 9 psserviceexe 1 openfilesexe 1 ipconfigex 8 tasklistexe 8 pslistexe 2 hostnameexe 8 quserexe 1 arpexe 8 scexe 2 cmd 133 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above autorunsc made writes to the following 4 registry keys hkcusoftware microsoft windowscurrentversion explorer mountpoints2 page 13 f8da80be 94b811de83d9806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints2 b50bbec3 94b911deb2a5806d6172696f baseclass hkcusoftware microsoftwindowscurrentversion explorer mountpoints2 b50bbec2 94b911deb2a5806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints2 ebaseclass in addition to the above arpexe made 1 write to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above ipconfigexe made writes to the following 5 registry keys hklmsoftware microsoft esentprocess7000debugtrace level hklmsystemcurrentcontrolset services eventlog application esenteve ntmessagefile hklmsystemcurrentcontrolset services eventlog application esentcat egorymessagefile hklmsystemcurrentcontrolset services eventlog application esentcat egorycount hklmsystemcurrentcontrolset services eventlog application esenttyp essupported in addition to the above ipconfigexe attempted to delete the following registry key hklmsoftware microsoft esentprocess7000debugtrace level in addition to the above pslistexe attempted to delete the following 4 registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count in addition to the above handle made writes to the following 4 registry keys hklmsystemcurrentcontrolset services procexp100 type hklmsystemcurrentcontrolset services procexp100 errorcontrol hklmsystemcurrentcontrolset services procexp100 start hklmsystemcurrentcontrolset services procexp100 imagepath page 14 in addition to the above handle made 2 deletes to the following registry keys hklmsystemcurrentcontrolset services procexp100 enum hklmsystemcurrentcontrolset services procexp100 in addition to the above netstat made writes to the following 2 registry keys hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs assertion 5 an examination of the process monitor logs ind icates that the programs run as part of the profile were run from the thumb drive and not from the suspect s hard drive this was done using the filters operation is load image and path ends with dll then exclude note dll files were loaded from the targets computer and used by runnerexe and programs invoked by runnerexe additional tester notes while there were several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were re sult of running these tools on live machine and could not be avoided in addition five additional writes were attempted to the target computer with only 4 of the writes being successful just as with the above registry modifications t hese writes we re unlikely to modify any files of evidentiary concern and could not be avoided short of not running the programs in question while there were slight changes to the registry and several writes to the target machine the writes were unavoidable in attem pting to retrieve the desired information and as such the overall rating for this test will be listed as expected overall success as expected page 15 test results report key test name runnertest nw3c volatiledataformat 0003 date 31 august 2009 descripti on running cofeee generated thumb drive with the nw3c volatile data profile sp2 tester name cweir sangara test machine ecit 01 assertion s tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the th umb drive not from the suspects machine unique setup informati on the system was loaded with microsoft windows xp service pack 2 4gb thumbdrive with the nw3c volatile data profile loaded results by assertion 1 all programs identified in the profi were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected as expected anomaly detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 01 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monit or one process monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1341 est end time 1342 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assertions listed above the results of the analysis are detailed below assertion 1 an examination of the thumb drives file s ystem indicated that all of the programs associated with the nw3c volatile data profile were successfully copied to the disk each page 16 program had been given unique four digit file name such as 2134exe each program was verified by either the internal f ile name or execution of it on the cofee gui machine which created the thumb drives ecit 03 an examination of the process monitor logs indicates that all of the programs associated with the nw3c volatile data profile were successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assertion 3 an examination of the process monitor logs indicates that there were direct writes made to the suspect drive by runner or any of its processes to include all of the programs within the selected profile this test was done by filtering the process monitor log results to show only file system in formation excluding the drive which contained the cofee usb drive and searching for any writefile operation assertion 4 total of 117 writesupdatesdeletions were made to the registry by runner and its processes to include all the programs within the selected profile these results will also include attempts to change the registry that were not allowed ie an attempt was made to delete key that did not exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation there were 105 writes made to the registry key below the breakdown of the programs that updated this registry key are as follows runnerexe 8 i pconfig 8 net 8 pslist 2 quser 1 netstat 16 sclist 1 showgrps 1 systeminfo 8 cmd 52 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above ipconfig made writes to the following 5 registry keys hklmsoftware microsoft esentprocess3074debugtrace level hklmsystemcurrentcontrolset services enventlog application esentev entmessagefile hklmsystemcurrentcontrolset services enventlog application esentca tegorymessagefile hklmsystemcurrentcontrolset services enventlog application esentca tegorycount hklmsystemcurrentcontrolset services enventlog application esentty pessupported one delete was attempted by ipconfig to the following registry key hklmsoftware microsoft esentprocess3074debugtrace level page 17 pslistexe attempted to delete the following 4 registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count netstat attempted to make the following two writes hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs assertion 5 an examination of the process monitor logs ind icates that the programs run as part of the profile were run from the thumb drive and not from the suspect s hard drive this was done using the filters operation is loadimage and path ends with dll then exclude note dll files were loaded from the targets computer and used by runnerexe and programs invoked by runnerexe additional teste r notes while there were several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were result of running these tools on live machine and could not be avoided while there were slight changes to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected overall success as expected page 18 test results report key test name runnertest nw3c incidentresponseformat 0004 date 31 august 2009 descriptio n running cofeee generated thumb drive with the nw3c incident response profile sp2 tester name cweir sangara test machine ecit 01 assertion s tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup informati on the system was loaded with microsoft windows xp service pack 2 4gb thumbdrive with the nw3c incident response profile loaded results by assertion 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected anomaly detected anomaly detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 01 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one process monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1522 est end time 1524 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assertions listed above the results of the analysis are detailed below assertion 1 an examination of the thumb drives file system indicated that all of the programs associated with the nw3c incident response profile were successfully copied to the disk each program d been given unique four digit file name such as 2134exe each program was verified by either the internal file name or execution of it on the cofee gui machine which created the thumb drives ecit 03 page 19 an examination of the process monitor logs indicates that all of the programs associated with the nw3c incident response profile were successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assertion 3 an examination of the process monitor logs indicates that there were 5 attempted writes to the suspects machine this test was performed by filtering the process monitor log resul ts to show only file system information excluding the drive which contained the cofee usb drive and searching for any writefile operation handleexe made three writes to the following file cwindowssystem32 driversprocexp100sys srvcheck exe made one write to the following file 127001 pipewinreg showgrpsexe attempted to make the following write but it failed due to bad network path ecit01mailslot netnetlogon these file writes are coded into the tools and are unlikely to be of evidentiary interest assertion 4 total of 262 writesupdatesdeletions were made to the registry by runner and its processes to include all the programs within the selected profile these results will also include attempts to change the re gistry that were not allowed ie an attempt was made to delete key that did not exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdel etekey operation there were 239 writes made to the registry key below the breakdown of the programs that updated this registry key are as follows runnerexe 8 sclistexe 1 showgrpsexe 1 netstatexe 16 autorunscexe 8 getmacexe 8 ne texe 9 psserviceexe 1 openfilesexe 1 ipconfigexe 8 tasklistexe 8 pslistexe 2 hostnameexe 8 quserexe 1 arpexe 8 scexe 2 cmd 133 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above autorunsc made writes to the following 4 registry keys hkcusoftware microsoft windowscurrentversion explorer mountpoints2 page 20 5878707d 94b811de8dc5806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints2 883190a4965411de9b5700173115d87b baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints2 429adec3 94b911de9b4e806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints2 429adec2 94b911de9b4e806d6172696f baseclass in addition to the above arpexe made 1 write to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above ipconfigexe made wri tes to the following 5 registry keys hklmsoftware microsoft esentprocess8109debugtrace level hklmsystemcurrentcontrolset services eventlog application esenteve ntmessagefile hklmsystemcurrentcontrolset services eventlog application esentcat egorymessagefile hklmsystemcurrentcontrolset services eventlog application esentcat egorycount hklmsystemcurrentcontrolset services eventlog application esenttyp essupported in addition to the above ipconfigexe attempted to delete the following registry key hklmsoftware microsoft esentprocess8109debugtrace level in addition to the above pslistexe attempted to delete the following 4 registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentco ntrolset services perfproc performance error count hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count in addition to the above handle made writes to the followin g 4 registry keys hklmsystemcurrentcontrolset services procexp100 type hklmsystemcurrentcontrolset services procexp100 errorcontrol hklmsystemcurrentcontrolset services procexp100 start hklmsystemcurrentcontrolset services procexp100 imagepath page 21 in addition to the above handle made 2 deletes to the following registry keys hklmsystemcurrentcontrolset services procexp100 enum hklmsystemcurrentcontrolset services procexp100 in addition to the above netstat made writes to the following 2 registry keys hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs hklmsoftware microsoft rfc1156agent currentversion parameters trappo lltimemillisecs assertion 5 an examination of the process monitor logs ind icates th at the programs run as part of the profile were run from the thumb drive and not from the suspect s hard drive this was done using the filters operation is load image and path ends with dll then exclude note dll files were loaded from the target s computer and used by runnerexe and programs invoked by runnerexe additional tester notes while there were several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifica tions were result of running these tools on live machine and could not be avoided in addition five additional writes were attempted to the target computer with only 4 of the writes being successful just as with the above registry modifications these writes were unlikely to modify any files of evidentiary concern and could not be avoided short of not running the programs in question while there were slight changes to the registry and several writes to the target machine the writes were unavo idable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected overall success as expected page 22 test results report key test name runnertest nw3c incidentresponseformat 0005 date 1st september 2009 description running cofee generated thumb drive with the nw3c incident response profile sp3 tester name sangara cweir test machine ecit 02 assertions tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drives file system 4 executing runnerexe did not cause any direct writes to the suspect drives registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup information system was loaded with microsoft windows xp service pack 3 used 2g pny attache thumb drive with the nw3c incident response profile loaded as well as process monitor results by assertion 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected anomal detected anomal detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 02 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one process monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1032 est end time 1034 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assertions listed above the results of t he analysis page 23 are detailed below assertion 1 an examination of the thumb drives file system indicated that all of the programs associated with the nw3c incident response profile were successfully copied to the disk each program had been given unique four digit file name such as 2134exe each program was verified either by the internal file name or execution of it on the cofee gui machine which created the thumb drives ecit 03 an examination of the process monitor logs indicates that all of the programs associated with the nw3c incident response profile were successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assert ion 3 an examination of the process monitor logs indicates that there were 5 attempted writes to the suspects machine this test was performed by filtering the process monitor log results to show only file system information excluding the drive wh ich contained the cofee usb drive and searching for any writefile operation the results indicate that the program handleexe made three writes to the file cwindowssystem32 driversprocexp100sys one of which failed due to fast io disal lowed in addition to the above writes one write was made by srvcheckexe to 127001 pipewinreg in addition to the above write one write was attempted but failed due to bad network path by showgrpsexe to ecit02mailslot netnetlogon these file writes are coded into the tools and are unlikely to be of evidentiary interest assertion 4 an examination of the process monitor logs indicates that there were 277 total writesupdatesdeletions made to the registry by runner and its processes to include all of the programs within the selected profile these results will also include attempts to change that were not allowed ie an attempt to delete page 24 key that doesnt exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation for simplicities sake any change made to the registry will be listed as write below there were 239 writes made to the registry key below the breakdown of the programs that updated this registry key is as follows arpexe 8 atexe 0 autorunscexe 8 getmacexe 8 handleexe 0 hostnameexe 8 ipconfigexe 8 msinfo32exe 8 nbtstatexe 0 netexe 9 netdomexe 0 netstatexe 16 openfilesexe 1 psfileexe 0 pslistexe 2 psloggedonexe 0 psserviceexe 1 pstatexe 0 psuptimeexe 8 quserexe 1 routeexe 0 scexe 2 sclistexe 1 showgrpsexe 1 srvcheckexe 0 tasklistexe 8 whoamiexe 0 cmdexe 133 and runnerexe 8 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above arpexe also made on write to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above autorunscexe also made one write to each of the following registry keys hkcusoftware microsoft windowscurrentversion explorer mountpoints 2f8da80be 94b811de83d9806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints 2be33e6dc 963d11deb2b000173115d853 baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints 2b50bbec3 94b911deb2a5806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints 2b50bbec2 94b911deb2a5806d6172696f baseclass in addition to any writes listed above handleexe also made one write to each of the following registry keys hklmsystemcurrentcontrolset services procexp100 type hklmsystemcurrentcontrolset services procexp100 errorcontrol hklmsystemcurrentcontrolset services procexp100start hklmsystemcurrentcontrolset services procexp100 imagepath in addition to any writes listen above handleexe also made the one delete to each of the following registry keys hklmsystemcurrentcontrolset services procexp100 enum hklmsystemcurrentcontrolset services procexp100 in addition to any writes deletes listed above ipconfigexe also made one delete to t he following registry key page 25 hklmsoftware microsoft esentprocess6407debugtrace level in addition to any writes listed above ipconfigexe also made one write to each of the following registry keys hklmsoftware microsoft rfc1156agent currentversion parameters trap pollmillsecs hklmsoftware microsoft esentprocess6407debugtrace level hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfglogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgcontrolflag hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier bitname s hklmsoftware microsoft windows ntcurrentversi ontracingmicrosoft eappprxy logsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy active hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy controlflag hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier bitnam hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutillogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilcontrolflag hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilbitnames hklmsystemcurrentcontrolset services eventlog application esente ventmessagefile hklmsystemcurrentcontrolset services eventlog application esentc ategorymessagefile page 26 hklmsystemcurrentcontrolset services eventlog application esentc ategorycount hklmsystemcurrentcontrolset services eventlog application esentt ypessupported in addition to any writes listed above netstatexe also made two writes to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above pslistexe attempted to make two deletes on each the following registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count assertion 5 an examination of the process monitor logs indicates that the programs run as part of the profile were run from the thumb drive and not from the suspects hard drive t his was done using the filters operation is loadimage and path ends with dll then exclude note dll files were loaded from the targets computer and used by runnerexe and programs invoked by runnerexe additional tester notes while there were s everal writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were result of running these tools on live machine and could not be avoided while there were slight cha nges to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected while there were slight changes to the drive and registry the writes were ei ther specific to program run handleexe or were unavoidable in attempting to retrieve the desired information the overall rating for this test will be listed as expected overall success as expected page 27 test results report key test name runnertest nw3c volatiledata format 0006 date 1st september 2009 description running cofee generated thumb drive with the nw3c volatile data profile sp3 tester name sangara cweir test machine ecit 02 assertions tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drives file system 4 executing runnerexe did not cause any direct writes to the suspect drives registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup information system was loaded with microsoft windows xp service pack 3 used 2g pny attache thumb drive with the nw3c incident response profile loaded results by assertion 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected anomal detected anomal detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 02 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one pr ocess monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1153 est end time 1153 est immediately after the completion of runner the tester stopped the pr ocess monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assertions listed above the results of the analysis are detailed below page 28 assertion 1 an examination of the thumb drives file system indicat ed that all of the programs associated with the nw3c volatile data profile were successfully copied to the disk each program had been given unique four digit file name such as 2134exe each program was verified either by the internal file name or execution of it on the cofee gui machine which created the thumb drives ecit 03 an examination of the process monitor logs indicates that all of the programs associated with the nw3c volatile data profile were successfully run during the testing peri od assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assertion 3 an examination of the process monitor logs indicates tha t there were direct writes made to the suspect drive by runner or any of its processes to include all of the programs within the selected profile this test was done by filtering the process monitor log results to show only file system information excluding the drive which contained the cofee usb drive and searching for any writefile operation assertion 4 total of 132 writesupdatesdeletions were made to the registry by runner and its processes to include all the programs within the s elected profile these results will also include attempts to change the registry that were not allowed ie an attempt was made to delete key that did not exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation there were 105 writes made to the registry key below the breakdown of the programs that updated this registry key is as follows ipconfigexe 8 nbtstatexe 0 netexe 8 netstatexe 16 pslistexe 2 psloggedonexe 0 quserexe 1 sclistexe 1 showgrpsexe 1 systeminfoexe 8 whoamiexe 0 cmdexe 52 and runnerexe 8 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above arpexe also made one write to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs page 29 in addition to any writes liste d above ipconfigexe made one ete to the following registry key hklmsoftware microsoft esentprocess1475debugtrace level in addition to any writes listed above ipconfigexe also made one write to each of the following registry keys hklmsoftware microsoft windows ntcurrentversiontracingmicrosoft eappcfglogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgcontrolflags hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier bitna mes hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy logsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy active hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy controlflags hklmsoftware microsoftwindows ntcurrentversion tracingmicrosoft eappprxy traceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier bitn ames hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutillogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilcontrolflags hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutiltraceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutiltraceidentifier bitname s hklmsoftware microsoft esentprocess1475debugtrace level hklmsystemcurrentcontrolset services enventlog application esen teventmessagefile page 30 hklmsystemcurrentcontrolset services enventlog application esen tcategorymessagefile hklmsystemcurrentcontrolset services enventlog application esen tcategorycount hklmsystemcurrentcontrolset services enventlog application esen ttypessupported in addition to any writes listed above netstatexe also made two writes to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above pslistexe attempted to make two deletes to each of the following registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfprocperformance error count assertion 5 an examination of the process monitor logs ind icates that the programs run as part of the profile were run from the thumb drive and not from the suspect s hard drive this was done using the filters operation is loadimage and path ends with dll then exclude note dll files were loaded from the targets computer and used by runnerexe and programs invoked by runnerexe additional tester notes while there we re several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were result of running these tools on live machine and could not be avoided while there were slight changes to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected while there were slight changes to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected overall success as expected page 31 test results report key test name runnertest nw3c volatiledata format 0007 date 1st september 2009 description running cofee generated thumb drive with the nw3c volatile data profile sp3 tester name sangara cweir test machine ecit 01 assertions tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drives file system 4 executing runnerexe did not cause any direct writes to the suspect drives registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup information system was loaded with microsoft windows xp service pack 3 used 2g pny attache thumb drive with the nw3c incident response profile loaded results by assertion 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing ru nnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected anomal detected anomal detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 01 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one process monitor loaded and had begun capturing data the tester navigated to the thumb drive and ran runnerexe start time 1225 est end time 1225 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examined later for testing the assertions listed above the results of the analysis are detailed be low page 32 assertion 1 an examination of the thumb drives file system indicated that all of the programs associated with the nw3c volatile data profile were successfully copied to the disk each program had been given unique four digit file name such as 2 134exe each program was verified either by the internal file name or execution of it on the cofee gui machine which created the thumb drives ecit 03 an examination of the process monitor logs indicates that all of the programs associated with th nw3c volatile data profile were successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates that runnerexe successfully saved the output files on the thumb drive and in the appropriate directori assertion 3 an examination of the process monitor logs indicates that there were direct writes made to the suspect drive by runner or any of its processes to include all of the programs within the selected profile this test was done by filterin g the process monitor log results to show only file system information excluding the drive which contained the cofee usb drive and searching for any writefile operation assertion 4 total of 132 writesupdatesdeletions were made to the regi stry by runner and its processes to include all the programs within the selected profile these results will also include attempts to change the registry that were not allowed ie an attempt was made to delete key that did not exist this test was d one by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation there were 105 writes made to the registry key below the breakdown of the programs that updated this registry key is as follows ipconfigexe 8 nbtstatexe 0 netexe 8 netstatexe 16 pslistexe 2 psloggedonexe 0 quserexe 1 sclistexe 1 showgrpsexe 1 systeminfoexe 8 whoamiexe 0 cmdexe 52 and runner exe 8 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above arpexe also made one write to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs page 33 in addition to any writes liste d above ipconfigexe made one delete to the following registry key hklmsoftware microsoft esentprocess2916debugtrace level in addition to any writes listed above ipconfigexe also made one write to each of the followi ng registry keys hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfglogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosofteappcfgcontrolflags hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier bitna mes hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy logsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy active hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy controlflags hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier bitn ames hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutillogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilcontrolflags hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutiltraceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutiltraceidentifier bitname s hklmsoftware microsoft esentprocess2916debugtrace level hklmsystemcurrentcontrolset services enventlog application esen page 34 teventmessagefile hklmsystemcurrentcontrolset services enventlog application esen tcategorymessagefile hklmsystemcurrentcontrolset services enventlog application esen tcategorycount hklmsystemcurrentcontrolset services enventlog application esen ttypessupported in addition to any writes listed above netstatexe also made two writes to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above pslistexe attempted to make two deletes to each of the following registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolse tservices perfproc performance error count assertion 5 an examination of the process monitor logs ind icates that the programs run as part of the profile were run from the thumb drive and not from the suspect s hard drive this was done using the filters operation is loadimage and path ends with dll then exclude note dll files were loaded from the targets computer and used by runnerexe and programs invoked by runnerexe additional tester notes while there we re several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were result of running these tools on live machine and could not be avoided while there were slight changes to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected while there were slight changes to the registry the writes were unavoida ble in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected overall success as expected page 35 test results report key test name runnertest nw3c incidentresponseformat 0008 date 1st september 2009 description running cofee generated thumb drive with the nw3c incident response profile sp3 tester name sangara cweir test machine ecit 01 assertions tested 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drives file system 4 executing runnerexe did not cause any direct writes to the suspect drives registry 5 the tools executed were run from the thumb drive not from the suspects machine unique setup information system was loaded with microsoft windows xp service pack 3 used 2g pny attache thumb drive with the nw3c incident response profile loaded as well as process monitor results by assertion 1 all programs identified in the profile were executed 2 results of the tools were properly stored on the investigators thumb drive 3 executing runnerexe did not cause any direct writes to the suspect drive file system 4 executing runnerexe did not cause any direct writes to the suspect drive registry 5 the tools executed were run from the thumb drive not from the suspects machine as expected as expected anomal detected anomal detected as expected tester notes for this test the cofee thumb drive was reformatted and rebuilt on the cofee gui machine ecit 03 the thumb drive was then connected to the target machine ecit 01 after the target system had finished booting to windows after the thumb drive was loaded the tester navigated to the thumb drive and started process monitor one process monitor loaded and had begun capturing data the tester navigated to th thumb drive and ran runnerexe start time 1245 est end time 1247 est immediately after the completion of runner the tester stopped the process monitor capture and saved the log file to the thumb drive the log file was examin ed later for testing the assertions listed above the results of the analysis are detailed below page 36 assertion 1 an examination of the thumb drives file system indicated that all of the programs associated with the nw3c incident response profile were succe ssfully copied to the disk each program had been given unique four digit file name such as 2134exe each program was verified by either the internal file name or execution of it on the cofee gui machine which created the thumb drives ecit 03 an examination of the process monitor logs indicates that all of the programs associated with the nw3c incident response profile were successfully run during the testing period assertion 2 an examination of the contents of the thumb drive indicates tha t runnerexe successfully saved the output files on the thumb drive and in the appropriate directories assertion 3 an examination of the process monitor logs indicates that there were 5 attempted writes to the suspects machine this test was performed by filtering the process monitor log results to show only file system information excluding the drive which contained the cofee usb drive and searching for any writefile operation the results indicate that the program handleexe made three wr ites to the file cwindowssystem32 driversprocexp100sys one of which failed due to fast io disallowed in addition to the above writes one write was made by srvcheckexe to 127001 pipewinreg in addition to the above write one write was attempted but failed due to bad network path by showgrpsexe to ecit01mailslot netnetlogon these file writes are coded into the tools and are unlikely to be of evidentiary interest asse rtion 4 an examination of the process monitor logs indicates that there were 277 total writesupdatesdeletions made to the registry by runner and its processes to include all of the programs within the selected profile these results will also include attempts to change that were not allowed ie an attempt to delete key that doesnt exist this test was done by filtering the process monitor log results to show only registry information and searching for any regsetvalue regdeletevalue or regdeletekey operation for simplicities sake any page 37 change made to the registry will be listed as write below there were 239 writes made to the registry key below the breakdown of the programs that updated this registry key is as follows arpexe 8 atexe 0 autorunscexe 8 getmacexe 8 handleexe 0 hostnameexe 8 ipconfigexe 8 msinfo32exe 8 nbtstatexe 0 netexe 9 netdomexe 0 netstatexe 16 openfilesexe 1 psfileexe 0 pslistexe 2 psloggedonexe 0 psserviceexe 1 pstatexe 0 psuptimeexe 8 quserexe 1 routeexe 0 scexe 2 sclistexe 1 showgrpsexe 1 srvcheckexe 0 tasklistexe 8 whoamiexe 0 cmdexe 133 and runnerexe 8 hklmsoftware microsoft cryptography rngseed in addition to any writes listed above arpexe also made one write to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above autorunscexe also made one write to each of the following registry keys hkcusoftware microsoft windowscurrentversion explorer mountpoints 25878707d 94b811de8dc5806d6172696f baseclass hkcusoftware microsoft windowscurrentversionexplorer mountpoints 2883190a4 965411de9b5700173115d87b baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints 2429adec3 94b911de9b4e806d6172696f baseclass hkcusoftware microsoft windowscurrentversion explorer mountpoints 2429adec2 94b911de9b4e806d6172696f baseclass in addition to any writes listed above handleexe also made one write to each of the following registry keys hklmsystemcurrentcontrolset services procexp100 type hklmsystemcurrentcontr olsetservices procexp100 errorcontrol hklmsystemcurrentcontrolset services procexp100 start hklmsystemcurrentcontrolset services procexp100 imagepath in addition to any writes listen above handleexe also made the one delete to each of the following registry keys hklmsystemcurrentcontrolset services procexp100 enum hklmsystemcurrentcontrolset services procexp100 in addition to any writes deletes listed above ipconfigexe also made one delete to t he following registry key page 38 hklmsoftware microsoft esentprocess3230debugtrace level in addition to any writes listed above ipconfigexe also made one write to each of the following registry keys hklmsoftware microsoft rfc1156agent currentversion parameters trap pollmillsec s hklmsoftware microsoft esentprocess3230debugtrace level hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfglogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgcontrolflag hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappcfgtraceidentifier bitname s hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy logsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy active hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy controlflag hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier guid hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft eappprxy traceidentifier bitnam hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutillogsessionname hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilactive hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilcontrolflag hklmsoftware microsoft windows ntcurrentversion tracingmicrosoft qutilbitnames hklmsystemcurrentcontrolset services eventlog application esente ventmessagefile hklmsystemcurrentcontrolset services eventlog application esentc ategorymessagef ile hklmsystemcurrentcontrolset services eventlog application esentc ategorycount hklmsystemcurrentcontrolset services eventlog application esentt ypessupported page 39 in addition to any writes listed above netstatexe also made two writes to the following registry key hklmsoftware microsoft rfc1156agent currentversion parameters trappolltimemillisecs in addition to any writes listed above pslistexe attempted to make two deletes on each the following registry keys hklmsystemcurrentcontrolset services perfosperformance error count hklmsystemcurrentcontrolset services perfproc performance error count assertion 5 an examination of the process monitor logs indicates that the programs run as part of the profile were run from the thumb drive and not from the suspects hard drive this was done using the filters operation is loadimage and path ends with dll then exclude note dll files were loaded from the targets computer and used by runnerexe and progr ams invoked by runnerexe additional tester notes while there were several writes to the systems registry the registry keys modified were unlikely to be of any evidentiary concern in addition the modifications were result of running these tools n live machine and could not be avoided while there were slight changes to the registry the writes were unavoidable in attempting to retrieve the desired information and as such the overall rating for this test will be listed as expected while there were slight changes to the drive and registry the writes were either specific to program run handleexe or were unavoidable in attempting to retrieve the desired information the overall rating for this test will be listed as expected overall success as expected page 40 report notes this validation was conducted to test the functionality of the two nw3c profiles as they would run on suspects system this is not validation of the full cofee suite additional references leo dorrendorf z g 2007 cryptanalysis of the windows random number generator the hebrew university of jerusalem bowser m wykes j 2009 cofee gui console national white collar crime center glossary entropy random data mouse position processor statistics local time etc collected by an application or operating system for use in cryptography file system in relation to this document file system refers to active files on the suspects system incident response the actions and approaches taken to network security breach such as system being hacked registry the registry consists of number of separate hive files which store various types of information when system is powered on the operatin g system combines these hive files in ram to create the registry when changes are made to the registry the changes are made to the registry that is located in ram the point at which these changes are actually written to the hive files on the disk varies depending upon number of factors therefore it is difficult to determine if any of the changes made to the registry by the profiles discussed in this report would actually affect the data stored on the suspects hard drive for example if the inv estigator removes power from the suspects machine by pulling the power cord immediately after running the volatile data profile it is possible that none of the changes made to the registry would have actually been stored to the suspects disk volatil data any data that is lost when power is removed from the system windows random number generator pseudo random number generator prng that uses collected entropy from windows machine to establish cryptographic keys each windows process has its own copy of wrng instance entropy collected is used to generate an rc4 key that is stored in its internal state for random number generation each instance of the wrng uses eight rc4 streams entropy collection occurs when an rc4 stream is initialized r it reaches the 16kb threshold the entire 3584 bytes of collected entropy are hashed to produce an 80 byte digest which is then fed into an rc4 algorithm as key the key is used to encrypt the clear text contained in the hkey_local_machine software microsoft cryptography rng seed registry key this key contains the latest seeded value obtained from windows entropy sources and is used by all instances of the wrng run on the machine the result is another 80 byte digest that is again fed into an rc4 52 algorithm that is used to encrypt 256 byte entropy source read from windows device driver the result of the final encryption is used as key for the rc4 instance that is used in the wrng internal state leo dorrendorf 2007