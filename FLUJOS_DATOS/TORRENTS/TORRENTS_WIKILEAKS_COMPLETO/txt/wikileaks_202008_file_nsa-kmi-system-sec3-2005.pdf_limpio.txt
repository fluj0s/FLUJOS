unclassifiedfor official use only printed 52005 unclassifiedfor official use onlytechnical report 1 kmi 2200 u system description and requirements 2 specification for key management infrastructure kmi3 capability increment 2 ci2 4 5 6 volume 3 7 u system security architecture and related 8 requirements 9 10 11 version 2 x 12 draft 13 14 15 e001 16 17 18 technical task order 2086 19 20 21 information assurance mission attainment 22 iamac contract 23 24 mda90403c1074 25 26 27 28 900 elkridge landing road 29 linthicum maryland 21090 30 31 32 20 may 2005 33back of removable transmittal page draft back of removable transmittal page draft1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 this page left blank intentionally 21 22unclassifiedfor official use only unclassifiedfor official use only key management infrastructure 1 2 3 4 20 may 2005 5 version 2 x 6 draft 7 8 9 kmi 2200 u system description and requirements specification 10 for key management infrastructure kmi 11 capability increment 2 ci2 12 13 volume 3 14 u system security architecture and related requirements 15 16 17 u this document specifies defenseindepth for system components 18 and for secure connections between those components and also specifies 19 rolebased rulebased and approvalbased access control processes 20 21 22 23 i56 24 kmi program management team 25 national security agency 26 9800 savage road 27 ft meade md 20755 28 29 30 31 32 not releasable to the defense technical information center per dod instruction 320012 33 34 35 this document contains information exempt from mandatory disclosure 36 under the foia exemption 3 37 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page iiu revision page 1 u this page lists the document versions that have been issued requests for changes to this2 document should be submitted in writing to the office of primary responsibility that is3 identified in section 154 date version description of changes 4 oct 2002 01 ci2 security architecture outline ci1 baseline 17 apr 2003 02includes material from section 25 security architecture of kmi 22002212 done except for sections 4345 25 apr 2003 03complete except for section 5 2 may 2003 04first complete draft near final 24 oct 2003 07major revision incorporates existing rolebased access control specification from kmi2200v2 provides new rulebased access control and new approvalbased access control sections issued to support srs b version skips from 04 to 07 in order to synchronize with kmi2200v2 6 nov 2003 071 released as part of srs b 19 dec 2003 10released as part of srs c 30 sep 2004 11final draft for srs d 30 dec 2004 12final draft of srs 28 feb 2005 125 final draft of srs f update to complete implementation of comments against srs d submitted as change proposals 11 apr 2005 126 incorporates results of processing change proposals for version 125 and clears change markings 15 apr 2005 20updated draft for community release tbd 2005 2x tbd for official use only 5 6kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page iiiu table of contents 1 1 u introduction12 11 u purpose13 12 u clientserver view14 13 u general terminology25 14 u nodal goal architecture36 15 u office of primary responsibility47 16 u requirement statements48 17 u key words in requirements59 18 u organization of this volume5 10 2 u protection strategy711 21 u risk management7 12 22 u objectives policies and guidelines7 13 23 u clientserver model and transaction model8 14 24 u defense in depth9 15 25 u compliance11 16 251 u resource protection11 17 252 u user accountability12 18 253 u assurance13 19 3 u architectural elements1520 31 u user roles and permissions15 21 311 u management roles16 22 312 u user access modes18 23 32 u resource protection19 24 321 u security perimeters19 25 322 u protected channels20 26 323 u domains enclaves and zones24 27 324 u perimeter defense27 28 3241 u boundary protection suites28 29 3242 u guards30 30 4 u nodal structures3131 41 u client nodes31 32 411 u client nodes serving managers31 33 412 u client nodes serving koa agents32 34 413 u client nodes serving devices33 35 42 u primary services nodes33 36 421 u prsn domains enclaves and zones33 37 422 u prsn service redundancy and data replication34 38 423 u prsn network connectivity35 39 424 u prsn security enclaves38 40 4241 u prsn orderingandmanagement enclaves43 41 4242 u prsn product delivery enclaves45 42 4243 u fill ports and distribution paths48 43 4244 u peer systems enclaves 49 44kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page iv425 u prsn security zones51 1 4251 u boundary protection suites in prsn security zones55 2 4252 u prsn public zones56 3 4253 u prsn buffer zones58 4 4254 u prsn common private zone61 5 4255 u prsn interenclave guards64 6 426 u prsn monitoring zones66 7 427 u prsn intradomain data flow68 8 43 u product source nodes699 431 u psn security characteristics69 10 432 u psn communications70 11 44 u central services node70 12 441 u csn services71 13 4411 u csn data management services71 14 4412 u csn security management services74 15 4413 u csn component management services75 16 4414 u csn production management services76 17 4415 u csn data characteristics77 18 442 u csn enclaves and data flows79 19 4421 u csn unclassified enclave80 20 4422 u csn classified enclaveoutbound zone81 21 4423 u csn classified enclaveinbound zone82 22 4424 u csn communication with other nodes82 23 45 u ekms translator84 24 451 u translator security characteristics84 25 452 u translator communications85 26 453 u translator security zones and data flows 86 27 5 u access control processes8928 51 u rolebased access control92 29 511 u definition and maintenance of roles and permissions94 30 512 u assignment of permissions to roles95 31 513 u permission inheritance in the role hierarchy95 32 514 u assignment of identities to roles96 33 5141 u assignment of identities to the koa agent role97 34 5142 u assignment of identities to management roles97 35 5143 u verification of authenticity and eligibility for managers99 36 5144 u manager reverification and reconfirmation100 37 515 u sessions and principals101 38 516 u session restrictions and permission checking103 39 517 u enrollment managers104 40 518 u constraints on identities roles permissions and sessions107 41 5181 u static separation constraints108 42 5182 u static cardinality constraints108 43 519 u enrollment domains109 44 5191 u hierarchy of enrollment domains109 45 5192 u enrolling managers in enrollment domains111 46kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page v5193 u implications of enrollment domains113 1 52 u rulebased access control1142 521 u rubac properties for system resource objects115 3 522 u rubac attributes for system entities116 4 53 u approvalbased access control1205 531 u approvalbased access control for symmetric key products123 6 5311 u overview of distribution of symmetric key products123 7 5312 u controlling authority for symmetric key products126 8 5313 u product requester for symmetric key products128 9 532 u approvalbased access control for asymmetric key products130 10 5321 u overview of distribution of asymmetric key products131 11 5322 u command authority for asymmetric key products132 12 5323 u product requester for asymmetric key products134 13 533 u kmi operating accounts135 14 5331 u koa registration and associated data136 15 5332 u koa managers138 16 5333 u koa device assignment140 17 5334 u koa local product distribution144 18 5335 u koa agents designation and removal145 19 5336 u koa agents login at pde147 20 5337 u koa agents retrieval of products148 21 54 u alternative mechanisms for access controls149 22 6 u distributed multidomain subsystems15123 61 u intrusion detection subsystem152 24 611 u ids types152 25 612 u ids capabilities in prsns153 26 6121 u capabilities in each enclave of each prsn153 27 6122 u capabilities in each prsn154 28 6123 u capabilities in each security domain154 29 6124 u capabilities in system of prsns154 30 613 u implementation issues155 31 62 u audit subsystem156 32 63 u compromise reports and revocation requests156 33 7 u glossary of acronyms15934 8 u glossary of terms16135 9 u glossary of terms16736kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page viu table of figures 1 figure 1 u kmi clientserver view22 figure 2 u kmi nodal architecture33 figure 3 u kmi security perimeters194 figure 4 u kmi protected channels between components205 figure 5 u kmi protected channel layers226 figure 6 u kmi domains enclaves and zones257 figure 7 u kmi prsn client domains348 figure 8 u kmi prsn client and peer system connectivity 36 9 figure 9 u kmi prsn client enclave access37 10 figure 10 u kmi prsn enclave types 38 11 figure 11 u kmi prsn omes configuration example4012 figure 12 u kmi prsn pdes configuration example4013 figure 13 u kmi product distribution paths for user devices4814 figure 14 u kmi prsn enclave structures5215 figure 15 u kmi strategy for security zones in prsns5316 figure 16 u kmi connections for security zones in prsns5417 figure 17 u kmi prsn components5718 figure 18 u kmi prsn notional monitoring architecture6619 figure 19 u kmi csn functions and databases7220 figure 20 u kmi csn enclaves and data flows7921 figure 21 u kmi csn connections to core nodes8322 figure 21b u kmi ekms translator enclaves and data flows 85 23 figure 22 u kmi access control framework8924 figure 23 u kmi rolebased access control9425 figure 24 u kmi enrollment of managers with examples9826 figure 25 u kmi user registration and manager enrollment9927 figure 26 u kmi registration enrollment and login10228 figure 27 u kmi enrollment manager examples10529 figure 28 u kmi enrollment authorization examples10630 figure 29 u kmi enrollment domain examples11131 figure 30 u kmi user enrollment examples11332 figure 31 u kmi rulebased access control11533 figure 32 u kmi rubac attribute set initialization and change11834 figure 33 u kmi rubac attribute set examples11935 figure 34 u kmi management roles in distribution of symmetric products12336 figure 35 u kmi twostage distribution of symmetric key products12537 figure 36 u kmi approvalbased steps for symmetric key product12638 figure 37 u kmi management roles in distribution of asymmetric products13139 figure 38 u kmi approvalbased steps for asymmetric key products13340 figure 39 u kmi registration of general devices at prsn14041 figure 40 u kmi product distribution via koa agents14542 figure 41 u kmi access control for koa agents14943 figure 42 u kmi multidomain subsystem15144 figure 43 u kmi handling of compromise reports and revocation requests15745kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page viiu table of tables 1 table 1 u kmi resource protection policy elements122 table 2 u kmi user accountability policy elements133 table 3 u kmi security assurance policy elements134 table 4 u kmi roles175 table 5 u kmi protection for client node connections to prsns236 table 6 u kmi prsn ome security domains configuration example417 table 7 u kmi prsn pde security domains configuration example438 table 8 u kmi data received by csn from other nodes779 table 9 u kmi data sent by csn to other nodes7810 table 10 u kmi management differences for major key product types12211 12kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page viii1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 this page left blank intentionally 21 22kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 11 u introduction1 ufouo this document is volume 3 of the threevolume systemlevel description and 2 requirements specification for capability increment 2 ci2 of the key management 3 infrastructure kmi4 ufouo volume 1 key management functions and related requirements provides an 5 overall system description and specifies key management requirements kmi2200v16 ufouo volume 2 system security policy and related requirements states systemwide 7 security policies and specifies requirements for security services8 ufouo volume 3 system security architecture and related requirements specifies the 9 security architecture for the kmi as whole and for each of its nodes kmi2200v3 10 ufouo for the purposes of these documents the kmi is defined as follows11 definition ufouo key management infrastructure all partscomputer hardware 12 firmware software and other equipment and its documentation facilities that house the 13 equipment and related functions and companion standards policies procedures and 14 doctrinethat form the system that manages and supports the ordering and delivery of 15 cryptographic material and related information products and services to users 16 11 u purpose17 ufouo an introduction to the system is provided in the kmi concept document 18 kmi1001 the system is being implemented in phases called capability increments as19 described in the kmi roadmap document kmi1011 each increment will provide new and 20 evolving key management capabilities and services as well as updates or enhancements to21 existing key management systems this volume in combination with volume 2 describes and22 specifies security framework for the design implementation and operation of components that23 are implemented as part of capability increment 2 ci2 and is intended to be the basis for later24 increments25 ufouo security architecture is plan and set of principles that describe the security26 services that system is required to provide to meet the needs of its users b the system27 components required to implement the services and c the performance levels required in the28 components to deal with the threat environment for ci2 part is specified mostly in volume29 2 part b is specified mostly in this document which describes how the major components of30 kmi are structurally organized and protected part c is specified partly in this document and31 partly in volumes 1 and 232 12 u clientserver view33 ufouo this document presents the ci2 security architecture in series of progressively34 more detailed views in the most general view illustrated by figure 1 the kmi is designed to be35 distributed clientserver system in which users operate clients to obtain products and services36 from centralized servers the kmi program seeks to integrate the set of existing and emerging37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 2systems for producing and managing cryptographic material and create single networkbased1 clientserver infrastructure for ordering and delivering cryptographic products and services an2 overview of the kmi mission general architecture and interfaces is provided in kmi10013 figure 1 u kmi clientserver view 4 5 unclassifiedfouo 6 ufouo kmi client nodes connect to the servers across the public internet and other7 department of defense dod commonuse data networks that also are based on the internet8 protocol suite which is commonly referred to as tcpip the servers provide products and9 services only to registered users10 13 u general terminology11 ufouo this document uses the following terms to describe and specify the parts of the kmi12 system these terms and additional terms that are defined in this volume and in volumes 1 and13 2 are written with initial capital letters when used in formal sense ie in policy statements 14 in requirement statements and in other definition statements 15 definition ufouo system entity an active elementie either 1 person or 2 16 set of persons or 3 an automated device or 4 set of devicesthat is part of either the kmi 17 or the kmis environment and that incorporates some specific set of capabilities 18 definition ufouo system resource information held in the system or service or 19 product provided by the system or system capability eg processing power or 20 communication bandwidth or an item of equipment ie hardware firmware software or 21 documentation or facility that houses those things 22 definition ufouo component collection of system resources that form 23 physical or logical part of the kmi system that 1 has specified functions and interfaces and 24 2 is treated by policies or requirement statements as existing independently of other parts 25 definition ufouo computer platform combination of computer hardware and an 26 operating system consisting of software firmware or both for that hardware that supports 27 automated kmi functions 28tcpip user clientscentral server complex public internetclassified dod networksunclassified dod networks tcpip tcpipkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 3definition ufouo site facilityie physical space room or building together 1 with its physical personnel administrative and other safeguardsin which 1 kmi2 functions are performed and 2 kmi components might be housed3 ufouo the term component may be used at more than one level of abstraction so that4 components may be nested within each other in requirement statements that follow in this5 document the specific interpretation of component depends on the context in which the term is6 used and the way in which requirement is implemented7 definition ufouo independent component component that has defined 8 security perimeter at which or within which the component is responsible for some set of9 security services 10 14 u nodal goal architecture11 ufouo this security architecture takes advantage of the distributed nature of the kmi to 12 enhance protection through separation and independence of components figure 2 illustrates that13 the kmi is clientserver system in which client nodes connect to server complex that14 includes three other types of nodes primary services nodes prsns product source nodes15 psns and the central services node csn16 figure 2 u kmi nodal architecture 17 18 unclassifiedfouo 19 definition ufouo node collection of related components that is 1 located on 20 one or more computer platforms at single site 21 definition ufouo core nodes the set of nodes that includes 1 the csn 2 all 22 psns 3 all prsns and 4 all client nodes that serve managers playing internal 23 management roles see management roles section 24central services node csn catalog management and distribution data archive and analysis center security and operations oversight product source nodes psns cryptographic material generation product packaging and vault certification authorities cas primary services nodes prsns user registration roles privileges request processing distribution tracking library help desk kmiekms interface client nodes system operation and administration operating account management product service request retrieval usepsns psnscsn prsns prsns client nodes client nodes dod commonuse and public networkskmi private networkskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 4definition ufouo client node abbreviated as client set of hardware and 1 software with computing and cryptographic capabilities that enable registered human user2 or user device to obtain products and services3 ufouo client nodes enable users to request and use kmi products and services and to4 perform operational and administrative management functions some clients enable users to5 obtain products and services from remote prsns via communications network and some6 client nodes can provide products and services locally7 15 u office of primary responsibility8 ufouo this document is issued by the national security agency nsa deputy director9 for information assurance questions about content or interpretation and requests for changes10 should be addressed as follows11 national security agency 12 code i56 kmi program management team 13 9899 savage road 14 ft meade md 20755 15 ufouo for ease of automated mail sorting the above address should be all upper case and16 10pitch or 12pitch type17 16 u requirement statements18 u requirement statements in this volume have label of the form ci2sar123a where 19 sar identifies the requirement as security architecture requirement and the 123a is 20 number of the section containing the statement and unique identifying letter for the21 requirement within in the section22 u most of the requirement statements are expected to cause incorporation of specific technical23 functionality ie hardware or software features in one or more types of kmi nodes however24 some of the statements either are expected to be satisfied by other nontechnical means or apply25 very broadly to the system and those requirements have the suffix nt nontechnical on their 26 labels27 u requirement statement normally is followed by either the number of the matching item in28 the kmi requirements database krd eg krd 0001 or the numbers of items from29 which the statement has been derived eg drv krd 1001 100230 u this volume includes some requirements that do not apply to ci2 and each of those has the 31 phrase not applicable to ci2 immediately following its label these requirements are32 included to make developers aware of future intentions so that if the developers have choice of33 alternative implementation approaches of nearly equal cost the developers will be encouraged to34 choose the alternative that would make it easiest to add the intended capabilities later35 u finally requirement statement is followed by one or more letters in curly brackets to36 indicate the main component types to which the requirement is allocated37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 5 advanced key processor1 c client node2 p product source node3 r primary services node4 s central services node5 t ekms translator6 z allocated to all of the components above7 x not allocated because not assigned to ci2 or not applicable in some other way8 17 u key words in requirements9 u the key words required shall shall not may and optional are to be interpreted as follows 10 when they appear in requirement statement11 u shall and required these words mean that the statement is an absolute mandate 12 u shall not this phrase means that the statement is an absolute prohibition 13 u may or optional these words means that compliance with the statement is optional 14 18 u organization of this volume15 u the remainder of this volume consists of the following sections16 u 2 protection strategy offers reasoning to support the claim that the presented 17 architecture provides adequate protection for the kmi system and its products and services 18 u 3 architectural concepts provides additional rationale for the assignment of security 19 functions to the components of the nodal architecture 20 u 4 nodal security architecture presents structural requirements for kmi security by 21 decomposing the system in series of progressively more detailed views 22 u 5 access control presents requirements for rolebased rulebased and approvalbased 23 access control processes 24 u 6 distributed twolevel subsystems presents model for implementing certain 25 systemwide internal security service functions 26 u 7 glossary of acronyms see additional definitions in kmi2211 27 u 8 glossary of terms terms for which this volume has definition statements 28 u 9 references 29kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 61 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 this page left blank intentionally 21 22kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 72 u protection strategy1 ufouo the ci2 security architecture provides administrative security communication2 security computer security emanations security personnel security and physical security to3 protect the kmi against both intentional intelligent threats and accidental kinds of threats this4 section offers reasoning to support the claim that the described security architecture provides5 adequate protection for the system and its products and services6 21 u risk management7 ufouo the ci2 security architecture is based not only on security objectives derived from8 national and dod policies see volume 2 but also on risk management process risk9 management is concerned with identification measurement control and minimization of10 security risks in information systems to level commensurate with the value of the system11 resources that require protection cnssi400912 ufouo the kmi threat environment is described in the threat assessment report 13 kmi2204 and the risk environment is described in the security risk analysis kmi2206 14 security objectives and policies to mitigate the identified risks are stated in volume 215 implementation requirements to enable the kmi to meet those objectives and enforce those16 policies are stated partly in this document and partly in volumes 1 and 217 22 u objectives policies and guidelines18 ufouo volume 2 defines kmis basic security objectives as follows19 ufouo access control protect all kmi resources from unauthorized use 20 ufouo information security protect all kmi information from unauthorized 21 disclosure modification destruction or loss 22 ufouo service availability protect the kmi system against denial of service to its 23 authorized users 24 ufouo system integrity protect all kmi system elements to ensure their continued and 25 correct operation 26 ufouo user authentication verify the identity of system entities before permitting 27 them to access system resources 28 ufouo user accountability enable kmi managers to trace the initiation of system 29 activities to individual users that can be held responsible for the consequences of the 30 activities 31 ufouo management control enable kmi managers to 1 configure kmi security 32 characteristics 2 ensure that the system meets applicable security pollicies and 3 enable 33 interoperation with peer systems including other key management infrastructures and other 34 external systems 35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 8ufouo these objectives provide basis for more detailed security policies and functional1 security requirements that are stated in volume 2 among those policies is the following 2 guideline3 ufouo general policy on system architecture to achieve its security objectives in 4 manner that supports the goals of the department of defense the kmi must apply defense5 indepth strategy to an architecture that is based on set of information enclaves that have6 welldefined security perimeters7 ufouo defense in depth is concept for deploying protections in multiple places and in8 multiple layers so that if one protective mechanism is defeated one or more other mechanisms9 which are thought of as being behind beneath or parallel to the first mechanism10 continue to provide security to provide defense in depth this security architecture describes 11 highlevel allocation of architectural security features and assurances to the various kmi nodes12 and their components and provides rationale for the allocation based on the security13 objectives14 ufouo this security architecture and the rest of the ci2 functional architecture that is 15 described in volume 1 state detailed requirements that implement the following general16 requirements17 ci2sar22a ufouo modular components the kmi shall implement modular 18 architecture that will support flexibility to add or delete products upgrade components and 19 add or modify system interfaces so that the kmi can evolve over time with minimal 20 architectural impact drv krd 1180 z 21 ci2sar22b ufouo protected connections the kmi shall not provide an 22 unprotected direct connection between components that are dedicated to different isolated 23 information processing security domains krd 1387 z 24 ci2sar22c ufouo protected core components of core nodes see security 25 perimeters section shall be protected by nsaapproved suite of network security devices 26 and protections including inline network encryption boundary protection and detection of 27 intrusions and malicious code drv krd 0834 prst 28 ci2sar22d ufouo isolated domains the kmi shall be capable of concurrently 29 serving client nodes and interacting with other systems where each client node and non 30 kmi system operates in specific security domain based on classification nationality or 31 affiliation eg us cceb nato coalition etc drv krd 1386 r 32 23 u clientserver model and transaction model33 ufouo the kmi includes numerous instances of clientserver operations in which client34 process sends service request to server process and the server receives the request performs35 the service and returns message perhaps with some resultant data these clientserver36 operations involve transactions transaction is series of units of work called events to 37 achieve the kmis security objectives transactions and events need to be designed so that they38 are atomic consistent isolated and durable gray39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 9 u atomic an event is an allornothing function all actions that comprise the transaction 1 should be completed or else none should happen2 u consistent an event satisfies correctness constraints defined for the data that is being 3 processed4 u isolated if two events are performed concurrently the events do not interfere with each 5 other and it appears as though the system performs one event at time6 u durable system state and event semantics survive system failures 7 ufouo use of the clientserver and transaction models in distributed architecture also8 affects how security services are implemented in the kmi9 ufouo global consistency clientserver interactions and their supporting protocols 10 need to be designed to ensure database consistency across kmi nodes particularly during 11 periods of system instability so that security services that depend on system databases are 12 not compromised 13 ufouo identity authentication clientserver interfaces at several levels not just at the 14 clientprsn level need to incorporate mechanisms to authenticate client and server 15 identities to each other 16 ufouo process authorization transaction processing functions at several levels need 17 to incorporate access control mechanisms to ensure that transactions are authorized for 18 clients that request them 19 ufouo interface restriction the number type and complexity of interfaces between 20 clients and servers and through which transactions are handled need to be kept to minimum 21 to better assure that security policies are correctly and consistently enforced at the interfaces 22 ufouo state awareness if system function requires that multiple transactions be 23 performed over relatively long period of time the function needs to incorporate 24 mechanisms specifically to maintain continued correct awareness of system state to ensure 25 secure operation of the function 26 24 u defense in depth27 ufouo the dod information assurance ia technical framework iatf iatf adopts 28 defense in depth as the fundamental strategy for protecting computer systems and their29 interconnecting networks this security architecture follows the iatf guidance for resisting 30 attack from multiple directions by either insiders or outsiders31 ufouo the defenseindepth concept is appealing because it aligns with traditional warfare32 doctrine but the concept has traditionally been applied to geospatial structures rather than33 cyberspace structures applying the concept to distributed networkbased information systems34 involves an assumption that such systems can have spatial or topological representation it35 assumes that one can implementfrom the outer perimeter of network through its various36 layers of components to its center which consists of the subscriber application systems37 supported by the networka varied series of countermeasures that together provide adequate38 protection however it can be difficult to map the topology of computer systems and make39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 10certain that path exists by which an attacker can bypass defensive layers and damage the1 center therefore the iatf enumerates defenseindepth objectives for various focus areas and2 this security architecture implements those objectives where appropriate 3 ci2sar24a ufouo the kmi shall incorporate the defenseindepth security 4 principles of the information assurance technical framework iatf krd new z 5 ufouo one iatf defenseindepth focus area is defense of networks and their6 infrastructure the iatf states the following guidelines for this area however not all are7 directly applicable to the kmi security architecture some apply to networks to which the kmi8 connects but which are not part of the kmi9 u protect local and wide area communications networks 10 u provide confidentiality and integrity service for data transmitted over these networks 11 u ensure that all data exchanged over wide area networks is protected from disclosure to 12 anyone not authorized to access the network 13 u ensure that wide area networks supporting missioncritical and missionsupport data 14 provide appropriate protection against denialofservice attacks 15 u protect against delay misdelivery or nondelivery of otherwise adequately protected 16 information 17 u protect from traffic flow analysis both user traffic and network infrastructure control 18 data 19 u ensure that protection mechanisms do not interfere with otherwise seamless operation 20 with other authorized backbone and enclave networks 21 ufouo some kmi requirements for the first focus area are stated in this security 22 architecture and other requirements for this area are stated in volume 2 the stated 23 requirements provide for strong separation between networks operating in different security24 domains and seek to ensure network availability even in the event of denialofservice attacks25 u second iatf defenseindepth focus area is defense of enclave boundaries the iatf26 states the following guidelines for this area27 u ensure that physical and logical enclaves are adequately protected 28 u enable dynamic throttling of services in response to changing threats 29 u ensure that systems and networks within protected enclaves maintain acceptable 30 availability and are adequately defended against denialofservice intrusions 31 u ensure that data exchanged between enclaves or via remote access is protected from 32 improper disclosure 33 u provide boundary defenses for those systems within the enclave that cannot defend 34 themselves due to technical or configuration problems 35 u provide riskmanaged means of selectively allowing essential information to flow 36 across the enclave boundary 37 u provide protection against the undermining of systems and data within the protected 38 enclave by external systems or forces 39 u provide strong authentication and thereby authenticated access control of users sending 40 or receiving information from outside their enclave 41kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 11ufouo some kmi requirements for the second focus area are stated in this security 1 architecture and other requirements for this area are stated in volume 2 the requirements 2 provide protected perimeter for security enclaves control the flow of information passing3 across security levels control access by remote locations and remote users and use network4 based attack sensing warning and response aswr capabilities to identify vulnerabilities5 attacks and suspicious activities and provide appropriate responses interconnection of kmi6 components to outside systems is done only in controlled fashion with adequate assurance7 kmi functions that require open uncontrolled access to and from other systems are isolated and8 have adequate safeguards to enforce security policy9 u third iatf defenseindepth focus area is defense of the computing environment the10 iatf states the following guidelines for this area11 u ensure that clients servers and applications are adequately defended against denial of 12 service unauthorized disclosure and modification of data 13 u ensure the confidentiality and integrity of data processed by the client server or 14 application both inside and outside of the enclave 15 u defend against the unauthorized use of client server or application 16 u ensure that clients and servers follow secure configuration guidelines and have all 17 appropriate patches applied 18 u maintain configuration management of all clients and servers to track patches and system 19 configuration changes 20 u ensure that applications can be readily integrated with reduction in security 21 u ensure adequate defenses against subversive acts by trusted persons and systems both 22 internal and external 23 ufouo some kmi requirements for the third focus area are stated in this security 24 architecture and other requirements for this area are stated in volume 2 the requirements 25 provide for protected computing environment to support security services and also provide for26 hostbased aswr capabilities to identify vulnerabilities attacks and suspicious activities and27 provide appropriate responses28 25 u compliance29 ufouo this security architecture ensures compliance with the security policy 30 kmi2200v2 through protection and controlled usage of system resources through user31 accountability and through security assurance in the following subsections these security topics32 are informally mapped to the section titles in volume 233 251 u resource protection34 ufouo this security architecture defines security perimeters for ci2 nodes and enclaves 35 and protects system resources inside the perimeters from unauthorized use modification36 disclosure destruction or loss components inside the perimeters incorporate mechanisms that37 provide protection for all resources for which the kmi is responsible interconnection of38 protected components to external systems is done only in controlled fashion table 139 informally maps resource protection areas to sections of volume 240kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 12table 1 u kmi resource protection policy elements 1 sections in volume 2 emanations security information confidentiality encryption key managementinformation protection information content integrity archive communication between kmi nodes product ordering product generation product handling product distribution product accountingservice protection marking unclassifiedfouo 2 ufouo controlled usage is the property of the kmi that limits user activities to those for3 which the users are authorized controlled usage is established primarily by the access4 control section of volume 2 and the access control services section of this security 5 architecture the kmi limits user access to system resources according to 1 attributes 6 associated with the resources eg classification ownership 2 attributes associated with the7 requested function eg authorizations and 3 attributes associated with user identity eg8 clearance roles domains needtoknow9 252 u user accountability10 ufouo user accountability is the property of the kmi that enables system activities to be11 traced uniquely to individual users or other causes that can be held responsible for the activities12 to establish user accountability the kmi registers users and requires evidence that they are13 eligible to access the system then the kmi identifies users uniquely whenever they access the14 system using strong means of user identity authentication that are incorporated uniformly across15 the entire system administrative activities are tracked by audit and aswr systems the kmi16 records information that associates users with kmi activities performed on their behalf the17 kmi enables authorized managers to access and evaluate the accountability information by18 secure means within reasonable amount of time and without undue difficulty table 219 informally maps the user accountability area to sections in volume 220kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 13table 2 u kmi user accountability policy elements 1 sections in volume 2 user registration user identification identity authentication peer entity authenticationassured identification audit data origin authentication activity tracking nonrepudiation unclassifiedfouo 2 253 u assurance3 ufouo assurance is an attribute of the kmi that provides grounds for believing the system4 operates in way that enforces the security policies stated in volume 2 and satisfies the5 functional security requirements stated in this security architecture and in volumes 1 and 2 the 6 design of kmi components must accurately interpret the security policy and not distort the intent7 of that policy assurance must be provided that correct implementation and operation of the8 policy exists throughout the systems lifecycle this objective is addressed through9 requirements for developmental assurance operational assurance and continuous operations10 table 3 informally maps the assurance areas to sections in volume 211 table 3 u kmi security assurance policy elements 12 sections in volume 2 security services computer security communication security configuration controldevelopmental assurance certification security implementation testing accreditation extend trust system integrity security configurationsecurity management attack sensing warning and response personnel security security training and awarenessoperational assurance personnel security outside users physical security continuous operations system availability contingency planning unclassifiedfouo 13 ufouo developmental assurance involves requirements that mandate policies for 14 security services and that ensure secure implementation of the services 15kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 14 ufouo operational assurance involves requirements that mandate the accreditation of 1 kmi components and ensure their secure operation secure operation relies on the use of2 trustworthy kmi management personnel and reliable management features also attack3 sensing warning and response services need to be implemented across all components4 within the kmi security perimeter5 ufouo continuous operations involves requirements that ensure system availability 6 the kmi should be both available and secure at all times but in some situations the system7 also needs to support degraded operational modes8 ufouo ci2 components gain approval to operate through formal process that satisfies the 9 dod information technology security certification and accreditation process ditscap 10 ditscap as required by volume 2 and as interpreted by the certification and accreditation 11 plan for key management infrastructure kmi capability increment 2 ci2 that will be 12 prepared by nsa the kmi certification and accreditation actions provide the framework for13 establishing overall assurance for the kmi and they provide the basis for systemwide site14 level and componentlevel assurance the kmi certification and accreditation effort addresses15 developmental deployment and postdeployment assurance issues16 ufouo the ditscap is the standard dod process for identifying information security17 requirements providing security solutions managing information system security activities and18 certifying and accrediting both classified and unclassified systems the ditscap defines the19 activities upon which overall kmi security assurance is based and the documentation generated20 by the ditscap provides kmi systemwide assurance evidence personnel and administrative21 security measures are expected to be identified and documented as part of the ditscap22 ufouo the kmi is expected to be implemented with robust commercialofftheshelf23 cots products that provide strong assurance augmented by government offtheshelf24 gots products where cots products do not exist or are not sufficiently robust as specified25 in volume 2 products need to be evaluated or certified against common criteria protection26 profiles or against other nsaapproved criteria such as the unified infosec criteria27 reftbd1 components that implement cryptographic functions need to meet federal28 information processing standards fips or meet other nsaapproved standards29 30kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 153 u architectural elements1 ufouo this security architecture together with volumes 1 and 2 assigns security 2 functions to the components of kmi nodes in ci2 so that the composite system achieves its3 basic security objectives and also satisfies the following control statement4 control nt ufouo dcfa1 functional architecture for ais applications 5 integrity for ais applications functional architecture that identifies the following has 6 been developed and is maintained dodi850027 all external interfaces the information being exchanged and the protection mechanisms 8 associated with each interface 9 user roles required for access control and the access privileges assigned to each role 10 unique security requirements eg encryption of key data elements at rest 11 categories of sensitive information processed or stored by the ais application and their 12 specific protection plans 13 restoration priority of subsystems processes or information 14 ufouo this section explains some of the architectural concepts that support those15 assignments the concepts include user roles and their authorizations user access modes16 security perimeters of protected resources protected channels that connect components and17 structuresenclaves and zonesthat provide modularity and domain isolation18 31 u user roles and permissions19 ufouo registered user abbreviated as user is system entity authorized to access the 20 kmi by invoking an identity that has previously been established in the system the kmi cannot21 prevent unauthorized entities in its environment from attempting to access its system resources22 but the kmi blocks such unauthorized access as much as possible the kmi provides products23 and services only to authorized entities and all authorized entities must first be registered as24 users before they can receive products or services25 ufouo whenever human user accesses the kmi the user acts in specific assigned role26 and with an assigned set of permissions registered user device is not assigned to role each27 permission that has been assigned to role enables person acting in that role to perform a28 specific type of system action against one or more system resource objects29 definition ufouo role job title in the kmi system that 1 has specified set of 30 functional responsibilities within the system 2 can be granted one or more permissions 31 and 3 can have one or more users assigned to it 32 definition ufouo permission an positivelystated authorization for access that 33 1 can be associated with one or more roles and 2 enables user in role to access 34 specified set of system resources by causing specific set of system actions to be 35 performed on the resources 36 definition ufouo system action specific function or behavior of the kmi that 37 accesses and possibly affects one or more resource objects 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 16definition ufouo resource object specific system resource that 1 can be 1 accessed by system action and 2 can be protected by access control services2 ufouo system action is implemented by an executable image of computer program3 which upon invocation performs some function for user ansi resource object in the4 context of the kmi usually take the form of product service or an operational or5 administrative mechanism6 ufouo in this security architecture permissions are not directly assigned to user identities 7 instead permissions are assigned to roles so that as defined in the common criteria 8 is154082 role becomes set of rules establishing the allowed interactions between user9 and the system then user identities are assigned to roles as appropriate for user responsibilities10 the assignment process is fully described in the rolebased access control section both11 role assignments and objects may be assigned attributes that can cause the kmi to constrain the12 exercise of permission the application of attributes and constraints to the process of13 requesting and distributing products for type 1 devices is specified in the rulebased access14 control section15 ufouo some kmi roles and permissions are built into the system to be available for use at16 system startup new permissions may be added to the system through the introduction of new17 software functionality and authorized kmi managers can create new roles and add new18 permissions to existing roles to meet evolving needs the builtin roles which are listed in table19 4 include several management roles and one nonmanagement role the nonmanagement role20 is called koa agent and is described in the approvalbased access control section21 ufouo volume 2 describes the processes that register users and authenticate their identities22 when they access the system to each registered user identity the kmi assigns an identifier and23 associated authentication material the type of authentication material depends on the24 authentication mechanism that is used for the role or roles to which the identity is assigned25 311 u management roles26 ufouo qualified human users are assigned as managers that operate or administer the kmi27 definition ufouo manager human user that directs controls or regulates some 28 set of system resources 29 definition ufouo management role role that has permissions that enable 30 registered user to direct control or regulate some set of system resources 31 ci2sar311a nt ufouo the kmi shall implement at minimum set of 32 management roles sufficient to perform the system management duties stated in the krd 33 drv krd 1787 z 34 ci2sar311b ufouo before permitting user identity to access the kmi in 35 management role the kmi shall authenticate the user identity through either type 1 36 cryptographic mechanism or another method that has equivalent strength and assurance 37 drv krd 1062 z 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 17table 4 u kmi roles 1 role types role names external operational management rolesorderinganddistribution managers product managers controlling authority command authority product requester koa manager registration managers koa registration manager user registration managers personnel registration manager device registration manager includes klif mgr access control managers enrollment manager user support managers serviceagency help desk manager external administrative management rolesclient node administrators client platform administrator client platform security officer internal operational management rolesaccess control service managers role manager toplevel enrollment manager user support service managers library manager help desk manager event service manager catalog service managers catalog manager internal administrative management rolessecurity administrators aka system security officers aswr manager audit data manager security configuration manager incident response manager core node administrators platformnetwork manager archive manager backup manager database managers accounting data manager tracking data manager nonmanagement roles nonmanagement users koa agent unclassifiedfouo 2 ufouo this security architecture states requirements for several kmi management roles 3 as shown in table 4 the management roles can divided into internal and external classes4kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 18definition ufouo internal management role role that is intended to be 1 performed by person who is member of the central organization that controls the kmi2 definition ufouo external management role role that is intended to be 3 performed by manager that typically is member of kmi customer organization4 ufouo the management roles also can be divided into operational and administrative5 definition ufouo operational manager manager that performs functions 6 directly involving the production of products and services or that supervises such functions7 ufouo operational managers use kmiissued credentials to authenticate their identity to the8 system and they obtain authorizations for their actions through kmis rolebased rulebased9 and approvalbased access control mechanisms10 definition ufouo administrative manager manager that performs housekeeping 11 functions that support the work of operational managers and koa agents but usually do not 12 directly involve kmi products and services 13 ufouo some examples of administrative functions are installing and maintaining software14 configuring accounts auditing for security and doing backup and recovery many administrative15 functions are common to all computing and communication platforms like operational16 managers administrative managers may use kmiissued credentials and rolebased permissions17 for some work but they also obtain authorizations through platformbased security mechanisms18 of operating systems and applications19 312 u user access modes20 ufouo users access prsns in three different modes21 ufouo interactive webbased access user can employ web browser to interact 22 with web server that is component of prsn this mode is intended for human users 23 who act in management role or as koa agent and who remotely access prsn with 24 browser that is part of their client node this type of clientprsn dialogue is conducted via 25 protected communication channel 26 ufouo noninteractive transactionbased users user can participate in highly 27 structured transaction dialogue between client node and prsn this mode is intended 28 for users that are automated devices acting as koa agent this type of clientprsn 29 dialogue is conducted via protected communication channel 30 ufouo interactive direct component access human users who act in certain 31 management roles can directly access computer platforms that are components of prsns 32 psns and the csn this mode may involve variety of specific interface types including 33 webbased transactionbased and others these users often access platforms locally but 34 when the access is remote the dialogue is conducted via protected communication channel 35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1932 u resource protection1 ufouo this security architecture defines layered security perimeters within which system 2 components and resources are protected it also states requirements for protected channels that3 enable communications to take place between protected components4 321 u security perimeters5 ufouo the kmis defenseindepth architecture is based on layered and complementary6 security perimeters that enclose system nodes figure 3 illustrates the main conceptual layers7 figure 3 u kmi security perimeters 8 9 unclassifiedfouo 10 ufouo internal management security perimeter client nodes that serve users acting 11 in the sensitive internal management roles operate inside the internal management security 12 perimeter and are subject to rigorous protections that are required for core nodes 13 ufouo external management security perimeter client nodes that serve users 14 acting in external management roles operate inside the external management security 15 perimeter these nodes also are usually treated as being within security perimeters of mission 16 systems and organizations that operate the nodes the nodes are primarily subject to kmi 17 security policy and secondarily to policies of those other systems and organizations but the 18 managers that operate the core nodes are not responsible for protecting these client nodes 19 ufouo registered users security perimeter client nodes that serve users acting in 20 the koa agent role are inside the registered users security perimeter and must be 21 protected in accordance with kmi policy however kmi policy is secondary for these 22 nodes their security is primarily the responsibility of the organizations that operate them 23 ufouo there are security perimeters in addition to these three each node has its own 24 individual security perimeter and is subject to specific protections defined for it also although25 figure 3 represents all nodes as single boxes some nodes especially prsns are implemented as26central services noderegistered users security perimeter client nodes of koa agents client nodes of internal managersproduct source nodesinternal management security perimeterexternal management security perimeter primary services nodes client nodes of external managerskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 20clusters or networks of components that each have local security perimeter defined by kmi1 policy and architecture any data communications that pass between two protected nodes or2 components and through an unprotected area outside the security perimeters are required to be3 carried by protected communication channel as described in the next section4 322 u protected channels5 ufouo kmi protected channel kpc is communication path that provides6 1 information integrity service 2 either data origin or peer entity authentication service as is7 appropriate to the mode of communication and 3 optionally information confidentiality8 service see communications services section of volume 2 the specific security services9 security mechanisms and level of assurance of kpc depend on the channels purpose and10 environment but the following requirements establish the basis for such specifications11 ci2sar322a ufouo kpc shall provide 1 information integrity service and 12 2 either data origin authentication service or peer entity authentication service and 13 3 may optionally provide information confidentiality service drv krd 0941 1026 14 z 15 ufouo figure 4 illustrates that when clients communicate with prsn or when clients of16 managers communicate with each other the dialogue is protected by kpc communications17 between prsn and other core nodesthe csn psns and other prsnsare primarily18 transactionbased and are carried by virtual private network created from kpcs19 communications between components inside prsn or other core node also may use kpc if20 the communication medium passes outside protected areas21 figure 4 u kmi protected channels between components 22 23 unclassifiedfouo 24 ufouo some operational and administrative functions require managers to connect directly25 to native interfaces of computer platforms in these cases the needed connection security is26 provided by physical means or by communication security mechanisms specific to the platform27 and are considered to be part of the component being managed28prsn client nodes of kmi managersclient nodes of koa agentsclient nodes of kmi managerscsn psns other prsns and ekms translator kpc kpckpc prsn internal kpc prsn internal kpc client nodes of user deviceskpckpc kpckmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 21ci2sar322b ufouo the kmi shall authenticate component identities when 1 necessary to meet its security objectives drv krd 1027 z2 ci2sar322c ufouo all information that the kmi transfers between 1 prsn 3 component and 2 client node through communication medium outside protected4 component security perimeters shall be carried by kpc that provides security services5 appropriate to the information and to the mode of communication drv krd 0842 08706 0941 0942 1026 cr7 ci2sar322m ufouo all information that the kmi transfers between two client 8 nodes of external managers ie between two client nodes that are not core nodes9 through communication medium outside protected component security perimeters shall be 10 carried by kpc that provides security services appropriate to the information and to the 11 mode of communication drv krd 0842 0870 0941 0942 1026 c 12 ci2sar322d ufouo all information that the kmi transfers through 13 communication medium outside protected component security perimeters 1 between 14 independent components of prsns 2 between prsn component and psn 15 component 3 between prsn component and csn component and 4 between psn 16 component and csn component shall be carried by kpc that provides security services 17 appropriate to the information and to the mode of communication drv krd 0842 0870 18 0942 1026 prst 19 ci2sar322e ufouo all information that the kmi transfers through 20 communication medium outside protected component security perimeters between the kmi 21 and cooperating nonkmi system shall be carried by kpc that provides security services 22 appropriate to the information and to the mode of communication drv krd 0842 0870 23 0942 1026 x 24 ci2sar322f ufouo the strength of mechanism and assurance of security services 25 for kpc shall satisfy the dcas and dcsr controls of dod instruction dodi 85002 26 dodi85002 according to the sensitivity of the information being transferred drv krd 27 1026 1536 see assurance levels section of volume 2 z 28 ci2sar322g ufouo the kmi shall use nsaapproved cryptography to secure 29 communications between components and cryptographic mechanisms must be keyed at 30 least at the highest of the systemhigh levels of the components drv krd 2129 z 31 ci2sar322m ufouo the kmi shall use nistcertified cryptography or better to 32 encrypt unclassified sensitive information as defined in dodi 85002 that 1 does not 33 affect the ordering and management of type 1 products and 2 is transmitted through 34 commercial or wireless network drv krd 2133 acr 35 ci2sar322h ufouo the kmi shall provide information confidentiality service on 36 kpc when required by the sensitivity of the information being transferred drv krd 37 1026 z 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 22ci2sar322i ufouo information confidentiality service shall be an available option 1 on kpcs between 1 client nodes operated by koa agents and 2 the prsn components2 through which those users receive kmi products and services drv krd 1026 cr3 ci2sar322j ufouo information confidentiality service shall be an available option 4 on kpcs between 1 client nodes operated by administrative managers and 2 the5 components they administer drv krd 0870 1026 cprst6 ci2sar322k ufouo information confidentiality service shall be an available 7 option on kpcs between 1 client nodes operated by operational managers and 2 the8 components they operate drv krd 0870 1026 acr9 ci2sar322l ufouo components that relay classified or sensitive messages shall 10 protect those messages from disclosure to local operators krd 0871 z 11 ufouo all managers and koa agents that use client to access prsn are registered and12 therefore able to authenticate their identity to the prsn see discussion of identification and13 authentication services in volume 2 all of those managers also have credentials that are needed14 to establish kpc however only some koa agents have such credentials and not all of the15 credentials are of the same type therefore as suggested by figure 4 not all of the kpcs used by16 koa agents are of the same type17 ufouo figure 5 illustrates that the kmi connects clients to prsns through two different18 types of standard kpcs which operate in different protocol layers19 figure 5 u kmi protected channel layers 20 21 unclassifiedfouo 22 pkibased kpc tls kpc this type of kpc is layered below the hypertext transfer 23 protocol http and kmi application protocols and above the transmission control 24 protocol tcp and is implemented with the transport layer security tls protocol 25 rfc3546 formerly known as secure sockets layer ssl protocol 26client node protocol stack browser http web protocol tls protocol formerly ssl haipe ipsec protocolprsn server protocol stack kmi application server http web protocol tls protocol formerly ssl haipe ipsec device protocolkpc based on pki keyscredentials kpc based on type1 credentialskmi applicationregistered userkmi transactions html exchanges to supplement tls transport control protocol tcptransport control protocol tcpkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 23 type 1 kpc this type of kpc is layered below tcp and above network substrate 1 protocols and it is implemented with type 1 endtoend encryption devices this kpc is2 implemented by an extended version of internet protocol security ipsec that is specified for3 the highassurance internet protocol encryptor haipe haipis4 definition ufouo type 1 cryptographic device classified or controlled 5 cryptographic item endorsed by the nsa for securing classified and sensitive us6 government information when appropriately keyed the term refers only to cryptographic7 devices and not to information key services or controls type 1 cryptographic devices8 contain classified nsa algorithms they are available to us government users their9 contractors and federally sponsored nonus government activities subject to export 10 restrictions in accordance with international traffic in arms regulation cnssi4009 11 ufouo the type of kpc needed for clients connection to prsn depends on the type of12 user that operates the client table 5 summarizes the various combinations13 table 5 u kmi protection for client node connections to prsns 14 type of user and client when users client node connects to prsns server human user acts in management roleclient uses both tls kpc and haipis kpcs tls kpc uses pki credentials that were issued to the user and server haipis kpc uses type 1 credentials that were issued to the client and prsns type 1 credentials human user acts as koa agent uses same client node as when acting as managerclient uses both tls kpc and haipis kpcs kpcs use the same credentials as when user acts as manager human user acts as koa agent uses nonmanagement client and pki credentialsclient uses tls kpc tls kpc uses the pki credentials that were issued to the user by the dod pki or other pki recognized by kmi and also uses servers pki credentials human user acts as koa agent uses nonmanagement client and identifierpasswordclient uses tls kpc tls kpc uses only servers pki credentials user device with client capabilityclient uses haipis kpc haipis kpc uses type 1 key management credentials of the user device and prsns type 1 credentials unclassifiedfouo 15 ufouo when client node makes webbased connection to prsn the clients browser16 or other access software normally establishes pkibased kpc in the tls layer so that the17 prsn can authenticate the identity of the user that is operating the client the tls kpc also18 provides data integrity for the connection that type of kpc alone may be adequate for when a19 koa agent connects to prsn however some system functions may require that the kpc20 also provide data confidentiality service and it is expected that the default configuration for all21 tls kpcs will include having data confidentiality service enabled22kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 24ufouo the identity authentication in the tls layer of webbased client enables the prsn1 server to determine what are the authorized roles and permissions of webbased user for a2 transactionbased client user identity can be established by digital signatures on the transaction3 protocol messages4 ufouo when user connects to prsn in management role kpc is required that is5 more robust than one based on pkibased tls the client must incorporate type 1 encryption6 device and establish type 1 kpc with counterpart type 1 device in the prsn so that the7 prsn can authenticate the managerclient combination as belonging to the type 1 community8 the type 1 kpc is in addition to the tls kpc and tls is carried over the type 1 kpc9 ufouo tls kpc for client access normally employs the users pki private key and10 publickey certificate in combination with the prsn servers key and credential and11 authenticates the identities of the user and server to each other in some cases however prsns12 may need to deliver key material to users that do not have pki credentials or to clients are not13 able to use their credentials when connecting to the prsn in these cases the tls kpc uses14 only the serviceside credential and authenticates only the server to the user the user stills need15 to be authenticated to the prsn but the prsn authenticates the user with an alternate16 mechanism usually an identifierpassword mechanism the alternate mechanism can be17 incorporated in hypertext markup language html exchanges or other application exchanges18 between the client and the prsn these exceptional cases are discussed further in the prsn19 product delivery enclaves section20 323 u domains enclaves and zones21 ufouo the kmi needs to meet requirements for component modularity see objectives22 policies and guidelines section and for isolation of components that operate at different levels23 of sensitivity24 dcsp1 security support structure partitioning integrity the security support 25 structure is isolated by means of partitions domains etc including control of access to and 26 integrity of hardware software and firmware that perform security functions the security 27 support structure maintains separate execution domains eg address spaces for each 28 executing process dodi85002 29 dcpa1 partitioning the application integrity user interface services eg web 30 services are physically or logically separated from data storage and management services 31 eg database management systems separation may be accomplished through the use of 32 different computers different cpus different instances of the operating system different 33 network addresses combinations of these methods or other methods as appropriate 34 dodi85002 35 ci2sar323a ufouo the kmi shall ensure that user interface services eg web 36 services are physically or logically separated from data storage and management services 37 eg database management systems per dodi 85002 control dcpa1 drv krd 2120 38 r 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 25ufouo ebpw1 public wan connection confidentiality for components that 1 process sensitive information connections between dod enclaves and the internet or other2 public or commercial wide area networks require demilitarized zone dmz3 dodi850024 ufouo the ci2 architecture meets requirements for modularity and isolation by using5 nested structures as illustrated by figure 6 to separate components that perform different6 functions and that serve different communities of clients kmi nodes 1 intersect security7 domains 2 contain security enclaves that lie inside the domains and 3 contain security zones8 that are subdivisions of the enclaves9 figure 6 u kmi domains enclaves and zones 10 11 unclassifiedfouo 12 definition ufouo security domain set of system entities that operate under 13 common security policy including operating at the same security level 14 ufouo security level is the combination of hierarchical classification designation and a15 set of nonhierarchical category designations which together represent the disclosure sensitivity16 of specified type or item of information17 ufouo this nodal security architecture section incorporates the following assumptions18 which ensure that automated components of the kmi system cannot move information from one19 classification level to another without authorization20prsn 1 prsn 2domain 1 domain 2 enclave 3 enclave 4 public zonebuffer zoneprivate zone public zonebuffer zoneprivate zoneenclave 1 enclave 2 public zonebuffer zoneprivate zone public zonebuffer zoneprivate zonekmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 26 ufouo singlelevel platforms except in multilevel guard devices that are specifically 1 designed to connect domains that operate at different security levels see data replication2 section below each computer platform in prsn or the csn is singlelevel component3 that operates at the security level of its containing domain4 ufouo singlelevel clients each client node is singlelevel component that operates 5 at the security level of its containing domain6 ufouo singlelevel tokens each pki hardware token that the dod pki issues to user 7 is singlelevel component that operates at either unclassified or ussecret8 ufouo ci2 nodes maintain separation between security domains however as illustrated9 by figure 6 single node can contain security enclaves belonging to two or more domains10 definition ufouo security enclave set of components that operate in the same 11 security domain and share the protection of common continuous security perimeter 12 ufouo this is kmispecific case of the definition stated in dodd8500113 collection of computing environments connected by one or more internal networks under 14 the control of single authority and security policy including personnel and physical 15 security enclaves provide standard ia capabilities such as boundary defense incident 16 detection and response and key management may be specific to an organization or 17 mission and the computing environments may be organized by physical proximity or by 18 function independent of location examples of enclaves include local area networks and the 19 applications they host backbone networks and data processing centers 20 ufouo security enclave within ci2 prsn is composed of one or more security zones21 definition ufouo security zone logically contiguous subdivision of security 22 enclave that is each component in security enclave is contained in one of the enclaves 23 security zones each zone has welldefined security perimeter part of which may be 24 formed by the perimeter of the enclave 25 ufouo an prsn uses three types of processing zonespublic buffer and private as26 illustrated by figure 6to separate its exposed frontoffice functions from its more sensitive27 back office functions and this zone structure could be used by other components too28 ufouo public zone all interactions with system entity prior to the user being either 29 authenticated as registered user or rejected are intended to be handled entirely by system 30 components that operate in public zone thus this type of zone contains the components 31 that have the greatest exposure to networkbased threats 32 ufouo buffer zone after an entity has been authenticated as registered user further 33 interactions with the entity are intended to be handled initially in buffer zone less 34 sensitive product and service requests are intended to be handled entirely in buffer zone 35 without any communication with private zone 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 27 ufouo private zone more sensitive requests are intended to be preprocessed in the 1 buffer zone and then processed in final form in the private zone however registered user2 communicates directly only with the buffer zone communications between registered user3 and the private zone are handled indirectly through proxy in the buffer zone4 ufouo the following statement is the basic requirement for enclaves and zones and for the5 boundary protection suites bpss that separate and protect them6 ci2sar323b ufouo the kmi shall be divided into multiple security enclaves and 7 security zones of progressively increasing security sensitivity and overall protection access8 to each enclave and zone except the least sensitive shall only be possible via boundary9 protection suites that enforce authenticated controlled access from an adjoining enclave or 10 zone the least sensitive enclave or zone may permit access via boundary protection suites 11 from generalpurpose networks eg niprnet and siprnet by entities that initially have 12 not been authenticated drv krd 1998 prs 13 ufouo in the previous requirement niprnet is the dods commonuse nonclassified14 internet protocol router network and siprnet is the dods commonuse secret internet15 protocol router network the phrase initially have not been authenticated refers for example16 to the fact that web browser must complete connection to web server before the server can17 request password from the browser18 ufouo the following section states requirements that apply to every kmi bps additional19 requirements for individual zones enclaves and bpss in prsns and the csn are stated in the20 nodal structures section in that section the specific implementation of zones in prsn is21 described in the prsn security zones subsection22 324 u perimeter defense23 ufouo communications that pass through security perimeters of domains enclaves and24 zones are mediated by special components25 control ufouo ecic1 interconnections among dod systems and enclaves 26 confidentiality discretionary access controls are sufficient ia mechanism for 27 connecting dod information systems operating at the same classification but with different 28 needtoknow access rules controlled interface is required for interconnections among 29 dod information systems operating at different classifications levels or between dod and 30 nondod systems or networks controlled interfaces are addressed in separate guidance 31 dodi85002 32 control ufouo ebbd3 boundary defense confidentiality for components 33 that process classified information boundary defense mechanisms to include firewalls and 34 network intrusion detection systems ids are deployed at the enclave boundary to the wide 35 area network and at layered or internal enclave boundaries and key points in the network as 36 required all internet access is prohibited dodi85002 37 ufouo the last sentence of ebbd3 contradicts krd 2031 this security architecture 38 interprets the all internet access is prohibited part of the ebbd3 control to mean that direct39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 28endtoend exchanges of data are prohibited between classified kmi security domain and the1 unclassified domain of the public internet including niprnet which is dodowned part of2 the internet this architecture observes that prohibition for all classified kmi security domains 3 however this architecture also uses type 1 endtoend encryption devices to create kpcs 4 across the unclassified internet between classified kmi security enclaves5 control ufouo ebbd2 boundary defense confidentiality for components 6 that process sensitive information boundary defense mechanisms to include firewalls and7 network intrusion detection systems ids are deployed at the enclave boundary to the wide8 area network at layered or internal enclave boundaries and at key points in the network as9 required all internet access is proxied through internet access points that are under the 10 management and control of the enclave and are isolated from other dod information systems 11 by physical or technical means dodi85002 12 ufouo ids capabilities of ci2 components are specified in the attack sensing warning13 and response service section of volume 2 to implement ecic1 ebbd3 and ebbd2 this14 security architecture specifies controlled interfaces called boundary protection suites and 15 some of the bpss are guards16 definition ufouo boundary protection suite bps component that 1 is data 17 communication gateway into security enclave or security zone and 2 regulates data 18 communication traffic to and from the enclave or zone 19 definition ufouo guard bps that 1 connects components that operate in 20 different security domains 2 is trusted to prevent unauthorized disclosure of data from one 21 domain to the other if that service is required by the respective security levels of the 22 components and 3 is trusted to protect the data integrity and system integrity of each 23 domain against threats actions communicated from the other 24 3241 u boundary protection suites25 ufouo bps primarily protects the data integrity and system integrity of components in an26 enclave or zone against threat actions originating outside and may also protect components27 outside the zone from those inside in some cases bps may provide confidentiality service for28 data being exchanged with another enclave or zone systems that perform bps functions are29 often called firewalls and the interzone confidentiality service is sometimes called virtual30 private network vpn31 ufouo the word suite is used here because contemporary bpss often consist of multiple32 components or platforms for example bps may consist of pair of filtering routers and one33 or more proxy servers running on one or more bastion hosts all connected to small dedicated34 local area network that acts buffer zone between the two routers the external router might35 block attacks that use the internet protocol ip to break security while the internal router might36 block traffic from leaving the protected network except through proxy servers which block37 attacks that attempt to exploit vulnerabilities in higher layer protocols or services38 ufouo this section states requirements that apply to all bpss and the nodal structures39 section states additional requirements for specific bpss and guards40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 29ci2sar3241a ufouo computer platform that implements functions of bps in 1 security zone shall be physically separate from other components of that zone that the2 bps protects drv krd 1180 1568 rs3 ufouo the dcpp1 control is implemented by the four requirements that follow it the4 outsourced part of this control does not apply to ci2 because the system description and 5 requirements specification kmi2200 does not incorporate any outsourced components 6 control ufouo dcpp1 ports protocols and services availability dod 7 information systems comply with dod ports protocols and services guidance ais8 applications outsourced itbased processes and platform it identify the network ports9 protocols and services they plan to use as early in the life cycle as possible and notify 10 hosting enclaves enclaves register all active ports protocols and services in accordance 11 with dod and dod service and agency guidance dodi85002 12 ci2sar3241b ufouo the application and network servicesie 1 the 13 communication protocols and 2 the channel bandwidththat bps permits to pass through 14 itself to specific component that the bps protects shall be the minimum that the 15 component needs to perform its function drv krd 0901 0903 0906 1999 rs 16 ci2sar3241c ufouo bps shall include features to limit the bandwidth of 17 potential covert channels in the communications that the bps permits to pass through itself 18 drv krd 1999 rs 19 ci2sar3241d ufouo bps that is component of core node and connects that 20 core node to another node via communication path outside those nodes shall use only 21 approved ports for supported protocols and services and shall block all other ports and 22 protocols in accordance with dod procedures for managing those communication 23 mechanisms dodi85002 drv krd 0901 0903 0906 prst 24 ci2sar3241e ufouo bps that is component of core node and connects that 25 core node to another node via communication path outside those nodes shall use network 26 address translation nat technology where appropriate to hide internet protocol addresses 27 internal to the core node krd new prs 28 ufouo the ecim1 and ecvi1 controls are implemented by the two requirements that29 follow them30 control ufouo ecim1 instant messaging integrity not applicable to ci2 31 ci2 does not implement instant messaging instant messaging traffic to and from instant 32 messaging clients that are independently configured by end users and that interact with 33 public service provider is prohibited within dod information systems both inbound and 34 outbound public service instant messaging traffic is blocked at the enclave boundary note 35 this does not include im services that are configured by dod ais application or enclave to 36 perform an authorized and official function dodi85002 37 control ufouo ecvi1 voice over ip availability not applicable to ci2 ci 38 2 does not implement voice over ip voice over internet protocol voip traffic to and 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 30from workstation ip telephony clients that are independently configured by end users for1 personal use is prohibited within dod information systems both inbound and outbound2 individually configured voice over ip traffic is blocked at the enclave boundary note this3 does not include voip services that are configured by dod ais application or enclave to4 perform an authorized and official function dodi850025 ci2sar3241f ufouo the kmi shall not implement 1 an instant messaging 6 capability or 2 voiceoverinternet protocol capability drv krd 2136 2142 ars7 ci2sar3241g ufouo bps that protects security enclave or security zone of 8 core node or of client node that supports external operational managers shall block 19 all instant messaging protocols and 2 all voiceoverinternet protocol service drv krd 10 2142 prst 11 ufouo the following three requirements implement vpn connections to core nodes12 ci2sar3241h ufouo bps that is component of core node and connects that 13 node to another core node shall be able to establish type 1 kpc as needed to protect the 14 communications between those nodes drv krd 1062 prs 15 ci2sar3241i ufouo bps that is component of core node and connects that 16 node to noncore client node that serves manager shall be able to establish both 1 17 pkibased kpc using dod credentials and 2 type 1 kpc as needed to protect the 18 communications between those nodes drv krd 1062 r 19 ufouo the preceding requirement applies to instances of bpsome in prsn and the20 following requirement applies to instances of bpspde in prsn as described in the nodal21 structures section22 ci2sar3241j ufouo bps that is component of prsn and connects that 23 node to client node that serves koa agent shall be able to establish 1 both pki 24 based kpc and type 1 kpc or 2 only pkibased kpc as needed to protect the 25 communications between the nodes krd new r 26 3242 u guards27 ufouo guard is bps that primarily prevents unauthorized disclosure of data from one28 domain to another however guard might also protect the data integrity availability or general29 system integrity of one system from threats posed by connecting to the other system systems30 that perform guard functions are sometimes called filters31 ci2sar3242a ufouo components operating at different classification levels 32 shall interconnect only through highassurance guard drv krd 2134 2135 prs 33 34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 314 u nodal structures1 ufouo ci2 has four basic types of physically separate nodesclient nodes prsns2 psns and the csnas illustrated by figures 2 and 3 this section describes each of the node3 types but concentrates mostly on the structures and functions of prsns and their interfaces with4 other nodes5 ci2sar4a ufouo the functions of each node shall be implemented by hardware and 6 software systems that are physically separate from all other nodes krd 1370 z7 41 u client nodes8 ufouo client nodes are information systems through which users interact with prsns the9 types of components and interfaces that comprise client node vary depending on the kmi role10 that is played by the nodes user user accesses the system in one of the several manager roles11 or in the koa agent role12 control ufouo ebru1 remote access for user functions confidentiality 13 all remote access to dod information systems to include telework access is mediated 14 through managed access control point such as remote access server in dmz remote 15 access always uses encryption to protect the confidentiality of the session the sessionlevel 16 encryption equals or exceeds the robustness established in controls that require encryption to 17 provide confidentiality for data in transit authenticators are restricted to those that offer 18 strong protection against spoofing information regarding remote access mechanisms eg 19 internet address dialup connection telephone number is protected dodi85002 20 ci2sar41a ufouo all remote access to the kmi shall be mediated through 21 managed access control point such as remote access server in security zone krd 22 2128 r 23 ufouo the ebru requirement is further implemented by several requirements in other24 sections in this security architecture and in volume 2 25 411 u client nodes serving managers26 ufouo operational and administrative managers use client nodes to securely communicate27 with prsns in support of system management activities all client nodes that serve kmi28 managers need to be protected in accordance with volume 2 and this nodal security29 architecture section client nodes that serve internal managers are inside the more strongly30 protected internal management security perimeter see figure 3 and must be protected31 according to additional stringent security requirements for core nodes32 ufouo ebrp1 remote access for privileged functions confidentiality remote 33 access for privileged functions is discouraged is permitted only for compelling operational 34 needs and is strictly controlled in addition to ebru1 sessions employ security measures 35 such as vpn with blocking mode enabled complete audit trail of each remote session is 36 recorded and the information assurance manager reviews the log for every remote session 37 dodi85002 krd 2125 2126 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 32ufouo dod instruction 85002 defines the information assurance manager iam as the1 individual responsible for the information assurance program of dod information system or2 organization while the term information assurance manager is favored within the department3 of defense it may be used interchangeably with the ia title information systems security4 manager issm the iam is also mentioned in the ecpa1 control that is quoted in the5 rolebased access control section of this security architecture however the iam role 6 which obviously encompasses very broad range of duties is not directly implemented by any7 single role in the kmi rolebased access control architecture instead some of the duties of the8 iam role are divided among multiple internal administrative management roles in kmi and9 other iam duties are outside the scope of this architecture10 ci2sar412a ufouo the kmi shall use kpcs per dodi 85002 ebrp1 11 dodi85002 to secure connections between remote manager client and component of 12 core node drv krd 2125 cr 13 ufouo additional requirements for connecting remote managers are specified in the14 protected channels section15 ci2sar412b ufouo the kmi shall record for audit each session between remote 16 manager client and component of core node drv krd 2126 cr 17 ufouo additional requirements for auditing management sessions are specified in the18 audit services section of volume 219 412 u client nodes serving koa agents20 ufouo clients that serve koa agents are outside the external management security21 perimeter see figure 3 but the kmi provides the following security services that benefit koa22 agents23 ufouo system availability the kmi protects prsn psn and csn resources to 24 ensure that kmi products and services authorized for koa agents are accessible and usable 25 upon demand by those users 26 ufouo data integrity and origin authentication the kmi enables koa agents to 27 verify the origin and integrity of data products that the system provides to those users 28 ufouo the clients used by koa agents need to be able to perform the network29 communication protocols through which prsns provide access to products and services this30 includes being able to establish kpcs by which clients connect to prsns see protected31 channels for prsns section below at minimum this means performing tls functions using32 serverside x509 publickey certificate33 ufouo the products available to koa agent are 1 products that have previously been34 requested or authorized for that the agents account by manager and 2 library resources that35 are available to all accounts the general mechanism for providing data integrity and data origin36 authentication for those products is cryptographic digital signature to take advantage of those37 security services clients used by koa agents may need to be able to verify digital signatures38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 33including performing any necessary pki functions such as obtaining and using publickey1 certificates and certificate revocation lists2 413 u client nodes serving devices3 ufouo some user devices are equipped with client node functionality that enables them to4 access prsns to retrieve cryptographic products that have been wrapped for the devices the5 security services provided by the kmi to such devices and the kpc requirements that the6 devices need to meet are similar to those for client nodes serving koa agents7 42 u primary services nodes8 ufouo from the perspective of user that is supported by client node prsns are servers9 that offer interfaces from which to obtain kmi products and services prsns provide authorized10 users with keying material for type 1 cryptographic systems and provide management services11 that support the life cycle of that material12 ci2sar42a ufouo kmi ci2 shall implement prsns that supply products and 13 related lifecycle services for type 1 cryptographic systems drv krd 1180 r 14 421 u prsn domains enclaves and zones15 ufouo each prsn is divided into security enclaves that provide separation between16 specific security domains including the domain that operates at the unclassified level and the17 domain that operates at the us secret level18 ufouo unclassified domain this domain includes registered users that the us 19 government has authorized to receive kmi credentials for use in unclassified environments 20 this user population includes human users who are us federal government employees 21 state and local government employees government contractors representatives of 22 international organizations and representatives of foreign governments that are us allies or 23 form coalitions with the us this population also includes registered user devices that are 24 under the control of those people and their organizations see definitions in volume 2 25 ufouo ussecret domain this domain includes registered users that the us 26 government has authorized to receive kmi credentials for use in ussecret environments 27 the human users in this domain all have us secret clearance otherwise this user 28 population in this domain may be nearly as diverse as in the unclassified domain 29 ufouo other domains depending on kmi operational requirements domains could be 30 configured at the unclassified or secret levels for cceb nato or coalition users 31 ufouo prsn enclaves are divided into zones that provide defenseindepth for accepting32 connections and processing transactions and also provide separation between system33 components and between functions of differing sensitivity boundary protection suites limit34 client access to prsns and mediate communication between prsns and other nodes between35 enclaves within prsns and between zones within enclaves36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 34 ufouo this security architecture uses security enclaves as modular building blocks that 1 enable prsn to serve variable number of client domains as illustrated by figure 7 each2 prsn has common services enclave and some number of client domain enclaves the3 common services enclave operates at the us secret level and performs functions that cannot4 or should not be replicated for each of the client domains or that can be performed more5 efficiently or effectively when centralized than when distributed6 figure 7 u kmi prsn client domains 7 8 unclassifiedfouo 9 ufouo each prsn is also expected to have an enclave to serve client nodes operating at an10 unclassified level eg computers on niprnet and the public internet and an enclave to11 serve clients operating at the ussecret level eg computers on siprnet each prsn may12 have additional enclaves to serve client nodes operating in other security domains13 422 u prsn service redundancy and data replication14 ufouo major objective of kmis nodal architecture is to ensure continued availability of15 service for user by providing redundant points of service ie service at two or more prsns as16 illustrated by figure 2 without requiring the user to have multiple client devices17 ci2sar422a ufouo replication of points of service the kmi shall enable 18 users client node to obtain all products and services for which the user is authorized from 19 any prsn that has an appropriate security enclave drv krd 2092 prst 20 ufouo therefore the kmi also has the objective of eliminating the need for user to enter21 data repetitively22 ci2sar422b ufouo replication of service data the kmi shall enable each users 23 client node to be serviced by all appropriate prsn security enclaves consistent with 24 network connectivity and access control restrictions such as classification and in support 25 of this requirement the kmi shall ensure that all data needed to meet functional security 26 and availability requirements is made available to all such enclaves drv krd 1905 27 prst 28psnsother prsnscsnprsn client nodes unclassifiedprsn client services enclave unclassifiedprsn client services enclave ussecret client nodes other domainsclient nodes ussecretprsn client services enclaves other domainsprsn common services enclave ussecretekms translatorkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 35ufouo the kmi needs to replicate data between enclaves that are in different prsns but in1 the same security domain furthermore some kmi functions require unified view of activity in2 multiple domains which implies that data must be replicated between kmi components that are3 in different domains including between components that operate at different security levels4 thus ci2 is designed to satisfy the following general requirements for data replication5 ci2sar422c ufouo replication with upgrade if the kmi design requires 6 replicating data from component to another component or to network that operates at a7 higher level of classification then the upgrade function shall take place via guard device8 approved by nsa for such functions or shall use other nsaapproved mechanisms of9 equivalent assurance but the kmi should be designed to minimize the need for such 10 functions drv krd 1899 1900 prs 11 ci2sar422d ufouo replication with downgrade if the kmi design requires 12 replicating data from component to another component or to network that operates at 13 lower level of classification then the downgrade function shall take place via guard device 14 approved by nsa for such functions or shall use other nsaapproved mechanisms of 15 equivalent assurance but the kmi should be designed to avoid the need for such functions 16 drv krd 1900 1900 aprs 17 ci2sar422e ufouo the kmi shall be able to provide client node with equivalent 18 service at two or more prsns that have an appropriate security enclave regardless of the 19 security domain in which the client node operates drv krd 1905 r 20 ci2sar422f ufouo the kmi shall replicate necessary authorized data within the 21 same security domainboth between prsns and between components in the same prsn 22 drv krd 1905 1817 1825 r 23 ci2sar422g ufouo the kmi shall replicate necessary authorized data from one 24 security domain to anotherboth between prsns and between components in the same 25 prsnsubject to data confidentiality requirements drv krd 1905 1817 1825 r 26 ci2sar422h ufouo the kmi shall provide information confidentiality service as 27 required by the security policy kmi2200v2 for data replicated between components 28 drv krd 1026 1903 z 29 ci2sar422i ufouo the kmi shall provide information integrity service and 30 related data origin or peer entity authentication service as required by the security policy 31 kmi2200v2 for data replicated between components drv krd 1901 1902 z 32 ufouo to replicate data between the common services enclave and other enclaves in a33 prsn kmi ci2 incorporates guards34 423 u prsn network connectivity35 ufouo figure 8 illustrates that prsn supports client nodes via tcpipbased computer36 networks including siprnet niprnet and the public internet prsns also connects to peer 37 systems via those networks38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 36definition ufouo peer system an information system other than the ekms that 1 is external to the kmi and with which the kmi exchanges products and services that are2 needed to support kmi operations3 ufouo pse architecture is described in this section and some peer systems are discussed in4 the relationship to existing key management systems and external support systems of5 volume 16 figure 8 u kmi prsn client and peer system connectivity 7 8 unclassifiedfouo 9 ufouo figure 8 also illustrates that client node always connects to prsn through a10 kpc and prsn connects to peer system through channel that is specific to the 11 requirements of the two systems however t the security services mechanisms and level of 12 assurance required for the kpc these channels range from very robust to rudimentary depending 13 on 1 the purpose of the access and 2 the security domain in which the client or peer system 14 operates see protected channels for prsns section above 15 ci2sar423a ufouo prsn shall support client node access via tcpipbased 16 computer networks drv krd 1241 1242 2031 cr 17 ci2sar423b ufouo prsn shall support communications with peer systems via 18 tcpipbased computer networks drv krd 1241 1242 2031 r 19 ufouo figure 9 illustrates that clients operating at us secret can reach the us secret20 enclave of prsn in four ways21 by connecting directly to siprnet 22 by connecting to other networks that operate at us secret and are connected to siprnet 23 by connecting through siprnet dialup server 24 by using endtoend encryption to connect to siprnet via niprnetinternet 25peer systems siprnetprsn tcpip interfaceclient nodesinternet niprnetvarious kpcs systemspecific channelskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 37figure 9 u kmi prsn client enclave access 1 2 unclassifiedfouo 3 ufouo figure 9 also illustrates that clients operating at an unclassified level can access the4 unclassified enclave of prsn in three ways but clients operating at unclassified are not5 expected to use endtoend encryption to connect via siprnet6 by connecting directly to niprnet 7 by connecting via the public internet either directly to prsn or through niprnet8 by connecting through nirpnet dialup server9 ufouo regarding dialup access prsn does not support direct connection of client10 nodes via the pstn although clients operating at us secret might use the pstn to reach dial11 up servers on some network and thereby connect to prsn the dialup servers are not provided12 by the kmi13 ufouo prsn does not have any enclaves that operate at security level above secret14 and therefore cannot directly serve client nodes that operate above secret figure 9 illustrates15 that clients operating at security level x that is higher than us secret may connect to a16 prsn indirectly through guard however the kmi does not provide such guards as part of the17 ci2 for example network domain x could be the joint worldwide intelligence18 community system jwics the guard accredited by domain x would need to be able to19 permit passage of the required kpcs and other kmi protocols and would need to be provided20 and accredited for that purpose by the approving authorities of the jwics domain21prsn network domain xcommon services enclave unclassified dialupsiprnet ussecretprsn enclaves for unclassified client domains registered user client nodes ussecretussecret dialup registered user client nodes domain xguard accredited by domain x other ussecret networkno direct pstn serviceno direct pstn serviceprsn enclaves for ussecret client domain e3niprnet and internet e3 registered user client nodes ussecretregistered user client nodes unclassifiedkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 38424 u prsn security enclaves1 ufouo figure 10 illustrates that prsn can have five types of security enclaves 2 ufouo ordering and management enclave ome the multiple omes serve client 3 nodes operated by humans who are acting in kmi management roles 4 ufouo product delivery enclave pde the multiple pdes serve client nodes 5 operated by humans who are acting in the role of koa agent and b pdeenabled devices 6 ufouo peer systems enclave pse the multiple pses access the servers of other 7 information infrastructures from which the kmi obtains needed operational data8 ufouo common services enclave this single enclave s does not directly serve client 9 nodes but supports them indirectly through the omes and pdes 10 ufouo common monitoring enclave this single enclave oversees the status of the 11 prsn by receiving and analyzing data from components of the other enclaves the 12 common monitoring enclave might be separate enclave or be part of one of the other 13 enclaves depending on how monitoring is implemented in prsns 14 figure 10 u kmi prsn enclave types 15 16 unclassifiedfouo 17 ufouo in addition to the enclaves shown in figure 10 prsn contains various guards the 18 guards are used 1 to connect the common services enclave to omes connect the common 19 services enclave to pdes and pses in the cases where the security domain of those enclaves 20 differ from that of common services and 2 to connect the common monitoring enclave to the 21 other prsn components that are monitored 22 ci2sar424a ufouo all functionality of prsn shall be divided into two types of 23 components drv krd 1180 1386 1998 r 24 1 security enclaves omes pde s pses common services enclave and common 25 monitoring enclave which might be part of one of the other enclaves depending on how 26 prsns are implemented 27prsn clients nodes serving managersordering and management enclaves omes type1 kpcproduct delivery enclaves pdes clients nodes serving koa agents ie humanspdeenabled user devicestype1 kpcpki kpcother kpcstype1 kpccommon monitoring enclave server devices in peer systemspeer systems enclaves pses server specific protocolscommon services enclavekmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 39 2 guards that mediate interenclave communications pde guards ome guards pse 1 guards and possibly separate mon guard if there is separate common monitoring 2 enclave 3 ci2sar424b ufouo computer platform that implements functions of specific 4 guard in prsn shall be physically separate from computer platforms that implement other5 functions of the prsn including the functions of other guards drv krd 1180 13876 1568 r7 ci2sar424c ufouo computer platform that implements functions of specific 8 ome shall be physically separate from computer platforms that implement other functions9 of the prsn including the functions of other omes drv krd 1180 1387 1568 r 10 ci2sar424d ufouo computer platform that implements functions of specific 11 pde shall be physically separate from computer platforms that implement other functions of 12 the prsn including the functions of other pdes drv krd 1180 1387 1568 r 13 ci2sar424e ufouo computer platform that implements functions of specific 14 pse shall be physically separate from computer platforms that implement other functions of 15 the prsn including the functions of other pses drv krd 1180 1387 1568 r 16 ufouo omes support complex operational functions of managers pdes only enable koa17 agents to retrieve encrypted products that manager has previously ordered or authorized18 through an ome separating ome functions from pde functions enables pdes to be simpler19 than omes which in turn simplifies requirements for the guards that connect pdes to the20 common services enclave minimizing the client population that needs access to the more21 complex and sensitive omes and also further isolating the most sensitive prsn functions in the22 common services enclave can further simplify security certification of prsns simplifying23 pdes can also reduce their cost which enables them to be replicated to serve separate24 communities within kmis diverse population of client nodes25 ufouo prsns are intended to be able to support client nodes in multiple security domains26 through multiple networks and through multiple configurations of kpcs thus requiring multiple27 omes and pdes however there are many possible ways in which prsn could be configured28 to support the client population29 ufouo for example figure 11 illustrates that ci2 prsn could be configured with omes30 to serve four of the domains listed in table 6 if necessary prsn could be expanded with31 additional omes for those domains and also for other domains listed in table 632kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 40figure 11 u kmi prsn omes configuration example 1 2 unclassifiedfouo 3 ufouo figure 12 illustrates that for example prsn could be configured with pdes to4 serve the four domains listed in table 7 if necessary prsn could be expanded with additional5 pdes for those domains or for other domains6 figure 12 u kmi prsn pdes configuration example 7 8 unclassifiedfouo 9 ufouo tables 6 and 7 describes the hypothetical configuration of omes and pdes shown 10 in figure 12 which is based on assumptions explained by the notes accompanying the tables in 11 the two tables each row describes one possible clientenclavenetworkkpc combination12 through which client node could connect to prsn13prsn common services enclave ussecret pdes koa agent clientsome uss manager clients usskpcsno ome usuome ccebu manager clients ccebukpcsome ccebs manager clients ccebskpcsome natos manager clients natoskpcsno ome natouno ome coalition prsn manager clientsomespdes uss koa agent clients usskpcsno pde usuno pde coalspdes ccebu koa agent clients ccebukpcsno pde ccebspdes natou koa agent clients natoukpcsno pde natospdes coalu koa agent clients coalukpcscommon services enclave ussecretkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 41table 6 u kmi prsn ome security domains configuration example 1 1 client type operational security level2 enclave type operational security level3 kpc required security level at which keyed4 internetworks served operational security level5 security levels of products that can be ordered manager ome type 1 siprnet uss usus ccebus ussecret ussecret ussecret niprnet usu natous us only us only public internet coalu coalitionus manager ome usunclas at this level see note 61 manager ome type 1 siprnet uss ccebus ccebsecret ccebsecret ccebsecret niprnet usu natous see note 62 public internet coalu coalitionus manager ome type 1 siprnet uss ccebu ccebunclas ccebunclas ccebunclas niprnet usu natou see note 62 public internet coalu coalitionu manager ome type 1 siprnet uss natous natosecret natosecret natosecret niprnet usu coalitionus see note 63 in ci2 public internet coalu manager ome natounclas at this level see notes 634 in ci2 manager ome coalitionsecret at this level see note 5 in ci2 manager ome coalitionunclas at this level see notes 5 in ci2 manager ome ustop secret at this level see notes 6 in ci2 unclassifiedfouo 2 ufouo the five columns in each table have the following content3 column 1 lists the type of client and in parentheses the security domain in which the 4 client operates all clients in table 6 serve users that are playing management role and all5 clients in table 7 serve users that are playing the koa agent role6 ufouo us domains managers and koa agents in these domains would all be 7 us government employees 8 ufouo cceb domains managers in these domains would all be authorized 9 representatives of national governments of cceb nations 10 ufouo nato domains managers in these domains would all be authorized 11 representatives of national governments of nato nations 12 ufouo coalition domains managers in these domains would all be authorized 13 representatives of national governments of noncceb nonnato nations 14kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 42 column 2 lists 1 the type of enclave provided at prsns to support the client type in 1 column 1 and 2 in parentheses the security domain in which the enclave operates all the2 enclaves in table 6 are omes and all the enclaves in table 7 are pdes3 column 3 lists the type of kpc required between the client and the enclave 4 type 1 the kpc is based on ipsec haipis and type 1 key as specified in the 5 protected channels section 6 pki the kpc is based on tls rfc2246 and pki credentials as specified in the 7 protected channels section 8 column 4 lists the longhaul internetworks on which the enclave offers point of 9 connection for those cases where there is doubt that connections will be offered in ci2 the 10 table has after the network name and there is an explanatory note below the table 11 column 5 in table 6 this column lists the products that can be managed through the ome 12 in table 7 this column lists the products that can be delivered through the pde 13 ufouo column 1 of table 6 references the following notes14 note 61 usonly unclassified ome might not be needed instead us managers 15 operating at unclassified could access ccebunclassified ome 16 note 62 cceb nations do not currently have connection approval for the us siprnet or 17 niprnet therefore this ome need serve siprnet and niprnet only if cceb 18 managers have access to uscontrolled clients on those networks 19 note 63 nato nations do not currently have connection approval for the us siprnet or 20 niprnet therefore this ome need serve siprnet and niprnet only if nato 21 managers have access to uscontrolled clients 22 note 64 natounclassified ome on the public internet might not be needed instead 23 us and cceb managers of natounclassified products could use any us cceb or 24 nato manager client and nato managers could use natosecret manager client 25 note 65 ome is needed at these levels in ci2 because coalition partners ie non 26 ccebnonnato are not expected to be permitted to be enrolled as managers in ci2 27 note 66 ci2 will not serve manager clients at the top secret level but later kmi 28 capability increment might do so 29kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 43table 7 u kmi prsn pde security domains configuration example 1 1 client type operational security level2 enclave type operational security level3 kpc required 4 internetworks served operational security level5 products that can be delivered koa agent uss pde pki class 3 or higher siprnet uss all wrapped ussecret type 1 ussecret niprnet usu products type 1 ussecret public internet coalu koa agent usu pde pki class 4 niprnet usu all wrapped ccebunclas public internet coalu products koa agent ccebu pki class 4 or equiv public internet coalu koa agent usu pde pki class 2 or higher niprnet usu all wrapped natounclas public internet coalu products koa agent ccebu pki class 2 or higher public internet coalu koa agent natou pki class 2 or higher public internet coalu koa agent usu pde other niprnet usu all wrapped coalitionunclas public internet coalu products koa agent ccebu other public internet coalu koa agent natou koa agent coalu unclassifiedfouo 2 4241 u prsn orderingandmanagement enclaves3 ufouo manager connects to an ome either 1 to request products and services for4 delivery through pdes to koa agents or 2 to perform related operational and administrative5 duties depending on the authorizations held by the manager users are not permitted to connect6 to omes in the koa agent role7 ufouo ordering is the process by which requests are made for the generation and8 distribution of products and by which the kmi responds to those requests and controls those9 processes this architecture assumes that ordering information and other data that an ome10 exchanges with manager is never classified higher than secret11 ufouo figure 10 illustrates that managers connect their client nodes to omes through a12 kpc based on type1 cryptography the kpc involves pkibased tls kpc channel that is 13 layered above type 1 channel kpc see figure 5 in protected channels section above the 14 kpcs two channels provide the following services for the client connections 15 ufouo authentication the two kpcs channels provide different complementary 16 forms of peerentity authentication 1 the type 1 kpc channel authenticates to the ome 17 server that the client node is member of the type 1 community and similarly 18 authenticates the ome server to the client 2 the pkibased tls kpc channel 19 authenticates the managers registered user identity to the ome and similarly authenticates 20 the ome to the manager the identities are stated in the pki credentials used for the tls 21 security association 22kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 44 ufouo data confidentiality one or both of the kpcs two channels is configured to 1 provide data confidentiality service for the ordering information and other data that is2 exchanged between the client and the ome3 ufouo data integrity one or both of the kpcs two channels is configured to provide 4 data integrity service for the data that is exchanged5 ufouo the following requirements establish basis for omes and other requirements for6 omes are stated in volume 17 ci2sar4241a ufouo an ome shall be able to receive and process product and 8 service requests from client nodes operated by managers drv krd 1180 cr9 ci2sar4241b ufouo the kmi shall enable an authorized security configuration 10 manager to cause selected omes temporarily to cease accepting and processing selected 11 types of requests from selected client nodes drv krd 1016 cr 12 ci2sar4241c ufouo the common services enclave of prsn shall provide 13 access control data and product catalog data to each ome in the prsn but only as needed 14 for the security domain that is authorized to connect to that ome drv krd 1645 r 15 ufouo the following requirements specify the security domains that can be served by16 omes in ci2 prsn17 ci2sar4241d ufouo in prsn each ome shall operate in single security 18 domain at single security level drv krd 1180 1386 1998 r 19 ci2sar4241e ufouo prsn shall be able to concurrently support client node 20 access with multiple omes such that each ome operates in specified security domain 21 drv krd 0504 1386 1998 r 22 ci2sar4241f ufouo prsn shall be able to be configured with omes to support 23 one or more of the following security domains drv krd 0504 1180 1386 r 24 1 ussecret 25 2 usunclassified 26 3 ccebsecret 27 4 ccebunclassified 28 5 natosecret 29 6 natounclassified 30 7 coalitionsecret 31 8 coalitionunclassified 32 ci2sar4241j ufouo prsn shall be able to be modularly configured with 33 omes or reconfigured with additional or fewer omes to have from one to twenty 20 34 omes drv krd 0504 1180 1386 r 35 ufouo the following requirements specify the networks on which prsns in ci2 shall be36 able to provide an ome point of presence37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 45ci2sar4241k ufouo an ome operating at secret level shall be able to be 1 connected to and support client node access 1 via siprnet or some other network2 operating at that secret level or 2 by using nsaapproved endtoend encryption via3 niprnet the public internet or some other network operating at an unclassified level4 drv krd 1241 1242 2031 r5 ci2sar4241l ufouo an ome operating at an unclassified level shall be able to be 6 connected to and concurrently support client node access via niprnet the public internet7 or some other network operating at that unclassified level drv krd 0504 1242 20318 r9 ci2sar4241m ufouo the connection of client node to an ome shall be through 10 1 pkibased tls kpc using kmi management credentials nsakmicp layered over 11 2 type 1 kpc using the haipe interoperability specification haipis drv krd 12 1026 1371 cr 13 4242 u prsn product delivery enclaves14 ufouo koa agents connect to pdes to receive products and services that have previously15 been ordered or authorized for them by managers users that access omes as managers might16 also access pdes as koa agents because managers might need to receive products and17 services that have been ordered for them by other managers pde does not accept new orders18 it only services requests to deliver pregenerated material or accepts requests to generate pre19 authorized material such as in rekey operations pde is essentially storeandforward20 server that relays messages between the common services enclave and client nodes pde21 does not support the more complex forms of clientserver interaction that an ome supports22 ufouo figure 10 illustrates that client nodes connect to pdes through various types of23 kpcs each pde offers service through just one kind of kpc configuration 1 some pdes use 24 pkibased tls kpc that is layered above the same kind of type 1 kpc that is used for 25 omes 2 some use only pkibased kpc and 3 some may support disadvantaged clients 26 through kpcs based on less robust technology as discussed in protected channels for prsns27 section above however the type and strength of the kpc is less critical in pde than in an28 ome because essential security services for product delivery are provided by product packaging29 and not by kpc mechanisms kpc that connect pde to client node of koa agent30 provides the following security services for the connection 31 ufouo authentication pde must be able to learn the users identity for the purpose 32 of determining which key material to deliver to the user and must be able to authenticate that 33 identity for product tracking and for countering denialofservice attacks by clients that 34 falsely connect 1 type 1 kpc if configured authenticates to the pde server that the 35 client node is member of the type 1 community and similarly authenticates the pde 36 server to the client 2 pkibased tls kpc can authenticate the koa agents registered 37 user identity to the pde and can similarly authenticate the pde to the agent however if the 38 client is disadvantaged some mechanism other than pkibased tls kpc may be used to 39 authenticate the agents identity 40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 46 ufouo data confidentiality this architecture assumes that all key material that pde 1 receives from the common services enclave and delivers to client node is encrypted and2 that the material can be decrypted only by the recipient intended by the prsn furthermore3 per cnssi40xx the delivered material is 1 unclassified and 2 not required to be4 treated as comsec material however some labeling and addressing data associated with5 the material may not be encrypted and may need protection for purposes of operational6 security kpc can provide data confidentiality service for such unencrypted data7 ufouo data integrity although product packaging can provide endtoend data 8 integrity service for delivered key material additional data integrity service provided by a9 kpc can counter denialofservice attacks in cases where the user is only relaying the 10 package between the pde and the intended final recipient 11 ufouo prsn needs to be able to establish such additional pdes rapidly the additional12 domains that will need to be supported cannot be predicted with certainty but the following are13 examples of domains that the kmi may need to support14 ufouo us nonfederal the koa agents include both persons who are authorized 15 representatives of us state and local government 16 ufouo other us allies partners and coalitions the koa agents are authorized 17 representatives and devices belonging to national governments of noncceb and nonnato 18 countries and of countries that are members of various coalitions that includes the us 19 ufouo international organizations the koa agents are representatives and devices 20 belonging to various nongovernment and quasigovernment organizations 21 ufouo the following requirements establish basis for pdes and other requirements for22 pdes are stated in volume 123 ci2sar4242a ufouo pde shall be able to 1 deliver pregenerated key material 24 to client nodes and 2 receive and process requests from client nodes to generate pre 25 authorized products ie products previously authorized by manager through an ome 26 drv 1180 cr 27 ci2sar4242b ufouo the kmi shall enable an authorized security configuration 28 manager to cause selected pdes temporarily to cease delivering products to and accepting 29 and processing selected types of requests from selected client nodes drv krd 1016 30 r 31 ci2sar4242c ufouo the common services enclave of prsn shall provide 32 access control data and product catalog data to each pde in the prsn but only as needed 33 for the security domain that is authorized to connect to the pde drv krd 1645 r 34 ufouo the following requirements specify the security domains that can be served by pdes35 in ci2 prsn36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 47ci2sar4242d ufouo in prsn each pde shall operate in single security 1 domain at single security level drv krd 1180 1386 1998 r2 ci2sar4242e ufouo prsn shall be able to concurrently support client node 3 access with multiple pdes such that each pde operates in specified security domain4 drv krd 1386 1998 r5 ci2sar4242f ufouo prsn shall be able to be configured to include pdes that 6 operate in one or more of the following security domains drv krd 0504 1180 1386 7 r8 1 ussecret 9 2 usunclassified 10 3 ccebsecret 11 4 ccebunclassified 12 5 natosecret 13 6 natounclassified 14 7 coalitionsecret 15 8 coalition unclassified 16 ci2sar4242g ufouo prsn shall be able to be modularly configured with pdes 17 or rapidly reconfigured with additional or fewer pdes to have from one to fortytwo 42 18 pdes drv krd 0504 1180 1386 r 19 ufouo the following requirements specify the networks on which prsns in ci2 provide a20 pde point of presence21 ci2sar4242h ufouo pde operating at secret level shall be able to be 22 connected to and support client node access 1 via siprnet or some other network 23 operating at that secret level or 2 by using nsaapproved endtoend encryption via 24 niprnet the public internet or some other network operating at an unclassified level 25 drv krd 1241 1242 2031 r 26 ci2sar4242i ufouo pde operating at an unclassified level shall be able to be 27 connected to and concurrently support client node access via niprnet the public internet 28 or some other network operating at that unclassified level drv krd 1242 2031 r 29 ci2sar4242j ufouo the connection of client node to pde shall be through 30 kpc that is configured in accordance with the requirements and capabilities of the pdes 31 security domain and its client population drv krd 1026 cr 32 ufouo the following requirement implements the protections described in table 533 ci2sar4242k ufouo prsn shall be able to be configured to include pdes that 34 each support one of the following types of kpcs for clients drv krd 0572 0574 1321 35 1026 cr 36 1 tls kpc that is established with class 3 or higher pki credentials 37 dodx509cp for both the prsn server and the clients user and which is layered over 38 haipis kpc using type 1 credentials haipis 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 48 2 tls kpc that is established with class 2 or higher pki credentials 1 dodx509cp or equivalent credentials for both the prsn server and the clients user 2 3 tls kpc that is established with class 2 or higher pki credentials 3 dodx509cp for the prsn server and an identifierpassword authentication 4 mechanism for the clients user 5 4243 u fill ports and distribution paths6 ufouo when client node has connected to pde and received wrapped product or7 when an akp has generated and wrapped product the product is then distributed to the user8 device for which the product is intended via one of the several different types of paths that are9 illustrated in figure 13 these paths are described in detail with their related requirements in the 10 key fill and delivery sections of volume 111 figure 13 u kmi product distribution paths for user devices 12 13 unclassifiedfouo 14 ufouo in brief there are five basic types of distribution paths and each of those can use15 one or more of three types of fill ports in user devices16 ufouo networkfill port nfp this type of fill port connects to pdes and to client 17 nodes and it accepts otnk fill 182a nfpportable media pass thruprsn product delivery enclave 2b wfp 1a nfp 3a nfp 3b wfp 3c rfp 4a nfp 4b wfp 4c rfp 5a nfp 5b wfp 5c rfp 3 management client with akp passes wrapped product through portable media pass thru5 management client with akp akp generates and wraps product fill device unwraps gd support tbd ecufill device unwrapsin cases 1 through 4 the prsn receives wrapped product from psn 2c rfp ld gd support tbd ecuci2 does not support this caseci2 does not support this caseportable media pass thruportable media pass thru fill device unwraps4 management client with akp akp unwraps and rewraps product clients push to devices gd akp ecugd akp ecugd akp eculd gd fd ecugd akp eculd gd fd eculd gd fd eculd gd fd ecu2 distribution client of koa agent passes wrapped product through fill device unwrapspsn does not wraps for fill devicepsn does not wraps for fill device ld gd support tbd ecutypes of devices expected to be supported in each case1 device acts as clientkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 49 ufouo wrappedfill port wfp this type of port connects to portable media1 including fill devices used to transport wrapped products and it may accept otnk2 ekms 217 or black fill3 ufouo redfill port rfp this type of port connects to fill devices that unwrap4 products and it accepts red fill5 ufou for each supported path the box at the bottom of the figure figure 13 lists which of 6 the three basic types of user devicesakp ecu and fill device fdare supported on that7 path some paths have akp to indicate that it has yet to be determined whether or not ci28 will support akps on the path9 ufouo the box at the bottom of figure 13 also lists the type of identity registration that 10 user device must have to use the path gd indicates globally registered general device and11 ld indicates locally registered limited device these device typesgeneral device and12 limited deviceare defined in the registered users section of volume 2 in addition to13 gd and ld some paths are shown as supporting gd ie gd in parentheses this is meant14 to indicate that the path can support user device that is treated by the management client as a15 limited device even though it has been registered as general device16 ufouu some of the combinations of path type and port type are special cases first ci217 does not support paths 2c and 3c which would use redfill port on user device because in18 ci2 there are fill devices that are general devices for which the psn can wrap key second it19 has yet to be determined whether or not ci2 will supports paths 3a 4a and 5a20 4244 u peer systems enclaves21 ufouo pses implement functionality needed for the kmi to communicate with peer22 systems for example to validate dod x509 publickey certificates of some koa agents who23 access pdes the kmi needs the certificates of dod pki certification authorities cas and also24 needs their certificate revocation lists crls or revocation status services this may require the25 pse to act as client to access directory server to get certificates and crls or to access an on26 line certificate status protocol ocsp server27 ufouo in addition to security requirements stated in this volume safeguards for28 interoperation with external systems and protections for externally generated information are29 stated in the following sections of volume 2 nonkmi systems information sensitivity30 control of import and export and extend trust and outside users31 ufouo the following requirements establish basis for pses32 ci2sar4244a ufouo pse shall be able to initiate communication associations to 33 access specified peer systems for the purpose of obtaining needed products and services 34 from those systems or otherwise exchanging data with those systems drv 1023 1359 r 35 ci2sar4244b ufouo the kmi shall enable an authorized security configuration 36 manager to cause selected pses temporarily to cease accessing selected peer systems drv 37 krd 1016 r 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 50ci2sar4244c ufouo pse shall not establish any communication association that 1 is initiated by peer system drv 1068 r2 ufouo all the security domains that will need to be supported by ci2 pses cannot be3 predicted with certainty but support is expected to be needed for the following4 ufouo us federal the kmi is expected to connect to some systems operated or 5 controlled by dod services and agencies and by some nondod federal agencies6 ufouo us nonfederal the kmi may need to obtain services and data from systems 7 belonging to some us state and local governments8 ufouo allies partners and coalitions the kmi may need to obtain services and data 9 from systems belonging to some other national governments or groups of governments 10 ufouo international organizations the kmi may need to obtain services and data 11 from systems belonging to some quasigovernment and nongovernment organizations 12 ufouo the following requirements specify the security domains in which pses of ci213 prsn need to be able to operate14 ci2sar4244d ufouo each prsn pse shall operate in single security domain at 15 single security level drv krd 1180 1386 1998 r 16 ci2sar4244e ufouo prsn shall be able to concurrently support access to peer 17 systems through multiple pses such that each pse operates in specified security domain 18 drv krd 1386 1998 r 19 ci2sar4244f ufouo prsn shall be able to be modularly configured to include 20 pses that operate in one or more of the following security domains drv krd 0504 21 1180 1386 r 22 1 ussecret 23 2 usunclassified 24 3 ccebsecret 25 4 ccebunclassified 26 5 natosecret 27 6 natounclassified 28 7 coalitionsecret 29 8 coalitionunclassified 30 ufouo in some cases single pse may be able to connect to more than one peer system in31 other cases peer system may need dedicated pse therefore prsn needs to be able to32 establish additional pses as needed33 ci2sar4244g ufouo prsn shall be able to be modularly configured with pses 34 or rapidly reconfigured with additional or fewer pses to have from one to fortytwo 42 35 pses drv krd 0504 1180 1386 r 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 51ufouo the following requirements specify the networks to which pses in ci2 need to be1 able to connect2 ci2sar4244h ufouo prsn pse operating at secret level shall be able to 3 access peer systems 1 via siprnet or some other network operating at that secret level or4 2 by using nsaapproved endtoend encryption via niprnet the public internet or5 some other network operating at an unclassified level drv krd 1241 1242 2031 r6 ci2sar4244i ufouo prsn pse operating at an unclassified level shall be able 7 to access peer systems via niprnet the public internet or some other network operating at8 an unclassified level drv krd 1242 2031 r9 ufouo pses do not usually connect to peer systems through kpcs specified by kmi10 instead as illustrated by figure 10 pse connects to peer system through channel defined11 by that system in some cases the peer may define security requirements for the channel but the12 kmi has the following security needs for such channel or for information received through it13 ufouo authentication the kmi usually needs either to authenticate the identity of 14 the external system to which pse connects or b to authenticate the origin of data received 15 by the pse from the external system 16 ufouo data confidentiality the kmi may need to have the channel provide data 17 confidentiality service for various purposes including operational security 18 ufouo data integrity the kmi usualy needs to be able verify the integrity of data 19 obtained by pses from peer systems 20 ci2sar4244j ufouo the connection of pse to peer system shall be through 21 communication association that is configured and protected to satisfy the security 22 requirements of both the peer system and its security domain and b the kmi krd 23 new r 24 425 u prsn security zones25 ufouo figure 1 4 illustrates how prsn is divided into security zones as described in the 26 architectural elements section security enclave of kmi core node that serves clients or 27 connects to peer systems needs three security zonespublic buffer and privateto provide 28 defense in depth however ci2 prsn does not provide three separate zones for every29 enclave instead prsn centralizes the functions of private zones in single common private30 zone that operates at the ussecret level in the common services enclave omes pdes and 31 pses each have their own public zone and buffer zone but share the services of the common32 private zone the common services enclave is connected to and supports all omes pdes and 33 pses in the prsn34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 52figure 14 u kmi prsn enclave structures 1 2 unclassifiedfouo 3 ufouo figure 1 5 illustrates the architectural security strategy for using security zones in 4 prsns to handle interactions with client nodes although interactions with peer systems are 5 not shown in figure 15 they are handled similarly to interactions with client nodes of6 managers both registered and unregistered entities are able to connect client nodes to publicly 7 accessible servers in the public zone and attempt to log in but unregistered entities are rejected8 only registered users can log in to the buffer zone and submit requests for products and9 services the buffer zone preprocesses the requests by checking them against kmi10 specifications against role and permission information provided from the private zone and11 against current system state requests that pass these checks are forwarded in canonical form to12 the common private zone which again authenticates and checks the requests before acting on13 them14 ufouo public zone this type of zone contains the prsn components that have the 15 greatest exposure to networkbased threats connections from client nodes to prsn and 16 connections from prsn to peer systems pass through this zone the public zone handles 17 initial user interactions such as by posting welcoming web pages and security warning 18 banners and manages network connections with clients such as by balancing 19 communications loads and countering attacks involving flooding or misuse of tcpip 20 protocols however the public zones of omes and some pdes are fronted by an endtoend 21 encryption device operating at the ip layer and these zone s will typically contain fewer 22 components and have fewer of these public interactions than the public zones of the other 23 pdes and the pses 24 ufouo pse initiates connections with peer systems but pse rejects any attempt by an 25 peer system to initiate connection with the prsn an ome or pde of prsn does not 26 provide any products or services not to system entities that are not registered as indicated in27 figure 15 by the box labeled reject requests of unregistered entities this access control 28 could be implemented in variety of ways depending on whether access is attempted through a29 webbased or transactionbased interface30private zone public zonebuffer zonesecurity enclave generic domaingeneric enclave architecture common private zone public zoneome or pde buffer zone public zonepse buffer zoneomespdes various domainspses various domainscommon services enclave ussecretprimary services node legend connection initiationkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 53figure 15 u kmi strategy for security zones in prsns 1 2 unclassifiedfouo 3 ufouo buffer zone this type of zone contains the prsn components that ensure 4 separation between 1 the threatfilled environment of public zone and 2 the sensitive5 functions of the common private zone and prevents unauthenticated unauthorized access to6 kmi products and services product and service requests made by koa agents are intended7 to be handled in pde buffer zone usually without any communication with the common8 private zone also some of the less sensitive requests of managers may be handled in an9 ome buffer zone such as request for status report on an order that was placed by 10 previous request the buffer zone always authenticates the identity of the users that access 11 the prsn and also enables the clients and peer systems to authenticate the identity of the 12 prsn 13 ufouo common private zone this zone contains the components that perform the 14 most sensitive prsn functions connections may be made from this zone to other prsns to 15 psns or to the csn clients do not communicate directly with this zone communications 16 between clients and this zone are handled through proxy in the buffer zone the common 17 private zone always reauthenticates the identity of the user before doing the final processing 18 of request and this authentication is of high assurance and independent of the 19 authentication performed by the buffer zone the common private zone also independently 20 enables the client to authenticate the origin of that zones response to users request in 21 cases when such additional authentication is needed 22client node of koa agent or managercommon private zone buffer zone public zone client node of unregistered system entityclient node of managerreject requests of unregistered entitiespreprocess requests and handle preapproved requestsprocess requests in final form proxyindependent highassurance legend bentity asserts its identity and b authenticates the identityendtoend communication transport layer and abovekmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 54ufouo the separation of prsn functions into zones is motivated by the likelihood that1 clients and peer systems will be used to attack prsns although the public and buffer zones are 2 designed to reject unregistered entities b prevent registered users and approved peer 3 systems from communicating directly communication between clients and with the common 4 private zone and c restrict registered users to authorized activities it is conceivable that some 5 defenses in these zones might fail in that case the zoned structure by requiring both the buffer6 zone and private zone to authenticate registered user interactions and validate service requests 7 independently of each other reduces the likelihood of successful attack on the private zone8 ufouo figure 1 6 illustrates how prsn zones are connected to each other to client nodes 9 and peer systems to other prsns to psns to the csn and to the ekms translator the 10 components shown in figure 1 6 provide defenseindepth protection for the prsn against threat 11 actions carried by communications from other nodes especially client nodes the zones of a12 prsn also provide defense for the csn and psns that are connected to the prsn figure 1 6 13 only depicts the general relationship of the four types of zones to each other the actual14 arrangement of zones in prsn is specified differently as illustrated in figures 1 7 and 18 15 figure 16 u kmi connections for security zones in prsns 16 17 unclassifiedfouo 18 ufouo figure 16 also illustrates that prsn has fourth type of zone 19 ufouo monitoring zone this type of zone contains components that monitor the 20 security and the performance of the other three types of zones this type of zone performs 21 certain secondary prsn functions such as managing aswr and auditing and separates 22 those functions from the prsns primary functions of product ordering and delivery which 23 are performed by the other types of zones connections may be made to monitoring zone 24buffer zone public zoneprivate zonepsns bps vpnprsncsn monitoring zonebps vpn security monitoring and other system management functions public functionsbps pri buffer functionsaccess control and privilege managementprivate functionsaccess control and privilege management bps buf warnings greetings and communicationsbps pubbps monother prsns public functions client nodes and peer systems ekms translator backend virtual private networkkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 55from other types of zones in the prsn but such connections are intended to provide only1 oneway communication into the monitoring zone from those other zones2 ufouo the following are basic requirements for security zones in prsn3 ci2sar425a ufouo all functionality of security enclaves in prsn shall be 4 divided into four types of security zones public buffer private and monitoring drv5 krd 1180 1998 r6 ci2sar425b ufouo computer platform that implements functions of security 7 zone in security enclave of prsn shall be physically separate from computer platforms8 that implement functions of any other zone enclave or node drv krd 1180 1387 15689 r 10 ci2sar425c ufouo all functionality of prsn ome shall be divided into public 11 zone buffer zone and the bpss associated with those security zones drv krd 1180 12 1998 r 13 ci2sar425d ufouo all functionality of prsn pde shall be divided into public 14 zone buffer zone and the bpss associated with those security zones drv krd 1180 15 1998 r 16 ci2sar425c ufouo all functionality of prsn pse shall be divided into public 17 zone buffer zone and the bpss associated with those security zones drv krd 1180 18 1998 r 19 4251 u boundary protection suites in prsn security zones20 ufouo figure 1 6 also illustrates that prsn contains five different types of bpss 21 ufouo bpspub this type of gateway from client nodes and peer systems into 22 prsn is intended to counter generic networkbased attacks such as distributed denialof 23 service attacks involving lowerlayer protocols that are launched from client nodes or from 24 any computer platforms that are not part of the prsn kmi the security countermeasures 25 used in bpspub could include for example routerbased filtering of tcpip protocols 26 ports and addresses 27 ufouo bpsbuf this type of gateway protects the functions of the buffer zone 28 against attacks that might be made by compromised components of the public zone or by 29 communications that are allowed to pass through bpspub from client nodes or peer 30 systems 31 ufouo bpspri this type of gateway protects the functions of the private zone 32 against attacks that might be made through bpsbuf or by compromised components of the 33 buffer zone 34 ufouo bpsmon this type of gateway protects the functions of the monitoring zone 35 against attacks that might be made through or by the other three zones 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 56 ufouo bpsvpn this type of gateway provides kpcs for vpn that enables the 1 prsn to connect to psns to other prsns to the csn and to the ekms translator this2 type of gateway also protects the functions of the private and monitoring zones against3 attacks that might be made by compromised components of other nodes4 ufouo to minimize the risk that bpss might share vulnerabilities that could negate the5 defense in depth that the zones are designed to provide each bps type needs to be implemented6 independently of the others7 ci2sar4251a ufouo all data communications access to prsn security enclave 8 of prsn from outside the enclave and all such access from one security zone of 9 security enclave to another zone shall be mediated by bpss that are incorporated in the 10 functionality of the zonesenclaves drv krd 0901 0906 1999 r 11 ci2sar4251b ufouo computer platform that implements bps functions to 12 protect security zone in security enclave of prsn shall be physically separate from 13 any computer platforms that implement other functions of that zone and that enclave drv 14 krd 1180 1387 1568 r 15 ci2sar4251c ufouo if set of bpss provide defenseindepth in serial or 16 stacked fashion along data path in the prsn eg the sequence bpspub bpsbuf 17 bpspri then the software functions of each type of bps in the set shall be performed by 18 software including any operating system software that is implemented separately from the 19 software in the other bps types krd new r 20 ci2sar4251d ufouo bps of security zone in security enclave of prsn 21 shall restrict data communication to the minimum needed for the intended functions of the 22 zone or zones to which the bps connects drv krd 0901 0906 1999 r 23 ci2sar4251e ufouo bps shall restrict data communication protocols to those 24 that are essential for the intended functions of the security zone or zones to which the bps 25 connects drv krd 1999 r 26 ci2sar4251f ufouo bps shall where appropriate incorporate features to limit 27 the bandwidth of potential covert data channels drv krd 1999 r 28 4252 u prsn public zones29 ufouo figure 1 7 illustrates that client nodes and peer systems connects through bps 30 pub to the public zone of security enclave that operates in the same security domain as the31 client or peer 32 ci2sar4252a ufouo the public zone of security enclave in prsn shall 33 incorporate bps bpspub that mediates data communications between 1 that zone 34 and either 2a client nodes that access the enclave from outside the prsn or 2b peer 35 systems that are accessed by the enclave drv krd 1998 r 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 57figure 17 u kmi prsn components 1 2 unclassifiedfouo 3 ufouo to avoid cascading security failures bpspub needs to be implemented4 separately from other bps types5 ci2sar4252b ufouo software that performs functions of bpspub including 6 any operating system software shall be implemented separately from the software in other7 bps types bpsbuf bpspri bpsmon and bpsvpn in the same prsn drv krd 8 1180 1387 1568 r9 ufouo bpspub needs to block unauthorized communications10 ci2sar4252c ufouo bpspub shall permit data communications between 1 11 the public zone of security enclave in prsn and 2 client nodes or peer systems as 12 needed to support the types of access that have been specified and authorized for between 13 that enclave and entities outside the prsn both registered users and shall prevent all other 14 communications drv krd 0901 0906 1999 r 15 ci2sar4252d ufouo components in the public zone of prsn security enclave 16 shall provide only the services that are specified have been authorized for authorized 17 entitiesie registered users in the case of omes and pdes and specified peer systems in 18 the case of pses and except for posting warning banners required by this specification 19 shall not interact with unregistered unauthorized entities any more than is necessary to detect 20 and reject their connection attempts drv krd 1998 1999 r 21other prsns psnsekms translatorcsn prsn omes various domainspdes various domainspses various domainsbpspri pde guardcommon services enclave ussecret domainbackend virtual private network bpsvpncommon private zone client nodes that serve managers ome buffer zone bpsbufome bpspubomeome public zonepse buffer zone bpsbuf pse bpspub psepse public zone servers in peer systems ie nonkmi externalbpspriome guardbpspri pse guard client nodes that are pdeenabled devicesclient nodes that serve koa agentspde buffer zone bpsbuf pde bpspub pdepde public zonekmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 584253 u prsn buffer zones1 ufouo figure 1 7 illustrates that data traffic from client nodes of registered users can enter 2 public zone and continue through bpsbuf into the associated buffer zone the traffic3 carries requests for products and services that are authorized for registered users the buffer4 zone validates and records the requests limiting each user to initiating only those requests that5 are authorized for the role the user is playing some requests are handled entirely in the buffer6 zone and other requests and related information are formatted as transactions to be passed7 through bpspri to the private zone for further processing for these purposes the buffer zone8 holds selected user registration and authorization data and in an ome also holds and product 9 catalog data and other information which is loaded into the buffer zone from the private zone10 from the private zone the buffer zone receives the results of processed requests and passes11 products and other service results back through the public zone to client nodes12 ufouo figure 1 7 illustrates that client node operated by manager connects through 13 bpsbufome to an ome buffer zone that operates at the same security level security level14 x as the client an ome buffer zone processes requests from managers for various services15 and for products to be delivered through pdes to koa agents an ome sends processed16 requests and related transactions through an ome guard to the common private zone of the17 common services enclave an ome also receives responses and other information from18 common services19 ci2sar4253a ufouo prsn pses buffer zone of security enclave in prsn 20 shall incorporate bps buf bpsbuf pse that mediates data communications 21 between the that buffer zone and the its associated public zone drv krd 1998 1999 22 r 23 ci2sar4253b ufouo prsn omes buffer zone shall incorporate bpsbuf 24 bpsbufome that mediates data communications between that omes buffer zone 25 and its associated public zone drv krd 1998 1999 r 26 ci2sar4253c ufouo prsn pdes buffer zone shall incorporate bpsbuf 27 bpsbufpde that mediates data communications between that pdes buffer zone and 28 its associated public zone drv krd 1998 1999 r 29 ufouo to avoid cascading security failures bpsbuf needs to be implemented30 separately from other bps types31 ci2sar4253d ufouo software that performs functions of bpsbuf including 32 any operating system software shall be implemented separately from the software in other 33 bps types ie bpspub bpspri bpsmon and bpsvpn in the same prsn drv 34 krd 1180 1387 1568 r 35 ufouo bpsbuf needs to block unauthorized communications36 ci2sar4253e ufouo bpsbuf pse shall permit data communications between 37 1 the buffer zone of security enclave and 2 the public zone of that enclave as needed 38 to support the types of access communications that have been specified and authorized for 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 59registered users kmi operations and shall prevent other communications drv krd 1 0901 0906 1999 r2 ci2sar4253f ufouo bpsbufome shall permit data communications between 3 1 an ome buffer zone and via that omes public zone 2 client nodes outside the 4 prsn as needed to support the types of ome access that have been specified and authorized 5 for managers and shall prevent other communications drv krd 0901 0906 1999 r 6 ci2sar4253g ufouo bpsbufpde shall permit data communications between 7 1 pde buffer zone and via that pdes public zone 2 client nodes outside the prsn 8 as needed to support the types of pde access that have been specified and authorized for 9 koa agents and pdeenabled devices and shall prevent other communications drv 10 krd 0901 0906 1999 r 11 ci2sar4253gg ufouo bpsbufpse shall permit data communications 12 between 1 pse buffer zone and via that pses public zone 2 peer systems outside the 13 prsn as needed to support the types of communications that have been authorized for pses 14 and shall prevent other communications drv krd 0901 0906 1999 r 15 ufouo buffer zone needs to block attacks that exploit vulnerabilities in communication16 protocols17 ci2sar4253h ufouo all packetswitched data communication protocol 18 associations that pass through bpsbuf ome shall be terminated in the ome buffer 19 zone drv krd 1999 r 20 ci2sar4253i ufouo all packetswitched data communication protocol 21 associations that pass through bpsbufpde shall be terminated in the pde buffer zone 22 drv krd 1999 r 23 ci2sar4253ii ufouo all packetswitched data communication protocol 24 associations that pass through bpsbufpse shall be terminated in the pse buffer zone 25 drv krd 1999 r 26 ufouo buffer zone needs to authenticate entities with which its enclave communicates27 ci2sar4253j ufouo buffer zone of security enclave in prsn ome pde 28 or pse shall authenticate the source of user identity that initiates service request which is 29 received on data packets that are is transported from outside the prsn through the public 30 zone to the buffer zone drv krd 1998 r 31 ci2sar4253k ufouo an ome s buffer zone shall authenticate the user identity 32 that initiates service request which is received on data packets that are transported through 33 the public zone to the buffer zone for each request received from client node drv 34 krd 1998 r 35 ci2sar4253l ufouo pde s buffer zone shall authenticate the user identity that 36 initiates service request which is received on data packets that are transported through the 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 60public zone to the buffer zone for each request received from client node or from 1 pdeenabled device drv krd 1998 r 2 ci2sar4253ll ufouo pses buffer zone shall perform the authentication 3 functions that are specified for interactions with peer systems drv krd 1998 r4 ufouo security enclaves buffer zone needs to validate information before passing it5 from the enclaves public zone to its private zone or vice versa6 ci2sar4253m ufouo buffer zone of security enclave in prsn ome pde 7 or pse shall before forwarding received request transaction from the public zone to the 8 common private zone validate the transaction and record the requestevent drv krd 9 1998 r 10 ci2sar4253n ufouo pse buffer zone of security enclave in prsn shall 11 before forwarding n intersystem transaction service request from the public zone to the 12 common private zone enforce rolebased access control checks to ensure that the initiating 13 user identity has the permissions needed for the request transaction is appropriate for the 14 peer system that is its source drv krd 1998 r 15 ci2sar4253o ufouo an ome buffer zone shall before passing product or 16 service request to the common services enclave enforce rolebased and other access 17 control checks to ensure that the initiating user identity has the permissions and other 18 authorizations that are needed for the request drv krd 1998 r 19 ci2sar4253p ufouo pde buffer zone shall before passing product or service 20 request to the common services enclave enforce rolebased and other access control 21 checks to ensure that the initiating user identity has the permissions and other 22 authorizations that are needed for the request drv krd 1998 r 23 ci2sar4253q ufouo buffer zone of security enclave in prsn ome or 24 pde shall before returning to the requesting client or peer system service transaction 25 result received from the common private zone validate the result and record the event 26 drv krd 1999 r 27 ufouo information sent to users from the buffer zone may require both data confidentiality28 and data integrity services the following are some functions implemented in the buffer zone29 ufouo web portal web server provides webbased registered users with authorized 30 products and services 31 ufouo mutually authenticated kpc is established with the users client node to 32 support the users activities users that fail the authentication check are denied access 33 ufouo each user is presented with menu of only the products and services that are 34 authorized for the user 35 ufouo the user can make requests and perform actions only as permitted by the 36 permissions of the role the user is playing 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 61 ufouo transaction portal transaction interface provides transactionbased 1 registered users with authorized products and services2 ufouo either mutually authenticated kpc is established with the users client 3 node to carry transaction messages or messages are authenticated and protected 4 individually any transaction that fails an authentication check is rejected 5 ufouo the prsn will accept transactions only for the products and services that are 6 authorized for the user 7 ufouo the user can make requests and perform actions only as permitted by the 8 permissions of the role the user is playing 9 4254 u prsn common private zone10 ufouo figure 17 illustrates that private zone has connections that enable it to 11 communicate with the buffer zones other prsns psns the csn and the ekms translator12 the private zone receives product and service requests from buffer zone revalidates them and13 performs the requested processing the private zone communicates with psns as needed to14 obtain products and services to satisfy valid user requests and sends results to the buffer zone15 tardy cleanup of duplicates after removal of pki prsn concept16 ufouo figure 1 7 illustrates that the common services enclave of prsn is connected so 17 that it can communicate with the following other components18 omes to receive certain requests send back replies and exchange other data 19 pdes to send products for pickup to receive certain requests and exchange other data 20 pses to exchange data with peer systems 21 psns as needed to obtain products to fulfill requests 22 prsns as needed to process requests from omes to exchange operational data 23 csn to exchange operational data as described in the csn services section 24 ekms translator to exchange products and related operational data with the electronic 25 key management system ekms 26 ci2sar4254i ufouo prsn shall include common services enclave that 27 operates in the ussecret security domain and contains common private zone to serve 28 the the prsns omes pdes and pses drv krd 1998 r 29 ci2sar4254a ufouo the common private zone of security enclave in 30 prsn shall incorporate bpss bpspri that each mediate data communications between 31 the private zone and buffer zone of that prsn drv krd 1998 r 32 ufouo to avoid cascading security failures bpspri needs to be implemented separately33 from other bps types34 ci2sar4254b ufouo software that performs functions of bpspri including 35 any operating system software shall be implemented separately from the software in the 36 other bps types ie bpspub bpsbuf bpsmon bpsvpn in the same prsn 37 drv krd 1387 1568 r 38 ufouo bpspri needs to block unauthorized communications39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 62ci2sar4254c ufouo bpspri in prsn shall permit communications between 1 1 the prsns common private zone of the enclave and 2 the buffer zone of an ome 2 pde or pse of that prsn enclave as needed to support authorized functions of that enclave 3 prsn and shall prevent other communications drv krd 0901 0906 1999 r 4 ufouo omes pdes and pse needs to block attacks that exploit vulnerabilities in5 communication protocols6 ci2sar4254d ufouo all packetswitched data communication protocol 7 associations that pass through bpspri shall be terminated in the common private zone 8 and in the associated buffer zone drv krd 1999 r 9 ufouo the common private zone needs to authenticate entities with which its ome10 pdes and pses communicate and needs to do that independently of the authentication done in11 those enclaves12 ci2sar4254e ufouo the common private zone of security enclave in prsn 13 shall authenticate the user identity that initiates product or service request and 14 authenticate the origin of data item from peer systemthat is received through the 15 buffer zone drv krd 1998 r 16 ci2sar4254f ufouo the authentication of n identity ie of either user identity 17 or the origin of data from peer system that is performed in the common private zone of 18 security enclave in prsn shall be performed independently of the associated 19 authentication of that identity that is performed in the buffer zone of an attached ome 20 pde or pse that enclave drv krd 1998 r 21 ci2sar4254g ufouo common private zone of security enclave in prsn 22 shall when receiving request passed from the buffer zone of that enclaveprsn enforce 23 rolebased and other access control checks to ensure that the initiating user identity has the 24 permissions and other authorizations that re needed for the request drv krd 1998 r 25 ci2sar4254h ufouo the rolebased access control checks performed for 26 request in the common private zone of security enclave in prsn shall be both 27 implemented and performed 1 independently of the checks performed in the buffer zone 28 from which the request is received and 2 by highassurance mechanism drv krd 29 1998 r 30 ci2sar4254j ufouo when receiving product or service request from an ome or 31 pde common services enclave shall authenticate the user identity that initiated the 32 request drv krd 1998 r tardy cleanup from removal of pki prsn concept 33 duplicates revised ci2sar4254e 34 ci2sar4254k ufouo the authentication of user identity that is performed in 35 common services enclave shall be performed independently of the authentication of that 36 identity that is performed in the ome or pde from which the associated request was 37 received drv krd 1998 r tardy cleanup from removal of pki prsn concept 38 duplicates revised ci2sar4254f 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 63ci2sar4254l ufouo when receiving product or service request from an ome or 1 pde common services enclave shall enforce rolebased and other access control checks2 to ensure that the initiating user identity has all of the permissions and other authorizations3 that are needed for the request drv krd 1998 r tardy cleanup from removal of pki 4 prsn concept duplicates revised ci2sar4254g5 ci2sar4254m ufouo the access control checks performed in common 6 services enclave shall be implemented and performed 1 independently of the checks7 performed in the associated omes or pdes and 2 by highassurance mechanism drv8 krd 1998 r tardy cleanup from removal of pki prsn concept duplicates revised ci2 9 sar4254h 10 ufouo among kmis objectives are ensuring continued availability of service for clients by11 providing redundant points of service and minimizing the cost of usage by eliminating the need12 for users either to enter data repetitively or to have multiple client devices to access the kmi13 these objectives imply that client node should be able to obtain equivalent products and14 services at any of two or more prsns as illustrated by figure 2 that in turn implies that15 registration data and other information must be replicated between prsns the bpsvpn16 enables data to be moved at the secret level between prsn and other prsns17 ci2sar4254n ufouo the common services enclave private zone of prsn shall 18 incorporate bps bpsvpn that mediates and protects data communications between 19 1 that zone the common private zone and 2a other prsns 2b psns 2c the csn and 20 2d the ekms translator drv krd 1998 prst 21 ci2sar4254o ufouo the functions of bpsvpn in prsn shall be 22 implemented independently of the other bps types in the same prsn drv krd 1180 23 1387 1568 r 24 ci2sar4254p ufouo bpsvpn in the services enclave private zone of prsn 25 shall implement kpc that permits authorized communication between 1 that enclave zone 26 and 2 the common services enclaves private zone of other prsns the psns the csn 27 and the ekms translator and that 3 prevents all other communications drv krd 1999 28 prs t 29 ci2sar4254q ufouo bpsvpn in the common services enclave private zone 30 of prsn shall permit replication of one or more of the following data types between 1 31 that enclave zone and 2 other core nodes and the ekms as specifically authorized for 32 each type of connection drv krd 1817 1825 1905 prs t 33 1 identifier credentials 34 2 user registration data and token registration data 35 3 role and permission data 36 4 product reference catalog data 37 5 request tracking and accounting data 38 6 aswr data 39 7 audit data 40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 64 8 key compromise and token compromise reports 1 9 credential revocation identifier revocation and identity revocation requests 2 4255 u prsn interenclave guards3 ufouo figure 1 7 illustrates that the common private zone in prsn is connected by bpss 4 bpsbufpriome bps bufpripde bpspripse to the omes pdes and pses in that 5 prsn each prsn is able to be configured with omes pdes and pses to support the 6 following security domains ussecret and usunclassified natosecret and nato7 unclassified ccebsecret and ccebunclassified and coalitionsecret and coalition8 unclassified for various coalitions for any ome pde or pse that does not operate at the same 9 level as the common services enclave ie at ussecret the bps pribuf must be guard 10 that protects against unauthorized disclosure of ussecret information from the common11 services enclave to the ome pde or pse prsn also has another kind of interenclave 12 guard which is specified in the following section prsn monitoring zones13 ufouo the prsn design also needs to minimize the extent to which it relies on the proper14 operation of untrusted hardware or software for making securityrelevant decisions in this case15 that means not relying on the components of the enclaves that are on either side of those guards16 however the design also should prefer options that minimize the amount and types of data that17 must be moved through the guards with regard to data confidentiality prsn could move data18 rather freely through guard from an ome pde or pse into the common private zone but 19 movement from the common private zone to an ome pde or pse needs to be minimized 20 also with regard to data integrity and system integrity data that moves in either direction needs21 to be carefully filtered and therefore the flows of information between the common services22 enclave and the omes pdes and pses needs to be carefully designed to enable this filtering to 23 be done24 ufouo pde mainly supports retrieval of prepositioned selfprotecting product packages25 and therefore could be viewed as writeonly destination from the perspective of the common26 services enclave in actual implementation return path from pde to the common private27 zone is needed eg to return tracking data about product retrievals but the data flows on that28 return path need to be carefully restricted and filtered29 ci2sar4255a ufouo for each security level other than ussecret at which 30 prsn operates an ome the prsn shall incorporate bpspri bpspriome that is 31 guard that mediates data communications between the security level of that ome and the 32 security level of the common services enclave drv krd 0842 1387 1998 2135 r 33 ci2sar4255b ufouo for each security level other than ussecret at which 34 prsn operates pde the prsn shall incorporate bpspri bpspripde that is 35 guard that mediates data communications between the security level of that pde and the 36 security level of the common services enclave drv krd 0842 1387 1998 2135 r 37 ci2sar4255bb ufouo for each security level other than ussecret at which 38 prsn operates pse the prsn shall incorporate bpspri bpspripse that is 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 65guard that mediates data communications between the security level of that pse and the1 security level of the common services enclave drv krd 0842 1387 1998 2135 r2 ci2sar4255c ufouo each bpspriome guard shall permit communications 3 between 1 its ome and 2 the common services enclave as needed to support authorized4 functions of the prsn and shall prevent other communications drv krd 1999 r5 ci2sar4255d ufouo each bpspripde guard shall permit communications 6 between 1 its pde and 2 the common services enclave as needed to support authorized7 functions of the prsn and shall prevent other communications drv krd 1999 r8 ci2sar4255dd ufouo each bpspripse shall permit communications between 9 1 its pse and 2 the common services enclave as needed to support authorized functions 10 of the prsn and shall prevent other communications drv krd 1999 r 11 ci2sar4255e ufouo guard functions of bpspri ie the functions that 12 separate security domains shall be modularly implemented separately from other bps 13 functions of that device drv krd 1180 1387 1568 r 14 ufouo omes pdes and pse needs to block attacks that exploit vulnerabilities in15 communication protocols16 ci2sar4255f ufouo all packetswitched data communication protocol 17 associations that pass through bpspriome guard shall be terminated in the common 18 services enclave and in the ome buffer zone drv krd 1999 r 19 ci2sar4255g ufouo all packetswitched data communication protocol 20 associations that pass through bpspripde guard shall be terminated in the common 21 services enclave and in the pde buffer zone drv krd 1999 r 22 ci2sar4255gg ufouo all packetswitched data communication protocol 23 associations that pass through bpspripse shall be terminated in the common services 24 enclave and in the pse buffer zone drv krd 1999 r 25 ci2sar4255h ufouo bpspriome guard shall permit data to pass between 26 the common private zone and ome buffer zone only as needed to support the ordering and 27 management of kmi products and services drv krd 1817 1825 1905 r 28 ci2sar4255i ufouo bpspripde guard shall permit data to pass between the 29 common private zone and pde buffer zone only as needed to support the delivery of kmi 30 products and services drv krd 1817 1825 1905 r 31 ci2sar4255ii ufouo bpspripse shall permit data to pass between the 32 common private zone and pse buffer zone only as needed to support the operation of the 33 kmi drv krd 1817 1825 1905 r 34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 66426 u prsn monitoring zones1 ufouo monitoring zone receives and analyzes intrusion detection event data audit event2 data and other information from computer platforms in other zones and bpss various3 approaches are possible for implementing this architectural concept in prsn each enclave4 could have its own monitoring zone or prsn could have single monitoring zone as5 illustrated by figure 1 8 prsn monitoring zone primarily has responsibility for aswr 6 functions as stated in the following requirements7 figure 18 u kmi prsn notional monitoring architecture 8 9 unclassifiedfouo 10 ci2sar426a ufouo each prsn computer platform that generates aswr data 11 shall report the data to its security enclaves monitoring zone ie to the monitoring zone 12 that is responsible for monitoring that security enclave upon demand or periodically as 13 configured by an aswr manager drv krd 1824 r 14 ci2sar426b ufouo monitoring zone that is responsible for prsn security 15 enclave shall include computer platform dedicated to aswr drv krd 1816 r 16 ci2sar426c ufouo prsn aswr processes shall enable an aswr manager to 17 configure the method and frequency by which aswr data is reported from computer 18 platforms in security enclave to the enclaves monitoring zone drv krd 1408 r 19common services enclave ussecret domainekms translator common monitoring enclave ussecretpsnsother prsnscsn manager client nodes koa agent client nodes pdeenabled devices servers in peer systemsomepde pse buffer zone bpsbuf omepde pse bpspub omepde pseomepde pse public zonebpsvpncommon private zone bpsmon oneway guardbpspri omepde pse some are guards backend virtual private network common monitoring zone bps vpnprsn omes pdes pses ussecret and various other domainskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 67ci2sar426d ufouo aswr processes in prsn security enclaves monitoring 1 zone shall be able to correlate and analyze aswr data produced by multiple components in2 security zone of that enclave in manner that facilitates detection and characterization of3 threat actions that span multiple components in the zone drv krd 1817 1824 r4 ci2sar426e ufouo aswr processes in prsn security enclaves monitoring 5 zone shall be able to correlate and analyze aswr data produced by multiple security zones6 in that enclave in manner that facilitates detection and characterization of threat actions that7 span multiple zones in the enclave drv krd 1817 1824 r8 ci2sar426f ufouo prsn shall have common monitoring enclave in which 9 aswr processes shall be able to correlate and analyze aswr data produced by multiple 10 security enclaves in manner that facilitates detection and characterization of threat actions 11 that span multiple enclaves in the prsn drv krd 1817 1824 r 12 ci2sar426g ufouo the common monitoring enclave of prsn shall 13 periodically as configured by an aswr manager report aswr data to the csn drv 14 krd 1824 rs 15 ci2sar426h ufouo the common monitoring enclave of prsn shall notify the 16 csn of actual or suspected threat actions detected in the prsn drv krd 0128 1824 17 rs 18 ci2sar426i ufouo each monitoring zone in prsn shall have configurable 19 ability to generate reports based on its analysis of received aswr data and the severity level 20 of actual or suspected threat actions drv krd 1824 r 21 ufouo prsn monitoring zones also have involvement in overseeing system integrity22 ci2sar426j ufouo each computer platform that generates data concerning system 23 integrity checks shall report the data to its security enclaves monitoring zone upon demand 24 or periodically as configured by an security configuration manager drv krd 1824 r 25 ci2sar426k ufouo processes in prsn security enclaves monitoring zone shall 26 be able to check the system integrity of the components in the enclave drv krd 1019 27 r 28 ci2sar426m ufouo the monitoring zone of prsn security enclave shall notify 29 an incident response manager of any unauthorized change in the system integrity of 30 component in the enclave drv krd 1019 r 31 ufouo prsn monitoring zones also have involvement in overseeing system performance32 ci2sar426n ufouo each computer platform that generates platform performance 33 data and related computer network traffic data shall report the data to its security enclaves 34 monitoring zone upon demand or periodically as configured by security configuration 35 manager drv krd 1865 r 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 68ufouo in the notional singlemonitoringzone architecture that is illustrated by figure 1 8 1 bpsmon mediates oneway data communication into 1 the common monitoring zone from2 the computer platforms of 2a the common private zone and its associated bpsvpn and bps3 pris 2b the ome and pde buffer zones and their associated bpsbufs and 2c the ome4 and pde public zones and their associated bpspubs r5 ci2sar426o ufouo monitoring zone shall incorporate one or more bpss bps 6 mon oneway guard that mediates data communication into 1 that zone from the 27 computer platforms of the prsn components that are being monitored by that monitoring8 zone drv krd 1998 r9 ci2sar426p ufouo software that performs functions of bpsmon including 10 any operating system shall be implemented separately from the software in the other bps 11 types in the same prsn enclave drv krd 1387 1568 r 12 ci2sar426q ufouo in prsn the communication media that connect 13 component platform of monitored security zone to bpsmon shall be physically 14 separate from those that provide other data paths between platforms drv krd 1387 15 1568 r 16 ci2sar426r ufouo in prsn all packetswitched data communication protocol 17 associations that pass through bpsmon to monitoring zone from computer platform 18 of another security zone bps or guard shall be terminated in that monitoring zone and in 19 that other component drv krd 1999 r 20 ci2sar426s ufouo in prsn bpsmon shall permit oneway data transfer 21 from the common private zone buffer zones public zones and bpss associated with those 22 zones through the bpsmon into its associated monitoring zone as needed to support 23 authorized functions of that monitoring zone and shall prevent other communications 24 including preventing any data transfer out of the monitoring zone through bpsmon drv 25 krd 0901 0906 1999 r 26 ci2sar426t ufouo in prsn bpsmon shall support data replication to the 27 bpsmons associated monitoring zone for the purpose of the keeping watch over the 28 prsn and that data shall include the following drv krd 1817 1825 1905 r 29 1 aswr event data 30 2 audit event data 31 additional data items are expected to be defined when detailed design is done 32 427 u prsn intradomain data flow33 ufouo the type of bps that is labeled illustrated as bpsvpn in figures 1 7 and 18 34 enables data to be moved within the same security domain between prsns between prsn35 and psn between prsn and the csn and between prsn and the ekms translator36 ci2sar427a ufouo the common services enclave of prsn shall incorporate 37 bps bpsvpn that mediates and protects authorized data communications between 38 1 that enclave and 2a the common services enclaves of other prsns 2b the us 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 69secret interfaces of psns and 2c ussecret interface of the csn and 2d ussecret1 interface of the ekms translator drv krd 1998 prst2 ci2sar427b ufouo the common monitoring enclave of prsn shall incorporate 3 bps bpsvpn that mediates and protects authorized data communications between4 1 that enclave and 2 only ussecret security enclave of the csn drv krd 19985 rs6 ci2sar427c ufouo the functions of bpsvpn in prsn shall be performed by 7 software including the operating system that is implemented separately from the software in8 any other bps types in the same security enclave drv krd 1180 1387 1568 r9 ufouo when data is replicated between enclaves in the same domain various integrity10 checks are needed at the application level for example when user registration data is replicated11 the kmi needs to compare the core data of replicated users to that of all existing users in the12 destination domain and if duplicate user is found or other data elements do not properly match13 between the domains either update the users data in the destination domain or notify an14 authorized user registration manager or system security officer sso to revoke associated15 identities identifiers and credentials as required by established procedures similar action is16 needed when token registration data is replicated further discussion of those requirements is17 provided in kmi2200v218 43 u product source nodes19 ufouo users request kmi products and services from prsns and prsns in turn obtain20 products and services from psns psn produces some subset of the products managed by the21 kmi and psn may additionally provide services related to those products specific types of22 products and functionality for producing them are specified in volume 123 ufouo psn may respond to product requests from one or more prsns and prsn may24 be served by more than one psn psns can either be collocated with prsns or be remote from25 them psns do not in principle require human intervention to process requests some psns are26 expected to support lightsout cryptographic manufacturing mode in which all psn27 operations are automated and prsns perform any operations that require interaction with28 humans29 ufouo psn is comprised of components needed to generate its products and also30 components needed to interface with other core nodes psns are intended to be modular new31 psns should be able to be attached to the kmi to meet new requirements of cryptographic32 systems and their users and existing psns should be removable when longer needed33 431 u psn security characteristics34 ufouo all ci2 psns are subject to the security policies in volume 2 but otherwise they35 may be quite different from each other each psn is expected to be designed to meet unique36 security needs of its product set and this usually will involve additional specialized policy and37 doctrine some ci2 psns will be legacy systems now operated by the dod some may be new38 systems developed with ci2 or developed by other parts of government and some may be39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 70commercial systems under contract to serve the government therefore although this nodal1 security architecture section states basic requirements for psns to communicate securely with2 prsns it does not state requirements for internal structures of psns like it does for prsns3 ufouo security level for psn interfaces since psns connect to the common private 4 zone of prsns and since that zone operates at the us secret level psn needs to include5 an interface at ussecret however psn either may operate at that single level or may6 operate in multilevel mode eg to produce key material for multiple levels of use7 ci2sar431a ufouo psns that are incorporated in kmi ci2 shall either operate in 8 the ussecret domain or shall provide one or more interfaces at the ussecret level for9 connecting to prsns and to the csn drv krd 1998 prs 10 ufouo data confidentiality and data integrity for products this nodal security 11 architecture section does not state requirements for prsns to provide specific data 12 confidentiality or data integrity services for products received from psns products issued by 13 psns include cryptographic secrets and other sensitive information 14 432 u psn communications15 ufouo figure 1 7 illustrates that connection between psn and prsn is made through 16 virtual private network implemented by bpss at the communication end points17 ufouo ci2sar432a psn shall be connected to data communications 18 infrastructure that enables it to interact with the csn and with one or more prsns drv 19 krd 1180 p 20 ufouo ci2sar432b psn shall incorporate one or more bpss that mediate and 21 protect data communication between 1 the psn and 2 the csn and one or more prsns 22 that the psn serves drv krd 1998 prs 23 ufouo ci2sar432c bps that connects psn to the csn or prsn shall 24 1 implement kpc for authorized communications between the psn and the csn or 25 prsn and 2 shall prevent other communications drv krd 1999 p 26 ufouo in addition to connecting to prsns psns in ci2 will need to connect to the csn27 depending on the extent to which csn functions are developed in ci2 this nodal security28 architecture section does not state requirements for psncsn communication interface29 because those requirements are not yet welldefined30 ufouo psn is not expected to connect to other psns in either ci2 or the target31 architecture32 44 u central services node33 ufouo the kmi target architecture defines the central services node csn as the34 component that has primary responsibility for providing management services that ensure35 functional consistency enterprisewide ie across all kmi nodes platforms and sites the ci236kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 71csn is separate from prsns and psns and it is intended to operate at central nsa site its1 components are intended to be replicated at an appropriate remote site to provide coldstart2 backup with manual cutover the ci2 csn provides an initial set of both offline and online3 services but not the full set of csn services contemplated by the target architecture future4 capability increments will build on the ci2 base of csn services possibly putting more csn5 services online also when kmi capabilities are developed to provide prsn and psn services6 to users deployed in tactical or isolated environments the kmi will provide accompanying csn7 services8 441 u csn services9 ufouo the services provided by the csn can be grouped into the following four general10 categories11 ufouo data management building maintaining and publishing centralized databases 12 ufouo security management analyzing event data issuing warnings and policies 13 ufouo component management monitoring configuration performance and health 14 ufouo production management overseeing user roles catalog 15 4411 u csn data management services16 ufouo as illustrated by figure 1 9 the csn supports kmi operations by maintaining 17 databases for some important types of data that are handled by prsns and psns in most cases18 the csn receives the data from prsns and psns and stores it in databases both for management19 use at the csn and for archival and backup purposes in few cases database is generated at20 the csn and its contents are distributed to psns and prsns for their use or for redistribution to21 client nodes all of the data that is received or generated at the csn is protected in accordance22 with volume 2 in some cases this involves encrypting or digitally signing data records23 44111 u data received by the csn from prsns and psns24 ufouo as illustrated by figure 1 9 the csn receives and stores the following types of data 25 from prsns and psns some of the data originates at client nodes but is passed through prsns26 to the csn27 ufouo registration data this database describes users and their pki hardware tokens 28 and is used for analyses that are part of the security component and production management 29 services provided by the csn 30 ufouo enrollment data this database records assignments of users to manager roles 31 this data is handled similarly to user registration data 32 ufouo pki output repository this database contains any pki products that are 33 generated by the kmi and are required for kmi operation 34 ufouo tracking and accounting data this database records the lifecycle status and 35 custody of products and services including ordering and delivery status 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 72figure 19 u kmi csn functions and databases 1 2 unclassifiedfouo 3 ufouo aswr data this database records potentially harmful events reported by 4 intrusion detection sensors5 ufouo audit data this database records significant events reported by platforms and 6 applications7 ufouo configuration data this database records changes that are made in the 8 composition and arrangement of system components9 ufouo p erformance data this database records measurements of the effectiveness of 10 system operations 11 ufouo fault reports this database contains records of errors failures and other 12 abnormal operations in system components 13 ufouo trouble reports this database contains reports and requests submitted by users 14 to the help desk 15 ufouo the ci2 csn is mainly sink for the data types listed above although the ci216 csn might make some of this data available as backup copies for some nodes the csn17 normally neither redistributes these types of data to other nodes nor provides database18 consolidation or synchronization services for other nodes19 44112 u data distributed by the csn to prsns and psns20 ufouo as illustrated by figure 1 9 the csn is the source for some types of systemlevel 21 data needed by other nodes either in common or individually in these cases the csn maintains22databasescsn role standards product catalog help desk aids configuration standards pki products from external pkis prsns psns ekms translatordata distribution functionskmi managers data analysis functions registration data enrollment data pki products output tracking and accounting data aswr and audit data configuration and performance data fault and trouble reports data collection functionsdata preparation functionskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 73a master database and downloads partial images to prsns and psns the csn distributes the1 following types of data to prsns and psns2 ufouo role standards this data defines systemwide rules for assignments 1 of 3 permissions to roles and 2 of roles as subordinates of other roles ie the role hierarchy4 ufouo product catalog this database describes and defines kmi products 5 ufouo library content this database contains master copies of unclassified library 6 objects that are made available to koa agents through pdes classified library objects7 need to be wrapped for delivery therefore they are treated like other products and must be8 ordered individually see access to library objects section9 ufouo help desk aids this database contains master copies of material that the help 10 desk provides to users 11 ufouo configuration standards this database defines systemwide rules for the 12 composition and arrangement of components 13 ufouo pki input repository this database contains any pki productsx509 14 certificates and crlsthat are received from pkis external to the kmi and are required for 15 kmi operation 16 44113 u purposes for storing data at csn17 ufouo database administrators at the csn maintain stored data in formats appropriate for18 the following uses19 ufouo management services the csn maintains databases to support security 20 management component management and production management functions 21 ufouo longterm archive service the csn maintains copies of kmi data that must 22 be stored for relatively long period of times 23 ufouo backup service the csn maintains reserve copies of some kmi data for use if 24 an original copy becomes lost or damaged 25 ufouo the ci2 csn consolidates data received from other nodes and creates databases26 that are used at the csn to perform analyses in support of ongoing management functions which27 are described in following sections28 ci2sar4411a ufouo the csn shall maintain databases to support security 29 management component management and production management processes drv krd 30 2011 s 31 ufouo the ci2 csn maintains an archive of data that is received from other kmi nodes or32 generated at the csn each prsn and psn includes functions that support archive operations33 these functions collect data that meets specified criteria offload the data to secure storage34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 74location and maintain records to support later retrieval of the data from the archive the locally1 archived data is also forwarded to the csn for central archiving ci2 has an initial online2 capability for receipt of archive data over vpn internal to kmi however because of the3 volume of such data some of it might instead be offloaded to physical media at prsns and4 psns and sent to the csn through offline channels5 ci2sar4411b ufouo the csn shall maintain archives to support longduration 6 security services and long periods of use of products and services drv krd 2011 s7 ufouo each prsn and psn includes functions that maintain backups for data needed for8 normal operations however copies of some of this data are sent to the csn to provide a9 secondary backup and some data archived at the csn also serves backup purpose10 ci2sar4411c ufouo the csn shall maintain backup databases to support 11 information integrity services and system integrity and availability services for core 12 nodes drv krd 1105 s see security service policies section of volume 2 for 13 service definitions and related requirements 14 4412 u csn security management services15 ufouo the csn supports the kmis security policy and security architecture by providing16 managers with an overview of security operating conditions across the entire system and to a17 limited extent in ci2 by distributing security information and helping to control security18 services and mechanisms in other nodes19 ufouo the csn receives data that is collected and generated by the aswr components20 and audit components in prsns and psns the csn receives the data both online and offline21 depending on the timecriticality and volume of the data and stores the data in appropriate22 databases the csn analyzes the data both periodically and as requested by managers to detect23 and investigate threat actions against the kmi24 ufouo aswr event data the csn receives data from idss in prsns and psns 25 merges the datasets to provide an overview of the entire kmi and analyzes the merged data 26 data flowing to the csn from prsns and psns can range from complete database transfers 27 to notification of only selected incidents exceeding configurable thresholds any decisions to 28 limit flow to the csn are based on tradeoff in benefits between localized versus centralized 29 aswr analysis and response and on network bandwidth issues 30 ci2sar4412a ufouo the csn shall incorporate processes and procedures to detect 31 threat actions against the kmi and if and when threat actions are detected provide warning 32 of them and respond to them with counteractions in accordance with the attack sensing 33 warning and response service section of the security policy kmi2200v2 drv krd 34 1016 1823 1826 s 35 ufouo audit data the csn receives audit data from individual prsns and psns 36 merges the data and analyzes it to provide an audit overview of the entire kmi 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 75ci2sar4412b ufouo the csn shall incorporate processes for recording and 1 analyzing audit trail data concerning securitysensitive events and securitysensitive2 functions in accordance with the audit service section of the security policy 3 kmi2200v2 drv krd 0990 s4 ufouo security analyses performed by the csn can take advantage of the csns data5 management resources by combining aswr and audit data and also by combining those types6 of data with any of the other types received and stored at the csn7 ufouo the csn distributes security management information to prsns and psns to8 support the control of security services and mechanisms and to provide warnings concerning9 threats and threat actions in ci2 however all such information is distributed offline with10 respect to the kmi vpn using other secure communications11 ufouo warnings alerts generated by csn aswr analyses are disseminated to other 12 nodes to enable them to respond appropriately the csn also is the focal point for receiving 13 alerts from nonkmi systems and for sending alerts to those systems 14 ufouo policies rules and directions for the operation of security components are 15 disseminated to other nodes among these are the following 16 directions for configuring bps policies 17 directions for configuring other aswr sensors and reports 18 directions for configuring the collection of audit trail data 19 4413 u csn component management services20 ufouo the csn does configuration monitoring performance monitoring and system health21 monitoring to support managers in controlling applications platforms networks and sites22 ufouo configuration monitoring this function supports configuration control of kmi 23 components in accordance with the configuration control section of volume 2 it 24 involves collecting and analyzing data to support the preparation initialization maintenance 25 and termination of kmi operations and services the csn maintains master database that 26 describes the authorized configuration for all core nodes and supports several aspects of 27 configuration management 28 ufouo establishing and verifying configurations this involves defining and 29 maintaining component resources and attributes each core node periodically tests 30 whether its installed configuration matches the authorized one and reports to the csn 31 ufouo distributing software this involves delivering operating instructions and 32 tabular data for use by hardware components for example installation of new software 33 at prsns is accomplished in ci2 by using outofband physical distribution but 34 software might be downloaded electronically in later kmi capability increments the 35 download of software presumably would originate at the csn 36 ufouo initializing and terminating operations this involves startup and 37 shutdown of components and routine maintenance functions such as performing 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 76backups in ci2 these functions are performed locally at every kmi node in later kmi 1 capability increments the csn might have capabilities to operate nodes remotely 2 ufouo performance monitoring kmi core nodes collect data regarding their own 3 functional effectiveness and forward reports to the csn the csn compiles and analyzes4 that data kmi managers both locally and at the csn use the data to evaluate and tune5 system operations and thereby control the quality of system services6 ufouo system health monitoring fault detection functions of kmi nodes monitor for 7 and collect data on errors and failures in their own components and in other nodes kmi8 managers at the nodes use the data to detect isolate and correct operating problems and9 abnormal conditions in local components the nodes also forward fault data to the csn 10 where managers use the data to detect isolate and correct systemwide problems 11 4414 u csn production management services12 ufouo as illustrated by figure 1 9 the csn supports operations concerned with the 13 production and delivery of products and services to users14 ufouo registration and enrollment oversight the csn receives user registration 15 data and manager enrollment data from prsns and checks the data for completeness and 16 correctness within the context of systemwide databases maintained at the csn these 17 checks help to verify the proper operation of the prsns however the csn does not 18 replicate that data to other prsns instead the prsns replicate registration data between 19 each other as required or each prsn maintains master copy of part of the registration 20 database and cooperates with other prsns to support the full database 21 ufouo role management the csn sets systemwide standards for the hierarchy of 22 roles and for assigning permissions to roles and distributes this information to prsns 23 ufouo product catalog management the csn supports the creation and 24 maintenance of the master version of the product catalog and distributes appropriate subsets 25 to prsns and psns conceptually the product catalog has two main parts 26 ufouo product ordering catalog this part of the product catalog contains 27 product descriptions that are used by prsns 1 to create forms templates for 28 accepting orders for products and related services and 2 to validate the orders this 29 security architecture assumes that this part of the kmi product catalog is unclassified if 30 further analysis determines that some product descriptions are classified they could be 31 stored with the product reference catalog as shown in figure 19 32 ufouo product reference catalog this part of the product catalog contains 33 product definitions that are used by type 1 psns to generate products this security 34 architecture assumes that this part of the product catalog either alone or combined with 35 classified product descriptions is classified but not higher than secret 36 ufouo library content management the csn maintains the master versions of 37 unclassified library objects and distributes copies to prsns for release through pdes 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 77 ufouo help desk support the csn maintains master versions of material that help 1 desks provide to users and the csn distributes copies to various help desk locations2 4415 u csn data characteristics3 ufouo to provide the services described above kmi managers that are responsible for the4 csn require database management servers together with processors to perform data preparation5 data distribution data collection and data analysis functions figure 1 9 illustrates those 6 functions and their supporting databases in the csn7 ufouo table 8 lists sources of data that is sent to the csn and table 9 lists destinations of8 data that is sent by the csn for each source and destination the tables list the types of data and9 the classification of each type10 table 8 u kmi data received by csn from other nodes 11 data source data types data classification 1 prsns common private zone which operates at secretregistration and enrollment data tracking and accounting data aswr and audit data configuration performance and fault data trouble reports received by help desksecret because it has been handled on systemhigh platform 2 prsns ome this is an indirect source data is routed through omeguard and common servicestracking and accounting data aswr and audit data configuration performance and fault datasecret unclas but all can be moved up to secret by omeguard 3 prsns pde this is an indirect source data is routed through pdeguard and common servicestracking and accounting data aswr and audit data configuration performance and fault datasecret unclas but all can be moved up to secret by pdeguard 4 psn that operates with an interface at the unclassified levelpki products tracking and accounting data aswr and audit data configuration performance and fault dataunclas because received from psn interface at that level 5 psn that operates with an interface at the secret levelpki products tracking and accounting data aswr and audit data configuration performance and fault datasecret because received from psn interface at that level 6 ekms translator aswr and audit data configuration performance and fault datasecret because ekms is at that level 7 client node this is an indirect source all data is routed through prsnregistration data also interaction with prsns causes other types of data to be generated in prsnssecret unclas according to security level of connection to prsn unclassifiedfouo 12 ufouo although the data received by the csn from other components is generated at 13 variety of security levels and the data generated and sent by at the csn is intended to be 14 used by components that operate at variety of security levels it is not necessary to use 15 multilevelsecure platforms for the csn database servers and other csn functions shown in 16 figure 19 instead csn services can be hosted on computer platforms that each operate at 17 single leveleither us secret or unclassifiedexcept for some guard devices and those 18kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 78guards need only to move data from the unclassified domain to the secret domain this is1 because of three characteristics of the data handled by the csn2 ufouo first the types of data received by the csn which are listed in table 8 are3 disjoint from the types of data issued by the csn which are listed in table 9 therefore the4 two sets of data can be kept on different servers5 ufouo second the inbound data listed in table 8 is generated in kmi components that6 operate at various security levels but it can all be stored at the csn on one or more servers7 that operate in system high mode at ussecret for example audit data could be generated8 in prsns omes at ussecret natosecret ccebsecret usunclassified9 natounclassified and ccebunclassified however these various kinds of audit data 10 need not be kept separated by the csn because they never are redistributed by the csn to 11 other nodes all the audit data can be aggregated in single systemhigh database at us 12 secret in fact audit data is aggregated by each prsn before it is sent to the csn because 13 each prsn is required to perform its own audit analysis prsn needs to aggregate the 14 data into the common private zone which operates at us secret ufouo third the 15 outbound data listed in table 9 needs to be sent to kmi components that operate at variety 16 of security levels but it all can be generated and stored at the csn in server operating at 17 usunclassified except for the classified part of the product catalog 18 table 9 u kmi data sent by csn to other nodes 19 data destination data types data classification 1 prsns common private zone which operates at secretrole standards product catalog descriptions configuration standards help desk aidsunclas unclas unclas unclas 2 prsns ome this is an indirect receiver data is routed through common services and omeguardproduct catalog descriptions configuration standardsunclas unclas 3 prsns pde this is an indirect receiver data is routed through common services and pdeguardconfiguration standards unclas unclas 4 psn that operates with an interface at unclassified levelproduct catalog definitions unclas 5 psn that operates with an interface at the secret levelproduct catalog definitions secret 6 ekms translator configuration standards unclas 7 client node this is an indirect receiver data is routed through prsnconfiguration standards unclas unclassifiedfouo 20 ufouo in summary data handled by the csn has the following characteristics21kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 79 ufouo data that the csn sends to other components can mainly be generated and stored1 at the csn at the usunclassified level and then be moved to the components by2 upgrading the data to other security levels as needed thus data need be downgraded3 ufouo data that the csn receives from other components can be stored and processed4 at the csn at the ussecret level and can be moved from the other components to the csn5 by upgrading the data to ussecret as needed thus none of the data need be downgraded6 442 u csn enclaves and data flows7 ufouo the csn consists of suite of highavailability servers which are replicated at a8 backup site the csn can connect online to psns and prsns via virtual private network9 implemented by kpcs and might communicate only offline with some of those core nodes10 guard devices internal to the csn move data between the csn components that operate at11 different security level and between those components and components of psns and prsns12 ufouo figure 20 illustrates csn components and data flows in the csn the csn is 13 divided into an unclassified enclave and secret enclave the unclassified enclave has only an14 outbound zone but the secret enclave is divided into an outbound zone and an inbound zone15 figure 20 u kmi csn enclaves and data flows 16 17 unclassifiedfouo 18 ci2sar442a ufouo all components of the csn shall be grouped into two separate 19 security enclaves of which one operates in the usunclassified domain and the other in 20 the ussecret domain drv krd 1180 1998 s 21bpscsn4 optional airgap prsnpsn components operating at unclasprsnpsn components operating at secret and ekms translatorbpscsn1 optional airgap prsnpsn components operating at unclasbpscsn3 optional airgapcsnizg u to sproduct reference catalog s other types of data distributed by csn uunclas labeling and signature functiondata prep and distribution u secret labeling and signature function outbound zoneinbound zonepossible future data distribution functions bpscsn2 optional airgapcentral services node outbound zoner legend dashed lines denote possible future functionscsn enclave usunclass csn enclave ussecret aproduct ordering catalog udata prep and distribution scsnieg u to sdatabase management and analysis s prsnpsn components operating at secret and ekms translatordata outputdata outputdata inputkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 80ci2sar442b ufouo all components of the csns unclassified security enclave 1 shall be grouped into single security zonethe outbound zone drv krd 1180 19982 s3 ci2sar442c ufouo all components of the csns secret security enclave shall be 4 grouped into two security zonesoutbound and inbound drv krd 1180 1998 s5 ci2sar442d ufouo computer platform that implements functions of an inbound 6 or outbound zone in security enclave of the csn shall be physically separate from7 computer platforms that implement functions of all other security zones drv krd 11808 1568 s9 ufouo the secret enclave of the csn distributes data directly to secret enclaves in other10 nodal components and via those other enclaves indirectly to unclassified enclaves in those11 components the unclassified enclave of the csn might in future capability increments deliver12 data directly to unclassified enclaves of other components the secret enclave handles data that13 the csn receives from secret enclaves of other components and might in future capability14 increments receive data directly from unclassified enclaves of those components the following15 subsections describe the components and functions of each enclave and zone of the csn and the16 communications between csn components and components of psns prsns and the ekms17 translator18 ufouo figure 20 shows the product ordering catalog data being distributed from the 19 unclassified outbound zone and the product reference catalog data from the secret outbound20 zone this is not intended to specify the architecture for the catalog database or its maintenance21 but only to describe the levels at which catalog data is distributed to prsns and psns the22 catalog and its kmi interfaces are described and specified in more detail in volume 123 4421 u csn unclassified enclave24 ufouo figure 20 illustrates that the unclassified enclave includes computer platforms to 25 support data preparation data storage and data distribution for unclassified data listed in table26 9 that the csn sends to psns and prsns data preparation storage and distribution functions27 may be performed on the same platforms or on separate platforms28 ci2sar4421a ufouo the outbound zone of the csns unclassified security 29 enclave shall incorporate one or more computer platforms database prep and distribution 30 u that operate at usunclassified and support 1 preparation of data to send to psns 31 and prsns 2 storage of that data and 3 distribution of that data drv krd 1998 s 32 ufouo from the types of data listed in table 9 the csns unclassified enclave tailors33 appropriate datasets to send to various enclaves and zones of psns and prsns and distributes34 each dataset directly or through the csns secret enclave for example the data maintained in35 the csns unclassified enclave includes the section of the product catalog that holds product36 descriptions this information is needed by prsns to construct the templates ie tailored web37 pages that omes display to users who manage products however the entire catalog is not38 intended to be offered in every ome an ome that operates at ussecret will probably offer39 the entire catalog and an ome that operates at usunclassified might offer most of the40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 81catalog but omes that serve nato and cceb users will offer only parts of the catalog1 therefore the csns unclassified enclave prepares an appropriate catalog subset to send to each2 type of ome and routes those datasets to the csns secret enclave which in turn routes them3 through the common private zone of prsns to the omes4 ufouo the csns unclassified enclave might in future capability increments distribute5 data directly to psns operating at the unclassified level through paths described in the csn6 communication with other nodes section below otherwise the unclassified enclave sends a7 dataset to the outbound zone of the secret enclave through the path labeled r in figure 20 to 8 be relayed to psn or prsn9 ci2sar4421b ufouo the csns unclassified security enclave shall be able to 10 route prepared dataset appropriately either for direct distribution to psn or for transfer 11 to the outbound zone of the csns secret security enclave drv krd 1899 s 12 4422 u csn classified enclaveoutbound zone13 ufouo figure 20 illustrates that when the csns secret enclave receives dataset from the 14 unclassified enclave the secret enclave immediately applies both 1 security label to indicate15 that the dataset consists only of unclassified data and 2 digital signature the signature16 protects the integrity of the dataset and its label and also identifies the csn as the origin of the17 dataset then the dataset is transferred into the secret security domain through the csn inter18 enclave guard csnieg19 ci2sar4422a ufouo the outbound zone of the csns secret security enclave 20 shall incorporate guard csnieg that 1 permits datasets to be transferred to that 21 enclave from the csns unclassified security enclave as needed to support authorized 22 functions of the prsn but prevents data from being transferred in the opposite direction and 23 2 labels each dataset as unclassified and digitally signs the labeled dataset before 24 transferring it to the secret domain drv krd 1387 1900 1999 s 25 ci2sar4422b ufouo computer platform that supports csnieg shall be 26 physically separate from computer platforms that implement other functions of the csn and 27 functions of other nodes drv krd 1180 1387 1568 s 28 ufouo figure 20 illustrates that the secret enclave also includes computer platforms to 29 support data preparation data storage and data distribution30 ci2sar4422c ufouo the outbound zone of the csns secret security enclave 31 shall incorporate one or more computer platforms data prep and distribution u as 32 illustrated in figure 20 that operate at the ussecret level and that support 1 preparation 33 of data to send to psns and prsns 2 storage of that data and 3 distribution of that data 34 drv krd 1998 s 35 ufouo the secret outbound zone prepares and stores the classified part of the product36 catalog ie the product definitions that the csn sends to psns37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 82ufouo the secret outbound zone sends data directly to psns and to the common private1 zones and monitoring zones of prsns through paths described in the csn communication2 with other nodes section below the secret outbound zone sends data indirectly to omes3 and pdes in various domains via prsn common services4 ci2sar4422d ufouo the outbound zone of the csns secret security enclave 5 shall be able to route prepared dataset either for direct distribution to psn or to prsn6 common services enclave or for indirect distribution via prsn common services to a7 prsn ome or pde drv krd 1999 s8 ufouo the csns secret outbound zone and the common services zone and monitoring9 zone of prsn all operate system high at the ussecret level therefore when the secret10 outbound zone passes dataset to prsn the common services or monitoring zone must11 handle the dataset as being secret however if the dataset is intended for an ome or pde12 common services can pass the dataset to the appropriate ome guard or pde guard the guard13 is able to verify csn signature and validate an unclassified label and therefore14 transfer dataset from the secret level of common services to an ome or pde that operates at a15 lower level than secret16 4423 u csn classified enclaveinbound zone17 ufouo figure 20 illustrates that the inbound zone includes computer platforms to support 18 databases that store the data listed in table 8 received from psns and prsns and to support19 analysis of that data for management purposes analysis functions may be performed on the20 same platforms that hold the databases or on separate platforms21 ci2sar4423a ufouo the inbound zone of the csns secret security enclave 22 shall incorporate one or more computer platforms database management and analysis 23 s that operate at ussecret support databases created from data received by the csn 24 from psns and prsns and support analysis of that stored data drv krd 1998 s 25 ufouo the dashed box and dotted line the secret inbound zone in figure 20 are not 26 intended for ci2 implementation they represent possible future data distribution functions27 that might be implemented in ci3 or later these possibilities are noted in the figure to alert ci28 2 implementers to avoid designs that would make it difficult to add such functions to the kmi in29 later capability increments the csnizg bpscsn3 and bpscsn4 components that30 are shown in the inbound zone in figure 20 are discussed in the following section 31 4424 u csn communication with other nodes32 ufouo figure 2 1 illustrates the types of communication associations between csn 33 components and components of psn and prsns34 ci2sar4424a ufouo the csn shall be connected to data communications 35 infrastructure that enables it to interact with psns and prsns krd 1180 s 36 ci2sar4424d ufouo the outbound zone of the csns secret security enclave 37 shall include an interface for sending data at the ussecret level to 1 common services 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 83zones and monitoring zones of prsns and 2 psn interfaces operating at the secret level1 drv krd 1998 s2 figure 21 u kmi csn connections to core nodes 3 4 unclassifiedfouo 5 ci2sar4424e ufouo the outbound zone of the csns secret security enclave 6 shall incorporate bps bpscsn2 that mediates and protects data sent from that7 zoneeither online or optionally through an air gapto components that operate at the8 ussecret level drv krd 1998 s9 ci2sar4424i ufouo the inbound zone of the csns secret security enclave shall 10 include an interface for receiving data at the ussecret level from 1 common services 11 zones of prsns 2 monitoring zones of prsns 3 psn interfaces operating at the secret 12 level and 4 the ekms translator drv krd 1998 s 13 ci2sar4424j ufouo the inbound zone of the csns secret security enclave shall 14 incorporate bps bpscsn4 that mediates and protects data received at the secret 15 leveleither online or optionally through an air gapfrom specified psn and prsn 16 components that operate at the ussecret level drv krd 1998 s 17 ci2sar4424k ufouo each bpscsn that connects the csn to specified 18 components of psns or prsns shall 1 implement kpc for communications that are 19 authorized between the csn and those components and 2 shall prevent other 20 communications drv krd 1999 s 21 ci2sar4424l ufouo computer platform that implements bps functions to 22 protect security zone in the csn shall be physically separate from any computer 23prsncsn csn enclave usu csn enclave ussecret csnizg u to sinbound dataset is secret prsn common services sprsn common services some or pde s or lowerome pde guardome pde guardoutbound zone inbound zone outbound zone bpscsn1 optional air gapbpscsn3 optional air gapbpscsn4 optional air gap transfers mediated by ome guard or pde guardlegend dashed lines denote possible future functionsprsnpsn components operating at unclasprsnpsn components operating at unclasbpscsn2 optional air gap prsn monitoring zone s psn s and ekms translator soutbound dataset is unclasoutbound dataset labeled secret or unclaskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 84platforms that implement functions of other components of the csn drv krd 11801 1387 1568 s2 45 u ekms translator3 ufouo prsns in ci2 need to communicate with the electronic key management system4 ekms as specified in the ekms translator section of volume 1 and in appendix of 5 volume 1 and some t ransactions generated in prsns need to be translated into ekms 6 transactions and vice versa for this purpose ci2 provides one or more ekms translator7 components that connect prsns to the ekms message server infrastructure as illustrated in8 figure 16 translator is kmi component that is separate from the csn psns prsns and9 client nodes10 451 u translator security characteristics11 ufouo translator is subject to applicable security policies and requirements that are12 stated in volume 2 and in this volume and also is subject to applicable ekms security policies13 and requirements ekms103 ekms202 kmi has been designed to be compatible with eksm14 security the ekms operates in systemhigh mode at the ussecret level ekms103 and15 prsn common private zones operate at that same level therefore translator which16 connects to both the ekms and common private zones needs to operate at ussecret17 ci2sar451a ufouo an ekms translator that is incorporated in kmi ci2 shall 18 operate in the ussecret domain or and shall provide interfaces at the ussecret level for 19 connecting to one or more prsns b to the csn and c to an ekms message server 20 drv krd 1998 rst 21 ufouo translator also needs to meet kmi requirements for component modularity and22 isolation of components that operate at different levels of sensitivity as stated in the domains23 enclaves and zones section of this volume figure 21b illustrates that translator is divided24 into two enclaves25 ci2sar451b ufouo all components of an ekms translator shall be grouped into 26 two separate security enclavesthe translation enclave and the monitoring enclaveboth 27 of which operate in the ussecret domain drv krd 1180 1998 t 28 ci2sar451c ufouo computer platform that implements functions of one 29 security enclave of an ekms translator shall be physically separate from computer 30 platforms of the other security enclave of the translator b other kmi nodes and c 31 any other ekms translators drv krd 1180 1568 t 32kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 85figure 21b u kmi ekms translator enclaves and data flows 1 2 unclassifiedfouo 3 452 u translator communications4 ufouo figure 21b illustrates that connection between n ekms translator and prsn 5 is made through backend virtual private network as was previously illustrated in figure 16 6 figure 21b also illustrates that kpc connects translator to the ekms however that7 connection is shown as being separate from the vpn because translator is likely to be8 connected to an ekms message server by short pointtopoint link that is separate from the9 backend network used for other internodal kmi communications however the requirements10 stated in this section only mandate appropriate protection for the connection and are not specific11 with regard to the implementation of that connection12 ci2sar452a ufouo an ekms translator shall be connected to data 13 communications infrastructure that enables it to interact with the csn and with one or more 14 prsns that the translator serves and b shall be connected to an ekms message server 15 drv krd 1180 t 16 ci2sar452b ufouo an ekms translator shall incorporate one or more bpss that 17 mediate and protect data communication between 1 the translator and 2a one or more 18 prsns which the translator serves 2b the csn and 2c an ekms message server 19 drv krd 1998 rst 20 ci2sar452c ufouo bps of an ekms translator that connects the translator to 21 the csn prsn or an ekms message server shall 1 implement kpc for authorized 22 communications between the translator and the other component and 2 shall prevent other 23 unauthorized communications drv krd 1999 rst 24 ci2sar452d ufouo ny kmi component that receives an ekms message 25 requiring relay shall transfer the message to the destination component without modification 26ekms translator monitoring enclave ussecrettranslation enclave ussecret translation zone transaction translation functionsekms transaction handling bpsmon oneway guardmonitoring zonebpsvpncsn kmi transaction handlingbpsvpnprsnsbackend virtual private networkekms ussecret k p c bpsekmsekms message serverkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 86except for the components that perform necessary ekmskmi translation functions drv 1 krd 1288 rt 2 453 u translator security zones and data flows3 ufouo figure 21b illustrates that translation enclave contains translation zone and4 two types of bpss5 ci2sar453a ufouo all components of an ekms translators translation enclave 6 shall be grouped into 1 translation zone that handles and translates transactions7 exchanged between prsns and the ekms 2 bps bpsvpn that connects the8 translator to prsns and 3 bps bpsekms that connects the translator to the9 ekms drv krd 1180 1998 t 10 ufouo figure 21b illustrates that translators monitoring enclave contains monitoring11 zone bps and oneway guard12 ci2sar453b ufouo all components of an ekms translators monitoring enclave 13 shall be grouped into 1 monitoring zone that receives and analyzes information from 14 computer platforms in the translation enclave 2 bps bpsvpn that connects the 15 monitoring zone to the csn and 3 oneway guard bpsmon that connects the 16 monitoring zone to components of the translation enclave drv krd 1180 1998 t 17 ufouo the monitoring zone receives and analyzes intrusion detection event data audit18 event data performance data and other types of information19 ci2sar453c ufouo each of translators computer platforms that generate 20 aswr data shall report the data to its the monitoring zone upon demand or periodically as 21 configured by an aswr manager drv krd 1824 t 22 ci2sar453d ufouo translators monitoring zone shall include computer 23 platform dedicated to aswr drv krd 1816 t 24 ci2sar453e ufouo the aswr processes in translator shall enable an aswr 25 manager to configure the method and frequency by which aswr data is reported to the 26 monitoring zone from computer platforms that are monitored drv krd 1408 t 27 ci2sar453f ufouo aswr processes in translators monitoring zone shall be 28 able to correlate and analyze aswr data produced by multiple components of the 29 translator in manner that facilitates detection and characterization of threat actions that 30 span multiple components drv krd 1817 1824 t 31 ci2sar453g ufouo translators monitoring zone shall periodically as 32 configured by an aswr manager report aswr data to the csn drv krd 0128 1824 33 st 34 ci2sar453h ufouo translators monitoring zone shall notify the csn of actual 35 or suspected threat actions detected in the translator drv krd 0128 1824 st 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 87ci2sar453i ufouo translators monitoring zone shall have configurable 1 ability to generate reports based on its analysis of received aswr data and the severity level2 of actual or suspected threat actions drv krd 1824 t3 ufouo translators monitoring zone also has involvement in overseeing the system4 integrity of the translator5 ci2sar453j ufouo each of translators computer platforms that generate data 6 concerning system integrity checks shall report the data to the translators monitoring zone7 upon demand or periodically as configured by security configuration manager drv8 krd 1824 t9 ci2sar453k ufouo processes in translators monitoring zone shall be able to 10 check the system integrity of monitored components drv krd 1019 t 11 ci2sar453m ufouo translators monitoring zone shall notify an incident 12 response manager of any unauthorized change that the zone detects in the system integrity 13 of component in the translator drv krd 1019 t 14 ufouo translators monitoring zone also has involvement in overseeing the system15 performance of the translator16 ci2sar453n ufouo each of translators computer platforms that generate 17 platform performance data and related computer network traffic data shall report the data to 18 the translators monitoring zone upon demand or periodically as configured by an security 19 configuration manager drv krd 1865 t 20 ufouo in the architecture illustrated in figure 21b bpsmon mediates oneway data21 communication into the monitoring zone from the computer platforms of the translation22 enclave23 ci2sar453o ufouo translators monitoring enclave shall incorporate one or 24 more bpss bpsmon oneway guard that mediate data communication into 1 the 25 monitoring zone from 2 the computer platforms of monitored components of the 26 translation enclave drv krd 1998 t 27 ci2sar453p ufouo software that performs functions of translators bpsmon 28 including any operating system shall be implemented separately from the software in the 29 other bps types in that translator drv krd 1387 1568 t 30 ci2sar453q ufouo in translator the communication media that connect 31 monitored component platform of the translation enclave to bpsmon shall be 32 physically separate from those that provide other data paths between platforms in that 33 enclave drv krd 1387 1568 t 34 ci2sar453r ufouo in translator all packetswitched data communication 35 protocol associations that pass through bpsmon to the monitoring zone from 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 88computer platform of the translation zone shall be terminated in the monitoring zone and1 in that other component drv krd 1999 t2 ci2sar453s ufouo bpsmon of translator shall permit oneway data transfer 3 from components of the translation enclave through the bpsmon into the monitoring4 zone as needed to support authorized functions of the monitoring zone and shall prevent5 other communications including preventing any data transfer out of the monitoring zone6 through bpsmon drv krd 0901 0906 1999 t7 ci2sar453t ufouo bpsmon of translator shall support data replication from 8 the translation enclave to the monitoring zone for the purpose of the keeping watch over9 the translator and that data shall include the following drv krd 1817 1825 1905 t 10 1 aswr event data 11 2 audit event data 12 additional data items are expected to be defined when detailed design is done 13 14kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 895 u access control processes1 ufouo this section specifies how ci2 restricts access to system resources in accordance2 with policies stated in the access control section of volume 2 figure 2 2 illustrates that 3 functional processes in core nodes provide products services and other system resources to4 users however access control decisions need to be made before those processes can permit5 users to handle products services and other system resources6 figure 22 u kmi access control framework 7 8 unclassifiedfouo 9 ufouo figure 2 2 shows that kmi access control decisions are made by three types of access 10 control processesrolebased rulebased and approvalbased however most cots platforms11 currently do not incorporate kmis pkibased authentication mechanisms and rolebased access12 control mechanisms therefore for some cases of administrative access kmi needs to use other13 access control mechanisms such as identifierpassword pairs that are native to the platforms14 see administrative security for platforms and applications section of volume 215 ufouu the three types of access control are supported by processes for user registration and16 session login the basic registration process for users is described and specified in the user17 registration and identification service section of volume 2 when users are assigned to18 management roles the basic registration process is supplemented by more rigorous registration19 process called enrollment which is described in this access control services section203 types of access control processes rolebased applicable to all users for all system functions assigns privileges to roles enrolls selected identities in selected management roles controls access to system functions by limiting user to the privileges of the role that is being playedrulebased applicable to resource management functions assigns attribute values to managers accounts and devices assigns property values to products and other objects compares the properties of objects to the attributes of accessing entity in order to implement and enforce rules for data confidentialityapprovalbased applicable to product management functions assigns devices to koas assigns products to koas by using account distribution profiles assigns koas products to devices by using device distribution profiles rubac limits assignmentsuser registration process initializes user identities of humans devices and sets initializes user identifiers and authentication material may associate credentials and hardware tokens with users and user sponsors may assign attributes to user identitiessession login process registered user presents user identifier and user identity is authenticated registered user either acts in koa agent role or selects one of the management roles to which the user identity has already been assignedprocesses in core nodes that provide products and services to users these processes require access control decisions to be made before permitting users to handle products services other resourceskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 90 ufouo user registration process user registration 1a initializes one or more 1 identities for an authorized user and 1b associates one or more identifiers with each2 identity 2 may also associate authentication material with each identifier and 33 depending on the authentication mechanism being used may also issue identifier credentials4 and tokens5 ufouo session login process when user accesses the kmi by presenting registered 6 user identifier session login processes authenticate that identity as described in the identity7 authentication service section of volume 2 the kmi then associates the identity with a8 role either automatically or by permitting the user to select from among set of roles to9 which the users identity has previously been assigned 10 ufouo access control processes ci2 incorporates three types of access control which 11 complement each other to protect against unauthorized use of system resources 12 rolebased access control these processes associate user identities with roles and also 13 associate permissions with roles when user acts in an assigned role during session 14 the user can exercise the permissions that have been assigned to the role 15 rulebased access control these processes associate attributes eg clearance level 16 with certain user identities and role assignments and associate counterpart properties 17 eg data classification with system resources when user acting in specific identity 18 and role assignment attempts to access resource during session the sessions 19 attributes which are combination of the attributes of the identity and role assignment 20 are compared to the resources attributes to enforce predefined access rules 21 approvalbased access control these processes enable the authorizations conferred by 22 rolebased and rulebased access control to be further tailored for each user organization 23 on finergrained leastprivilege needtoknow basis that addresses individual products 24 and other resources 25 ci2sar5a ufouo the kmi shall provide three types of access control rolebased 26 rulebased and approvalbased drv krd 0425 0949 1152 1613 1792 1794 2008 27 ars 28 ufouo the kmi grants various types of access rights to registered users in discussing29 access rights volume 2 and this security architecture usually use the term authorization 30 volume 1 and other kmi documents and some dod publications also use the synonym31 privilege32 definition u authorization or privilege right that is granted to registered user 33 or other system entity to access system resource for specific purpose 34 ci2sar5b ufouo the kmi shall ensure that changes in authorization data for 35 access control processes are made available within two hours to all components that require 36 them assuming that there are communication system interruptions drv krd 1898 37 ars 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 91ufouo this security architecture uses other more narrowly defined terms for access rights 1 that are specifically associated with one type of access control process for example as2 explained below permission is an authorization controlled by rolebased process3 ufouo the three types of access control cooperate to ensure that sensitive functions are4 performed only by authorized managers and that products and services are received only by5 authorized users however kmi access controls combine rigorous assurance with flexibility6 user communities can define domains for access control and select their own managers but7 product ordering and distribution can cross domain boundaries when necessary8 the duties of management role may be divided among multiple persons when required by a9 large workload or the distributed nature of an organization or the duties of multiple roles 10 may be combined and performed by single person when personnel resources are scarce 11 ufouo all three types of ci2 access control processes are designed to incorporate and12 support the following principles and general requirements13 definition ufouo principle of positive authorization the practice of granting 14 access to system resources only in positive way 15 ci2sar5c ufouo the kmi shall grant access to system resources only in positive 16 way in the absence of an explicit authorization that grants access the default action shall be 17 to refuse access krd 1551 ars 18 definition ufouo principle of least privilege the practice of granting to each 19 system entity the minimum authorizations that the entity needs to do its legitimate work 20 ci2sar5d ufouo the kmi shall provide means to restrict each system entity to 21 only the minimum authorizations and capabilities that the entity needs to perform its 22 function drv krd 0952 z 23 definition ufouo principle of separation of duties the practice of dividing the 24 functions of system process among different system entities to prevent single entity 25 from subverting the process the role separation constraints section specifies general 26 capability for separating roles and the specifically separated roles section identifies some 27 required separations 28 ci2sar5e ufouo the kmi shall provide means to divide management duties and 29 system functions among multiple system entities to protect against security violations drv 30 krd 0951 z 31 ufouo this security architecture applies these three general requirements to implement the 32 following control33 control ufouo eclp1 least privilege confidentiality access procedures 34 enforce the principles of separation of duties and least privilege access to privileged 35 accounts is limited to privileged users use of privileged accounts is limited to privileged 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 92functions that is privileged users use nonprivileged accounts for all nonprivileged1 functions this control is in addition to an appropriate security clearance and needtoknow2 authorization dod850023 ufouo this security architecture applies these three principles to all three types of access 4 controlrolebased rulebased and approval basedto support prevention and detection of5 security violations which are acts by users and other system events that disobey or otherwise6 break the rules of the systems security policy7 ufouo the following requirements also apply to all three types of kmi access control8 these requirements are included here as an overall statement but also are implemented by more9 specific statements in this and other sections of kmi220010 ci2sar5f ufouo the kmi shall record as mandatory audit events the request 11 assignment receipt modification deletion and rejection of any authorization pertaining to 12 access control drv krd 0071 0876 z 13 ci2sar5g ufouo the kmi shall notify an incident response manager of any request 14 for products services or other system resources from system entity that cannot be 15 authenticated or has insufficient authorization for the request drv krd 0867 z 16 ci2sar5h ufouo the kmi shall record as mandatory audit event any request for 17 products services or other system resources from system entity that cannot be 18 authenticated or has insufficient authorization for the request drv krd 0419 0844 19 0866 z 20 ci2sar5i ufouo each independent component shall record as mandatory audit 21 events at minimum 1 identification and authentication checks 2 attempts to access 22 modify or delete authentication material or access control information and 3 failed 23 attempts to access system resources drv krd 0844 z 24 ci2sar5j the kmi shall record as mandatory audit event each success or failure of 25 access control checks performed prior to delivery of classified or sensitive kmi products 26 drv krd 0419 r 27 51 u rolebased access control28 ufouo ci2 uses rolebased access control ferraiolo that enables functional permissions to29 be assigned to user roles flexibly and in accordance with the principles of needtoknow and least30 privilege see user roles and permissions section above31 control ufouo ecpa1 privileged account control integrity all privileged 32 user accounts are established and administered in accordance with rolebased access 33 scheme that organizes all system and network privileges into roles eg key management 34 network system administration database administration web administration the 35 information assurance manager tracks privileged role assignments dodi85002 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 93ufouo it is expected that ci2 will need to use cots platforms that do not support role1 based access control in those cases ci2 needs to use other access control mechanisms2 typically mechanisms that are native to those platforms as described in administrative security3 for platforms and applications section of volume 24 ci2sar51a ufouo the kmi shall restrict access to system resources based on the 5 attributes of the accessing entitys authenticated user identity and the permissions of the6 roles to which that identity has been assigned drv krd 1289 1552 1613 r7 ufouo the way that permissions are assigned differs depending on the type of role8 ufouo management roles for most management roles rolebased access control is9 implemented fully including the ability to dynamically assign and remove permissions but 10 the permissions of role manager are assigned statically ie they are built in when the 11 system is implemented 12 ufouo koa agent rolebased access control in pdes is intended to be implemented 13 only minimally because only koa agents access pdes using client nodes general 14 functional permissions are intended to be assigned statically to the role of koa agent during 15 implementation of pde functionality the authorizations that enable koa agents to act for 16 specific koas are not rolebased permissions instead they are approvalbased authoriza 17 tions that are assigned dynamically by koa managers 18 ci2sar51b ufouo the kmi shall record for audit any attempt to access system 19 resources by system entity that does not have the necessary permissions drv krd 20 0867 z 21 ci2sar51c ufouo the kmi shall provide capability to manage roles and 22 permissions drv krd 0403 1792 1794 rs 23 ufouo ci2 rolebased access control is designed to conform with basic parts of the model24 contained in american national standards institute draft ansi the draft standard has the25 following four parts but ci2 uses features from only the first three26 core rolebased access control ci2 supports minimal set of elements and relations 27 hierarchical rolebased access control ci2 supports partial ordering of roles 28 static separation of duty ci2 supports exclusivity for role assignments 29 dynamic separation of duty ci2 prohibits playing concurrent roles in single session 30 ufouo figure 2 3 illustrates entities and relationships that comprise rolebased access 31 control system the system model includes the following five relationships32 u assignment of user identities to roles 33 u assignment of permissions to roles 34 u association of user identity with session 35 u association of role with session 36 u assignment of role to be inherit the permissions of another role 37 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 94ufouo figure 2 3 also illustrates that ci2 supports constraints on relationships 1 and 2 but 1 not on 3 4 or 52 figure 23 u kmi rolebased access control 3 4 unclassifiedfouo 5 511 u definition and maintenance of roles and permissions6 ufouo role manager maintains builtin roles and creates any new roles that are needed7 ci2sar511a ufouo the kmi shall enable role manager and only role 8 manager to create review modify and delete roles in order to maintain builtin roles and9 establish and maintain additional roles drv krd 0404 0406 1203 s 10 ufouo the builtin roles are intended to be sufficient for initial kmi operation however11 the kmi needs to be extensible to managing new products in new situations and thus new roles12 may be needed in the future13 ufouo permissions identify actions the system is capable of performing new permissions14 may be needed in the future and can only be added with software upgrades to the system if a15 software upgrade contains new permissions they will be added to the list of permissions available16 for assignment to roles by the role manager also role managers may need to treat sets of17 permissions as units in order to simplify their assignment to roles18 ci2sar511c ufouo the kmi shall enable role manager to establish and maintain 19 new permissions that are defined as sets of other already existing permissions drv krd 20 0404 0406 0873 1794 s 21kmi access sessionsconstraints constraints constraints constraintsconstraints kmi permissions5 permission inheritance assignments kmi role hierarchy session session session1 identity assignments2 permission assignments legend onetomany manytomanyonetoonesupported not supported3 4kmi user identitieskmi roles relationships constraintskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 95512 u assignment of permissions to roles1 ufouo role manager also administers the assignment of permissions to roles2 ci2sar512a ufouo the kmi shall enable role manager and only role 3 manager to assign permissions to management roles except for the role of role4 manager subject to any constraints that may be in force at the time drv krd 08735 0875 0949 1203 1609 1794 2008 s6 ufouo the principle of separation of duties implies that managers should not be able to7 assign their own authorizations8 ci2sar512b ufouo role manager shall not be able to assign permissions to the 9 role of role manager drv krd 1560 s 10 ufouo thus all permissions needed by role manager must be statically assigned to the11 role ie builtin during implementation or configured during installation to be available at12 system startup13 ci2sar512c ufouo the kmi shall enable role manager and only role 14 manager to remove permissions from management roles drv krd 0873 1203 1560 15 s 16 ci2sar512d ufouo the kmi shall record as mandatory audit event each action 17 by role manager that either 1 assigns permission to management role or 2 removes 18 permission from management role drv krd 071 0844 0876 1609 s 19 513 u permission inheritance in the role hierarchy20 ufouo it is expected that managers will need to organize the set of kmi roles into a21 hierarchy to reflect lines of authority and responsibility in the kmi and in user organizations22 role hierarchies can be defined by using permission inheritance relationship illustrated by23 figure 23 this relationship is supported by the draft standard ansi 24 definition ufouo role hierarchy subordination relationship among roles 25 where b means that role is subordinate to role b the relationship is manytomany 26 and is partial ordering of the set of all roles that is for any three roles b and c the 27 following are always true 1 2 if b and bc then c and 3 if b and 28 ba then and b must be the same role 29 ci2sar513a ufouo the kmi shall maintain the set of all management roles as 30 role hierarchy drv krd 0403 s 31 ufouo role can hold permissions directly by having permissions assigned to it and also32 can hold permissions indirectly by inheriting permissions that are held by subordinate roles33 ci2sar513b ufouo the kmi shall enable role manager and only role 34 manager to assign one or more roles in the role hierarchy to be subordinate to one or more 35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 96other roles in hierarchy so that the each superior role inherits the permissions that have1 previously been assigned to or inherited by its subordinate roles drv krd 0403 s2 ci2sar513c ufouo the kmi shall enable role manager to remove role from 3 position of subordination to another role in the role hierarchy drv krd 0403 s4 ci2sar513d ufouo the kmi shall record for audit all user actions that assign 5 role to be subordinate to another role in the role hierarchy or that remove role from a6 position of subordination drv krd 0071 0844 1609 s7 514 u assignment of identities to roles8 ufouo user identities acquire access permissions when they are assigned to roles the9 following requirements apply to all instances of assignment of an identity to role10 ci2sar514a ufouo the kmi shall record as mandatory audit event each action 11 that either 1 assigns user identity to role or 2 removes an identity from role drv 12 krd 0071 0844 0876 r 13 ufouo assignments of identities to management roles are subject to rolebased access14 control constraints that are described in the constraints on identities roles permissions and15 sessions section16 ci2sar514b ufouo the assignment of user identity to management role shall 17 be subject to applicable existing constraints on the relationships of the kmi rolebased 18 access control system drv krd 0872 rs 19 ci2sar514c ufouo the kmi shall permit user identity to be assigned to two or 20 more roles in any combination that is not prohibited by requirement stated in this 21 specification kmi2200 or by constraint imposed by an administrative manager drv 22 krd 1576 1604 1617 1618 1620 rs 23 ci2sar514f ufouo the kmi shall permit user identity that has been assigned to 24 the role of enrollment manager to be assigned also to either or both of the roles of 25 controlling authority and product requester drv krd 1620 rs 26 ufouo if user identity is assigned twice or more to the same role then the user has the27 same rolebased permissions in each assignment however if the role is one that receives rule28 based or approvalbased authorizations then those authorizations can be different for each of the29 two or more assignments30 ci2sar514e ufouo the kmi shall permit user identity to be assigned twice or 31 more to the same role but such assignments shall be treated as distinct managers each with 32 its own rulebased and approvalbased authorizations if such authorizations apply to the 33 role drv krd 1617 1618 r 34 ci2sar514d ufouo if registered user is acting in management role that can 35 assign user identity to management role the kmi shall not permit the user to assign 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 97any of the users own user identities including set identities to any management role1 drv krd 1560 r2 ufouo in this security architecture the role of enrollment manager can make assignments 3 to management roles and the role of koa manager can make assignments to the koa agent4 role these assignment functions are specified in the following subsections5 5141 u assignment of identities to the koa agent role6 ufouo koa manager assigns users only to the koa agent role7 ci2sar5141a ufouo the kmi shall enable an authorized koa manager to assign 8 user identity to the role of koa agent and only to that role either at the time of initial9 registration of the identity or at later time according to approved procedures drv krd 10 0405 1487 1599 1617 r 11 ufouo system functions associated with koa agents are described in detail in the kmi12 operating accounts section13 5142 u assignment of identities to management roles14 ufouo in addition to the primary registration process that establishes user identities ci215 also has secondary registration process called enrollment for performing additional steps16 that are required to assign identities to management roles which hold the sensitive authorizations17 needed to operate and administer the kmi and which are restricted to relatively few users18 definition ufouo enrollment the kmi process that assigns user identity to 19 management role 20 ufouo during the enrollment process as illustrated by figure 2 4 an enrollment manager 21 assigns an existing user identity to management role and thus creates an instance of manager22 the enrollment manager is said to confer the management role on the identity in the simplified23 example shown in the figure an enrollment manager has made five different assignments24 involving two human users three identities and three roles resulting in five different manager25 instances26 ufouo for some roles the enrollment process assigns attribute values for rulebased access27 control rubac which constrains permissions granted by rolebased access control see rule28 based access control section if the new manager is an enrollment manager the process also29 provides the manager with 1 authorizations to confer specific roles and 2 authorizations to30 assign specific rubac attributes to managers see enrollment managers section31 ci2sar5142a ufouo the kmi shall enable an enrollment manager and only an 32 enrollment manager to assign singular identity of human user to any management 33 role drv krd 0405 0671 1487 1617 1618 2008 r 34 ci2sar5142b ufouo the kmi shall enable an enrollment manager and only an 35 enrollment manager to assign shared identity of user set of human users to any 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 98external management role but not to any internal management role drv krd 04051 0671 1487 1617 1618 2008 r2 ufouo the two foregoing requirements do not enable an identity of user device to be3 assigned to management role4 figure 24 u kmi enrollment of managers with examples 5 6 unclassifiedfouo 7 ci2sar5142e ufouo the kmi shall enable an enrollment manager and only an 8 enrollment manager to assign group identity to management role if and only if the9 enrollment manager has been granted specific authorization to make such an assignment 10 drv krd 0863 1487 1585 r 11 ufouo the foregoing requirement recognizes that although the kmi needs to maintain12 strict individual accountability for access by users acting as managers the user community13 needs operational flexibility to help them adjust to new technology that the kmi is introducing14 the best practice would be to prevent assignment of group identity to any management role15 because the kmi cannot maintain individual accountability within group identity however in16 early capability increments the best way to meet the operational needs in some situations might17 be to keep single authentication token locked in safe for use by group identity that18 collectively performs the manager function thus exceptional circumstances may require that a19 group identity be assigned to management role even if accountability for that identity can be20 maintained only at the groups local site by physical personnel and administrative security21 measures however such assignments should require special authorization22kmi manager 1 in role 1 user identity 1 kmi manager 3 in role 2 kmi user identitieskmi human users kmi manager 5 in role 3 user identity 2 kmi manager 2 in role 1 user identity 3 kmi manager 4 in role 2 human user 2 new kmi managers human user 1 kmi management roles management role 3 management role 1 management role 2 enrollment manager creates new manager by assigning an identity to management roleenrollment processkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 99ci2sar5142d ufouo the kmi shall permit user identity to be enrolled twice or 1 more by either the same enrollment manager or different enrollment managers drv krd2 1604 1617 1618 r3 ufouo the foregoing requirement enables user identity to be assigned to two or more4 roles or be assigned twice or more to the same role in different situations5 5143 u verification of authenticity and eligibility for managers6 ufouo figure 2 5 illustrates how the basic registration process for user identities is followed 7 by supplemental registration and enrollment processes when registered user is nominated to be8 manager although the figure shows the manager registration step preceding the9 enrollment step these steps could be done in the opposite order or in parallel depending on10 the specific operational procedures that are adopted for ci211 figure 25 u kmi user registration and manager enrollment 12 13 unclassifiedfouo 14 ufouo when user identity is assigned to management role the kmi establishes15 authentication material for very strong authentication mechanism as specified in the issuance16 of identifier credentials section of volume 2 when user identity is assigned only to the koa17 agent role the kmi establishes authentication material for whatever type of authentication18 mechanism the user is able to support ranging from the same strong form used for managers to a19 simple passwordbased form20 ufouo for each user identity that the kmi registers user registration manager examines21 evidence to verify the users authenticity ie that the user has the right to claim the identity22 being registered and eligibility ie that the identity is eligible for kmi registration as23 described in the user identity authenticity and eligibility section of volume 2 when user24 identity is assigned to management role the enrollment manager reverifies that authenticity25 and eligibility and also verifies or certifies that the assignment is authorized26 ci2sar5143a ufouo for each assignment of user identity to management 27 role the kmi shall record and maintain data elements that 1 describe the evidence that was 28 presented and examined to verify the authenticity and eligibility of the identity and 2 ensure 29 accountability for approval of the evidence drv krd 0923 1593 rs 30managerhuman device or setenrollment processidentity registration processregistration mgr verifies identity and eligibilityenrollment mgr reverifies identity checks credentialenrollment mgr reverifies eligibility sets attributesregistered user is nominated for role highassurance credential needed for management rolesystem entity applies to be registered manager registration process user identifier authentication materialkoa agentkoa authorization processregistered user koa manager checks credential and authorizes for koakmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 100ufouo appendix of volume 2 proposes partial draft listing of acceptable forms for1 evidence of authenticity and eligibility of managers2 ci2sar5143b ufouo when an enrollment manager assigns user identity to 3 management role the kmi shall prompt the enrollment manager to verify and enter 14 evidence of the identitys authenticity and eligibility to be registered user and manager5 and 2 the organizational source of authority for the assignment drv krd 0923 15936 r7 ufouo the following requirements restrict eligibility for assignment to certain management8 roles according to nationality these requirements are marked nt because it is assumed that9 they will be implemented procedurally at the time when an enrollment manager determines10 whether an identity is eligible for assignment to role implementing these requirements as11 prsn functions would at least require the system to record and adequately maintain nationality12 information for user identities13 ci2sar5143c nt ufouo the kmi shall not assign singular identity of 14 human user to an internal management role unless that person belongs to us security 15 domain krd new r 16 ci2sar5143d nt ufouo the kmi shall not assign singular identity of 17 human user to an external management role unless that identity belongs to us security 18 domain nato security domain or cceb security domain krd new r 19 ci2sar5143e nt ufouo the kmi shall not assign shared identity of user 20 set of human users to an external management role unless each identity in the user set 21 belongs to us security domain nato security domain or cceb security domain 22 krd new r 23 ci2sar5143f nt ufouo the kmi shall not assign singular identity of user 24 device to the role of product requester unless that identity belongs to us security 25 domain nato security domain or cceb security domain drv krd 1601 2149 r 26 ufouo consequence of the three preceding requirements is that nonnato noncceb27 coalition partners cannot perform the roles of controlling authority product requester and28 koa manager and therefore are prevented from ordering products products for such coalition29 partners are ordered and distributed only by us managers30 5144 u manager reverification and reconfirmation31 ufouo the user identity reverification section of the security policy states requirements 32 for periodically reverifying the authenticity and eligibility of each active user identity in the33 same manner as if the identity were being newly registered those requirements are extended by34 the following statements35 ci2sar5144a ufouo for each existing assignment of user identity to 36 management role in an enrollment domain the kmi shall periodically prompt an 37 enrollment manager in that enrollment domain to examine and reverify evidence of the 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 101identitys authenticity and eligibility in accordance with the kmi policy for registration of 1 users nsakmiur and if that is not done within specified time interval the kmi shall 2 revoke the assignment drv krd 0925 r3 ci2sar5144b ufouo the kmi shall enable security configuration manager to 4 configure the periodicity of reverification by an enrollment manager of the authenticity and5 eligibility of user identity assigned to management role drv krd 0925 rs6 ci2sar5144c ufouo the kmi shall enable an authorized security configuration 7 manager to set the time interval within which an enrollment manager must complete8 reverification of user identity that is assigned to management role drv krd 09259 rs 10 ufouo to verify user identity with sufficient assurance for assignment to management11 roles the kmi might require the user to make personal appearance before some official but12 this type of reverification might be done only infrequently on the other hand reconfirmation13 that an assignment is authorized might be done more frequently and therefore is specified here14 separately from reverification of the basic authenticity and eligibility of the identity15 ci2sar5144d ufouo for each existing assignment of user identity to 16 management role in an enrollment domain the kmi shall periodically prompt an 17 enrollment manager in that enrollment domain to review and reconfirm the need for and 18 organizational source of authority for the assignment in accordance with the kmi policy for 19 enrollment of managers nsakmiem and if that is not done within specified time 20 interval the kmi shall revoke the assignment drv krd 0952 s 21 ci2sar5144e ufouo the kmi shall enable an authorized security configuration 22 manager to configure the periodicity of reconfirmation by an enrollment manager of an 23 assignment of user identity to management role drv krd 0952 rs 24 ci2sar5144f ufouo the kmi shall enable an authorized security configuration 25 manager to set the time interval within which an authorized enrollment manager must 26 complete reconfirmation of an assignment of user identity to management role drv 27 krd 0952 rs 28 515 u sessions and principals29 ufouo as illustrated by figure 2 6 user gains accesses to the kmi by presenting an 30 identifier for registered identity31 definition ufouo principal specific user identity that is asserted and activated 32 by registered user when accessing the system 33 ufouo the user then selects role to which that identity has been assigned and the kmi34 establishes session35 definition ufouo session temporary mapping of principal to role or roles 36 especially when client node accesses prsn 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 102figure 26 u kmi registration enrollment and login 1 2 unclassifiedfouo 3 ufouo figure 2 6 illustrates two cases in which session is established with role 4 management role if registered user has been assigned to one or more management roles 5 the user can select one of those roles for session when logging in at an ome or some other6 node that supports rolebased access control7 koa agent role if registered user has been assigned to the koa agent roles selection of 8 that role is implicit when the user logs in at pde9 ufouo the session abstraction has various concrete interpretations depending on the type10 of user and the mode of access this specification of rolebased access control for ci2 is11 directed mainly at the case of client node accessing prsn through either webbased or12 transactionbased interface but this specification also covers other pairs of nodes or components13 an access session usually involves all three of the following aspects14 u platform access session is continuous period of time typically initiated by an 15 identity authentication process during which user accesses server computer system 16 u application access session is set of transactions or other actions that are performed 17 by or for user during period of time 18 u network access session is persistent but usually temporary communication 19 association between client or agent and server or peer usually involving kpc 20 ufouo each session is associated with single principal and therefore is controlled by a21 single user22managerhuman device or setenrollment process selected role is managerregistered user default role is koa agentidentity registration process user identifier user selects an assigned management roleserver authenticates user identity role selection process user acts as koa agent in assigned koasuser exercises privileges of the management role unregistered system entityunregistered system entity is rejectedentities attempt login at ome or pdemanager registration process session initiation processrole activation processome pdekoa agent authentication materialregistered user koa authorization processkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 103ci2sar515a ufouo an independent component shall prevent singular identity 1 from initiating two or more concurrent sessions under the control of that component drv2 krd 0953 r also see separation of duties in access control services section3 ci2sar515b ufouo an independent component may permit group identity to 4 initiate either single session or two or more concurrent sessions under the control of that5 component drv krd 2105 r6 ci2sar515c ufouo if an independent component permits shared identity to 7 initiate two or more concurrent sessions the component may permit the sessions principals8 to play either the same role or different roles drv krd 2105 r9 ci2sar515d ufouo if the design of component enables user identity to initiate 10 two or more concurrent sessions the component shall enable security configuration 11 manager to limit the number of concurrent sessions drv krd 2139 r 12 516 u session restrictions and permission checking13 ufouo the permissions available to principal in session are those that are currently14 assigned to the role that the principal is playing in the session the kmi permits principal to15 access only system resources for which the role has permissions but managers need to be careful16 to assign to each role only the minimum permissions that the role needs to perform its duties17 ci2sar516a ufouo when registered user accesses an independent component 18 in user identity that is authenticated at the start of session the kmi shall permit the user 19 to select and play any of the roles and only those roles to which the principal identity is 20 currently assigned and for which the authentication process provides sufficient assurance 21 drv krd 0865 1550 1552 prs 22 ci2sar516b ufouo when registered user accesses an independent component 23 in an user identity that is currently assigned twice or more to the same role then the kmi 24 shall enable the user to distinguish among those assignments and to select one of them for 25 the session drv krd 1617 1620 r 26 ufouo assigning an identity to the same role twice probably makes sense only when the27 assignments are made in two different enrollment domains where neither is subdomain of the28 other see enrollment domains section below for example an identity could be enrolled29 twice as controlling authority to enable someone to jointly support two different dod30 services or agencies that operate separate enrollment authorities in that case when presenting31 the two assignments to the user for selection at login time the kmi could them distinguish them32 by for example appending the domains names33 ci2sar516c ufouo when registered user accesses an independent component 34 in session the kmi shall permit the user to play only one role at time during the 35 session drv krd 0953 r 36 ufouo note that the foregoing requirement does not prevent user from selecting the same37 role in concurrent sessions at different core nodes38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 104ci2sar516d ufouo when registered user accesses an independent component 1 in an authenticated user identity the kmi shall permit the sessions principal to play a2 management role only if the identity has been authenticated to the kmi using mechanism3 approved by nsa for managers drv krd 1603 r4 ci2sar516e ufouo when registered user accesses the kmi in an user identity 5 that is authenticated with mechanism approved for management roles the kmi shall6 enable the user to switch during the session from one role to another without having either7 to reauthenticate the user identity or to end the session and begin new one drv krd8 1604 1607 r9 ci2sar516f ufouo when registered user accesses the kmi in role the kmi 10 shall permit the user to exercise only those permissions that are currently assigned to that 11 role drv krd 0407 0865 1289 1552 prs 12 ci2sar516g ufouo the kmi shall check the permissions associated with the role 13 being played by principal before permitting access to products services or other system 14 resources and shall reveal to the user only those resources which the principal is authorized 15 to access drv krd 0865 0946 1290 1552 prs 16 ufouo the kmi needs to control access to its resources not only by entities that are outside17 the system but also by entities inside the system including access to one component by another18 component the definitions of system entity and user that are stated in the user entities 19 section enable this policy to specify such intercomponent intrasystem controls20 ci2sar516h ufouo each independent component shall check the eligibility of 21 another component to access selected kmi capabilities products or information prior to 22 permitting access by the other component drv krd 1546 z 23 ci2sar516i ufouo operator at component shall be able to employ 24 permissions in excess of the capabilities or security attributes of that component krd 25 0881 z 26 517 u enrollment managers27 ufouo during the system startup process at least one user identity needs to be initialized as28 an enrollment manager as illustrated by figure 2 7 this manager is called toplevel 29 enrollment manager because it operates at the highest of potentially multiple levels of30 enrollment managers alternatively this manager could be called kmilevel enrollment31 manager because it can confer roles for which the scope of operation extends over the entire32 kmi33 definition ufouo toplevel enrollment manager kmi job position held by 34 human user who has user identity that is initialized in the role of enrollment manager as 35 part of the kmi startup process and is then able to enroll other user identities in 36 management roles an enrollment manager also has rubac management responsibilities 37 as described in the rulebased access control section 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 105figure 27 u kmi enrollment manager examples 1 2 unclassifiedfouo 3 ufouo as illustrated by figure 2 7 single root enrollment manager position could be 4 built into the system be made active at startup and be used only to enroll all of the toplevel5 enrollment managers alternatively toplevel enrollment manager position could be built6 into the system be made active at system startup and be used to enroll additional toplevel7 enrollment managers as well as perform the other duties of toplevel enrollment manager8 other highly sensitive roles for internal operational management might also be built into the9 system so that they would not have to be assigned after system startup10 ufouo as illustrated by the simplified example in figure 2 7 toplevel enrollment 11 manager enrolls other enrollment managersone or more for each of the user organizations12 named uniformed service 1 and dod agency 2 the figure assumes that service 1 chooses13 to delegate enrollment authority to organizations 11 and 12 ie organizations within service14 1 and so an enrollment manager at the service 1 headquarters level enrolls one or more15 additional enrollment managers for each suborganization in contrast to service 1 agency 216 chooses to centralize its enrollment authority therefore enrollment managers at the agency 217 headquarters level do not enroll any other enrollment managers18 ufouo not every enrollment manager can confer every role especially sensitive roles need19 to be either 1 built into the system so that they are available at startup or 2 capable of being20 restricted so that they can be conferred only by toplevel enrollment managers for example21 as illustrated by figure 2 8 toplevel enrollment manager might enroll one or more additional 22 enrollment managers for each user organization that wants to operate its own enrollment23 process but give those organization enrollment managers only the ability to confer six different24kmi managers top level kmi managers service org 11kmi managers service org 12kmi managers agency 2toplevel kmilevel enrollment manager organization enrollment manager dod agency 2 organization enrollment manager uniformed service 1 organization 11organization enrollment manager uniformed service 1 organization 12a single root enrollment manager could be built into the system become active at system startup and be used only to enroll toplevel enrollment managers or toplevel enrollment manager could be built into the system become active at startup and enroll additional top level enrollment managers organization enrollment manager uniformed service 1 legend enrollment actionoptional root enrollment managerkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 106roles 1 enrollment manager 2 koa registration manager 3 controlling authority 41 command authority 5 product requester and 6 koa manager2 ufou the decision whether to delegate or centralize enrollment is left to each organization3 however an enrollment manager of user organization at any level can create an enrollment4 manager for suborganization without conferring the authority to create further enrollment5 managers for example as illustrated by figure 2 8 the enrollment managers at the headquarters 6 level of uniformed service 1 create enrollment managers for service organizations 11 and 127 but those new managers cannot themselves create enrollment managers8 figure 28 u kmi enrollment authorization examples 9 10 unclassifiedfouo 11 ci2sar517a ufouo the kmi shall initialize at system startup at least one user 12 identity in the role of toplevel enrollment manager drv krd 1617 rs 13 ci2sar517b ufouo the kmi shall authorize toplevel enrollment manager to 14 confer all defined management roles ie including that of enrollment manager except for 15 any special positions that might be built into the system as part of the startup process drv 16 krd 1617 r 17 ci2sar517c ufouo the kmi shall enable an enrollment manager when conferring 18 the role of enrollment manager to restrict the enrollment capabilities of the new enrollment 19 manager by specifying which roles the new enrollment manager is authorized to confer 20 drv krd 1618 r 21 ci2sar517d ufouo the kmi shall enable an enrollment manager when 22 conferring the role of enrollment manager to authorize the new enrollment manager to 23 confer any subset up to and including the entire set of the roles that the conferring 24managers for dod agency 2 managers for service organization 12managers for service organization 11managers for uniformed service 1dod agency 2 enrollment managersuniformed service 1 enrollment managerstoplevel ie kmilevel enrollment managers service organization 12 enrollment managersservice organization 11 enrollment managersmanagers for kmi leveltoplevel enrollment managers may confer all roles secondlevel enrollment managers in this example may confer these roles enrollment manager koa registration manager controlling authority command authority product requester koa manager thirdlevel enrollment managers in this example may confer these roles koa registration manager controlling authority command authority product requester koa managerlegend enrollment actionkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 107enrollment manager itself is authorized to confer but only those roles drv krd 16181 r2 ci2sar517e ufouo the kmi shall prevent an enrollment manager from enrolling 3 user identity in any role which the enrollment manager has not been authorized to confer4 drv krd 1618 r5 ci2sar517f ufouo the kmi shall prevent user identity that is acting in the role 6 of enrollment manager from being able to enroll any user identity that belongs to the same7 user drv krd 1560 r8 518 u constraints on identities roles permissions and sessions9 ufouo some of the requirements that are stated in the enrollment managers section are10 examples of being able to apply the principles of 1 separation of duties and 2 least privilege11 more detailed capabilities for implementing and enforcing the principle of least privilege are12 stated in subsections that follow13 ci2sar518a nt ufouo the kmi shall be designed to minimize the number of 14 distinct management roles that must be staffed by separate persons while still separating 15 management duties and permissions sufficiently to ensure security drv krd 0951 1196 16 z 17 ci2sar518b ufouo the kmi shall enable security configuration manager to 1 18 set and modify limits on the assignment of permissions to roles and 2 constrain the 19 exercise of permissions drv krd 0872 0952 s 20 ci2sar518c ufouo the kmi shall enable security configuration manager to set 21 and modify resource consumption limits for management roles drv krd 2008 rs 22 ufouo to control proliferation of management permissions reduce the chances of making23 mistakes when granting those permissions or limit the exercise of permissions it could be24 desirable to constrain the assignment and selection relationships that are shown in figure 2 3 25 definition ufouo constraint limitation implemented by rolebased access 26 control on relationship or function of user identity role or permission in effect 27 constraint is form of security policy 28 ufouo this security architecture specifies constraint mechanisms for relationships 1 and 2 29 however to reduce the complexity of implementing ci2 this architecture does not support 30 constraints on relationship 3 for example preventing specified role from being made31 subordinate to another role also this architecture supports only static constraints in ci2 32 therefore constraints are not supported for relationship 4 eg setting maximum number of33 concurrent sessions for an identity or relationship 5 eg setting maximum number of34 concurrent sessions permitted for role35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1085181 u static separation constraints1 ufouo the security of the kmi access control processes depends on separating the duties of2 certain specific roles3 ci2sar5181a ufouo the kmi shall prevent registered user from having one of 4 its user identities assigned to the role of user registration manager and also concurrently5 having that identity or another of its identities assigned to the role of enrollment manager6 drv krd 0951 1619 s7 ufouo kmi security administrators also need to be able to set other constraints to enforce8 separation of duties9 ci2sar5181d ufouo the kmi shall enable security configuration manager to 10 specify sets of two or more management roles such that the kmi shall prevent registered 11 user from having user identity or identities concurrently assigned to two roles in set 12 drv krd 0951 1621 s 13 ci2sar5181e ufouo the kmi shall enable security configuration manager to 14 specify sets of two or more management roles such that the kmi shall prevent registered 15 user from having user identity or identities concurrently assigned to all the roles in set 16 drv krd 951 1621 s 17 ci2sar5181f ufouo the kmi shall enable security configuration manager to 18 specify sets of two or more management roles such that the kmi shall prevent specified 19 permission from being assigned to more than one role in set drv krd 0952 s 20 ci2sar5181g ufouo the kmi shall enable security configuration manager to 21 specify sets of two or more permissions such that the kmi shall prevent more than one 22 permission in set from being concurrently assigned to the same management role drv 23 krd 0952 s 24 5182 u static cardinality constraints25 ufouo kmi ssos need to be able to set constraints to limit the granting of permissions26 ci2sar5182a ufouo the kmi shall enable security configuration manager to 27 prevent more than specified number of user identities from being concurrently assigned to 28 specified management role drv krd 0951 s 29 ci2sar5182b ufouo the kmi shall enable security configuration manager to 30 prevent specified user identity from being concurrently assigned to more than specified 31 number of management roles drv krd 0951 s 32 ci2sar5182c ufouo the kmi shall enable security configuration manager to 33 prevent more than specified number of permissions from being concurrently assigned to 34 specified management role drv krd 0952 s 35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 109ci2sar5182d ufouo the kmi shall enable security configuration manager to 1 prevent specified permission from being concurrently assigned to more than specified2 number of management roles drv krd 0952 s3 519 u enrollment domains4 ufouo kmi management roles are usually conferred on individual persons however kmi5 customers often want to control the assignment of these roles and the authorizations associated6 with them from an organizational viewpoint rather than an individual viewpoint therefore ci27 enables the processes that confer these and their authorizations to be aligned with administrative8 procedures of customer organizations by grouping managers into enrollment domains9 definition ufouo enrollment domain set of managers ie set of assignments 10 of user identities to management roles that includes 1 one or more enrollment managers 11 and 2 any additional managers of other types that have been placed into the domain 12 ufouo ci2 enables enrollment domains to be arranged in hierarchy aligned with the13 command structures of customer organizations if an enrollment manager belongs to a14 enrollment domain then that manager can enroll additional managers of various types and can15 control rulebased authorizations both in that enrollment domain and in other subordinate16 enrollment domains in the hierarchy the concept of hierarchical domains is also potentially17 applicable to other functions in kmi for example access to tracking accounting or audit data18 for management actions could be limited to managers that are at or above the hierarchical level19 of the managers that performed the actions however this security architecture does not now 20 specify any such additional applications21 5191 u hierarchy of enrollment domains22 ufouo ci2 enables enrollment domains to be arranged in hierarchy that is rooted tree23 definition ufouo enrollment domain hierarchy subordination relationship 24 among all enrollment domains that is onetomany and is transitive that is if enrollment 25 domain is subordinate to domain b and b is subordinate to c then is also subordinate 26 to c if is subordinate to b then b is said to be superior to 27 ufouo the enrollment domain hierarchy starts out with at least toplevel domain which28 is the root of the tree29 ci2sar5191a ufouo the kmi shall at system startup initialize hierarchy of 30 enrollment domains by 1 establishing an enrollment domain called the toplevel 31 enrollment domain and 2 enrolling in that domain one or more enrollment managers 32 called toplevel enrollment managers drv krd 1618 r 33 ufouo after system startup enrollment managers in existing enrollment domains may34 establish new enrollment domains that are subordinate to their own35 ci2sar5191b ufouo the kmi shall enable each enrollment manager in an 36 existing enrollment domain to create new enrollment domain that is subordinate to the 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 110managers own domain ie place the new enrollment domain into the enrollment domain1 hierarchy in position either 1 immediately subordinate to the managers own domain or2 2 immediately subordinate to an existing third domain that is already subordinate to the3 managers own domain drv krd 1618 r4 ufouo figure 2 9 illustrates fictitious enrollment domain hierarchy that has the following 5 the enrollment domain for service 1 eds1 and the one for agency 2 eda2 are both6 immediately subordinate to toplevel enrollment domain edtl7 the enrollment domains for service organizations 11 and 12 eds11 and eds12 are8 both immediately subordinate to eds19 because the domain subordination relationship is transitive eds11 and eds12 are 10 subordinate to edtl 11 also edtl is superior to all of the other enrollment domains 12 ci2sar5191c ufouo when an enrollment manager creates new subordinate 13 enrollment domain the kmi shall 1 enable the manager to choose for that domain an 14 enrollment domain identifier that can be unambiguously represented by printable non 15 blank character string and 2 ensure that the name is unique among any peer subordinate 16 domains that have the same immediately superior domain drv krd 1618 r 17 ufouo when ci2 is deployed the actual domains that are immediately subordinate to the18 toplevel enrollment domain might for example be the following19 u united states army20 u united states navy21 u united states air force22 u united states marine corps23 u united states coast guard24 u united states public health service25 u national oceanic and atmospheric administration26 u other for other kmi user organizations27kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 111figure 29 u kmi enrollment domain examples 1 2 unclassifiedfouo 3 5192 u enrolling managers in enrollment domains4 ufouo each enrollment manager can enroll managers in 1 that enrollment managers5 own domain and in 2 any domains that are subordinate to that mangers domain6 ci2sar5192a ufouo when an enrollment manager assigns user identity to 7 management role the kmi shall require the enrollment manager to place the new manager8 in either 1 the enrollment managers own enrollment domain or 2 an enrollment9 domain that is subordinate to the enrollment managers domain drv krd 1618 r 10 ufouo figure 2 9 illustrates the foregoing requirement with these examples 11 at least one toplevel enrollment manager had to be initialized as part of system startup 12 but each additional toplevel enrollment manager could have been enrolled by toplevel 13 enrollment manager 14 each of the other managers for the kmi level ie managers in edtl that are not 15 enrollment managers had to be enrolled by toplevel enrollment manager because an 16 enrollment manager cannot enroll managers into domain superior to its own 17 after eds1 had been created at least one of the enrollment managers for service 1 had to 18 be enrolled by toplevel enrollment manager but then each of the others could have been 19other managers for service organization 11 enrollment domain for organization 1 1 eds11enrollment managers for service org 11other managers for the kmi leveltoplevel ie kmilevel enrollment domain edtl enrollment domain for agency 2 eda2enrollment domain for service 1 eds1 other managers for dod agency 2 other managers for service organization 12 enrollment domain for organization 1 2 eds12toplevel enrollment managers enrollment managers for dod agency 2 enrollment managers for service org 12other managers for uniformed service 1enrollment managers for uniformed service 1kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 112enrolled either by top level enrollment manager or by an existing enrollment manager1 for service 1 similarly after eda2 had been created at least one of the enrollment2 managers for agency 2 had to be enrolled by toplevel enrollment manager but then3 each of the others could have been enrolled either by top level enrollment manager or by4 an existing enrollment manager for agency 25 after eds1 had been created each of the other managers for uniformed service 1 could6 have been enrolled either by an enrollment manager for service 1 or by toplevel7 enrollment manager similarly after eda2 had been created each of the other managers8 for dod agency 2 could have been enrolled either by an enrollment manager for agency 29 or by toplevel enrollment manager 10 after eds11 had been created at least one enrollment manager for organization 11 had 11 to be enrolled either by enrollment manager for service 1 or by toplevel enrollment 12 manager but then each of the others could have been enrolled by an existing enrollment 13 manager for eds11 by an enrollment manager for service 1 or by toplevel enrollment 14 manager similarly after eds12 had been created its enrollment managers could have been 15 enrolled by toplevel enrollment manager by an enrollment manager for service 1 or by 16 an existing enrollment manager for eds12 17 after eds11 had been created each of the other managers for service organization 11 18 could have been enrolled by an enrollment manager for organization 11 by an enrollment 19 manager for service 1 or by toplevel enrollment manager similarly after eda12 had 20 been created each of the other managers for service organization 12 could have been 21 enrolled by an enrollment manager for organization 12 by an enrollment manager for 22 service 1 or by toplevel enrollment manager 23 ufouo the procedures structures or operations of kmi customer organization might24 result is needing to enroll user or user identity in multiple enrollment domains25 ci2sar5192b ufouo the kmi shall permit the same user identity or user 26 identities of the same registered user to be enrolled in two or more enrollment domains 27 by either the same enrollment manager or different enrollment managers drv krd 1618 28 r 29 ci2sar5192c ufouo the kmi shall not permit user identity to be assigned twice 30 to the same management role in single enrollment domain drv krd 0952 1618 r 31 ufouo also an enrollment may need to be undone at some later point in time32 ci2sar5192d ufouo the kmi shall enable an enrollment manager to withdraw an 33 existing assignment of user identity to management role ie disenroll manager 34 regardless of which enrollment manager originally made the assignment if 1 the 35 enrollment manager has authority to confer that role 2 the assignment is contained in 36 either the enrollment domain of that enrollment manager or b an enrollment domain 37 that is subordinate to that one and 3 the user identity is not one that belongs to the same 38 user that is acting as the enrollment manager drv krd 1203 1618 r 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 113ci2sar5192e ufouo the kmi shall enable an enrollment manager to request and 1 view information concerning all assignments of user identities to management roles that 12 currently exist in either that managers enrollment domain or b any enrollment3 domain subordinate to that one 2 for all roles which that enrollment manager has4 authority to confer 3 regardless of which enrollment manager made the assignment drv5 krd 1618 rs6 5193 u implications of enrollment domains7 ufouo the requirements stated in this enrollment domains section bestow strong8 capabilities on an enrollment manager including 1 the ability to create subdomain at the9 managers own level in the domain enrollment hierarchy or subordinate level 2 the ability10 to enroll managers at its own domain level or subordinate level and 3 the ability to remove11 managers at its own domain level or subordinate level regardless of how the management roles12 were originally conferred these strong and flexible capabilities are needed by enrollment13 managers to enable the kmi to deal with contingencies for example as illustrated by figure 2 9 14 if the failure of longhaul network prevented the client nodes of enrollment managers in15 eds1 from communicating with prsn then the toplevel enrollment managers at least16 some of which are expected to be collocated with core nodes could perform the duties of the17 incapacitated managers however the kmi and its user organizations will need to institute18 equally strong procedures to control these capabilities19 ufouo figure 30 illustrates additional kmi capabilities that are implied by the requirements 20 pertaining to the enrollment process21 figure 30 u kmi user enrollment examples 22 23 unclassifiedfouo 24enrollment domain edtl enrollment domain eds1 enrollment domain eds11toplevel enrollment managers enrollment managers for dod agency 2enrollment managers for uniformed service 1 manager in role 1manager in role 3enrollment managers for service organization 12enrollment domain eds12 manager in role 2enrollment domain eda2 koa agent rolemanager in role 1enrollment managers for service organization 11 manager in role 2 user identity yuser identity xkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 114 user identity can be assigned to one or more management roles and also to the koa agent1 role for example identity x is assigned to management roles 1 and 2 and identity is2 assigned to management roles 2 and 33 user identity can be assigned to two or more management roles in the same enrollment4 domain for example identity x is assigned to both management role 1 and management role5 2 in eds116 user identity can be assigned to management roles in two or more enrollment domains and7 the roles can be either the same in each domain or different for example identity x is8 assigned to management role 1 in both eds11 and eds12 but identity is assigned to9 management role 3 in eds12 and management role 2 in eda2 10 user identity can be assigned to multiple management roles at either the same level of the 11 enrollment domain hierarchy or at different levels for example identity x is enrolled only 12 in subordinate enrollment domains that are two levels below edtl but identity is 13 assigned to management role 3 in subordinate domain eds12 two levels below edtl 14 and to management role 2 in subordinate domain eda2 only one level below edtl 15 finally ci2 uses the enrollment domain concept only to control the enrollment of 16 managers and the assignment of their rubac attributes therefore koa agent does not 17 belong to any enrollment domain for example user identities x and are both assigned to 18 the koa agent role but these agents are not treated as belonging to any enrollment domain 19 52 u rulebased access control20 ufouo the rolebased access control process specified in the previous section assigns21 permissions to management roles each permission enables user identity acting in role to22 perform specific type of system action against one or more system resource objects the rule23 based access control rubac processes that are specified in this section constrain the actions of24 rolebased permissions in the context of specific session and specific resource objects25 ufouo as illustrated by figure 3 1 managers can associate rubac attribute values with 26 role assignments and also associate counterpart rubac property values with resource objects27 then during session system actions associated with permission are constrained by requiring28 the attributes of the sessions principal which is exercising the permission to match ie29 correspond according to prespecified confidentiality rules with properties of the affected30 resource objects this security architecture specifies rubac properties only for type 1 31 products but rubac properties could be specified for other types of system resource objects32 for example rubac could be applied to reports generated for managers also rubac33 concepts could be adapted to other types of security services using other types of properties34 however this architecture does not specify any such additional properties or applications 35 ufouo the terminology here has been chosen carefully although the rubac36 characteristics associated with role assignments rubac attributes are similar in nature to the37 characteristics associated with resource objects rubac properties different nouns have been38 used to prevent ambiguity in requirement statements39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 115figure 31 u kmi rulebased access control 1 2 unclassifiedfouo 3 ci2sar52a ufouo the kmi shall restrict the access of system entities to resource 4 objects by comparing 1 the rubac properties of an object to 2 the rubac attributes of5 the accessing entity drv krd 0612 0872 1332 1613 r6 ci2sar52b ufouo the kmi shall record for audit any attempt to access resource 7 object by system entity that does not have the necessary rubac attribute values drv8 krd 0867 r9 ci2sar52c ufouo the kmi shall provide capability to manage rubac attributes 10 of managers and the corresponding rubac properties of resource objects drv 1610 11 rs 12 ufouo rolebased access control could be adapted to support confidentiality rules by itself13 this could be done by binding rubac attributes into role definitions however that would14 greatly increase the complexity of role management functions because it would increase both the15 number of roles to be managed and the number of times that an identitys role might need to be16 changed therefore ci2 manages rubac separately enabling roles to be more easily managed17 521 u rubac properties for system resource objects18 ufouo as illustrated by figure 3 1 rubac property values are assigned to kmi products 19 and could be assigned to other system resources such as library objects kmi products are used20 to protect information ranging from unclassified to compartmented top secret and the kmi21 needs to ensure that the products are released only to properly authorized system entities ci222 uses rubac to implement data confidentiality requirements see data confidentiality section23 of volume 2 for products the properties that kmi needs for products are numerous and varied24rule enforcement processmanagement role permission actionelements of permissionmanagement permission resource objectskmi user identityregistration and enrollment processes 3 principal exercises permission that is controlled by ruleprincipal in session1 enrollment manager associates rubac attributes with manager ie with an assignment of user identity to management role2 product manager ie controlling authority or command authority associates rubac properties with product or other resource object properties of resource classification compartments handling restrictions national releasability ownership attributes of principal clearance compartment handling authorizations nationality membership ie user domains4 attributes of principal must correspond with properties of resource in accordance with security policykmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 116and the kmi must be able to support new ones as needs arise therefore this security 1 architecture specifies types of properties but does not specify individual values 2 definition ufouo rubac property characteristic of system resource object 3 where the value of the characteristic is used to make access control decisions that enforce4 data confidentiality drv krd 16145 ufouo when product manager establishes new product see approvalbased access6 control section that manager assigns values for the products rubac properties product7 has at least the following rubac properties which in effect comprise security label8 basic classification singlevalued hierarchical sensitivity level such as secret 9 security categories multivalued nonhierarchical sensitivity designations 10 national releasability multivalued country designations 11 handling restrictions multivalued other handling requirement designations 12 522 u rubac attributes for system entities13 ufouo as illustrated by figure 3 1 rubac attribute values are assigned to managers the 14 values that the kmi needs for managers are numerous and varied and the kmi must be able to15 support new ones as needs arise therefore this security architecture specifies types of 16 attributes but does not specify individual values17 definition ufouo rubac attribute characteristic of system entity where the 18 value of the characteristic is used in making access control decisions that enforce data 19 confidentiality 20 ufouo when an enrollment manager creates new manager ie assigns user identity to21 management role the enrollment manager also assigns values for the rubac attributes of the22 new manager the values represent the new managers authorizations for ordering and23 distributing products or for performing managerial functions related to the rubac and approval24 based access control processes manager at least has the following four rubac attributes25 basic clearances possibly multivalued hierarchical sensitivity levels comparable to basic 26 classification attribute of product or other resource object 27 security categories possibly multivalued nonhierarchical sensitivity designations 28 comparable to the security categories attribute of product or other resource object 29 nationality singlevalued country designation comparable to the national releasability 30 attribute of product or other resource object 31 handling approvals multivalued comparable to handling restrictions attribute of 32 product or other resource object 33 ufouo this security architecture specifies rubac attributes only for 1 certain managers 34 2 certain user devices and 3 accounts that are used to manage devices and products35 potentially rubac attributes could be specified for other types of system entities and36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 117constructs including koa agents and operational components for example the kmi could1 treat sponsoring organization as rubac attribute of user identity or of the assignment of a2 user identity to the koa agent role see static user domain constraints the value of this3 attribute could be matched against the value of an ownership attribute of system resource4 objects to implement access control based on organizational affiliation and this form of rubac5 could be used to limit access to tracking accounting and or audit data however this6 architecture does not specify such additional attributes or applications 7 ufouo the enrollment process assigns one or more sets of rubac attribute values to8 certain managers9 definition ufouo rubac access set set of rubac attribute values that is 10 1 contained in the set of all kmi rubac attribute values 2 is associated with 11 manager and 3 is used in determining the limits of the managers permissions with regard 12 to accessing resource objects 13 ufouo rubac access set contains the following types of values which must be14 consistent ie semantically noncontradictory15 basic clearances one or more values 16 security categories zero or more values 17 nationality single value 18 handling approvals zero or more values 19 definition ufouo rubac conferral set set of rubac attribute values that is 20 1 contained in the set of all kmi rubac attribute values 2 is associated with an 21 enrollment manager device registration manager or koa registration manager and 3 22 is used to constrain the rubac attribute values that the manager can assign 23 ufouo rubac conferral set functions as follows24 1 for an enrollment manager it constrains the attribute values that the manager can assign 25 to the access sets and conferral sets of other managers 26 2 for device registration manager it constrains the attribute values that the manager can 27 assign to user devicesecus fill devices and akps 28 3 for koa registration manager it constrains the attribute values that the manager can 29 assign to koas 30 ufouo conferral set contains the same attributes as in an access set but each attribute31 may have several values possibly all the values defined in the kmi32 basic clearances one or more values 33 security categories zero or more values 34 nationalities one or more values 35 handling approvals zero or more values 36 ufouo figure 3 2 illustrates that when an enrollment manager manager 1 confers role 37 that does not need rubac conferral set the enrolling manager manager 1 assigns the38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 118rubac access set access set 2a of the new manager manager 2 and the new access set1 access set 2a must be contained in the enrolling managers conferral set conferral set 12 figure 32 u kmi rubac attribute set initialization and change 3 4 unclassifiedfouo 5 ufouo figure 3 2 also illustrates that when an enrollment manager manager 1 confers 6 role that needs rubac conferral setenrollment manager device registration manager or7 koa registration managerthe enrolling manager manager 1 assigns to the new manager8 manager 3 both the conferral set conferral set 3a and also rubac access set access set9 3a and each set must be contained in the enrolling managers conferral set conferral set 110 however the new access set access set 3a and the new conferral set conferral set 3a do11 not need to be either identical to or contained in each other12 ufouo figure 3 2 further illustrates that sometime after manager either manager 2 or 13 manager 3 has been enrolled either the original enrolling manager manager 1 or another14 enrollment manager manager 4 may change the new managers access set or conferral set by15 adding or deleting values the enrollment manager that makes the change can add or delete only16 values that are in its own conferral set17 ufouo an enrollment managers access set need not be contained in that managers18 conferral set for example figure 3 3 illustrates that the total set of rubac attribute values that 19 is supported by the system is b c d f each toplevel enrollment manager is20 authorized to access f but not confer f this might be designed to ensure that only toplevel21 managers can ever access data labeled f22 ufouo conversely managers conferral set need not be contained in that managers23 access set in figure 3 3 the enrollment managers for uniformed service 1 can confer b c 24 d and but can access only b c and d for example an enrollment manager that is citizen25 of country probably would not have the access value for country b citizenship but might be26 authorized to confer that access value when supporting multinational organization27access set 3b contained in conferral sets 1 and 4conferral set 1 access set 1 access set 3a contained in conferral set 1conferral set 3b contained in conferral sets 1 and 4access set 2b contained in conferral sets 1 and 4access set 2a contained in conferral set 1 registered human userenrollment processregistered human userenrollment process enrollment manager 1 conferral set 3a contained in conferral set 1conferral set 4 access set 4enrollment manager 4 manager 3 needs conferral set ie this is an enrollment mgr or device registration mgr or koa registration mgrmanager 2 needs conferral setkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 119figure 33 u kmi rubac attribute set examples 1 2 unclassifiedfouo 3 ci2sar522a ufouo the kmi shall grant to any toplevel enrollment manager 4 that is initialized at system startup rubac conferral set that is an appropriate subset of all5 the rubac attribute values that have been defined for data confidentiality for type 16 products which includes at least the following four attribute types drv krd 1611 r7 1 hierarchical data sensitivity designations 8 2 nonhierarchical data category designations 9 3 nationality designations 10 4 other data handling authorization designations 11 ci2sar522b ufouo the kmi shall give to any toplevel enrollment manager that 12 is initialized at system startup rubac access set that is an appropriate subset of all the 13 rubac attribute values that have been defined for data confidentiality for type 1 products 14 drv krd 1615 2008 r 15 ci2sar522c ufouo the kmi shall enable an enrollment manager when assigning 16 user identity to any management role to give the new manager rubac access set 17 containing only consistent ie noncontradictory set of the rubac attribute values that 18 are contained in the enrolling managers own conferral set drv krd 1615 2008 r 19 ci2sar522d ufouo the kmi shall enable an enrollment manager when assigning 20 user identity to the role of 1 enrollment manager 2 device registration manager or 21 3 koa registration manager to give the new manager rubac conferral set containing 22zenrollment domain eda2 confer abe confer aceconfer abcde confer abceother managers for kmi level other managers for service organization 12other managers for service organization 11other managers for uniformed service 1 service organization 12 enrollment managersservice organization 11 enrollment managersconfer abcdetoplevel ie kmilevel enrollment managers uniformed service 1 enrollment managersaccess bcd dod agency 2 enrollment managers access bc access bcother managers for dod agency 2 access subsets of abeaccess subsets of abce access subsets of aceaccess subsets of abcdef access subsets of abcdaccess abcdef access ade legend enrollment actionkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 120only consistent ie noncontradictory set of the rubac attributes that are contained in1 the enrolling managers own conferral set drv krd 1615 2008 r2 ufouo the foregoing requirement means that the enrolling manager establishes the initial3 authority of the new manager to confer rubac attributes however this authority can be4 changed later as stated in the following requirement5 ci2sar522e ufouo the kmi shall enable an enrollment manager to either view 6 add or delete an attribute value in either the rubac access set or rubac conferral set of7 another existing manager if and only if all of the following conditions hold drv krd8 1560 1611 2146 r9 1 the value is contained in the conferral set of the enrollment manager that is making 10 the change 11 2 the manager being changed is contained in either the enrollment domain of the 12 enrollment manager that is making the change or b an enrollment domains that is 13 subordinate to the enrollment managers own domain 14 3 the user identity of the manager being changed does not belong to the same user as 15 does the user identity of the enrollment manager that is making the change 16 ufouo for example any one of the toplevel managers illustrated by figure 3 3 could add 17 or delete values b c d or in either the rubac access set or the rubac conferral set of18 any manager in the domain edtl ie of 1 any other toplevel enrollment manager or other19 manager for the kmi level or 2 any enrollment manager or other manager for uniformed20 service 1 dod agency 2 service organization 11 or service organization 22 in other words21 any toplevel manager could change any rubac attribute set for any manager shown in the22 figure23 ufouo however any one of the dod agency 2 enrollment managers could add or delete24 values b c or in either the access set or the conferral set of only managers in the domain25 eda2 dod agency 2 enrollment manager could not change any rubac attribute value of26 any manager outside of eda227 ufouo after ci2 is deployed the kmi is expected to have several thousand external28 managers that are distributed throughout the world and that operate within many user29 organizations that take different approaches to selecting those managers regardless of these30 differences all enrollment managers need to be knowledgeable of their local command structure31 and its operational procedures so that they can select the other managers appropriately and32 verify that those persons have authorization to be granted the rubac attribute values that are33 needed to operate in their various roles enrollment managers need to have strong lines of34 communication with personnel security offices to ensure that rubac attributes assigned to35 managers are based on proper authority are accurate and are kept uptodate including being36 revoked if needed37 53 u approvalbased access control38 ufouo in addition to rolebased and rulebased access controls ci2 implements third39 form of access control called approvalbased the rolebased form provides functionality40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 121controls based on roles and permissions and the rulebased form provides confidentiality1 controls based on classification handling restrictions and nationality however rolebased and2 ruledbased controls do not provide sufficient granularity for managing the distribution of3 products to cryptographic devices4 definition ufouo kmi operating account koa kmi business relationship 5 that is established to manage 1 the set of user devices that are under the control of kmi6 customer organization and 2 the distribution of kmi products to those devices7 ufouo for distributing products to koas and to devices held by koas the kmi needs8 controls based on needtoknow that is approved by managers for example not every koa that9 operates at the secret level should be able to receive every secret product10 ci2sar53a ufouo the kmi shall implement an approvalbased access control 11 process that enables the authorizations conferred by rolebased and rulebased access 12 control processes to be restricted on needtoknow basis for koas and selected managers 13 drv krd 0425 1034 ar 14 ci2sar53b the kmi shall record as mandatory audit event each approval by 15 manager for access to kmi product service or other system resource drv krd 1564 16 ar 17 ufouo approvalbased access control involves the four management roles that deal directly18 with product ordering and distribution controlling authority command authority product19 requester and koa manager enrollment managers in kmi customer organizations assign20 identities to these four roles through the rolebased access control process users are expected to21 be selected for these roles based on organizational affiliation geographical location and other22 operational factors23 ufouo the operational flow and access control considerations for key ordering depend on24 the type of product being ordered at the highest level there are two groups of products to25 consider26 symmetric key and netted firefly key the ordering and management of these product 27 types are based on short titles corresponding to cryptonets and typically involve distribution 28 of key to multiple destination koas andor comsec accounts in this section the 29 requirements and descriptions that address symmetric key should be understood as 30 applying to both symmetric key and netted firefly key unless otherwise stated 31 basic and enhanced firefly key other than netted firefly key the ordering and 32 management of firefly key is based on key attributes particularly partition codes and 33 department agency organization dao codes each firefly key is ordered for and 34 delivered to single destination koa or comsec account 35 ufouo table 10 summarizes the ordering and management distinctions among symmetric36 key firefly key and netted firefly key37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 122table 10 u kmi management differences for major key product types 1 product type managed by specified by ordered by recipients symmetric keycontrolling authorityshort titlecontrolling authority or product requestermultiple firefly keycommand authoritypartition code dao codeproduct requester single netted firefly keycontrolling authorityshort titlecontrolling authority or product requestersingle but coordinated with other recipients in the same net unclassifiedfouo 2 ufouo the first subsection that follows approvalbased access control for symmetric3 key products begins with an overview and then provides details and states basic requirements4 the second subsection approvalbased access control for symmetric key products parallels5 the first but is shorter because much of the material that applies to symmetric key products also6 applies to asymmetric key products however these two types of products are under the7 management control of two different product manager roles8 ufouo controlling authority is the product manager role for symmetric products9 traditionally the controlling authority role has had the following definition and the first10 subsection interprets that definition in terms of kmi responsibilities11 definition ufouo controlling authority official responsible for directing the 12 operation of cryptonet and for managing the operational use and control of keying material 13 assigned to the cryptonet cnssi4009 14 ufouo command authority is the product manager role for asymmetric products15 traditionally the command authority role has had the following definition and the second16 subsection interprets that definition in terms of kmi responsibilities17 definition ufouo command authority individual responsible for the appointment 18 of user representatives for department agency or organization and their key ordering 19 privileges cnssi4009 20 ufouo third subsection kmi operating accounts provides more detail concerning21 processes that apply to both symmetric and asymmetric products additional specifications and22 descriptions for approvalbased access control are provided in volume 1 and in the concept of 23 operations kmi2212 24 ufouo approvalbased access control for symmetric and netted firefly products25 involves three management roles that deal directly with product ordering and distribution koa26 manager product requester and the product manager role of controlling authority for27 asymmetric products the roles are koa manager product requester and the product manager28 role of command authority29kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 123ufouo as specified in the verification of authenticity and eligibility for managers1 section the kmi does not assign user identity to management role unless the identity belongs2 to either us nato or cceb security domain consequently nonnato noncceb3 coalition partners cannot perform the roles of controlling authority command authority4 product requester and koa manager and therefore are prevented from ordering either5 symmetric or asymmetric products products are ordered for coalition partners only by us6 managers7 531 u approvalbased access control for symmetric key products8 ufouo for each specific symmetric key product relationships are established among the9 controlling authority product requesters and koa managers as illustrated by figure 3 4 10 controlling authority defines product the controlling authority and possibly product11 requesters determine which koas are authorized to distribute the product to devices based on12 the relationship of those accounts to communications networks in the context of an operational13 mission in each of those koas koa manager determines which of that koas devices are to14 receive the product15 figure 34 u kmi management roles in distribution of symmetric products 16 17 unclassifiedfouo 18 5311 u overview of distribution of symmetric key products19 ufouo the approvalbased distribution process shown in figure 3 4 has the following steps 20 ufouo controlling authority defines new product controlling authority can define 21 new product eg product in figure 3 4 the controlling authority also can place 22 orders for generating and distributing that product or the controlling authority can delegate 23 responsibility for ordering by appointing product requesters 24 ufouo controlling authority appoints product requesters the controlling authority 25 for product can optionally select one or more user identities that have been enrolled as 26 product requesters and authorize them to place orders for the product the selections are 27managers downward flow of approvalbased authority ordering and management enclaves koa managersrequest distribution of product to specified devices in koasappoints authorizesproduct requestersrequest ie order product be authorized for distribution through specified koasmanagement responsibilitiesprsn if required approve requests for product adefine new product product appoint product requesters for product abefore the actions shown on the right can happen kmi user organizations request separate enrollment actions for each of these managers controlling authority request ie order product be authorized for distribution through specified koaskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 124not constrained by enrollment domains the controlling authority can require that orders1 placed by product requester receive peredition approval before the product is generated2 and distributed if such approval is required the controlling authority acts as the approver3 ufouo controlling authority or product requester orders products for operating4 accounts controlling authority or an authorized product requester can order product a5 ie can request that product be generated and be distributed to devices under the control6 of selected koas7 ufouo koa manager directs product to devices koa manager of koa for which 8 product has been ordered can request that product be distributed to specific devices that9 are managed by that account 10 ufouo the management of symmetric products involves all three types of access control11 rolebased processes determine which users are controlling authorities product requesters 12 and koa managers 13 approvalbased processes restrict ordering to authorized controlling authorities and product 14 requesters and restrict distribution to koas and devices that have legitimate need 15 rulebased processes ensure that only appropriately authorized koas may distribute 16 products to devices and that only authorized devices may receive products 17 ufouo as illustrated by figure 30 human user could be assigned to one of the three 18 product management roles in some enrollment domain and then be assigned to the same role in19 another enrollment domain each assignment would receive separate set of rubac20 authorizations and would be constrained to what is allowed in its own enrollment domain and21 the user would be able to act in only one of these management roles at time thus the user22 would not be able to use the authorizations granted in one domain to manage products in the23 other domain although this kind of dual assignment might be made only rarely this could be24 useful in special situations such as joint operations for example member of the army who is25 enrolled as product requester in an army domain might also temporarily need to order26 products for air force devices for which the army domain does not have access in that case an27 enrollment manager in an air force domain could also enroll the user as product requester28 when the need for the air force access has expired the air force could revoke the enrollment in29 their own domain without affecting the users ability to order products for the army30 ufouo figure 3 5 illustrates that the distribution process for symmetric product product 31 has two stages32 ufouo stage 1 distribution directed by product requesters the controlling 33 authority or product requester requests that product be distributed to selected koas 34 collectively all such requests create an access control list for product and the list is 35 maintained by prsns 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 125figure 35 u kmi twostage distribution of symmetric key products 1 2 unclassifiedfouo 3 definition ufouo account distribution profile an approvalbased access control 4 list for specific product that 1 names the koas to which prsns distribute the product5 and 2 states conditions of distribution eg requires peredition approval6 ufouo stage 2 distribution directed by koa managers koa manager of 7 koa for which product has been ordered can request that product be distributed to8 specific selected devices owned by that account the koa managers requests for9 product are entered on an access control list that is maintained by prsns 10 definition ufouo device distribution profile an approvalbased access control 11 list for specific product that 1 names the user devices in specific koa to which prsns 12 distribute the product and 2 states conditions of distribution for each device 13 ufouo in summary for each product there is separate device distribution profile in each14 koa for which the product has been approved by product requester conversely for each15 koa there is separate device distribution profile for each product for which the koa has been16 approved17 ufouo the following sections provide further more detailed description of the approval18 based access control process for symmetric products and specify its basic system requirements19 additional descriptions and specifications for the operation of the process are provided in the20 concept of operations conop and volume 1 21user device m user device 1user device 2 lists of devices held by koaskoa ns local distribution profile for product koa 2s local distribution profile for product koa 1s local distribution profile for product this profile listing devices 1 thru m is maintained by the prsns the profile is defined collecively by the distribution requests made by the koa managers for koa 1koa n koa 1koa managersthe account distribution profile for product this profile listing koas 1 thru n is maintained by the prsns the profile is defined collectively by the orders for product that are placed by its controlling authority and by product requesters that have been authorized to order the product stage 1 stage 2koa 2 controlling authority and product requesters for product aproduct akmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1265312 u controlling authority for symmetric key products1 ufouo in the kmi the role of controlling authority is assigned responsibility for2 1 determining the need for new instance of an available product type eg new cryptonet3 2 specifying rubac attribute values for the new product 3 requesting short title for the4 new product 4 either ordering the product for koas and comsec accounts that should5 receive it or authorizing product requestors to do the ordering or both and 5 approving per6 edition distribution of the product to devices if the controlling authority deems such approval is7 needed8 definition ufouo short title an identifying combination of letters and numbers 9 assigned to certain comsec materials to facilitate handling accounting and controlling 10 cnssi4009 11 ufouo figure 3 6 provides simplified example involving one symmetric product short title 12 usead nnnn prsn2 and three ecus to illustrate that establishing new product involves13 the following steps14 figure 36 u kmi approvalbased steps for symmetric key product 15 16 unclassifiedfouo 17 ufouo establish short title controlling authority working at management 18 client node connects to an ome of prsn and requests that new short title be assigned 19 for some basic product type that that kmi is capable of generating the prsn assigns short 20 title for the product eg usead nnnn prsn2 and designates the product to be under the 21 control of the requesting controlling authority 22managers downward flow of approvalbased authorityprsn 2 user device 2 user device 3pdesomes account distribution profile for the product usead nnnn prsn2 local distribution profiles for the product usead nnnn prsn2user device 1assign new short title usead nnnn prsn2 with those rubac attribute values request ie place order for distribution of the product usead nnnn prsn2 to koa 1 request assignment of user devices 1 2 and 3 to koa 1 request distribution of the product usead nnnn prsn to user devices 2 and 3 user device 2 receives delivery of the product usead nnnn prsn2 user device 3 receives delivery of the product usead nnnn prsn2request new short title with rubac attribute values of secret us only appoint product requesters for the short title usead nnnn prsn2 if required approve peredition distribution for the short title usead nnnn prsn2 rubac properties secret usonlyproduct usead nnnn prsn2 koa 1koa manager for koa 1rubac conferral set ts s us nato controlling authority or product requestercontrolling authoritykmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 127 ufouo assign the rubac property values the controlling authority specifies 1 rubac values for the product eg secret and usonly the prsn checks that2 the specified values are contained in the managers rubac conferral set and if so3 associates the values with usead nnnn prsn24 ufouo each product is resource object that has rubac properties the following5 requirements enable controlling authority to establish products6 ci2sar5312a ufouo the kmi shall enable controlling authority to establish 7 new product that is based on an existing product type krd new crs8 ci2sar5312b ufouo the kmi shall assign management control of newly 9 requested product to the controlling authority that makes the request drv krd 0949 10 cr 11 ci2sar5312c ufouo the kmi shall enable controlling authority to assign to 12 new product set of rubac property values that are the counterparts to consistent subset 13 of the rubac attributes that are contained in that controlling authoritys access set drv 14 krd 1332 1614 cr 15 ci2sar5312g ufouo the kmi shall enable controlling authority to attach one 16 and only one of the following conditions to new product drv krd 1484 cr 17 1 for all orders that are placed for the product by product requesters explicit approval 18 by the controlling authority is required each time before an edition of the product is 19 distributed 20 2 peredition approval is not required for all orders but the controlling authority may 21 require approval for the orders received from selected product requesters 22 ci2sar5312d ufouo the kmi shall maintain an account distribution profile for 23 each symmetric product that is established by controlling authority and the profile shall 24 contain the following data items drv krd 0910 0911 r 25 1 the products rubac property values 26 2 list of any koas for which distribution orders are active with necessary 27 information about each order including the user identity of the manager either the 28 controlling authority or product requester who placed the order b distribution 29 requirements such as routing required quantities and need dates and c whether per 30 edition approval is required 31 3 list of any nonkoa key management entities kmes ie comsec accounts 32 for which distribution orders are active with necessary information about each order 33 additional data items are defined in volume 1 and still more items are expected to be 34 defined when detailed design is done 35 ci2sar5312e ufouo the kmi shall enable controlling authority to cause the 36 kmi temporarily to cease distributing product under the authoritys control and to restart 37 distribution that has been temporarily stopped drv krd 1016 cr 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 128ci2sar5312f ufouo the kmi shall enable controlling authority to manage the 1 account distribution profile for product under the authoritys control drv krd 09102 0911 r3 5313 u product requester for symmetric key products4 ufouo after short title has been established the products controlling authority can5 request that the product be made available to specific koas ie can place orders for the6 product optionally controlling authority can delegate that responsibility by authorizing one7 or more product requesters to order the product as illustrated by the next step in figure 3 6 8 ufouo appoint the product requesters the controlling authority selects one or 9 more user identities that have previously been enrolled as product requesters and authorizes 10 those managers to request usead nnnn prsn2 for koas 11 ci2sar5313a ufouo the kmi shall permit only the roles of controlling 12 authority and product requester to be assigned permissions that enable manager to order 13 symmetric products drv krd 0910 0949 r 14 ci2sar5313b ufouo the role of controlling authority shall in addition to the 15 permissions that are assigned to that role have the permissions that are assigned to the role 16 of product requester drv krd 0910 1721 s 17 ci2sar5313c ufouo the kmi shall enable controlling authority to order any of 18 the products and only those products that are under the control of that authority drv 19 krd 0425 0910 0946 1034 1720 1721 cr 20 ci2sar5313d ufouo if registered user acting in the role of controlling 21 authority orders product for which that authority has required peredition approval then 22 approval shall be automatic and implicit that is controlling authority shall not be required 23 to explicitly approve peredition distributions for the authoritys own orders krd 0910 24 cr 25 ufouo note that the foregoing requirement purposely does not implement krd 162126 which says the kmi shall not allow manager to approve any request that the manager27 originates to do so would conflict with the intent of krd 0910 which says the kmi shall28 provide means for controlling authority to authorize the distribution of key from any29 appropriate kmi component to user who previously was not authorized to receive the key of30 course user could be separately assigned to both the role of controlling authority and the role31 of product requester and that user while acting as the controlling authority could grant an32 ordering authorization to itself as product requester for product that requires peredition33 approval in that case it is clear that if the user places an order for the product while acting as the34 product requester then the user would need to act as the controlling authority to grant explicit35 peredition distribution approvals for that order however it is not apparent that any kmi36 customer organization would want to institute such product management arrangement37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 129ci2sar5313e ufouo the kmi shall enable controlling authority and only 1 controlling authority to authorize one or more product requesters ie user identities that2 are currently assigned to the role of product requester to order one or more of the products3 that are under the control of that controlling authority drv krd 0949 1720 1721 17224 cr5 ci2sar5313f ufouo the kmi shall enable controlling authority to withdraw or 6 modify any ordering authorization previously granted to product requester for product7 under the control of that controlling authority drv krd 1722 cr8 ci2sar5313g ufouo the kmi shall enable product requester to order any of the 9 products but only those products for which ordering authorization has been granted to the 10 requester by controlling authority drv krd 0425 0946 0949 1034 1720 1722 11 cr 12 ci2sar5313h ufouo the kmi shall enable controlling authority or product 13 requester to order product for distribution through koa ie list the koa identifier on 14 the account distribution profile of the product ie authorize the koa to distribute the 15 product to user devices drv krd 0949 cr 16 ci2sar5313i ufouo the kmi shall enable controlling authority or product 17 requester to order product for distribution through nonkoa kme that is the manager 18 can list comsec accounts ekms identifier on the account distribution profile of the 19 product drv krd 0949 cr 20 ci2sar5313j ufouo the kmi shall permit controlling authority or product 21 requester to order product for koa only if the rubac property values of the product 22 are contained in the rubac access set of the koa drv krd 0946 1332 r 23 ci2sar5313k ufouo the kmi shall enable controlling authority or product 24 requester to request that product be distributed through koa regardless of whether the 25 requester and the koa belong to the same enrollment domain or not drv krd 0949 26 r 27 ufouo controlling authorities can authorize product requester for product either for a28 limited period of time or indefinitely but may withdraw the authorization at any time once an29 order is placed each edition of the product is distributed as ordered until the approval expires or30 is withdrawn however controlling authority may also require peredition approval before31 distribution ie require separate predistribution authorization action for each individual32 edition of the product either for all orders for that product or for orders for that product that are33 received from selected product requesters34 ci2sar5313l ufouo the kmi shall require controlling authority to attach one 35 and only one of the following conditions to an ordering authorization granted to specific 36 product requester for specific product drv krd 1484 r 37 1 the authorization is for an indefinite period of time unless the controlling authority 38 withdraws or modifies the authorization specified as not before time 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 130 2 the authorization is for limited period of time unless the controlling authority 1 withdraws or modifies the authorization before the end of the period specified as not 2 before and not after times 3 ci2sar5313m ufouo the kmi shall require controlling authority to attach one 4 and only one of the following conditions to an ordering authorization granted to specific5 product requester for specific product drv krd 1484 cr6 1 for an order that is placed for the product by that requester explicit approval by the 7 controlling authority is required each time before an edition is distributed 8 2 peredition approval is not required for orders for that product from that requester 9 unless the controlling authority has required peredition approval for every order of the 10 product regardless of which requester places the order 11 ci2sar5313n ufouo the kmi shall notify controlling authority when 12 distribution of an edition of product requires approval by the authority drv krd 1483 13 1776 r 14 ci2sar5313o ufouo the kmi shall enable controlling authority to approve or 15 disapprove distribution of an edition of product but only for product that the authority 16 controls drv krd 1483 1563 1776 r 17 ci2sar5313p ufouo the kmi shall not perform the distribution of an edition of 18 product that requires peredition approval until the kmi has received an authenticated 19 approval from the products controlling authority drv krd 1484 1561 1563 1564 20 1777 r 21 ci2sar5313q ufouo the kmi shall record for audit any approval given by 22 controlling authority for the peredition distribution of product drv krd 1564 r 23 532 u approvalbased access control for asymmetric key products24 ufouo for each specific kmi asymmetric product relationships are established among the25 managers as illustrated by figure 3 7 command authority requests the assignment of 26 partition codes and departmentagencyorganization dao codes for asymmetric products that27 the command authoritys organization requires the command authority identifies which28 partition codes and dao codes may be ordered by each product requester product requesters29 in response to key material needs identified by the organizations they support order30 asymmetric key products and identify the koa or comsec account that should receive each31 product koa manager at the receiving koa determines which device should receive the32 product33kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 131figure 37 u kmi management roles in distribution of asymmetric products1 2 unclassifiedfouo 3 5321 u overview of distribution of asymmetric key products4 ufouo the approvalbased distribution process shown in figure 3 7 has the following steps 5 ufouo command authority defines new product codes command authority can6 define new partition codes and dao codes7 definition ufouo partition code mechanism used to divide an asymmetric eg 8 firefly universal into smaller nets such that only devices in specific partition can9 interoperate even though they would otherwise be cryptographically compatible 10 definition ufouo departmentagencyorganization dao code an encoded 11 unique identifier assigned to an department agency or organization description and used in 12 generation of firefly key credentials 13 ufouo command authority appoints product requesters the command authority 14 selects one or more user identities that have been enrolled as product requesters and 15 authorizes them to place orders containing specific partition codes and dao codes the 16 command authority can require that orders placed by product requester receive perorder 17 approval before the product is generated and distributed if such approval is required the 18 command authority acts as the approver 19 ufouo product requester orders product for operating account product requester 20 can order an asymmetric product containing partition codes and dao codes for which that 21 product requester is authorized and identify the koa or comsec account that should 22 receive the product 23 ufouo koa manager directs product to device koa manager of the koa for 24 which an asymmetric product has been ordered can request that the product be distributed to 25 specific device managed by that account 26managers downward flow of approvalbased authorityprsn ordering and management enclaves koa managersrequest distribution of product to specified device in the koabefore the actions shown on the right can happen kmi user organizations request separate enrollment actions for each of these managers appoints authorizesrequest product with specific product codes for distribution through specified koamanagement responsibilities if required approve requests for productdefine new partition codes and dao codes appoint product requesters for specific partition codes and dao codescommand authority product requesterskmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 132ufouo the management of asymmetric products involves all three types of access control1 rolebased processes determine which users are command authorities product requesters2 and koa managers3 approvalbased processes restrict ordering of dao and partition codes to designated product4 requesters and restrict distribution to koas and devices that have legitimate need5 rulebased processes ensure that only appropriately authorized koas may distribute the6 product to devices and that only authorized devices may receive the product7 ufouo the twostage distribution process for symmetric products which is shown in8 figure 35 also applies to asymmetric products with the following exceptions 9 an asymmetric product is ordered only by product requesters not the command authority 10 role 11 each asymmetric key is delivered to single destination device thus the account distribution 12 profile for an asymmetric product will list only single koa or comsec account 13 for the same reason the products device distribution profile in that account will list only 14 one destination device 15 ufouo the following sections provide further more detailed description of the approval16 based access control process for asymmetric products and specify its basic system requirements17 additional descriptions and specifications for the operation of the process are provided in the18 concept of operations conop and volume 1 19 5322 u command authority for asymmetric key products20 ufouo in the kmi the role of command authority role is assigned responsibility for 121 determining the need for partition codes and dao codes based on organizational requirements22 2 requesting the assignment of partition codes and dao codes 3 specifying the partition23 code and dao code ordering privileges of product requesters and 4 approving asymmetric24 key orders by product requesters if such approval is needed25 ufouo figure 3 8 provides simplified example illustrating the establishment of partition 26 codes and dao codes and their use by product requester27 ufouo request partition codes and dao codes command authority receives 28 notice typically by outofband means from product requester that new dao code or 29 partition code is needed working at management client node the command authority 30 connects to an ome of prsn and requests that new code be assigned the prsn assigns 31 dao code or partition code for the product and designates the code to be under the control 32 of the requesting command authority 33 ufouo the following requirements enable command authority to establish partition34 codes and dao codes for asymmetric products35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 133figure 38 u kmi approvalbased steps for asymmetric key products 1 2 unclassifiedfouo 3 ci2sar5322a ufouo the kmi shall enable command authority to establish 4 new partition code for an available asymmetric product type krd new crs5 ci2sar5322b ufouo the kmi shall assign management control of newly 6 established partition code to the command authority that requested it drv krd 09497 cr8 ci2sar5322c ufouo the kmi shall enable command authority to establish 9 new dao code for an available asymmetric product type krd new crs 10 ci2sar5322d ufouo the kmi shall assign management control of newly 11 established dao code to the command authority that requested it drv krd 0949 12 cr 13 ci2sar5322e ufouo the kmi shall enable command authority to attach one 14 and only one of the following conditions to product requests containing partition codes and 15 dao codes over which the command authority has management control drv krd 16 1484 cr 17 1 for all orders that are placed by product requesters for products containing specific 18 partition codes andor dao codes explicit approval by the command authority is 19 required for each order 20 2 the command authority may require approval for the orders received from selected 21 product requesters 22managers downward flow of approvalbased authorityprsn assign the new partition code order product with specific partition code dao code and rubac property values for specific koa user device 1 user device 2pdesomes product requester privileges user device 2 receives delivery of productrequest new partition code request new dao code assign the new dao codepartition codes account distribution profile lists only koa 1 device distribution profile lists only device 2dao codes allocate dao codes partition codes to product requestersoutofband communication of partition code and dao code needs request assignment of user devices 1 and 2 to koa 1 request distribution of product to user device 2requests and responses command authority koa manager for koa 1 koa 1product requesterkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1345323 u product requester for asymmetric key products1 ufouo after appropriate partition codes and dao codes have been established the2 command authority responsible for those codes can authorize one or more product requesters3 to order products containing those codes as illustrated by the next step in figure 3 8 4 ufouo allocate codes to product requesters the command authority selects one or 5 more user identities that have previously been enrolled as product requesters and authorizes6 those managers to request asymmetric products containing specific partition codes and dao7 codes that the command authority has established8 ufouo if person who is acting as command authority also needs to be able to order9 asymmetric products then that person must also become enrolled as product requester10 ci2sar5323g ufouo the kmi shall permit only the role of product requester to 11 be assigned permissions that enable manager to order asymmetric products drv krd 12 0910 0949 r 13 ci2sar5323a ufouo the kmi shall enable command authority and only 14 command authority to authorize one or more product requesters ie user identities that 15 are currently assigned to the role of product requester to order asymmetric products 16 containing partition codes and dao codes that are under the control of that authority 17 drv krd 0949 1720 1721 1722 cr 18 ci2sar5323b ufouo the kmi shall enable command authority to withdraw or 19 modify any ordering authorization previously granted to product requester for use of any 20 partition code or dao code under the control of that authority drv krd 1722 cr 21 ci2sar5323h ufouo the kmi shall enable product requester to order and 22 specify the rubac property values for any of the asymmetric products but only those 23 products for which the necessary partition code andor dao code ordering authorization 24 has been granted to the requester by command authority drv krd 0425 0946 0949 25 1034 1720 1722 cr 26 ci2sar5323i ufouo the kmi shall enable product requester to order an 27 asymmetric product for distribution through koa ie list the koa identifier on the 28 account distribution profile of the product ie authorize the koa to distribute the product 29 to user devices drv krd 0949 cr 30 ci2sar5323j ufouo the kmi shall enable product requester to order an 31 asymmetric product for distribution through nonkoa kme that is the requester can list 32 comsec accounts ekms identifier on the account distribution profile of the product 33 drv krd 0949 cr 34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 135ci2sar5323k ufouo the kmi shall permit product requester to order an 1 asymmetric product for koa only if the rubac property values of the product are2 contained in the rubac access set of the koa drv krd 0946 1332 r3 ci2sar5323l ufouo the kmi shall maintain an account distribution profile for 4 each asymmetric product that is ordered by product requester and the profile shall contain5 the following data items drv krd 0910 0911 r6 1 the products rubac property values 7 2 the koa or nonkoa key management entity kme ie comsec account to 8 which the product is distributed with necessary information about the order including 9 the user identity of the product requester who placed the order b distribution 10 requirements such as routing required quantities and need dates and c whether per 11 order approval is required 12 additional data items are defined in volume 1 and still more items are expected to be 13 defined when detailed design is done 14 ci2sar5323m ufouo the kmi shall enable product requester to request that an 15 asymmetric product be distributed through koa regardless of whether the requester and 16 the koa belong to the same enrollment domain or not drv krd 0949 r 17 ufouo command authority may require perorder approval before distribution ie18 require separate predistribution authorization action for each individual order of product19 either for all orders for that product or for orders for that product that are received from selected20 product requesters21 ci2sar5323c ufouo the kmi shall notify command authority when an order 22 for an asymmetric product requires approval by that authority drv krd 1483 1776 r 23 ci2sar5323d ufouo the kmi shall enable command authority to approve or 24 disapprove an order for an asymmetric product containing partition codes and dao codes 25 that the authority controls drv krd 1483 1563 1776 r 26 ci2sar5323e ufouo the kmi shall not generate and distribute an asymmetric 27 product based on an order that requires approval until the kmi has received an authenticated 28 approval from the appropriate command authority drv krd 1484 1561 1563 1564 29 1777 r 30 ci2sar5323f ufouo the kmi shall record for audit any product order approval 31 given by command authority drv krd 1564 r 32 533 u kmi operating accounts33 ufouo koa is kmis logical construct for managing the distribution of products and34 providing related services to set of registered user devices typically set being used by unit35 of dod service or agency each koa has one or more koa managers that are able to request36 the distribution of products to the devices held in the koa37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 136ufouo in the ci2 timeframe some products that are ordered through prsn omes will be1 distributed to user devices through prsn pdes and some will be distributed through legacy2 ekms mechanisms or physical means in all cases however the distribution must be associated3 with comsec account therefore each koa will be associated with specific comsec4 account in the ci2 timeframe5 5331 u koa registration and associated data6 ufouo each koa is established by registration process that records administrative data7 for the account8 definition ufouo koa registration data the set of data values that is maintained 9 by the kmi for managing koa 10 ufouo the kmi retains part of the data on longterm basis for compromise recovery and11 uses other parts on daytoday basis for performing ordering and distribution functions12 ci2sar5331a ufouo the kmi shall enable koa registration manager to 13 establish new koas drv krd 0949 r 14 ci2sar5331b ufouo the kmi shall when establishing new koa place the 15 koa in either 1 the enrollment domain of the koa registration manager that establishes 16 the account or 2 an existing enrollment domain that is subordinate to that managers 17 domain drv krd 0949 r 18 ci2sar5331c ufouo the kmi shall require koa registration manager when 19 establishing koa to associate the koa in onetoone relationship with an existing 20 comsec account and shall present to the manager list of the ekms identifiers of 21 comsec accounts that are available for selection krd new r 22 ci2sar5331d ufouo the kmi shall enable koa registration manager to record 23 koa registration data when establishing and operating koa including the following 24 subsets drv krd 0949 r 25 1 core data 26 2 rubac access set 27 3 data about the koa managers that are assigned to the account 28 4 data about the user devices that are assigned to the account 29 5 data about device distribution profiles of products that have been ordered for the 30 account 31 additional data items are expected to be defined when detailed design is done 32 ufouo comsec account is type of key management entity kme and each kme is33 listed in the ekms directory because koas have onetoone relationship with comsec34 accounts the set of data items that comprise the koa registration data is expected to overlap35 with the set of the data items that comprise the ekms common account data36 ci2sar5331e ufouo the kmi shall enable koa registration manager to record 37 koa core data when establishing koa drv krd 0949 r 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 137definition ufouo koa core data subset of the koa registration data that 1 distinguishes koa from all other koas and relates it to nonkmi systems and2 organizations3 ufouo koa core data items are intended to have values that remain essentially constant4 over the life of the koa5 ci2sar5331f ufouo the koa core data shall include at least the following 6 drv krd 0949 r7 1 the ekms identifier of the associated comsec account8 2 the assigned koa identifier9 3 identification and contact information for the organizational authority that sponsors 10 the koas registration ie unit of dod service or agency or of some other 11 department of the us government 12 additional data items are expected to be defined when detailed design is done 13 definition ufouo koa identifier name that can be unambiguously represented 14 by printable nonblank character string 15 ufouo each kme has an ekms identifier in support of the intended transition from16 ekms to kmi each koa identifier is expected to be algorithmically derivable from the ekms17 identifier of the koas associated comsec account and vice versa18 ci2sar5331g ufouo the kmi shall require koa registration manager when 19 establishing koa to assign to that koa permanent kmiunique koa identifier drv 20 krd 0949 r 21 ufouo each koa has rubac access set that contains values for the same set of rubac22 attributes that are defined for managers see rubac attributes for managers section just as23 managers access set limits the managers access to system objects in general koas access24 set limits the products that can be distributed to the account25 ci2sar5331h ufouo the kmi shall enable koa registration manager when 26 establishing koa to assign to the new account rubac access set that contains only 27 values that are also contained in the managers rubac conferral set krd new r 28 ci2sar5331i ufouo the kmi shall enable koa registration manager to either 29 add or delete rubac attribute value in the rubac access set of koa only if both of 30 the following conditions hold krd new r 31 1 the value is contained in the rubac conferral set of the koa registration manager 32 that is making the change 33 2 the koa being changed is contained in either the enrollment domain of the 34 koa registration manager or b an enrollment domain that is subordinate to that 35 managers domain 36 ci2sar5331j ufouo if koa registration manager deletes rubac attribute 37 value in the rubac access set of koa then for every product that has the counterpart 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 138value in its rubac property set and b has the koa on its account distribution profile the1 kmi shall do all of the following krd new r2 1 delete the koa from that products account distribution profile 3 2 delete that products device distribution profile from the koa if such profile 4 exists 5 3 provide appropriate notice of the deletion actions to the koa manager the products 6 controlling authority and every product requester that ordered the product for the 7 koa 8 ci2sar5331k ufouo the kmi shall record for audit 1 the assignment of 9 rubac access set to koa and 2 any change in koas rubac access set drv 10 krd 1564 r 11 ci2sar5331l ufouo the kmi shall enable koa registration manager to 12 terminate an existing koa only if both of the following conditions hold krd new r 13 1 the rubac access set of the koa being terminated is contained in the conferral 14 set of the koa registration manager 15 2 the koa being terminated is contained in either the enrollment domain of the 16 koa registration manager or b an enrollment domain that is subordinate to that 17 managers domain 18 5332 u koa managers19 ufouo koa manager performs two primary functions 1 associating ecus with a20 koa and 2 determining which ecus within koa should receive each specific product that21 has been ordered for the koa koa manager also performs secondary functions that are22 described and specified in following subsections23 ufouo each koa can have one or more associated koa managers of whom one is the24 primary koa manager koa also may have one or more associated koa agents as25 described in the koa agent section below the work of managing koa can be divided26 among its koa managers the kmi permits only the primary koa manager and cognizant27 koa registration managers to assign other koa managers to the account but any other28 division of labor among an accounts koa managers is defined by local operating procedures29 and is not specified here30 ci2sar5332a ufouo the kmi shall enable each koa to have one or more koa 31 managers be assigned to the account of which exactly one at time is designated as the 32 primary koa manager krd 0951 cr 33 ci2sar5332b ufouo the kmi shall require that when koa registration 34 manager establishes koa that manager must assign to the account koa manager that is 35 designated as the accounts primary koa manager krd 0951 cr 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 139ci2sar5332c ufouo the kmi shall enable each of the following managers to 1 assign one or more additional koa managers to koa to assist the primary koa manager2 krd 0951 cr3 1 the koa registration manager that established the koa 4 2 koa registration manager in either the same enrollment domain as the koa 5 registration manager that established the koa or b domain that is superior to that of 6 the establishing manager 7 3 the koas primary koa manager 8 ci2sar5332d ufouo the kmi shall enable koa manager to be assigned to 9 koa only if the manager belongs to the same enrollment domain as does the koa drv 10 krd 0951 cntr 11 ci2sar5332e ufouo the kmi shall permit koa manager to be assigned to 12 koa only if the rubac access set of the koa is contained in the rubac access set of 13 the manager drv krd 0425 0951 1034 cr 14 ci2sar5332f ufouo the kmi shall ensure that the user identity of koa 15 manager assigned to koa belongs to different human user than any other koa 16 manager assigned to that koa drv krd 0951 cr 17 ci2sar5332g ufouo the kmi shall permit an enrolled koa manager to have 18 current status of being assigned to just one koa to two or more koas or to none krd 19 1196 r 20 ufouo koas primary koa manager can be replaced but the position cannot be left21 vacant koas other koa managers can simply be removed koa is not required to have22 any koa managers in addition to the primary23 ci2sar5332h ufouo the kmi shall enable each of the following managers to 24 replace koas primary koa manager with another koa manager krd 0951 r 25 1 the koa registration manager that established the koa 26 2 koa registration manager in either the same enrollment domain as the koa 27 registration manager that established the account or 2 domain that is superior that of 28 the establishing manager 29 ci2sar5332i ufouo the kmi shall enable each of the following managers to view 30 koas list of currently assigned koa managers and remove any that are not the primary 31 krd 0951 cr 32 1 the koas primary koa manager 33 2 the koa registration manager that established the koa 34 3 koa registration manager in either the same enrollment domain as the koa 35 registration manager that established the account or 2 domain that is superior to that 36 of the establishing manager 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1405333 u koa device assignment1 ufouo koas managers maintain list of devices that are administratively assigned to2 the account maintaining the list involves the following step as illustrated by figures 3 6 and 38 3 request to associate device with account koa manager working at client node 4 connects to prsn ome and requests that device be assigned to specific koa5 ufouo as described in the user devices section of volume 2 the kmi supports three6 types of user devices as kmi registered users end cryptographic unit ecu fill device and7 advanced key processor akp ecus and akps can be registered as general devices ie user8 devices for which the registration has significance across the entire kmi and for which product9 can be generated and wrapped by psn for distribution to that specific device in ci2 fill10 devices can be registered only as limited devices ie devices for which the registration has11 significance at only one management client node at which products can be wrapped by an akp12 for distribution to that specific device some ecus can be registered only as limited device13 also an ecu that is registered as general device can be treated like limited device by the14 koa to which the device is assigned15 ufouo figure 3 9 illustrates the registration process for general devices and compares it to 16 that for human users as described in the client support for registered users section of17 volume 2 device that is registered as general device may also be constructed registered and18 installed so that it is pdeenabled ie able to connect as client node to prsn pde to19 obtain kmi products and services pdeenabled general device needs to be registered with20 associated authentication material in addition to its key wrapping material and depending on21 the authentication technology being used the device may be issued credential thus the22 registration process for pdeenabled general devices is similar to that for human users23 figure 39 u kmi registration of general devices at prsn 24 25 unclassifiedfouo 26 ufouo registration as limited device is described and specified in the local device27 registration management section of volume 1 the registration process for limited device is28 similar to that shown in figure 3 9 however the registered identity is unique only within the 29 user identifier device registration mgr sets attributes registration manager verifies identity and eligibility establish kmiunique identity user device is registered by device registration manager human user wrapping material is provided registered general device device ready to receive products from system registered human user person is ready to access system as user the type of authentication information is suited to the users intended role credential is issued for some types human human is registered by personnel registration manager establish kmiunique identity associate wrapping material assign rubac attributes device intended to be pdeenabled is associated with authentication material each person is associated with some type of authentication material assign kmiunique identifier associate authentication material associate authentication material assign kmiunique identifier associate credential and token user device ecu or akp kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 141scope of the client node that supports the device and the device does not need authentication1 material for logging in at prsn2 ufouo as illustrated by figure 3 9 the registration process for devices also has steps that are 3 not needed for humans4 assign rubac attributes each device is assigned device registration rubac set that5 controls the distribution of products to the device6 associate wrapping material each device is associated with cryptographic material that can7 be used to wrap products that are distributed to the device8 ecus that are overthenetworkkeyable or benign techniquescapable have firefly 9 credentials 10 ecus and fill devices that accept black fill have keyencryption keys keks 11 akps have firefly credentials 12 ufouo although figure 3 9 shows associate wrapping material as the last step of the 13 registration process for devices the figure is only notional wrapping material could be loaded14 before registration or at any point during or after the process depending on the procedures15 required for manufacture initialization and registration of specific type of device16 ufouo general devices are normally expected to be registered at key loading and17 initialization facility klif when any user is registered the user registration manager records18 items of user registration data including user core data and identifier registration data as19 described and specified in the user identity registration and identification service section of20 volume 2 among those items is at least one user identifier when the user being registered is a21 device the user registration manager is device registration manager and that manager22 records additional data items that are specific to devices23 ci2sar5333a ufouo the kmi shall enable device registration manager to 24 record the following additional items of user registration data in addition to those specified 25 in the security policy kmi2200v2 when registering user device drv krd 0949 26 1332 1965 cr 27 1 as part of the user core data for the device 28 the devices globally unique device serial number kmi3001 29 2 as part of the identity registration data for the device 30 the devices device registration rubac set 31 identification of key material to be used for wrapping products for distribution to that 32 device see volume 1 for other requirements regarding wrapping material 33 additional data items are expected to be defined when detailed design is done 34 definition ufouo device serial number centrally registered electronically 35 processed identifier that is assigned to kmi user device or other information assurance 36 device for the purpose of remote management and is unique across all nsa equipment 37 programs 38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 142definition ufouo device registration rubac set set of rubac attribute 1 values that is 1 contained in the set of all kmi rubac attribute values 2 is associated2 with user device identity and 3 controls the distribution of products to the device in any3 koa to which the device is assigned4 ufouo concurrent with registration at klif device is normally expected to be assigned5 to an initial koa6 ci2sar5333b ufouo the kmi shall require each newly registered general device 7 to be assigned to an initial koa when the device is registered in the kmi drv krd8 0949 cr9 ufouo this security architecture does not specify requirements to differentiate koas 10 according to specialized functions but the initial koa might be called factory koa or11 depot koa in small klif the same person might act as both 1 the device registration12 manager and 2 koa manager of the depot koa13 ci2sar5333c ufouo the kmi shall enable koa manager that is currently 14 assigned to koa to assign registered user device specified by user identifier device 15 serial number or some other kmiunique identifier to that koa drv krd 0949 cr 16 ufouo for each device the kmi recognizes exactly one koa at time as being in charge17 of the device that koa needs to give permission before another koa may distribute products to18 the device or receive products for it19 ci2sar5333d ufouo the kmi shall ensure that each general device is assigned to 20 at most one koa at time drv krd 0949 cr 21 ufouo device is expected to be held in depot koa until it is transferred to working22 koa that fields the device and loads it with operational keying material23 ci2sar5333e ufouo the kmi shall enable koa manager to request that 24 general device specified by its kmiunique user identifier that is currently assigned to 25 koa of that manager the old account be transferred to another koa the new account 26 specified by that manager ie be deassigned from the old account and reassigned to the new 27 account drv krd 0949 cr 28 ufouo the koa manager that requests koatokoa transfer for device may be a29 manager only for the old account or also for the new account but cannot be manager only for30 the new account31 ci2sar5333f ufouo when the kmi receives request to transfer general device 32 from one koa to another the kmi shall notify one or more koa managers that currently 33 are assigned to the intended destination koa and request consent for the transfer drv 34 krd 0949 r 35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 143ci2sar5333g ufouo the kmi shall not carry out koatokoa transfer of 1 general device until at least one of the currently assigned koa managers of the destination2 account has consented to the transfer drv krd 0949 r3 ci2sar5333h ufouo when the koa transfers general device from one koa to 4 another koa the kmi shall terminate distribution of products to the device from the first5 koa ie shall remove the device from all of the first koas device distribution profiles6 on which the device is listed drv krd 0425 1034 r7 ci2sar5333i ufouo the kmi shall record for audit the transfer of general 8 device from one koa to another koa drv krd 0990 cr9 ufouo when device that is assigned to working koa is longer needed it might be10 transferred back to its initial depot koa or to some other depot koa then it might be11 transferred to another working koa that needs it finally if device is decommissioned12 destroyed lost or otherwise longer usable by working koa it might be transferred to a13 disposal koa14 ci2sar5333j ufouo the kmi shall permit general device to be held by koa 15 only if the devices device registration rubac set is contained in the koas rubac 16 access set drv krd 0424 1332 cr 17 ci2sar5333k ufouo the kmi shall record for audit any request by koa 18 manager to assign user device to koa when the devices device registration rubac 19 set is not contained within the koas rubac access set drv krd 1564 cr 20 ci2sar5333l ufouo when koa manager assigns general device to koa or 21 consents to the transfer of general device to koa from another koa the kmi shall 22 record the following items of device data which are in addition to those specified in the 23 security policy and related requirements kmi2200v2 drv krd 1332 cr 24 1 the koa identifier of the koa to which the device is newly assigned or transferred 25 2 device convenience label for the device 26 3 an optional device account rubac set for the device 27 additional data items are expected to be defined when detailed design is done 28 ufouo when user device is assigned to its initial koa or transferred to another koa that29 koa becomes the user device sponsor that is discussed in the registration of singular30 identities section of volume 231 definition ufouo device convenience label nonblank printable text string that 32 is assigned to user device is unique among the user devices in the koa to which the 33 device is currently assigned and can be used by the koa managers to assist in identifying 34 and managing the device 35 definition ufouo device account rubac set set of rubac attribute values 36 that is 1 contained in the set of all kmi rubac attribute values 2 is associated with 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 144user device identity in the context of the koa to which the device is currently assigned and1 3 controls the distribution of products to the device within that koa2 ufouo the constraints imposed by devices device registration rubac set cannot be3 relaxed by the koa managers of koa to which the device is assigned but those managers4 can by assigning device account rubac set to the device impose additional constraints in5 order to assist in managing the device within that account6 ci2sar5333m ufouo the kmi shall ensure that device convenience label 7 proposed by koa manager for user device in koa is nonblank printable text string8 that is unique among the user devices currently assigned to that koa before permitting the9 label to be associated with that user device drv krd 0949 cr 10 ci2 sar5333n ufouo the kmi shall enable an koa manager to obtain sorted 11 list of user devices including associated data items that are currently held by koa to 12 which that manager is currently assigned drv krd 0949 cr 13 5334 u koa local product distribution14 ufouo after product requester has ordered product for one or more koas the koa15 managers of those koas can direct distribution of the product to devices owned by their16 accounts this involves the following step as illustrated by figures 3 6 and 38 17 request to distribute product to device koa manager of specific koa requests that 18 product which has been ordered for that account by controlling authority or product 19 requester be distributed to one or more devices in the account 20 ufouo this step causes device distribution profile to be established for the product21 associated with that koa22 ci2sar5334a ufouo for each koa the kmi shall establish and maintain 23 separate device distribution profile for each product for which koa manager requests 24 distribution to user device in the account drv krd 0424 cr 25 ci2sar5334b ufouo device distribution profile for product shall contain the 26 following data items drv krd 0425 cr 27 1 the products short title or some other kmiunique identifier for the product 28 2 list of the user devices designated by kmiunique device identifiers kmi3001 29 for which distribution orders are active for that product with necessary information about 30 each order such as distribution routing and other items 31 additional data items are expected to be defined when detailed design is done 32 ci2sar5334c ufouo for each koa the kmi shall enable each koa manager of 33 the koa to request distribution of any of the products but only those products for which 34 authorization has been granted to the koa by controlling authority or product requester 35 ie products for which the koa is listed on the products account distribution profile 36 drv krd 0425 0946 0949 1034 1720 1722 cr 37kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 145ci2sar5334d ufouo for each koa the kmi shall enable each koa manager of 1 the koa to request distribution of product to an individual user device ie to place the2 user device on that koas device distribution profile for that product drv krd 04253 cr4 ci2sar5334e ufouo for each koa the kmi shall enable each koa manager of 5 the koa to terminate distribution of product to an individual user device ie remove a6 user device from that koas device distribution profile for that product drv krd7 0425 1034 r8 ci2sar5334f ufouo the kmi shall record as mandatory audit event any 9 request by koa manager to place user device on device distribution profile or to 10 remove one from profile drv krd 0990 cr 11 ufouo each product has rubac property values and can be distributed only to devices that12 have compatible rubac attribute values13 ci2sar5334g ufouo the kmi shall enable koa manager to request the 14 distribution of product to user device only if the products rubac property values are 15 contained in both 1 the counterpart values of that devices device registration rubac set 16 and 2 the counterpart values of that devices device account rubac set drv krd 17 0424 0612 1332 cr 18 5335 u koa agents designation and removal19 ufouo when products being distributed by koa have been generated and wrapped for20 distribution they are placed in pdes human users that have been enrolled as koa agents for21 that koa access the pdes as illustrated in figure 40 to retrieve the products for use in 22 cryptographic devices that are assigned to the koa23 figure 40 u kmi product distribution via koa agents 24 25 unclassifiedfouo 26prsn common services enclave controlling authority or product requester order product for koakoa managers of the koa distribute product to selected deviceskoa agents for the koa retrieve product from prsn pdeskoa managers of the koa may also act as its koa agentsclient node for koa agent for koa managerclient node for external managerproduct delivery enclaves pdesordering and management enclaves omes client node for koa agentkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 146definition ufouo koa agent user identity of human user that is designated 1 by koa to access prsn pdes for the purpose of retrieving wrapped products that have2 been requested for user devices that are assigned to that koa3 ci2sar5335a ufouo prsn common services shall receive products items from 4 psns and place them into pdes to be retrieved by koa agents in accordance with the5 distribution directions and designations of controlling authorities product requesters and6 koa managers drv krd 0949 pr7 ufouo general device that is pdeenabled can access prsn pde to receive products8 that have been wrapped by psn according to the directions of the koa managers of the koa9 to which the device is assigned however if general device is not pdeenabled then some10 human user who is designated as koa agent for that account needs to retrieve the products11 from pde so that they can be delivered to the device12 ufouo the koa agent role is not management role it is only designation for a13 registered identity of human user that has been associated with one or more koas the process14 by which person becomes koa agent has two stages15 ufouo stage 1 registration as human user an identity is registered for the user as 16 illustrated in figure 3 9 see user registration and identification service of volume 2 17 human identity is registered by personnel registration manager but the registration 18 process is expected to differ depending on whether the identity is intended to be enrolled as 19 manager or only designated as koa agent the registration manager is likely to be 20 associated with an enrollment manager in the first case and with koa manager in the 21 second case also the rigor with which the users identity and eligibility are verified is 22 expected to vary between the two cases as is the amount and type of registration data that is 23 gathered by the system if an identity is first registered to become manager then 24 additional registration processing should be needed before also designating that identity as 25 koa agent but if human identity is first registered to become koa agent than it is 26 expected that additional processing will be needed to upgrade the registration before 27 enrolling the identity as manager including upgrading the identitys associated 28 authentication material 29 ufouo stage 2 designation as koa agent koa manager designates the 30 registered human identity as koa agent for specific koa 31 ufouo human user identity might have more than one kmiunique user identifier see32 user identifier registration section of volume 2 to make the koa managers job easier33 the kmi permits the manager to use any of those identifiers for designating or removing the34 identity as koa agent the kmi also automatically designates the identities of koa35 managers to be koa agents for their own koas and permits an identity to be designated as a36 koa agent for more than one koa37 ci2sar5335b ufouo the kmi shall enable each koa manager of koa to 38 designate the user identities of one or more human users to be koa agents to retrieve 39 products from pdes on behalf of that koa drv krd 0949 r 40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 147ci2sar5335c ufouo the kmi shall enable each koa manager of koa to 1 remove the koa agent designation from one or more koa agents in that koa drv2 krd 0949 r3 ci2sar5335d ufouo the kmi shall enable koa manager of koa to 4 designate or remove user identity of human user as koa agent by entering or5 selecting any one of the kmiunique user identifiers of that user identity drv krd6 0949 r7 ci2sar5335e ufouo user identity of human user shall be permitted to be 8 designated as koa agent by one or more koas drv krd 0949 r9 ci2sar5335f ufouo the kmi shall automatically designate the user identities of 10 the koa managers of koa to be koa agents for that koa drv krd 0949 r 11 ci2sar5335g ufouo the kmi shall record as mandatory audit event any 12 request by koa manager to designate user identity as koa agent or to remove that 13 designation from user identity drv krd 0071 0876 0990 r 14 ufouo kmi customer organizations might want to establish process for vetting and15 preapproving koa agents before assigning them to koas in the same way that koa16 managers are enrolled by enrollment managers before being assigned to koas but this security 17 architecture does not specify system functions to implement or support such process 18 5336 u koa agents login at pde19 ufouo the designation of human user identity as koa agent for some koa results in20 that identity being placed on the kmiwide list of all koa agents 21 definition ufouo koa agents list the list of all the registered user identities 22 that are currently designated as koa agents 23 ufouo this requirements specification kmi2200 does not specify how to implement the 24 koa agents list but any implementation approach will necessarily involve replicating the list25 data between independent components of the system for example an obvious choice of a26 component in which to maintain the list is the prsn common private zone however the27 requirements stated in the prsn service redundancy and data replication section imply that28 data from the list must be replicated between prsns and the requirement to check the list for29 each pde login implies that data from the list must be replicated from common services to all30 pdes within prsn31 ci2sar5336a ufouo the kmi shall maintain koa agents list consisting of all 32 user identities that are currently designated as koa agent by one or more koas drv 33 krd 0949 r 34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 148ci2sar5336b ufouo the kmi shall permit user identity to log in at pde as 1 koa agent only if that user identity is currently listed on the koa agents list drv2 krd 0949 r3 ufouo to make the koa agents job easier the kmi permits koa agent to use any of4 its user identifiers to log in at pde as long as the identifier has authentication material for the5 authentication method used by the pde each pde uses only one authentication method for6 koa agents and each kmiunique user identifier is associated with only one type of7 authentication method ie may have only one type of authentication material however not all8 identifiers of an identity need be authenticated with the same method so that koa agent that9 has two identifiers each with different type of authentication material might be able to access10 two different types of pdes11 ci2sar5336c ufouo the kmi shall enable user identity to use each of its user 12 identifiers to log in as koa agent at any pde for which the identifier has valid 13 authentication material of the type required by the pde drv krd 0949 r 14 ufouo this requirements specification kmi2200 does not specify how to implement the 15 login process for koa agents but any implementation approach would involve replicating data16 between independent components of the system the requirements stated in the prsn service17 redundancy and data replication section imply that data must be replicated between prsns18 and the data must be replicated from common services to the pdes within prsn to avoid19 having each login request result in passing both 1 verification request from pde to20 common services through pde guard and 2 response in the opposite direction it would be21 desirable for common services to prestock each pde with all data needed to authenticate the22 identities of any koa agents that are eligible to access that pde each pde needs the kmi23 unique user identifiers for those eligible agents and any associated data to operate the pdes24 authentication mechanism eg password files and trust anchors to validate credentials25 5337 u koa agents retrieval of products26 ufouo the designation of user identity as koa agent for koa also results in that27 identity being added to an access control list for that specific koa28 definition ufouo koa access control list an approvalbased access control 29 list for specific koa that names the user identities that are permitted to access pdes to 30 obtain products that are distributed by that koa 31 ufouo that is besides the consolidated koa agents list which lists all current koa32 agents for all koas the kmi maintains set of koaspecific lists that each name the koa33 agents for single koa as illustrated in figure 4 1 the combination of these lists is logically 34 equivalent to an access control matrix with m rows that each represent koa and n columns35 that each represent user identity36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 149figure 41 u kmi access control for koa agents 1 2 unclassifiedfouo 3 ci2sar5337a ufouo the kmi shall enable user identity that has successfully 4 logged in to pde as koa agent to retrieve any product that is held by the pde for5 distribution by koa that has that user identity on its koa access control list ie by a6 koa for which that identity is designated koa agent drv krd 0949 r7 ufouo this requirements specification kmi2200 does not specify how to implement the 8 koa access control lists but any implementation approach would involve replicating the list9 data between independent components for example an obvious choice of component to10 maintain the lists is the prsn common private zone however the requirements stated in the11 prsn service redundancy and data replication section imply that data must be replicated12 between prsns and the need to check lists before allowing koa agent to retrieve products13 from pde implies that data must be replicated from the common services enclave to the pdes14 within prsn15 54 u alternative mechanisms for access controls16 ufouo some basic types of mechanisms for implementing access control in an automated17 information system are access control lists capability lists and access control matrices18 definition ufouo access control list mechanism that implements access 19 control for system resource by enumerating the system entities that are permitted to 20 access the resource and either implicitly or explicitly the access modes granted to each 21 entity 22 definition ufouo capability list mechanism that implements access control for 23 system entity by enumerating the system resources that the entity is permitted to access 24 and either implicitly or explicitly the access modes granted for each resource 25 definition ufouo access control matrix rectangular array of cells with one row 26 per subject and one column per object the entry in cell indicates the mode of access that 27koa agents listuser identity 2user identity 1user identity n koa acl for koa 1yesno yesno yesno koa acl for koa myesno yesno yesno koa acl for koa 2yesno yesno yesnokmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 150the subject is permitted to exercise on the object each column is equivalent to an access1 control list and each row to capability list2 ufouo if only these three types of mechanisms were used to implement kmi rolebased3 rulebased and approvalbased access control then several different lists or matrices would need4 to be made available to many different kmi components and probably would prove difficult and5 expensive to maintain distribute and protect replacing such lists and matrices at least in part6 by mechanism involving capability tokens could reduce the complexity of maintaining7 distributing and protecting access control data8 definition ufouo capability token token usually an unforgeable data object 9 that gives the bearer or holder the right to access system resource possession of the token 10 is accepted by system as proof that the holder has been authorized to access the resource 11 that is named or indicated by the token 12 ufouo attribute certificates which are specified in x509 are one possible form that could13 be used for capability tokens14 definition ufouo attribute certificate digital certificate that binds set of 15 descriptive data items other than public keysuch as authorizations for an access control 16 processeither directly to subject name or to the identifier of another certificate that is 17 publickey certificate 18 19kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1516 u distributed multidomain subsystems1 ufouo some systemwide security functions such as the audit service and aswr need to2 be implemented as internodal subsystems that is such functions are expected to be3 implemented by set of components that are parts of different nodes but also cooperate as parts4 of the same subsystem5 definition ufouo subsystem collection of related components that together 6 perform or deliver particular kmi function or service kmi20207 ufouo however the multiple domains enclaves and zones that are specified for prsns in8 this security architecture cause complications for implementing data flows between subsystem 9 components as an example this section presents model for data flows in an intrusion10 detection system ids that provides part of the aswr service that is specified in volume 211 the data flows needed for other types of kmiwide services would be similar12 ufouo the subsystem model presented here assumes that ids functions need to be13 distributed across prsns and across the enclaves within prsns as illustrated in figure 4 2 14 figure 42 is intended only to illustrate the concepts discussed in this section and is not intended 15 to correspond exactly with the prsn components shown in figures in other sections such as16 figures 17 and 18 17 figure 42 u kmi multidomain subsystem 18 19 unclassifiedfouo 20 ufouo the following requirements are basic for any such distributed subsystem of the21 kmi22enclave masterbackup masterbackup master ids agentsids agents paths and f event datapaths b and g event datapaths d and h event datapaths and j control datapaths c and k control data masters in other enclavesk h c d bj g fussecret domain usunclassified domain prsn uss enclaves in other prsnsusu enclaveusu enclaves in other prsns uss enclave agents in other enclavesa b agents in other enclavesc dmasters in other enclaves inter enclave guard unclass secretenclave mastersystem master domain master prsn masterenclave masterkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 152ci2sar6a ufouo within core node the components of functional subsystem 1 should be integrated across security domains to the extent that is technically possible but2 the components within domain should be able to operate independently of other domains3 krd 1180 1824 prs4 ci2sar6b ufouo within security domain the components of functional 5 subsystem should be integrated across nodes to the extent that is technically possible but6 the subsystems functions within core node should be able to operate independently of7 other nodes krd 1180 1824 prs8 ufouo when data is replicated between domains database synchronization and integrity9 checks are needed for example when user registration data is replicated the kmi needs to10 compare the replicated user core data from one domain to that of another domain and if11 duplicates or discrepancies are detected either update the users data in one of the domains or12 revoke associated identities identifiers and credentials and notify an authorized user13 registration manager and sso according to established procedures14 61 u intrusion detection subsystem15 ufouo as defined in volume 2 aswr has three aspects 1 sensing includes recognizing16 identifying and categorizing attacks and other threat actions 2 warning includes17 communicating to responsible official an alert concerning an attack or other threat action in18 time for the official to make decision and respond with effective counteractions and 319 response includes initiating counteraction to an attack or other threat action the definition of20 aswr could be construed broadly to include many different kmi security functions here21 aswr is limited to services provided by intrusion detection systems other closely related22 security services such as audit are treated separately23 ufouo although all kmi nodes need intrusion detection services this section discusses24 only prsns platforms within prsn comprise computer network there is set of host ie25 end system computers together with an infrastructure subnetwork or internetwork through26 which the hosts can communicate with each other and with nodes in this context an intrusion27 detection system ids or subsystem in this case is an aswr system that supports the defense28 of the components against malicious traffic that originates either externally or internally an ids29 may also have features that actively respond in some way to perceived attacks30 611 u ids types31 u many types of ids products are available but the two basic types are hostbased hids and32 networkbased nids in hids the system componentsthe sensors and analyzersare33 placed on the hosts that they protect in nids the sensors are placed on infrastructure34 components and the analyzers are placed either on subnetwork platforms or separate hosts35 u the two basic ids methods for detecting attacks are signature detection and anomaly36 detection signaturebased ids scans network traffic to detect packets and streams of packets37 that have content matching the patterns of known attacks an ids of this type has library of38 attack patterns and the library needs to be updated whenever new kinds of attacks become39 known usually the ids vendor supplies standard updates and the ids operator can add custom40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 153updates an anomalybased ids monitors network traffic to detect deviations from normal ie1 expected behavior which is defined by profile that has been established in advance profile2 is set of statistical values and relationships concerning packet frequencies types and contents3 in commercial offerings profile may be established automatically by monitoring traffic for4 some period of time or manually by defining rules or both both signature and anomalybased5 idss typically look at all the fields in the ip header and some of the fields in the tcp header6 particularly source port and destination port they may or may not look higher into the7 protocol stack depending on how they are designed and configured and how much processing8 power they have available signaturebased ids does not learn new attack patterns and9 cannot detect any attack that is not in the library an anomalybased ids may be able to detect a10 new attack if the attack creates traffic that deviates sufficiently from the established profile11 612 u ids capabilities in prsns12 ufouo figure 4 2 illustrates that an ids typically consists of number of agents eg 13 sensors some of which are hostbased and some of which are networkbased and one or more14 management stations called masters that monitor and control agents or that monitor and control15 other masters in hierarchical arrangement it is desirable that ids components in ci2 prsns16 provide the following capabilities these capabilities would take ci2 in the direction of the target17 system in which it is intended that all event data be sent to the csn to be fused and analyzed18 6121 u capabilities in each enclave of each prsn19 ufouo in figure 4 2 the subsystem of ids components in an unclassified or secret enclave 20 has the following capabilities21 ufouo agent per platform each computer platform in each zonepublic buffer 22 and privateof an enclave has an ids agent that is responsible for detecting attack events 23 that occur on the platform 24 ufouo master for enclave the private zone of the enclave has an master enclave 25 master that 1 is responsible for controlling agents in the enclave path and c and 2 26 receives fuses and analyzes event data sent to it by agents in the enclave path b and d 27 ufouo enclavewide control an authorized manager can use the enclave master to 28 operate the ids subsystem of the enclave independently of the operation of ids components 29 in any other enclave or node this implies that backup service for the master needs to be 30 provided by redundant equipment in the same enclave rather than depending on master in 31 another enclave 32 ufouo enclavewide analysis an authorized manager can use the enclave master to 33 view all detected attacks that are directed against any platforms in the enclave 34 ufouo these capabilities imply that control messages sent by the enclave master in the35 private zone to agents in the buffer zone and public zone and event reporting messages36 received by the master from those agents need to be permitted to pass through bpss that37 separate and protect the zones38kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1546122 u capabilities in each prsn1 ufouo in figure 4 2 the subsystem of ids components in each prsn has the following 2 capabilities3 ufouo master for prsn the enclave master in the unclassified enclave relays event 4 data from that enclave to the enclave master in the secret enclave aka prsn master5 path or else agents in the unclassified enclave send event data directly to the prsn6 master path f alternatively the prsn master might be located in the secret enclave but7 be an additional master separate from the enclave master8 ufouo prsnwide analysis the prsn master receives fuses and analyzes event data 9 sent to it from both the secret and unclassified enclaves an authorized manager can use the 10 prsn master to view all detected attacks that are directed against any platforms in the 11 prsn 12 ufouo these capabilities imply that event reporting messages received by the prsn master13 in the secret enclave from the enclave master or agents in the unclassified enclave need to be14 permitted to pass through an interenclave guard15 6123 u capabilities in each security domain16 ufouo the subsystem of ids components in each security domainunclassified or17 secrethas the following capabilities18 ufouo master for domain one enclave of each domain has master domain 19 master that 1 is responsible for controlling all masters in the domain path j and k and 20 2 receives fuses and analyzes event data from that domain that is sent to it by all enclave 21 masters in that domain path g and h the domain master might be an enclave master or 22 prsn master or it might be an additional master that is separate from those 23 ufouo domainwide control an authorized manager can use the domain master to 24 operate the ids subsystem of the domain independently of the operation of components in 25 the other domain 26 ufouo domainwide analysis an authorized manager can use the domain master to 27 view all detected attacks that are directed against any platforms in any enclaves of the 28 domain 29 ufouo these capabilities imply that control messages sent by the domain master to the30 enclave masters in other enclaves of the domain and event reporting messages received by the31 domain master from those other masters need to be permitted to pass through bpss32 6124 u capabilities in system of prsns33 ufouo the subsystem of ids components in the set of all prsns has the following34 capabilities35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 155 ufouo master for system one enclave of the secret domain has master system 1 master that receives fuses and analyzes event data from both domains that is sent to it by2 the enclave masters in all secret enclaves path g and h the system master might be an3 enclave master prsn master or domain master or it might be an additional master that is4 separate from those5 ufouo systemwide analysis an authorized manager can use the system master to 6 view all detected attacks that are directed against platforms in any prsn in the system7 ufouo these capabilities imply that event reporting messages that are received by the8 system master from enclave masters in the secret domain need to be permitted to pass through9 bpsvpn10 613 u implementation issues11 ufouo the stated capabilities raise the following questions when evaluating cots ids12 components for use in the multidomain architecture of prsns13 ufouo what data needs to pass through multilevel bps ie through an interdomain 14 guard 15 ufouo what data needs to pass through the singlelevel bpss such as the bpsbufs 16 and bpsvpn illustrated in figure 1 7 17 ufouo what protocols are used for those communications 18 19 ufouo this discussion assumes that data may move rather freely through an interenclave20 guard from low to high eg from an unclassified enclave to secret enclave but data that is21 downgraded from high to low needs to be minimized because of the difficulty of assuring that22 such data is properly reclassified23 ufouo in the ids model presented here event data moves from the unclassified domain to24 the secret domain but not in the reverse direction however even when data is sent from the25 unclassified domain to the secret domain there may be problems with how it is moved if an26 application component on platform in private zone sends data through an interenclave guard27 to counterpart component in another private zone the application data might be carried over a28 transport layer protocol that protocol could be either besteffort datagram protocol such as29 user datagram protocol udp or reliable protocol such as tcp udp could easily be30 upgraded through guard but tcps acknowledgement packets could not easily be downgraded31 through guard tcp would need to be proxied and it might be necessary to implement proxies32 for each side of the guard the proxy on the unclassified side would terminate tcp connections33 there and pass the application data through the guard on some oneway protocol to the proxy on34 the secret side to achieve acceptable tcplike reliability from end to end the proxies would35 need to be implemented on the guard platform36 ufouo within each domain event data also needs to pass through bpsbuf from a37 public zone to buffer zone through bpspri from buffer zone to private zone and38 through bpsvpn pair from one enclave to another since downgrading takes place39 passing tcp packets directly through these bpss is less of problem than in bpsieg but40kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 156carefully filtering of the traffic is still needed separate implementation question is whether a1 cots ids supports the relay of event data from one master to another2 ufouo in the ids model presented here control messages do not pass through the inter3 enclave guard at all master in the secret domain that could fully control agents and masters in4 the unclassified domain probably would cause unacceptable volumes of control data to be5 downgraded through guards it might be feasible to downgrade some limited set of control6 commands but this should be analyzed further also it would be easier for master in the7 unclassified domain to send control commands to agents and masters in the secret domain but8 this does not seem to be advantageous if data was sent from the secret domain to the9 unclassified domain the master in the unclassified domain would have to operate blind and10 if the more vulnerable unclassified domain could be compromised the master there might be11 used to disable the ids in the more sensitive secret domain12 ufouo control messages do need to pass through bpsbuf bpspri and bpsvpn13 components again there is the question of how these messages are moved using tcp for14 control messages would not seem to present any greater problem in these cases than using tcp15 for event reporting but carefully filtering of the traffic is still needed16 ufouo there is more basic question of why tcp should be used at all for either event17 reporting or control messages rather than using simple network management protocol snmp18 snmp assumes that monitoring and control capability is needed most when network service is19 least reliable therefore snmp avoids tcp and instead uses udp and applications of snmp20 are designed with the assumption that some packets may be lost ids components might be more21 robust if they were designed the same way22 62 u audit subsystem23 ufouo subsystem to implement the requirements stated in the audit service section of24 volume 2 would be similar to the ids subsystem shown in figure 4 2 however the data flows 25 in figure 4 2 that carry control messagespaths c j and kwould be eliminated to ensure 26 the integrity of the audit process the ability to control mechanisms that generate audit records on27 kmi computer platform needs to be limited to the platforms local audit data manager also28 the audit data that is reported from one component to another needs to receive data integrity29 service of high robustness otherwise the audit subsystem needs capabilities similar to those of30 the ids subsystem31 63 u compromise reports and revocation requests32 ufouo another function that may involve interdomain data flow through guard from the33 unclassified enclave of prsn to the secret enclave is the handling of compromise reports and34 revocation requests prsn needs to enable user at client node to connect to either the35 unclassified or secret enclave of prsn and make the following reports and requests36 regardless of the domain in which the subject item was issued or intended to be used37 ufouo report the compromise loss theft or exposed of key lost stolen or 38 exposed 39kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 157 ufouo report the compromise loss theft or pin exposure of cryptographic1 hardware token2 ufouo request the revocation of credential3 ufouo request the revocation of an identity or identifier ie revocation of all4 certificates associated with that identity or containing that identifier or5 ufouo request the revocation of user ie revocation of all identities by naming6 one regardless of the domain in which the item was issued or intended to be used7 8 ufouo figure 4 3 illustrates that the action taken by the prsn depends on the domain in 9 which the report or request is originated10 figure 43 u kmi handling of compromise reports and revocation requests11 12 unclassifiedfouo 13 ufouo if compromise report or revocation request is received from client node in the14 unclassified domain the private zone of the unclassified enclave takes the following actions15 1 ufouo for each key compromise report pass the report to the unclassified psn or 16 send the report to the secret enclave as appropriate for the key 17 2 for each token compromise report copy the report to secret enclave for information 18 purposes and for action in case the token was issued for use in the secret domain also if the 19 token was issued for the unclassified domain queue one revocation request for each 20 credential on the token 21 inter enclave guard prsn u enclave prsn s enclave s client u clientu psns psn u cas ca1 key compromise report 5 user revocation request 3 credential revocation request4 identity or identifier rev request 2 token compromise report1 key compromise report 5 user revocation request 3 credential revocation request4 identity or identifier rev request 2 token compromise reporteither pass to u psn or copy to s enclave as appropriate for keysecurity officer ie air gap may use u client to file report or request either pass to s psn or notify sso for possible refiling in u domain copy req to s enclave and if cred issued by s ca issue req to s ca copy report to s enclave and if u token queue cred revocation reqsif s token queue cred revocation reqs else notify ssocopy req to s enclave and if u identity queue cred revocation reqs queue s cred revocation reqs and if identity also u notify ssocopy req to s enclave if user has u id queue identity revocation reqsif user has s id queue identity revocation reqs else notify sso if cred issued on u side notify sso for possible refiling in u domainkmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1583 for each credential revocation request copy the request to the secret enclave for1 information purposes also if the credential was issued by an unclassified psn send the2 request to the psn3 4 for each identity revocation request copy the request to secret enclave also queue one4 revocation request for each unclassified credential issued for that identity5 5 for each user revocation request copy request to secret enclave also queue one6 revocation request for each unclassified identity that has been registered for the user7 ufouo if compromise report or revocation request is received from client node in the8 secret domain the private zone of the secret enclave takes the following actions9 1 for each key compromise report pass the report to the secret psn or notify the cognizant 10 sso to refile the report through client node in the unclassified domain ie such reports 11 are not downgraded through an interenclave guard as appropriate for the key 12 2 for each token compromise report if the token was issued in the secret domain queue one 13 revocation request for each credential on the token or else notify the cognizant sso to refile 14 the report through client node in the unclassified domain ie such reports are not 15 downgraded through an interenclave guard 16 3 for each credential revocation request send request to secret psn if credential was issued 17 by secret psn or else notify the cognizant sso to refile the request through client node 18 in the unclassified domain ie such reports are not downgraded through an interenclave 19 guard 20 4 for each identity revocation request queue one revocation request for each secret 21 credential issued for that identity if identity has also been registered in the unclassified 22 domain notify the cognizant sso to refile the request through client node in the 23 unclassified domain ie such reports are not downgraded through an interenclave guard 24 5 for each user revocation request queue one revocation request for each secret identity that 25 has been registered for the user and notify the cognizant sso to refile the request through 26 client node in the unclassified domain ie such reports are not downgraded an inter 27 enclave guard 28 u the stated requirements and capabilities have the following implications29 ufouo the ci2 prsn needs to replicate token content data from the unclassified 30 domain to the secret domain during token and credential issuance processes 31 ufouo some delay is tolerable for processing report or request pertaining to an 32 unclassified item when the report or request is made on the secret side of prsn 33 ufouo additional unstated processing occurs to maintain secret replica of 34 unclassified databases for identity registration token registration outstanding certificates 35 and other configuration information 36kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1597 u glossary of acronyms1 u akp advanced key processor 2 u aswr attack sensing warning and response 3 u bps boundary protection suite 4 u ca x509 certification authority 5 u cceb combined communicationselectronics board referring to australia 6 canada new zealand the united kingdom and the us 7 u ci2 capability increment 2 8 u cnss us committee on national security systems formerly nstissc 9 u cots commercial offtheshelf 10 u crl x509 certificate revocation list 11 u csn central services node 12 u deers us defense enrollment eligibility reporting system 13 u ditscap dod information technology security certification and accreditation 14 process ditscap 15 u dn x500 distinguished name 16 u dod us department of defense 17 u dodd dod directive 18 u dodi dod instruction 19 u drv derived from 20 u ecu end cryyptographic unit 21 u edipi electronic data interchange person identifier 22 u ekms electronic key management system 23 u fnbdt future narrowband data terminal 24 u fouo for official use only 25 u gots government offtheshelf ie developed under government auspices 26 u haipe highassurance internet protocol encryptor 27 u hids hostbased ids 28 u http hypertext transfer protocol 29 u ia information assurance 30 u iatf information assurance technical framework 31 u ids intrusion detection system 32 u ieg interenclave guard 33 u ip internet protocol 34 u it information technology 35 u izg interzone guard 36 u kek keyencryption key 37 u klif key loading and initialization facility 38 u kme key management entity 39 u kmi key management infrastructure 40 u kms key management system 41 u koa kmi operating account 42 u kpc kmi protected channel 43 u krd kmi requirements database 44 u mpmss mission planningmanagementsupport system 45kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 160u nato north atlantic treaty organization 1 u nids networkbased ids 2 u niprnet dod nonclassified internet protocol router network 3 u nsa us national security agency 4 u nstissi us national security telecommunications and information systems 5 security instruction 6 u nt nontechnical see requirement statements section 7 u ocsp online certificate status protocol 8 u ome ordering and management enclave 9 u pde product distribution enclave 10 u pki publickey infrastructure 11 u prsn primary services node 12 u psn product source node 13 u pstn public switched telephone network 14 u rubac rulebased access control 15 u siprnet secret internet protocol router network 16 u ssl secure sockets layer protocol 17 u sso system security officer 18 u tcp transmission control protocol 19 u tls transport layer security protocol 20 u udp user datagram protocol 21 u vpn virtual private network 22 23kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1618 u glossary of terms1 ufouo this glossary lists the terms for which this volume has definition statements2 access control list mechanism that implements access control for system resource by3 enumerating the system entities that are permitted to access the resource and either implicitly or4 explicitly the access modes granted to each entity5 access control matrix rectangular array of cells with one row per subject and one column per6 object the entry in cell indicates the access mode that the subject is permitted to exercise on7 the object each column is equivalent to an access control list and each row to capability list8 account distribution profile an approvalbased access control list for specific product that9 1 names the koas to which prsns distribute the product and 2 states conditions of10 distribution eg requires peredition approval11 administrative manager manager that performs housekeeping functions that support the work12 of operational managers and koa agents but usually do not directly involve kmi products and13 services14 attribute certificate digital certificate that binds set of descriptive data items other than a15 public keysuch as authorizations for an access control processeither directly to subject16 name or to the identifier of another certificate that is publickey certificate17 authorization or privilege right that is granted to user or other system entity to access a18 system resource for specific purpose19 boundary protection suite bps component that 1 is data communication gateway into a20 security enclave or security zone and 2 regulates data communication traffic to and from the21 enclave or zone22 capability list mechanism that implements access control for system entity by23 enumerating the system resources that the entity is permitted to access and either implicitly or24 explicitly the access modes granted for each resource25 capability token token usually an unforgeable data object that gives the bearer or holder the26 right to access system resource possession of the token is accepted by system as proof that27 the holder has been authorized to access the resource that is named or indicated by the token28 client node abbreviated as client set of hardware and software with computing and 29 cryptographic capabilities that enable registered human user or user device to obtain products30 and services31 command authority individual responsible for the appointment of user representatives for a32 department agency or organization and their key ordering privileges cnssi400933kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 162component collection of system resources that form physical or logical part of the kmi1 system that 1 has specified functions and interfaces and 2 is treated by policies or2 requirement statements as existing independently of other parts3 computer platform combination of computer hardware and an operating system consisting of4 software firmware or both for that hardware that supports automated kmi functions5 constraint limitation implemented by rolebased access control on relationship or6 function of user identity role or permission in effect constraint is form of security7 policy8 controlling authority official responsible for directing the operation of cryptonet and for9 managing the operational use and control of keying material assigned to the cryptonet10 cnssi400911 core nodes the set of nodes that includes 1 the csn 2 all psns 3 all prsns and 4 all12 client nodes that serve managers playing internal management roles see management roles13 section14 device account rubac set set of rubac attribute values that is 1 contained in the set of15 all kmi rubac attribute values 2 is associated with user device identity in the context of16 the koa to which the device is currently assigned and 3 controls the distribution of products17 to the device within that koa18 device convenience label nonblank printable text string that is assigned to user device is19 unique among the user devices in the koa to which the device is currently assigned and can be20 used by the koa managers to assist in identifying and managing the device21 device registration rubac set set of rubac attribute values that is 1 contained in the set22 of all kmi rubac attribute values 2 is associated with user device identity and 323 controls the distribution of products to the device in any koa to which the device is assigned24 device serial number centrally registered electronically processed identifier that is assigned25 to kmi user device or other information assurance device for the purpose of remote26 management and is unique across all nsa equipment programs27 enrollment the kmi process that assigns user identity to management role28 enrollment domain set of managers ie set of assignments of user identities to29 management roles that includes 1 one or more enrollment managers and 2 any additional30 managers of other types that have been placed into the domain31 enrollment domain hierarchy subordination relationship among all enrollment domains that32 is onetomany and is transitive that is if enrollment domain is subordinate to domain b33 and b is subordinate to c then is also subordinate to c if is subordinate to b then b is said34 to be superior to a35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 163external management role role that is intended to be performed by manager that typically1 is member of kmi customer organization2 guard bps that 1 connects components that operate in different security domains 2 is3 trusted to prevent unauthorized disclosure of data from one domain to the other if that service is4 required by the respective security levels of the components and 3 is trusted to protect the data5 integrity and system integrity of each domain against threats actions communicated from the6 other7 independent component component that has defined security perimeter at which or within8 which the component is responsible for some set of security services9 internal management role role that is intended to be performed by person who is a10 member of the central organization that controls the kmi11 key management infrastructure all partscomputer hardware firmware software and other12 equipment and its documentation facilities that house the equipment and related functions and13 companion standards policies procedures and doctrinethat form the system that manages and14 supports the ordering and delivery of cryptographic material and related information products15 and services to users16 kmi operating account koa kmi business relationship that is established to manage 117 the set of user devices that are under the control of kmi customer organization and 2 the18 distribution of kmi products to those devices19 koa access control list an approvalbased access control list for specific koa that names20 the user identities that are permitted to access pdes to obtain products that are distributed by21 that koa22 koa agent user identity of human user that is designated by koa to access prsn23 pdes for the purpose of retrieving wrapped products that have been requested for user devices24 that are assigned to that koa25 koa agents list the list of all the registered user identities that are koa agents26 koa core data subset of the koa registration data that distinguishes koa from all other27 koas and relates it to other nonkmi systems and organizations28 koa identifier name that can be unambiguously represented by printable nonblank29 character string30 koa registration data the set of data values that is maintained by the kmi for managing a31 koa32 device distribution profile an approvalbased access control list for specific product that33 1 names the user devices in specific koa to which prsns distribute the product and 234 states conditions of distribution for each device35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 164management role role that has permissions that enable registered user to direct control1 or regulate some set of system resources2 manager registered user that directs controls or regulates some set of system resources3 node collection of related components that is 1 located on one or more computer platforms4 at single site5 operational manager manager that performs functions directly involving the production of6 products and services or that supervises such functions7 peer system an information system other than the ekms that is external to the kmi and with8 which the kmi exchanges products and services that are needed to support kmi operations9 permission an positivelystated authorization for access that 1 can be associated with one or10 more roles and 2 enables user in role to access specified set of system resources by11 causing specific set of system actions to be performed on the resources12 principal specific user identity that is asserted and activated by registered user when13 accessing the system14 principle of least privilege the practice of granting to each system entity the minimum15 authorizations that the entity needs to do its legitimate work16 principle of positive authorization the practice of granting access to system resources only in17 positive way18 principle of separation of duties the practice of dividing the functions of system process19 among different system entities to prevent single entity from subverting the process the20 role separation constraints section specifies general capability for separating roles and the21 specifically separated roles section identifies some required separations22 product manager either controlling authority or command authority23 resource object specific system resource that 1 can be accessed by system action and24 2 can be protected by access control services25 role job title in the kmi system that 1 has specified set of functional responsibilities26 within the system 2 can be granted one or more permissions and 3 can be assigned to one or27 more users28 role hierarchy subordination relationship among roles where b means that role 29 is subordinate to role b the relationship is manytomany and is partial ordering of the set30 of all roles that is for any three roles b and c the following are always true 1 2 31 if ab and bc then c and 3 if b and ba then and b must be the same role 32 rubac access set set of rubac attribute values that is 1 contained in the set of all kmi33 rubac attribute values 2 is associated with manager and 3 determines the limits of the34 managers permissions when accessing resource objects35kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 165rubac attribute characteristic of system entity where the value of the characteristic is1 used in making access control decisions that enforce data confidentiality2 rubac conferral set set of rubac attribute values that is 1 contained in the set of all3 kmi rubac attribute values 2 is associated with an enrollment manager device4 registration manager or koa registration manager and 3 constrains the attribute values that5 the manager can assign6 rubac property characteristic of system resource object where the value of the7 characteristic is used to make access control decisions that enforce data confidentiality8 security domain set of kmi system entities that operate under common security policy9 including operating at the same security level10 security enclave set of components that operate in the same security domain and share the11 protection of common continuous security perimeter12 security zone logically contiguous subdivision of security enclave that is each13 component in security enclave is contained in one of the enclaves security zones each zone14 has welldefined security perimeter part of which may be formed by the perimeter of the15 enclave16 session temporary mapping of principal to role or roles especially when client node17 accesses prsn18 short title an identifying combination of letters and numbers assigned to certain comsec19 materials to facilitate handling accounting and controlling cnssi400920 site facilityie physical space room or building together with its physical personnel21 administrative and other safeguardsin which 1 kmi functions are performed and 2 kmi22 components might be housed23 subsystem collection of related components that together perform or deliver particular kmi24 function or service kmi202025 system action specific function or behavior of the kmi that accesses and possibly affects one26 or more resource objects27 system entity an active elementie either 1 person or 2 set of persons or 3 an28 automated device or 4 set of devicesthat is part of either the kmi or the kmis environment29 and that incorporates some specific set of capabilities30 system resource information held in the system or service or product provided by the31 system or system capability eg processing power or communication bandwidth or an item32 of equipment ie hardware firmware software or documentation or facility that houses33 those things34kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 166toplevel enrollment manager kmi job position held by human user who has user1 identity that is initialized in the role of enrollment manager as part of the kmi startup process2 and is then able to enroll other user identities in management roles an enrollment manager3 also has rubac management responsibilities as described in the rulebased access control4 section5 type 1 cryptographic device classified or controlled cryptographic item endorsed by the nsa6 for securing classified and sensitive us government information when appropriately keyed7 the term refers only to cryptographic devices and not to information key services or8 controls type 1 cryptographic devices contain classified nsa algorithms they are available9 to us government users their contractors and federally sponsored nonus government10 activities subject to export restrictions in accordance with international traffic in arms11 regulation cnssi400912 13kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 1679 u glossary of terms1 u ansi american national standards institute role based access control 2 secretariat information technology industry council bsr incits 359 3 draft 10 nov 2003 4 u cnssi4009 committee on national security systems national information system 5 security infosec glossary cnss instruction 4009 may 2003 6 u cnssi40xx _____ safeguarding comsec material in electronic form draft7 cnss instruction 40xx rev 52 3 jul 2003 or as updated if there is 8 later version 9 u ditscap dod instruction 520040 dod information technology security10 certification and accreditation process ditscap 30 december 1997 11 u dodx509cp asd c3i x509 certificate policy for the us department of defense12 version 52 13 nov 2000 13 u dodd520028 dod directive 520028 security requirements for automated14 information systems aiss 21 march 1988 15 u dodd85001 dod directive 85001 information assurance 24 october 200216 u dodi85002 dod instruction 85002 information assurance ia implementation 617 feb 2003 18 u ekms103 national security agency security policy for the electronic key 19 management system ekms 103a 22 jan 1997 20 u ekms202 _____ electronic key management system security requirements 21 ekms 202b 16 sep 1998 22 u ferraiolo david f ferraiolo d richard kuhn and ramaswamy chandramouli23 rolebased access control artech house norwood massachusetts 24 2003 isbn 1580533701 25 u fnbdt interoperability specification for future narrowband data terminal is 26 tbd 27 u gray jim gray and andreas reuter transaction processing concepts and 28 techniques morgan kaufmann publishers inc 1993 29 u haipis national security agency interoperability specification for high 30 assurance internet protocol encryptor haipe devices version 20 31 charlie 3 jan 2003 32 u iatf _____ information assurance technical framework release 31 sep 33 2002 34 u is154082 common criteria implementation board common criteria for 35 information technology security evaluation ver 21 ccib98031 36 august 1999 part 2 security functional requirements 37 u kmi1001 national security agency concept for the kmi kmi 1001 10 jun 38 1999 39 u kmi1011 _____ key management infrastructure roadmap for the department of 40 defense kmi 1011 draft 9 jun 2000 41kmi2200 vol 3 unclassifiedfor official use only 20 may 2005 security architecture and related requirements version 2 x draft unclassifiedfor official use only page 168u kmi2020 _____ key management infrastructure kmi target architecture system 1 interface description kmi 2020 draft 19 jan 2000 2 u kmi2200 _____ system description and requirements specification for key 3 management infrastructure kmi capability increment 2 ci2 kmi 4 2200 version 126 srs f plus changes april 2005 including the 5 following 6 u kmi2200v1 _____ _____ volume 1 key management functions and related 7 requirements version 126 srs f plus changes april 2005 8 u kmi2200v2 _____ _____ volume 2 system security policy and related 9 requirements version 126 srs f plus changes april 2005 10 u kmi2204 _____ threat assessment report for key management infrastructure 11 kmi capability increment 2 ci2 kmi 2204 version 10 final 12 draft 30 jan 2004 13 u kmi2206 _____ security risk analysis for key management infrastructure kmi14 capability increment 2 ci2 kmi 2206 draft 2003 15 u kmi2211 _____ glossary for the key management infrastructure kmi program16 capability increment two ci2 draft 17 u kmi2212 _____ concept of operations for the key management infrastructure18 kmi capability increment two ci2 draft version 08 3 nov 19 2003 20 u kmi3001 national security agency electronic serial number standard draft 21 version 071 24 oct 2003 22 u nsakmicp x509 certificate policy for us dod kmi trustees technical 23 report version 10 17 sep 2003 24 u nsakmiru kmi policy for registration of users to be provided by the 25 government 26 u nsakmiem kmi policy for enrollment of managers to be provided by the 27 government 28 u reftbd1 tbd need to provide reference or explain unified infosec criteria29 u reftbd7 tbd need reference to specifications of kmi management token30 u rfc3546 s blakewilson et transport layer security tls extensions request 31 for comments 3546 the internet society june 2003 32