insecurities and inaccuracies of the sequoia vc advantage 900h dre v oting machine andrew w appel princeton universitymaia ginsburg princeton universityharri hursti brian w kernighan princeton universitychristopher d richards princeton universitygang tan lehigh university october 17 2008 executive summary the sequoia vc advantage is directrecording elec tronic dre voting machine used in new jersey pennsylvania and other states ithe vc advantage 900 is easily hacked by the installation of fraudulent ﬁrmware this is done by prying just one rom chip from its socket and pushing new one in or by replacement of the z80 processor chip we have demonstrated that this hack takes just 7 minutes to perform the fraudulent ﬁrmware can steal votes during an election just as its criminal designer programs it to do the fraud cannot practically be detected there is this research was supported in part by national science foundation award cns0627650 any opinions ﬁndings and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reﬂect the views of the national science foundation 1no paper audit trail on this machine all electronic records of the votes are under control of the ﬁrmware which can manipulate them all simultaneously iiwithout even touching single vc advantage an attacker can install fraudulent ﬁrmware into many vc advantage machines by viral propagation through audioballot cartridges the virus can steal the votes of blind voters can cause vc advantages in targeted precincts to fail to operate or can cause wineds software to tally votes inaccurately iiidesign ﬂaws in the user interface of the vc advantage disenfranchise voters or violate voter privacy by causing votes not to be counted and by allowing pollworkers to commit fraud iv vc advantage results cartridges can be easily manipulated to change votes after the polls are closed but before results from different precincts are cu mulated together v sequoias sloppy software practices can lead to error and insecurity wyles ita reports are not rigorous and are inadequate to detect security vulnerabilities programming errors that slip through these processes can miscount votes and per mit fraud vianomalies noticed by county clerks in the new jersey 2008 presidential primary were caused by two different programming errors on the part of sequoia and had the effect of disenfranchising voters vii the vc advantage has been produced in many versions the fact that one version may have been examined for certiﬁcation does not give grounds for conﬁdence in the security and accuracy of different version new jersey should not use any version of the vc advantage that it has not actually examined with the assistance of skilled computersecurity experts viii the vc advantage is too insecure to use in new jersey new jersey should immediately implement the 2005 law passed by the legislature requiring an individual voterveriﬁed record of each vote cast by adopting precinctcount opticalscan voting equipment note regarding redactions as paragraph 11 and appendix l ex plain this research was conducted pursuant to court order by the hon linda feinberg of the new jersey superior court sequoia v oting systems ﬁled motion alleging that certain parts of this report contain protected trade secrets plaintiffs dispute sequoias contentions judge feinberg has expressed her intention to pre serve plaintiffs objections until the time of the hearing when she will rule on the merits of sequoias claims of trade secret we are conﬁdent that the court will then permit release of the full unredacted report in the interim the court encouraged us to release the report with redactions paragraphs 198 199 213 and 215 as well as appendices bg are redacted in this release 2contents 1 introduction 8 2 description of the vc advantage 10 i fraudulent ﬁrmware can steal votes 15 3 v otestealing ﬁrmware can be installed in the vc advantage 16 4 we demonstrate votestealing ﬁrmware in an vc advantage 17 5 installing fraudulent software into z80 program rom 22 6 v otestealing ﬁrmware can avoid detection 24 7 the technical knowledge to write votestealing programs is basic computer science widespread in our society 27 8 it is easy in new jersey to gain unsupervised access to an vc advantage in order to replace rom chips 28 9 picking the lock on the vc advantage cabinet takes only seconds 30 10 the seals in the vc advantage do not provide tamperevidence 33 11 reverse engineering allows construction of fraudulent ﬁrmware even with out access to tradesecret source code 40 12 fraudulent ﬁrmware can be installed inside the z80 processor chip 46 13 would anyone go to these lengths 49 14 there is means to reliably detect fraudulent ﬁrmware in vc advan tages 50 15 many insiders have access sufﬁcient to tamper with vc advantage voting machines 51 16 the danger of fraudulent ﬁrmware is widely recognized by experts 52 17 conclusion of part i 55 ii daughterboard and wineds viruses can disenfranchise voters 56 18 the audiokit daughterboard is second computer in the vc advantage 57 19 one can install fraudulent daughterboard ﬁrmware by inserting cartridge even unwittingly 58 20 v otestealing computer viruses can infect vc advantage and wineds 61 21 viruses can propagate through the vc advantage 63 22 viruses can propagate through wineds computers 64 23 wineds computers have severe security vulnerabilies and are routinely connected to the internet 67 24 the daughterboard can steal votes or selectively disable voting machines 71 25 genius required for daughterboard attacks 72 326 the motherboard is vulnerable to malicious daughterboard ﬁrmware 73 27 security vulnerabilities in wineds 31 74 28 conclusion of part ii 75 iii userinterface inaccuracies and insecurities can disenfranchise voters 77 29 how we vote in new jersey 77 30 vc advantage falsely indicates votes are recorded when they are not 80 31 pressing an option switch deactivates the advantage so that votes are recorded 82 32 sound on activation is not an effective signal for voter pollworkers or witnesses to determine when votes are cast 83 33 the vc advantages lack of feedback leads voters to undervote 85 34 v oter cant tell which primary is activated 86 35 pollworker can see who the voter votes for 86 36 cant undo writein vote in violation of fec guidelines 88 37 procedures for ﬂeeing voter leave opportunities for violating the privacy or integrity of the ballot 88 38 conclusion of part iii 89 iv design errors and programming bugs make the vc advan tage insecure 90 39 v ote data is not electronically authenticated making it vulnerable to tam pering 90 40 manipulating results cartridges 92 41 some nj county clerks use the less trustworthy source of data in tabulating ofﬁcial election results 94 42 the advantage can print paper report from fraudulent results cartridge 95 43 one can confuse the vc advantage with fraudulent ballot deﬁnition that yields two votes for one button 96 44 results cartridges can be easily converted into other kinds of cartridges and used for fraud 98 45 early v oting cartridges permit fraud in states that use them 99 46 manipulating consolidation cartridges 99 47 wireless access to results cartridges opens avenues to manipulation 101 48 fraudulent intelligent results cartridges could steal votes 103 49 electronically stored ballot images compromise privacy of the ballot 104 50 conclusion of part iv 106 4v insufﬁciently rigorous design and certiﬁcation processes leave the ﬁrmware vulnerable 108 51 sequoias sloppy software practices can lead to error and insecurity 108 52 wyle laboratories examines ﬁrmware only superﬁcially 110 53 new jersey ofﬁcials neglected to read the ita reports and thus had opportunity to notice how their inadequacies 112 54 sequoia does not keep track of what ﬁrmware is installed in its dres 113 55 conclusion of part v 116 vi computerprogramming errors have actually disenfranchised nj voters 117 56 primary election partyafﬁliation bug disenfranchised voters 117 57 hardware malfunctions can disenfranchise voters 123 58 conclusion of part vi 130 vii different versions of the vc advantage have different vul nerabilities 131 59 advantage versions 900g and 900h have identical vulnerabilities 131 60 the vc advantage has changed great deal in successive versions 132 61 version 10 vc advantage is extremely vulnerable to fraud 134 62 version 8 vc advantage is vulnerable to fraud in some ways that version 9 is not 137 63 conclusion of part vii 139 viii conclusions and recommendations 140 64 new jersey should not continue to use the vc advantage 900 because it is insecure 140 65 new jersey should immediately remove the audio kits 140 66 there is way to safely use computers to count votes 141 67 forms of voterveriﬁed paper ballots 142 68 summary of conclusions reached in this report 145 ix appendices 147 memory devices 147 b buffer overrun reading messages from daughterboard 148 5c technical details of the optionswitch bug that disenfranchised some pri mary voters 149 d how the ballot images can be unshufﬂed thereby violating voter privacy 149 the source code violates the fecs softwareengineering guidelines for votingmachine ﬁrmware 149 f installing fraudulent software into z80 program ram 149 g the security measures in technician cartridges are easily defeated 149 h printer inaccuracy can change vote totals in results report 150 i inadequate indications of undervotes 151 j cumbersome procedure for dealing with ﬂeeing voters 153 k bug in wineds causes ballot programming to be extremely slow 156 l the court order 157 list of figures 1 the vc advantage from the front 9 2 vc advantage voter panel covered by printed paper ballot 11 3 excerpt from results report 13 4 results cartridge 13 5 inside the vc advantage cabinet from the rear 20 6 the motherboard of the vc advantage 21 7 z80 and rom chips on the motherboard 21 8 rom readerprogrammer 23 9 unattended voting machines in public places 29 10 keys for an vc advantage 31 11 picking the lock of an vc advantage 32 12 plastic strap seal 34 13 plasticstrap seal as installed by union county 34 14 do not remove sticker 36 15 results report tape with seal number not ﬁlled in 38 16 list of vc advantage voting machines sold by govdealscom 42 17 description of the vc advantage machines sold by govdealscom 43 18 desoldering tool 48 19 audio ballot cartridge front and back 58 20 wineds computer 65 21 closeup of voter panel with paperballot overlay 78 22 green x appears by selected candidate 79 23 cast v ote button 79 24 vote recorded thank you 80 625 operator panel 82 26 peeking through the slot 87 27 tiny computer for hacking results cartridges 92 28 cigarettepack hacking device 93 29 hacking results cartridge 93 30 buttons behind paper ballot on voter panel 97 31 eyeﬁ card for wireless access to cartridge 101 32 digital voice recorder 105 33 operator panel 119 34 results report tape demonstrating optionswitch bug 121 35 three resultsreport printouts demonstrating inconsistencies 126 36 inconsistent data from pennsauken 6 in camden county 129 37 version 10 results cartridge 136 71 introduction 11 in 2004 group of publicinterest plaintiffs represented by professor penny venetis of the rutgers law school sued the state of new jersey over the states use of directrecording electronic dre voting machines most of new jerseys counties had adopted the sequoia vc advantage fullface dre the plaintiffs argued that the use of dre voting machines is illegal and constitutional illegal because they violate new jersey election laws requiring all votes be counted accurately and that voting machines be thoroughly tested accu rate and reliable unconstitutional because they violate the new jersey constitu tions requirement that all votes count the plaintiffs argued that one cannot trust paperless dre machine to count the vote the case was dismissed by the trial court in january 2005 the dismissal was appealed while the appeal was pending in the summer of 2005 the new jersey legislature passed and the governor signed bill requiring that later than jan uary 1 2008 any voting system in new jersey must produce voterveriﬁed paper ballot in 2006 the appellate court reinstated the lawsuit and instructed the trial judge to monitor the progress of state election ofﬁcials in meeting the legislatures dead line in 2008 when the executive branch twice requested that the deadline be extended the legislature obliged each time with sixmonth extension based on an appellate divisions decision of june 2006 expressing concern that the state would not meet the legislatures january 2008 deadline the trial judge the hon linda feinberg ordered trial to proceed on the constitutional issue the case is gusciora et v corzine et docket merl269104 superior court of new jersey judge feinberg ordered that the state provide to plaintiffs expert witness for examination vc advantage voting machines complete with their source code appendix l shows the terms of the court order the authors of this report exam ined voting machines and source code during july and august 2008 and delivered our report to the court on september 2 the court order permits us to make our ﬁndings available to the public 30 days later 12 based on our examination of the vc advantage voting machine it is our opinion that 1 the vc advantage can be hacked to steal votes by replacing its ﬁrmware 2 the hack can be perpetrated by person with only ordinary training in computer science 8figure 1 the avc advantage from the front the large fullface voter panel white is visible in normal use it would be covered by printed ballot sheet which is not present in this photo an array of buttons 12 across by 42 down is visible when in use these are hidden behind the printed sheet below the voter panel is the writein keyboard to the left of the writein keyboard is an lcd display and to the right not quite visible is the cast v ote button this machine is owned by andrew appel the photograph was taken in 2007 at princeton university 93 person can easily gain enough access to voting machines to install this hack 4 once installed the fraudulent ﬁrmware is practically impossible to detect 5 once installed on voting machine the fraudulent ﬁrmware can steal votes in election after election without any additional effort 6 the vc advantage is vulnerable to hacks fraudulent manipulations in several different ways 7 some of these hacks take the form of viruses that can automatically propa gate themselves from one voting machine to another 8 even when not hacked the vc advantage in its normal state has design ﬂaws that can cause votes to be lost or cause voters to be given the wrong primary ballot to vote 9 even when not hacked the vc advantage in its normal state has design ﬂaws that encourage voter error and pollworker error and permit fraud 13 as part of this report we have prepared video demonstrating several of these vulnerabilities and inaccuracies this video will be available at httpcitpprincetoneduadvantage 2 description of the vc advantage 21 the vc advantage is directrecording electronic dre voting computer that is the voter indicates selection of candidates via userinterface to com puter the program in the computer stores data in its memory that are supposed to correspond to the indicated votes and at the close of the polls the computer outputs what are supposed to be the number of votes for each candidate 22 in the case of the vc advantage the primary input device used by the voter is large panel containing twodimensional array of buttons and lights see fig ure 1 this panel is covered by sheet of paper on which contests and candidate names are printed see figure 2 markings on the paper are placed over the but tons that are to be pressed for the corresponding candidates the lights on the panel when lit are visible shining through the paper on the side of the machine an op erator panel contains additional buttons and an lcd alphanumeric display with two rows of 24 characters each during an election before each voter can vote 10figure 2 the avc advantage voter panel covered by printed paper listing tests and candidates this is the 2008 new jersey presidential primary election as printed for union county the printed paper covers the hundreds of buttons shown in figure 1 11pollworker must press button on the operator panel to activate the machine to accept votes as elections are conducted in new jersey the pollworker is supposed to do this upon being handed paper ticket v oting authority by the voter1 23 the dre ballot is laid out so that to the layman there is an intuitive connec tion between the candidates name shown on printed ballot sheet and the input device button behind sheet of plastic in the hardware of the voting machine however there is direct connection between the button and the vote counter observing the click of button and accumulating corresponding candidate total is totally under software control since there is inherent internal connection between the buttons and the totals kept in memory and reported at the end of the election erroneous or malfeasant software can readily add to the wrong total or make some other error at any time during an election thereby misrecording votes even though the software produces socalled audit trail of the results it can always display an audit trial consistent with its fraudulent results and report that it has performed correctly 24 the vc advantage is paperless dre voting computer that is during the election while the votes are being cast there is paper trail of each vote while the polls are open paper is printed at all by the vc advantage this means that the only record of the votes is in the computers memory every socalled audit trail in the vc advantage including all records of votes can be modiﬁed at the discretion of the ﬁrmware firmware is software that has been installed semipermanently in computer as we will discuss throughout this report the ﬁrmware can be replaced by fraudulent ﬁrmware that abuses this discretion to steal votes 25 at the close of the polls the vc advantage communicates vote totals to elec tion ofﬁcials and to the public first it prints paper printout of candidate totals second it writes these totals along with record of the votes cast in each ballot the ballot image to results cartridge about the size of vcr tape that is then removed from the voting machine third it keeps these totals with the ballot images in its internal memory election workers can extract this information from the vc advantage by 1the vc advantage is available with an option not used in new jersey by which the voter can activate the machine with smart card obtained when she signs the pollbook 12figure 3 excerpt of paper results report printout from an avc advantage in the 2008 nj presidential primary election figure 4 results cartridge using the menu buttons on the operator panel the machine can be instructed to print the internally stored data onto its printer or copy it to fresh car tridge 26 if there is fraudulent ﬁrmware in the voting machine the fraud will have ready taken place by the time the polls close the paper printout the results cartridge and the ballot images will agree with each other but they will not be true record of the actual votes cast instead they will show whatever numbers the designer of the fraudulent computer program chooses amount of auditing these records will detect any discrepancy2 27 therefore it is absolutely crucial that the ﬁrmware should be correct in all cir cumstances and the votingmachine ﬁrmware should be immune to tampering but 2thus dre cannot be effectively audited in constrast an opticalscan voting machine can be audited in way that is truly independent of any computer program that might be suspected of cheating an opticalscan voting machine works as follows the voter ﬁlls in paper ballot by using pencil to ﬁll in circles or ovals next to the name of the candidates she wishes to vote for then in precinctcount opticalscan she takes the ballot to the opticalscan machine and feeds the ballot through the machine counts her votes then drops her ballot into ballot box to audit an optical scan voting machine it sufﬁces to recount the paper ballots by hand this method does not work with dres that have paper ballot 13this is not the case 28 we have found that the advantage vc ﬁrmware has errors we have also found that it is easy to replace ﬁrmware in the vc advantage with fraudulent ﬁrmware that can undetectably steal votes and thus change the outcomes of elections furthermore some kinds of fraudulent ﬁrmware can automatically virally propagate themselves from one vc advantage vot ing machine to another without the attacker being physically present once fraudulent ﬁrmware is installed in the vc advantage it can steal votes in election after election without any additional effort by the attacker 29 we examined the ﬁrmware and hardware of the vc advantage models 900g and 900h which are used by most counties in new jersey the conclusions in this report apply to those version 9 models however based on the evidence available to us we can also draw certain conclusions about the version 8 vc advantage few of which are still owned by mercer county and the version 10 which has been proposed but not yet certiﬁed for use in new jersey see sections 62 and 61 for details 14part i fraudulent firmware can steal votes 210 the most dangerous insecurities in dre voting machines and in the vc advantage in particular permit an attacker to install fraudulent votecounting program to control the computer in the voting machine in this part of the report we describe how we created fraudulent votecounting program and installed it into the vc advantage such programs can be made practically undetectable we deliberately made our program detectable just to demonstrate it 211 we will also explain in detail that the skills and methods we used to create this program are those available to many thousands of computer programmers with bachelorsdegreeequivalent education in computer science it is easy to gain access to vc advantage machines owned by new jersey counties in order to tamper with them the locks and seals on the vc advantage do not prevent this tampering keeping the source code secret cannot prevent this tampering source code is the humanreadable form of computer program if it is kept secret then the attacker just has to take the extra step of reverseengineering the ﬁrmware back into source code as we will explain 212 deﬁnitions computer takes its instructions in the form of machine lan guage which is inconvenient for humans to read and write computer program mers write programs in humanreadable formal language called source code which is then translated by build tools such as compiler into machine lan guage computer program once it is installed in readonly memory rom inside device such as microwave oven or voting machine is often called ﬁrmware henceforth we shall refer to source code and its corresponding ﬁrmware 153 votestealing ﬁrmware can be installed in the vc advantage 31 summary it is not difﬁcult to replace the ﬁrmware of the vc advan tage with fraudulent ﬁrmware that steals votes while leaving detectable evidence 32 the computer program ﬁrmware in the vc advantage that translates the voters buttonpushes into votes and counts those votes can be replaced by fraud ulent ﬁrmware 33 we found that we could make fraudulent ﬁrmware that can cheat in any of the following ways 1 the program can deliberately misinterpret the voters buttonpress record ing vote for candidate b even when the voter pushed the button labeled for candidate at the same time it will light the indicator x by the candidate the voter selected giving hint that the program is cheating 2 the program can count votes accurately until late in the election day and then simply modify the record of votes cast ballot images and candidate totals in the voting machines memories before the polls close 3 the program can violate the privacy of the ballot by storing record of how each voter actually voted in sequential order in the video that accompanies this report we demonstrate program that uses method 2 but it is straightforward to use any combination of these methods 34 in the next few sections of this report we will explain how criminal might design fraudulent computer program to steal elec tions how to physically replace the legitimate ﬁrmware in the vc advantage with fraudulent ﬁrmware how it is impossible to detect the fraudulent ﬁrmware during or after the election simple relatively lowtech fraud could not be detected by any means now in use in new jersey more sophisticated frauds which are straightforwardly achievable today could not be detected by any means that it is practical for new jersey to employ in the foreseeable future 164 we demonstrate votestealing ﬁrmware in an vc advantage 41 we built votestealing program and burned it into rom chip that we installed into an vc advantage this program moves votes from one candidates total to another while taking care not to change the total number of votes cast 42 the vc advantage has preelection logicandaccuracy testing prelat mode in which election ofﬁcials can debug the ballot deﬁnition to make sure the candidates names are printed over the right buttons but the control program for the vc advantage knows whether it is in prelat mode or ofﬁcial election mode our fraudulent ﬁrmware takes care to change votes only in ofﬁcial election mode our votestealing ﬁrmware does nothing untoward in prelat or postlat mode 43 an election ofﬁcial might think of testing the voting machine in ofﬁcial elec tion mode to see if it will cheat as we will explain later real votestealing program would have several means to avoid detection3our demonstration fraud illustrates just one of these which is to wait until large number of votes have been cast in ofﬁcial election mode for every voter before or after the nth voter the pro gram does nothing it waits until the 20th voter casts vote real fraud would wait until the 150th voter to better distinguish real election from test at that time the fraudulent program walks through the list saved ballot images in the vc advantages memory on half the ballots it changes vote from one candidate to another and it adjusts the candidate totals accordingly it writes its fraudulent ballot images and candidate totals both to the internal memory and to the results cartridge 44 when the polls are eventually closed the resultsreport printout is generated from the machines internal memory therefore all the socalled audit trails and results data agree with each other and with the printout 45 we could build practically indetectable votestealing programso indetectable that we could not demonstrate it because it would steal votes only in real elections 3as we will explain in section 6 welldesigned votestealing program carefully examines its environment to ensure that it is in real election not in test it must be real election day dates of which are known decades in advance the timedate in the machine must not have been ﬁddled with recently the polls must stay open for at least 12 hours at least 150 votes must have been cast and so on if we built such program and installed it in the vc advantage it would not serve the purpose of showing how easy it is to steal votes because observers would never catch it redhanded any demonstration we made for the court of such program would not show it stealing votes 17not in demonstrations therefore for purposes of demonstration we purposely built alesssophisticated votestealing program our exploit is intentionally simple so it can be explained and intentionally unsubtle in its attack so the theft is visible real votestealing program would be more clever and would be practically unde tectable 46 real votestealing program which will stay installed in the machine for elec tion after election might steal votes only in general elections it would not need to be programmed with knowledge of particular ballot design or the names of particular candidates instead it would steal from generic republican candidates for particular ofﬁces or from democratic candidates depending on the goals of the attacker 47 real votestealing program might also steal votes in primary elections if one partys political machine wished to make sure that primary challengers never win in any election in the future then it could install ﬁrmware that steals votes in favor of the candidate in the ﬁrst column where partyendorsed candidates are listed 48 the context of our demonstration we demonstrate votestealing program on the vc advantage machines provided to us by union county nj under the courts order we show that the voting machines are hackable in exactly the state in which union county had conﬁgured them for an election the voting machines are conﬁgured for the presidential primary of february 5 2008 that is the voter panel is covered by postersize printed ballot paper listing the candidates in that election and the results cartridge is programmed with ballot deﬁnition for listing candidates 49 we designed our votestealing program to match this particular artiﬁcial sce nario it does not steal from generic republican in favor of generic democrat or vice versa because that cannot happen in primary election it does not steal in favor of generic partyendorsed candidate because there were none in this presidential primary 410 to demonstrate real votestealing program in practice on union countys machines as they were set up for this election we decided to steal votes from bill richardson and gives them to dennis kucinich we have the highest respect for the integrity of mr kucinich and we hope that he will not take offense but we had to choose someone whose name was on the ballot our program waits until at least 20 votes are cast then takes half of mr richardsons votes and gives them to 18mr kucinich 411 we ran fake election in which 16 votes were cast for mr richardson and then 4 votes for mr kucinich when this sequence of votes is cast dur ing the prelat phase the results are exactly as expected richardson 16 kucinich 4 the identical sequence of votes was then cast in ofﬁcial election mode this time mr richardson only received 8 votes while mr kucinich received 12 the results tape and the audit trail tape both show this fraudu lent result there is inconsistency in the results output from the machine they all agree richardson 8 kucinich 12 412 we made our program simple and speciﬁc just to clearly and unambiguously demonstrate how the vc advantage is vulnerable to fraud in section 6 we will explain how it is matter of simple computer programming to make the fraudulent ﬁrmware do much more sophisticated thefts that are not speciﬁc to single election 413 the vc advantage program ﬁts in three rom readonly memory chips of 128 kb kilobytes each our votestealing program is modiﬁcation of just one of these roms which makes the physical installation simpler for the attacker we added our cheating code to the function that implements add 1 to the public counter because this function was most convenient it happens to reside on rom chip that has empty space and the function executes once for each voter 414 our votestealing program is 122 lines of source code it translates into less than 600 bytes of ﬁrmware it took two of us about two days to write 19figure 5 inside the avc advantage cabinet from the rear visible is the main circuitboard cover sheetmetal approximately 17x14 inches through which pro trude two ports currently labeled results and auxiliary in this picture the results port contains results cartridge and the auxiliary port is empty to the right of these ports is smaller metal box containing the audiokit daughterboard with cable leading to black nylon bag at lower right containing more audio voting accessories at center left are the power onoff knob the polls openclosed keyswitch and the print more button at upper right is printer used for print ing results reports this machine is owned by union county nj closeup of the onoff knob polls openclosed keyswitch and print more button 20figure 6 the motherboard of the avc advantage the z80 is the largest chip at center right the roms have white labels this machine is one that appel purchased in 2007 the motherboards of the ma chines we examined from union county nj are similar figure 7 z80 and rom chips on the motherboard the z80 is the large chip at lower left the roms have white labels 21legitimate sequoia firmware v otestealing firmware v oter selects candidateswhich mode are we inv oter presses cast vote operator activates machine for next voteradd vote to candidate totalspre latofficial election is this the 20th vote yes dont change any votes right nowchange stored votes from one candidate to another 415 this ﬂowchart illustrates the logic of our votestealing ﬁrmware the vote stealing program is small addition to sequoias factoryinstalled ﬁrmware of which we have illustrated only tiny portion here 5 installing fraudulent software into z80 program rom 51 summary with just few minutes of unsupervised access to an vc advantage one can easily replace the motherboard ﬁrmware to steal votes and change election results we have demonstrated this replacement on video that accompanies this report 52 the motherboard of the vc advantage is large circuit board containing z80 computer and many other chips that serve as memory inputoutput devices and so on the computerprogram ﬁrmware that controls how votes are interpreted and added resides in rom chips on the motherboard we will refer to these as z80 program rom 53 to prepare rom chip containing our votestealing ﬁrmware we bought some erasable programmable rom eprom chips4for 387 each 4uverasable eprom 27c1001 from allied electronics wwwalliedeleccom 2254 the device for writing ﬁrmware into the rom chips costs 1505we borrowed an old one an attacker would use this device to prepare fraudulent rom chips in advance of gaining access to the voting machine figure 8 rom readerprogrammer cost150 approx 3 inches by 2 inches 55 to install fraudulent software into the z80 program rom one removes the rom chips from the motherboard and inserts replacement rom chips since our votestealing program is such small modiﬁcation to the ﬁrmware we had to re place just one rom chip on the vc advantage motherboard 56 on the vc advantage motherboard the roms are installed in socketsnot soldered directly to the circuit board although this is standard industrial practice for computer equipment it is not wise practice for voting machines computer equipment has most chips soldered directly to the circuit board but rom chips are often placed in sockets so that they can be easily removed and replaced with new roms containing new upgraded ﬁrmware however for voting computers this poses grave security risk to access the rom sockets in order to replace the rom chips we removed the main circuitboard cover this is rectangle of sheet metal approximately 17x14 inches held in place by 10 sheetmetal screws then we pried the rom from its sockets using screwdriver and pressed the replacement rom into place 57 ﬂexible plasticstrap seal is sometimes installed that is supposed to provide tamperevidence if the circuitboard cover is removed section 10 describes how such seals are easily defeated how we were able to defeat this seal and how at 5batronix usb eprom programmer 14950 httpwwwprogshopcomshopprogrammerusb chipprogrammerindexhtml 23many times the seals are not even installed at all 58 the vc advantage ﬁrmware attempts to detect replacement of the z80 pro gram rom by computing checksum kind of digital ﬁngerprint of the contents of rom then the ﬁrmware in rom compares the checksum against what it should be that is it attempts to detect the replacement of itself this is not an effective security measure because once the ﬁrmware is replaced obviously it is longer there to perform this detection any new fraudulent rom can simply omit this check6 59 in fact we found that the design of the vc advantages romchecksum gorithm is so weak and insecure7that we were easily able to construct fraudulent ﬁrmware with checksum that matched the legitimate one 510 the vc advantage ﬁrmware attempts to log events such as different pro gram rom installed in the its maintenance log however 1 this logging is done by ﬁrmware in the program rom itself and fraudu lent rom can avoid logging anything it doesnt want to and 2 fraudulent program rom can modify the maintenance log in any way it wants to since the maintenance log is kept in writable memory 6 votestealing ﬁrmware can avoid detection 61 summary it is well known how to design votestealing program so that it can avoid detection the program takes care not to cheat in any circum stance where someone can compare the actual votes cast with the programs computed results 62 fraudulent votingmachine ﬁrmware can be easily written to take all of the following steps to avoid detection 63 it would take care to maintain correct public counter this is counter of how many voters cast votes on the machine election workers and pollwatch ers representing the parties can see how many voters use the machine during 6in addition the ﬁrmware in the z80 program rom computes checksum of itself and writes this to the maintenance log where it can be printed this is not an effective security measure against fraudulent rom replacement because fraudulent ﬁrmware would simply write the known good checksum into the maintenance log 7function checksum in asmchecksumasm is simply the sum of the 8bit bytes taken modulo 216 even 50 years ago this algorithm was known to be insecure 24the day and there are v oting authority tickets that tabulate this number so if the program gets this number wrong it will be caught 64 it would take care that the candidate totals are consistent with the public counter that is equal to or slightly less in real elections voters sometimes do not vote every contest 65 the fraudulent ﬁrmware must take care not to steal too many votes for example if some machines in heavily republican district vote democratic by 9010 margin suspicions will be raised experts in the ﬁeld of election auditing usually assume that 20 of the votes can be stolen without raising suspicions8 66 the fraudulent ﬁrmware would take care not to cheat in preelection logic andaccuracy testing prelat mode prelat is notan examination of the ﬁrmware itselfit is mock election in which election workers cast few votes on the voting machine and make sure that the totals come out right the voting machines computer program ﬁrmware knows exactly what mode it is in on the vc advantage it is design feature that the program makes sure that election workers perform prelat testing before switching to ofﬁcial election mode it is easy to make the fraudulent ﬁrmware take care not to cheat in prelat mode where inaccuracy would be detected 67 the fraudulent ﬁrmware would defend itself against preelection testing in ofﬁcial election mode we have seen evidence at all that this kind of testing is done in new jersey but the criminal would be prudent nonethe less in this kind of testing election workers set the date of the machine forward to election day and test the machine as if it were real election however changing the date of the machine is done under control of the ﬁrmware itself thus it can examine the maintenance log for datechange commands entered through the operator panel and try to estimate what the real date is the fraudulent ﬁrmware might choose not to cheat if the date has recently been changed 68 the fraudulent ﬁrmware can to defend itself against parallel testing this is practice for attempting to detect fraudulent dres it is not used in new jersey as far as we know in parallel testing election ofﬁcials wait until the morning of election day itself and than randomly select some voting 8random auditing of ev oting systems how much is enough by howard stanislevic wwwv otetrustusaorg august 9 2006 25machines these machines are taken out of service and are not used in the actual election instead people cast votes on the machine as if it were real election trying to fool the electionstealing ﬁrmware in case any were installed then the results are compared with the actual votes cast 69 cleverly designed fraudulent ﬁrmware can detect differences in the patterns of use between testers and real voters the simplest way is to wait until at least 150 votes have been cast spread over several hours before altering any votes in memory that way parallel testing must be very thorough to succeed9 610 some voting machines including the vc advantage have ﬁrmware that computes and reports digital ﬁngerprint of itself severaldigit number that summarizes the contents of the ﬁrmware the fraudulent ﬁrmware can simply lie about itself the author of the fraudulent program knows what the right number is because the legitimate voting machines print it out when asked and the author writes the program to just print that number 611 while this might seem long list of criteria for an effective votestealing pro gram it is actually quite straightforward computer programming to implement program that works this way it would take trained computer programmer month to write this program 612 generalpurpose votestealing ﬁrmware fraudulent votestealing pro gram installed just once in voting machine can steal votes in election after elec tion without the criminal ever needing to give it further instructions 613 in general elections the fraudulent program can easily tell which are the republican candidates and which are the democrats since the ballot def inition in the results cartridge contains this information therefore once the fraudulent ﬁrmware is installed it needs further instructions it will always cheat in favor of the attackers party 614 in primary elections with organizationendorsed candidates like most primary elections in new jersey the ballot layout makes it clear who is the endorsed candidate fraudulent ﬁrmware can be installed to cheat in favor of endorsed candidates for example 9in addition the ﬁrmware has access to the timing of buttonpushes down to fraction of second and tester who casts hundred votes will settle into very different pattern than 150 different real voters do these patterns can probably be effectively distinguished by standard methods of computer science such as the statistical techniques called machine learning 26 615 for other kinds of elections the attacker may not know today how he wants the machine to cheat in future election consider for example the 2016 presidential primary or the 2016 princeton regional school board election it is difﬁcult to imagine now what candidates will be on the ballot an at tacker with access to the voting machines now can install ﬁrmware that steals votes in many elections between now and 2016 but he can easily leave him self the ﬂexibility to steal votes in those elections too he can do so by any of the following means 616 design the votestealing program steal votes away from candidates with hispaniclooking names or whose ﬁrst names look like womens names 617 design the votestealing program so that one could communicate to it the name of the candidate to favor for example one could say steal in favor of the second candidate voted for in the prelat then corrupt election worker could arrange in the prelat to vote for that candidate on the sec ond test ballot the technical term for this kind of underthetable commu nication is secret knock 618 one can make secret knocks that do not require corrupt election worker for example corrupt voter could signal to the corrupt ﬁrmware to cheat in favor of candidate x as follows ﬁrst select and deselect each candidate in the race by pushing the button twice for each candidate then vote for candidate x it is easy to design computer program that can recognize this sequence the corrupt voter can vote at any time of day since the ﬁrmware can do the actual transfer of votes just before the polls close 619 finally of course one can simply install on many machines used in par ticular election fraudulent ﬁrmware that is speciﬁc to that election then the attacker does not get the beneﬁt of hack the machine once and for all but the single election is effectively stolen 7 the technical knowledge to write votestealing programs is basic computer science widespread in our society 71 technical knowledge and skills are needed to design create and install fraud ulent votestealing computer ﬁrmware into voting machines however this knowl edge and these skills are widespread the fundamental skill needed is basic knowledge of computer programming and basic knowledge of computer orga nization at the level taught in the core of the undergraduate curriculum of most 27colleges and universities that offer degree in computer science or in computer engineering in each year from 1983 to 2004 at least 25000 bachelors degrees in computer science were awarded in the united states alone10thus there is pool of over half million people who have the kind of technical skills needed to perform the hack that we performed 72 the technical skills to create fraudulent votingmachine ﬁrmware are similar in many ways to the skills needed to create computer viruses there are tens of thousands of known computer viruses11 8 it is easy in new jersey to gain unsupervised access to an vc advantage in order to replace rom chips 81 summary voting machines are left unattended in public places for several days before and after each election its not difﬁcult to gain ten minutes of unsupervised access to the voting machine 82 the sequoia vc advantage weighs about 250 pounds therefore the ma chines are delivered several days before the election and removed several days after the election12 83 polling places are sites to which the public generally has access elementary schools colleges ﬁrehouses churches and so on at these places in new jersey vc advantage voting machines are left unsupervised for days on end 84 on tuesday june 3 2008 the day of the new jersey nonpresidential primary election professor edward w felten wrote voting machines were left unguarded all over princeton as usual on sunday and monday evenings i visited ﬁve polling places in prince ton and found unguarded voting machines in all of them18 ma chines in all the machines were sitting in school cafeteriagyms try hallways and even in loading dock area in case were there any locks or barriers stopping people from entering and walking right 10science and engineering degrees 19662004 maurya m green project ofﬁcer division of science resources statistics national science foundation arlington v january 2007 11az listing of threats and risks symantec inc httpwwwsymanteccombusinesssecurity responsethreatexplorerazlistingjsp 12see certiﬁcations of approximately 15 county ofﬁcials ﬁled with the court by defendants in october 2004 28figure 9 unattended voting machines at four different polling places in princeton nj on june 1 and june 2 2008 before the june 3 primary election photos by edward felten 29up to the machines in case did i see any other people this was in the evening roughly between 800 and 900 pm there were even handy signs posted on the street pointing the way to the polling place showing which door to enter and so on13 figure 9 shows some photographs that professor felten took of these unattended vc advantage machines 85 on saturday november 4 2006 three days in advance of tuesday federal election professor felten reported seeing unattended voting machines at polling place in princeton nj with other people in sight 86 when voting machine is left unattended in public place before an election its obvious that an attacker could tamper with the machine before an election but even when the voting machine is left unattended after an election this is an opportunity to install fraudulent ﬁrmware to cheat in the next election and in every subsequent election 87 between elections the voting machines are kept in county warehouses where any number of employees have access to them v oting machines are delivered to the polling sites and picked up from polling sites typically by private trucking companies14 9 picking the lock on the vc advantage cabinet takes only seconds 91 summary the lock on the cabinet of the vc advantage is simple cheap and easy to pick this is signiﬁcant because many of the attacks we describe require access to the inside of the cabinet 92 the cabinet of the vc advantage has door at the rear equipped with key lock the door must be opened to access any of the following devices inside the cabinet 1 the ports for inserting results cartridges and other types of cartridges 2 the printer that prints preelection and postelection reports 13nj election day v oting machine status by ed felten freedomtotinkercom june 3 2008 14see footnote 12 on page 28 303 the hook where the operator panel is stored while not in use 4 the nylon bag containing the audio v oting equipment 5 the emergency ballot box 6 the computer circuit boards which are additionally covered by sheetmetal circuitboard cover 93 at the polling place electionboard workers unlock this door in the morning to remove the operator panel and print zero tape then normally lock the door before voters arrive during the election they may need to unlock the door to access audiovoting equipment which can only be accessed with the door open at the end of the election day the board workers open the door again to close the polls print results report and remove the results cartridge 94 inside this locked door the switch labeled polls openclosed is operated by different key that is the electionboard workers are given keyring containing the door key the pollsopenclosed key and metal tag with the serial number of the machine15 95 vc advantage voting machines are delivered to polling places several days before the election see section 8 without their keys and removed from the polling places several days after the election figure 10 door key left and polls openclosed key right for an avc advantage 96 by the day preceding the election upon notiﬁcation of the municipal clerk one election clerk ie electionboard worker shall obtain from the clerks ofﬁce 15ofﬁcial instructions for members of the district boards of elections presidential primary election february 5 2008 mercer county bates number mercer 004642 in gusciora et v corzine et 31the registration binders and all the other election supplies to be delivered to the polls for the election16these election supplies include the keys to the voting machines thus the keys arrive with the electionboard workers on the morning of the election and are removed after the polls close they are sent back to the county election warehouse after the close of the polls 97 the door lock is described by its manufacturer illinois lock co as eco nomical die cast cam locks for high quantity applications it is cheap 5tumbler lock which does not provide very much security we were easily able to get the key duplicated at the local hardware store for 169 plus tax 98 even without key the door is easily opened by picking the lock appel had never before attempted to pick lock before beginning this study in july 2008 he received few minutes of advice about lockpick tools and instruction on their use from princeton university graduate student lockpicking tools are easily available on the internet he bought set of lockpicking tools for less than 40 questions asked except creditcard number of course figure 11 picking the lock of an avc advantage 99 two days later appel could pick the door lock of an vc advantage voting machine in an average of 132 seconds measured over 10 trials on two different 16ofﬁcial instructions for the district board of elections middlesex county board of elections revised jan 2008 bates number middlesex 1048 page 3 32voting machines 910 the key switch for pollsopenclosed is very similar and also easy to pick however picking this lock is not necessary for any of the ﬁrmwarereplacement attacks that we designed 911 the vc advantage would not be made resistant to fraud simply by using better locks for example pin tumbler lock instead of the cheap wafer tumbler lock that sequoia uses professor matt blaze of the university of pennsylvania is an expert in computer security and one of the plaintiffs experts in this case since computers are often embedded into physical devices such as voting machines and atms with physical locks professor blaze has spent considerable time on the academic study of the security of locks in 2004 he taught class on security at the university of pennsylvania in one of the laboratory sessions for this course he taught the students how to pick pintumbler locks which are of substantially better quality than the locks used on the vc advantage in the 3hour laboratory session every one of the halfdozen students in the class was successful in learning how to pick pintumbler lock 912 aside from the fact that the locks can be picked there is the fact that many people have access to the keys until few days before the election they are in the municipal clerks ofﬁce one or more days before the election the keys are transferred to the custody of oneelectionboard worker17anywhere in this chain of custody someone can make copy of the key or someone can use the key to tamper with the voting machine 913 therefore the locks on the vc advantage do not prevent tampering with the internals of the machine 10 the seals in the vc advantage do not provide tamperevidence 101 summary the supposedly tamperevident seals in the vc advantage provide signiﬁcant protection 102 in its promotional literature sequoia claims that the vc advantage design permits the installation of numbered security seals that are supposed to provide 17see footnote 16 33tamperevidence in case the roms are replaced18these ﬂexible plasticstrap seals give real protection as we explain in this section figure 12 plastic strap seal 103 the vc advantage machines are prepared for each election by installing results cartridge containing ballot deﬁnition this is done by employees of the superintendent of elections or equivalent before the machines are transported to the polling places after the cartridges are inserted plastic strap seal is inserted passing through the cartridge and through slot in the vc advantage sheet metal each seal is stamped with serial number 104 figure 13 shows an vc advantage with green plastic seal installed by union county in the results port union county provided two vc advantage machines for examination one of them had this plastic seal in place the other had seal figure 13 green plastic strap seal in the results port of an avc advantage exactly as installed there by union county new jersey this seal is supposed to prevent removing the circuitboard cover without breaking the seal but in fact it is possible to remove the circuitboard cover without removing the seal 105 at the close of the election day the election workers at the polling place remove the cartridge which now contains records of the votes cast to do this they cut the 18a vc advantage security overview sequoia v oting systems inc 2004 34seal they are supposed to record the serial number of the seal in space provided on the results report printout that came from the voting machine before they sign this document then they are supposed to place the cartridge the results report and the serialnumbered seal into bag they are supposed to seal this bag with yet another serialnumbered tamperevident seal and transport the bag immediately to county election ofﬁcials typically several miles away then the bag is opened the results cartridge is removed from the bag and inserted into computer so that election results from that voting machine can be extracted and accumulated with other precincts 106 for system of tamperevident seals to provide effective protection the seals must be consistently installed they must be truly tamperevident and they must be consistently inspected with respect to the sequoia vc advantage this means thatall ﬁve of the following would have to be true but in fact not single one of these is true in practice as we will explain 1 the seals would have to be routinely in place at all times when an attacker might wish to access the z80 program rom but they are not 2 the cartridge should not be removable without leaving evidence of tamper ing with the seal but plastic seals can be quickly defeated as we will explain 3 the panel covering the main circuit board should not be removable without removing the seal but in fact it is removable without disturbing the seal 4 if seal with different serial number is substituted written records would have to reliably catch this substitution but we have found major gaps in these records in new jersey 5 identical replacement seals with duplicate serial numbers should not exist but the evidence shows that serious attempt is made to avoid duplication 107 now we will explain in detail why not single one of these necessary condi tions for tamper evidence actually holds in practice in new jersey 108 circuitboard cover seal does not exist in addition sequoia claims that numbered seal can be installed on the circuitboard cover but in practice such seals are actually installed19this seal is supposed to be installed through the hole labeled do not remove in on the circuitboard cover 19a vc advantage security overview sequoia v oting systems inc 2004 35figure 14 closeup from figure 5 the hole labeled do not remove contains seal in actual practice the circuitboard cover seal is not installed on all ﬁve machines bought from buncombe county north carolina and on both of the machines we examined from union county new jersey the circuitboard cover seal is not in place notwithstanding the sticker labeled do not remove we believe this is because the four aa batteries on the main circuit board must be replaced period ically to do this maintenance technician typically someone employed by the county superintendent of elections or equivalent must remove the circuitboard cover the instructions in the maintenance manual20for replacing the batteries make mention of reinstalling seal on the circuitboard cover 109 sloppy logging of seals in new jersey the pollworkers who remove the seals from voting machine at the end of the day are asked to sign paper form printed by the vc advantage at the end of the results report at the close of the polls this form indicates the vote totals from that voting machine and has blank in which the pollworkers are supposed to write the number of the tamperevident seal in sample of 51 such result report forms from the new jersey primary election of february 5 2008 just half 26 of these had seal number ﬁlled in the blank see figure 1521 20sequoia v oting systems vc advantage maintenance manual release 900 document ver sion 102 january 2005 page 41 21i obtained these 51 results reports via an opra open public records act request made in march 2008 by edward felten the following vc advantage voting machines were represented in our data 9520 9521 6838 6837 6702 6703 19507 19475 19551 19533 19564 19592 19650 19624 19646 sn illegible mansﬁeld twp 4d 19678 19677 19688 19696 19697 19744 19748 19749 19756 19757 19786 19787 19799 19496 19843 19842 19853 19872 19552 22791 22951 23133 23301 23146 23038 22980 22977 22970 22938 22902 22891 22867 22810 2327x bayonne w3 23880 bayonne 36the others were either blank or erroneously contained the serial number of the voting machine this lapse indicates either that there was seal on the ma chine or that the pollworkers neglected to note the number therefore even if the plastic tamperevident seal technology actually worked the recordkeeping proce dures used in connection with the seals are inadequate in practice 1010 seals routinely not in place the seal holding the results cartridge must be removed at the close of the polls in order to send the results cartridge back to county election ofﬁcials new seal is installed by pollworkers22then the vc advantage voting machine remains at the polling site for several days before it is collected by transportation contractor during this time seal is in place protecting the circuitboard cover replacing the z80 program roms at this time will affect all future elections conducted with this machine 1011 audioballot cartridge has seal as part ii of this study discusses the audioballot cartridge is especially vulnerable to attack it is completely unpro tected by any seals so once the main lock is picked trivial task the audio car tridge can be replaced 1012 removing the cover without removing the seal because the plastic strap seal that holds the results cartridge in place is so ﬂexible we were able to remove the circuitboard cover without removing this seal to remove the circuitboard cover after the screws are removed one pulls the cover straight out in figure 5 this would be towards the viewer of the picture this removal would be equally easy with or without the results cartridge in place 1013 duplicate seals reduce security in studies of computer security we often consider protocols that have sequence numbers that have duplicates so that fraudulent messages cannot be inserted the same issue arises with plastic security seals they should have duplicate numbers otherwise the attacker can simply cut the seal and replace it with duplicate 1014 union county has been running elections for many decades with several hun dred voting machines if the county were maintaining consecutive sequence of seal numbers without duplicates the serial number on one of todays seals would be in the hundreds of thousands but we found that the union county voting ma 22page 12 ofﬁcial instructions for members of the district boards of elections presidential primary election february 5 2008 mercer county bates number mercer 004642 in gusciora et v corzine et 37figure 15 results report tape from the nj presidential primary of february 5 2008 as signed by wit nesses at the close of the polls in englewood cliffs nj the seal number is not ﬁlled the the blank just above the signature lines as it should be about half of the 51 results reports we examined had the seal number missing at right closeup of the same report 38chine provided to us had seal number 585 that is it is marked with nothing more than the name of the electionsupply vendor intab and the number 0000585 this strongly suggests that union county orders each batch of new seals starting from 0 this defeats the purpose of numbered and logged security seals 1015 defeating tamperevident seals in general we have studied seals in detail because like locks they are important in the ﬁeld of computer security one of the most useful reference works in this area is by dr roger g johnston of the alamos national laboratory of the us department of energy alamos has scientists who work on nuclear weapons and scientists who work on the problem of nuclear proliferation this laboratory has reasons to study the security and tamper resistance of seals because these can be vital in the transport of nuclear materials and in the inspection of nuclear facilities dr johnston has published several scientiﬁc studies of the vulnerability of security seals in one such study23he studied 94 different types of seal including 13 different designs of plastic seals including several different plastic strap seals it is plastic strap seals that are used on the results cartridge of the vc advantage 1016 dr johnston found how to defeat all 94 seals using rapid inexpensive low tech methods he deﬁnes defeating seal consists of opening the seal without any detectable damage or evidence of entry or opening the seal and repairing any damage andor erasing detectable evidence of entry or replacing the entire seal with counterfeit that will be confused with the original or replacing relevant parts with counterfeits 1017 all of johnstons attacks were lowtech and can be implemented with tools and supplies that can be carried easily by one person the median cost of materials and tools to defeat seal is under 100 the median time to defeat plastic seal is two to three minutes 1018 the experimental methodology presented by dr johnston in this and other reports appears to be sound 1019 we found that we were able to bypass the plastic seal installed by union county and remove the circuitboard cover without disturbing the seal we have shown this on the video that accompanies this report furthermore based on dr johnstons analysis we conclude that matter what form of plastic strap seal 23vulnerability assessment of security seals by roger g johnston phd and anthony r garcia technical report laur963672 alamos national laboratory 1996 39a county might use it would not prevent deter or even signiﬁcantly delay termined attacker from replacing or modifying either the internal software or the removable ballot cartridges of voting machine 11 reverse engineering allows construction of fraudulent ﬁrmware even without access to tradesecret source code 111 summary an attacker would not need sequoias tradesecret source code in order to design fraudulent votestealing ﬁrmware in order to construct fraudulent votestealing ﬁrmware the attacker must derstand the legitimate ﬁrmware in the voting machine just enough to modify it one might think this is not possible because the ﬁrmware is secret however the ﬁrmware is present in every single vc advantage voting machine and is straight forward to extract and analyze the attacker would apply reverse engineering to analyze the ﬁrmware even without source code 112 reverse engineering is the process of deducing the design of an engineered artifact from the artifact itself for example recovering the source code from the firmware would be reverse engineering or recovering the design speciﬁcations and behavioral description from the source code would be another form of reverse engineering 113 reverse engineering is commonly done in industry for variety of reasons for example learning how competitors product works or learning how your own product works when the engineers who built it have left the company and you cant ﬁnd the original design documents or source code 114 in our current study pursuant to the courts order we requested access to quoias source code we did this not because its impossible to analyze and hack the ﬁrmware without the source code but because the reverseengineering process would have added several weeks of time to the analysis we requested source code in order to expedite this examination 115 in 2007 appel and students performed study to quantify how easy it is to hack the vc advantage without source code this kind of hack takes 4 steps step 1 is to obtain access to the vc advantage to get copy of the ﬁrmware in section 8 we described how one could do this illegally appel did it legally by purchasing used machine 40step 2 is to derive source code from ﬁrmware by perform reverse engineer ing analysis step 3 is to prepare new fraudulent program in section 4 of this report we explain that this took 4 persondays step 4 is to install the fraudulent ﬁrmware into the voting machines as we describe in section 4 and showed on the video that accompanies this report it is steps 1 and 2 that we will discuss in this section it is easy to legally obtain votingmachines to analyze 116 in early january 2007 the county of buncombe in north carolina advertised for sale on the internet auction site govdealscom several sequoia vc advantage voting machines there were 136 machines sold in lots of 10 machines 4 ma chines and 5 machines for total of 18 lots the auctions closed on january 16 and january 26 depending on the lots figure 16 shows screenshot from the gov dealscom site showing that the lots of voting machines all sold to various bidders for prices ranging from 7 to 140 per lot figure 17 shows description of the vc advantage merchandise the auction site govdealscom is apparently meant for federal state and local governments to sell surplus equipment any person can qualify to bid on and purchase equipment through this site 117 appel purchased one lot of 5 machines for price of 82 for the lot in reg istering to bid he did not have to present any credentials other than his name address email and telephone number other questions were asked of him by govdealscom or by buncombe county the government had information about him or his motives in obtaining the voting machines at any time before or after the auction and delivery of the voting machines to him he paid for the machines by cashiers check he had these machines shipped to princeton by commercial carrier where they arrived on february 2 2007 the machines arrived in operating order complete with one results cartridge and two sets of keys per machine 118 the machines originally sold to buncombe county in 1997 for 5200 each are physically very similar to the union county machines except that they do not contain an audiokit daughterboard and the roms are version 500d instead of union countys 900h figure 1 shows photograph taken in february 2007 of one of appels sequoia vc advantage voting machines in his ofﬁce at princeton university 41figure 16 list of avc advantage voting machines sold by govdealscom in jan uary 2007 42figure 17 description of the avc advantage machines that appel purchased through govdealscom in january 2007 43reverseengineering translates the vc advantage ﬁrmware back to source code 119 in the spring of 2007 appel advised team of students at princeton university to assess the effort required to reverseengineer the vc advantage 1110 joshua herbach wrote simulator software program running on an ordinary pc the the ﬁrmware can be loaded into this simulator and it will run the ﬁrmware as if the ﬁrmware were installed in the vc advantage voting machine24alex halderman and ariel feldman analyzed the circuit boards and the contents of the roms25 1111 herbach built the simulator in approximately 3 personweeks that is 25 of his time for 12 weeks he started with an opensource z80 simulator ﬁxed the bugs in it and then implemented simulation of inputoutput operations that the advantage uses to run its memory manager external lights and buttons and other devices 1112 halderman and feldman reverseengineered the circuit boards this took about 4 personweeks then they used the idapro reverse engineering tool to analyze about 35 kilobytes of the ﬁrmware this took about 2 personweeks the version 9 vc advantage has 320 kilobytes of ﬁrmware we estimate that the reverse engineering task would take about 25 personweeks 1113 we obtained sequoias source code by court order about one year after the reverseengineering study concluded therefore the reverseengineering experi ment was not inﬂuenced in any way by seeing sequoias source code reverseengineering is possible even without possession of an vc ad vantage dre 1114 it would be entirely possible to cheat in an election even without having pos session as we do of governmentsurplus vc advantage voting machine it is straightforward although illegal to get copy of the ﬁrmware by tampering with voting machine while it is left unattended in public place section 8 describes 24simulating the sequoia vc advantage dre v oting machine by joshua s herbach partment of computer science princeton university may 2007 25a vc advantage hardware functional speciﬁcations by j alex halderman and ariel j feld man technical report tr81608 department of computer science princeton university march 2008 44how voting machines are left unattended in public places one would open the back door unscrew the 10 screws holding the circuitboard cover in place pry out the four rom chips and put each one in romreader device for 5 seconds we show this device at 54 then he would replace the unaltered rom chips replace the cover and close the door the attacker can then study and reverse engineer the ﬁrmware in the privacy of his own home another reverseengineering study 1115 in the summer of 2007 the secretary of state of california commissioned toptobottom review of the hardware and software of the voting machines then in use in california the review was conducted by several teams of computer security experts most of the experts were from universities in california penn sylvania new jersey and texas but some were at private consulting companies 1116 one of the explicit goals of the california study was to determine whether an attacker could exploit vulnerabilities in voting machine without access to the source code therefore for each voting machine studied two separate teams were constituted the source code review team studied the source code to assess its accuracy and security and the red team studied the physical voting machine without access to the source code on all the voting machines studied the red team found ways to exploit security vulnerabilities in the voting machines in particular the red team was able to extract and analyze the sequoia vc edge26ﬁrmware and construct malicious versions of that ﬁrmware without access to the source code27 1117 conclusions keeping the source code secret does not make the vc ad vantage or any voting machine secure the source code is simply shortcut that enables the attacker to skip the step of reverseengineering the ﬁrmware the secu rity vulnerabilities we describe could be found by someone without access to the source code 26they studied voting machines used in california including vc edge the vc advantage is not used in california and they did not study it 27security evaluation of the sequoia v oting system public report computer security group department of computer science university of california santa barbara july 2007 httpwwwsoscagovelectionsvoting systemsttbrred sequoiapdf 4512 fraudulent ﬁrmware can be installed inside the z80 processor chip 121 summary it is possible to physically replace the main computer chip on the motherboard with fraudulent computer that steals votes 122 the cpu central processing unit chip that masterminds the vc advan tage 900 is z80 processor invented in 1976 with todays technology it is straightforward to replace the z80 on the vc advantage motherboard with an imitation of z80 one that is specially constructed to steal votes instead of run ning the legitimate ﬁrmware from roms 123 one way to hack the vc advantage or any electronic voting machine so that it steals votes is to replace the cpu chip with fraudulent one that does not obey the instructions in the ﬁrmware to do this in 1980 might have required million dollars to design new processor chip and fabricate it in silicon however using modern technology it can be done for few dollars in parts and few weeks of time by an engineer trained at the bachelors degree level 124 the way to do this is via ﬁeld programmable gate array fpga this is commercially available silicon chip that can be programmed to simulate any kind of cpu chip programmable gate arrays can be slower than the chips they simulate by factor of 10 or more however modern computer chips are well over 1000 times faster than the computer chips of the z80 era therefore it is easy to program modern fpga to simulate an ancient z80 125 computer hobbyists have already programmed z80 simulation into an fpga and published the entire design speciﬁcation28an fpga chip that can be pro grammed to simulate the z80 costs about 1329to have an fpga chip profes sionally custommolded into plastic chip package that would mimic the z80 on the motherboard would cost 40 each in quantities of 300 or more or 60 in quan tity 5030 126 the fraudulent processor chip would be built as follows one would start with the readily available design speciﬁcation for the z80 processor implemented in 28zxgatesourceforgenet 29xilinx spartan 3 at emwcsavnetcom 30quikpak ic packages assembly prototype services san diego ca 46the fpga one would install fraudulent votestealing ﬁrmware inside the same fpga 127 the attacker would install this fake z80 in place of the real z80 on the mother board he would not touch the rom chips that contain the legitimate votecounting ﬁrmwarehe would leave them alone on the motherboard however the computer program ﬁrmware in the fake z80 would choose when to fetch instructions from the legitimate roms and when to ignore those instructions and use its own internal instructions 128 the behavior of the voting machine will be the same as if the roms were replaced by fraudulent ﬁrmware the machine would cheat in elections but it would not cheat in circumstances where it is likely to be detected the fraudulent election program will interact with the voter and with the results cartridge in almost the normal way except of course that it writes the wrong votes into the results cartridge and prints the wrong votes to match onto the results report printout 129 to replace the z80 processor chip it must be unsoldered from the motherboard desoldering tools are widely available in range of prices from 30 and up fig ure 18 shows highperformance industrial desoldering device that sells for 649 1210 this attack requires more work and more sophistication to perform instead of taking week to design fraudulent rom chip it might take several weeks for person to prepare this attack however new science needs to be invented all the techniques are well understood and all the processes and parts are easily affordable 1211 fraudulent processors are of concern to many scientists report from the national institute of standards and technology used by committee of the federal election assistance commission as the basis for resolution on voting machine standards explicitly discusses this kind of fraudulentprocessor hack under the term asic for applicationspeciﬁc integrated circuit see paragraph 162 of our report for more discussion 1212 to examine the computersecurity implications of fraudulent processor chips researchers at the university of illinois built fraudulent processor chip based on the sparc computer made by sun microsystems31they write current defense 31designing and implementing malicious hardware by samuel t king joseph tucek an thony cozzie chris grier weihang jiang and yuanyuan zhou in proceedings of the first usenix 47figure 18 desoldering tool uses heat to melt the solder and vacuum pump to suck it out of the joint can be used to remove z80 processor chip from avc advantage motherboard wwwhowardelectronicscom edsynzd500dxhtml 48techniques are completely ineffective against malicious processors then they go on to speculate about how in the future it might be possible to detect fraudulent processor chips 1213 the us department of defense is concerned that fraudulent processor chips fabricated in china and then installed in us military networks could contain extra fraudulent circuitry these fraudulent computers could purposely leak secret data that passes through them therefore the dod funds reseach by the ibm research laboratory among others to ﬁnd way to detect fraudulent processor chips32 this research being done by ibm is interesting from scientiﬁc point of view but it is years away from application to tool that new jersey election ofﬁcials could use 1214 conclusion replacing processor chips with fakes that cheat is recognized threat not only in voting computers but in other applications as well 13 would anyone go to these lengths 131 it might seem that person would spend half year of his time to reverse engineer the ﬁrmware of voting machine or design fraudulent computer chip on an fpga however political campaigns are very highstakes contests candidates for president will spend hundreds of millions of dollars to be elected and they beneﬁt from thousands of volunteers that spend enormous amounts of time and money to get their candidates elected some of these partisans cross the line into unethical or downright illegal tactics half year is not such lot of time we have spent far more than that just in explaining the technology issues in voting machines to the public 132 in addition there is an aspect of puzzlesolving that motivates some com puter programmers to take on challenge like this some computer hackers spend months developing clever new computer virus that costs the world millions of dollars and countless hours of inconvenience mostly they have done this for the fun of it not for expectation of reward new computer viruses appeared year after year before anyone ﬁgured out how to exploit them for criminal proﬁt workshop on largescale exploits and emergent threats leet april 2008 32trojan detection using ic fingerprinting by dakshi agrawal selcuk baktir deniz karakoyunlu pankaj rohatgi and berk sunar in ieee symposium on security and privacy 2007 49133 thus the time required to design votestealing hack is not enough to be substantial deterrent 14 there is means to reliably detect fraudulent ﬁrmware in vc advantages 141 we have described methods by which an attacker could install new ﬁrmware in the vc in general it is almost impossible to detect this fraud from any external observation of the voting machine 142 we will describe procedure that an election ofﬁcial could use in principle to test the rom chips however this method is fraught with difﬁculties which we will explain also this method for testing rom chips does notwork for detecting fraudulent z80 processor chips there is practical method that new jersey election ofﬁcials could use to detect fraudulent z80 processor chips 143 the procedure for examining rom chips is unscrew the circuitboardcover screws carefully pry out each rom chip insert each rom chip into rom reader device attached to pc copy the contents of the rom to the pc and compare with reference standard using computer program then replace the roms into the circuit board screw everything back together and run the machine through pre lat to make sure that the roms were put back in the right places 144 election ofﬁcials in new jersey have ever performed this procedure based on documents produced by the state of new jersey in connection with this lawsuit 145 this procedure cannot catch the replacement of roms at the polling place while they sit unattended for up to three days before the election 146 this procedure cannot easily be done in the presence of witnesses from the political parties in such way that they can trust that the test is being performed accurately and legitimately this is because it depends on the software running in the pc that is testing the roms in effect we are using one piece of software to check on another if we were witnesses to this procedure even with all our expertise we would have way of knowing that the testing software in the election ofﬁcials pc is doing what it is supposed to an ordinary citizen serving as witness representing political party would be in better position than we would 50147 additionally using romtesting devices could easily contaminate legitimate rom chips the pc that is used for testing roms may carry virus millions of innocent pcs on the internet have been infected by viruses that cause them to do the bidding of those who created the virus33at the very least an attacker who gained control of the testing computer by means of virus from the internet could install fake testing software that gives pass to fraudulent rom chips at worst fake testing software can modify the contents of the rom to install fraudulent votestealing ﬁrmware instead of reading and testing it 148 as we explained in paragraph 1213 there is standard method for detect ing fake processor chips although scientists are pursuing this goal even if such method were to be developed it would require new jersey election ofﬁcials to des older and remove the z80 processor chips which runs the risk of damaging them the attacker who is replacing them with fake processor chips does not mind dam aging the ones he is removing in contrast to election ofﬁcials who would need to test and reinstall them therefore fraudulent votestealing z80 processor chips are not practically or reliably detectable 15 many insiders have access sufﬁcient to tamper with vc advantage voting machines 151 there are many insiders who have sufﬁcient access to voting machines to install fraudulent ﬁrmware these insiders include employees of the superintendent of elections from maintenance logs provided by camden county it appears that camden employs at least 8 electionmachine technicians34these insiders include private companies who service the voting machines35these insiders include the delivery company who delivers vc advantage machines to the polling places 33press release fbi national press ofﬁce june 13 2007 the majority of victims are not even aware that their computer has been compromised or their personal information exploited said fbi assistant director for the cyber division james finch an attacker gains control by infecting the computer with virus or other malicious code and the computer continues to appear to operate normally 34bates numbers cam 0003000444 35for example at least two employees of election support services inc of medford nj perform setup ballot veriﬁcation audio test and prelat test for the county of camden letter from ess to county of camden january 22 2008 bates number cam 000295 51and sometimes to the wrong place36 152 in many parts of the 20th century corrupt political machines particularly in new jersey but elsewhere as well manipulated elections from the inside by trolling the election workers even in recent decades there have been several cor rupt elected and appointed ofﬁcials even in new jersey 153 in general we should assume and believe that the people who run our elections are honest but even so we permit party challengers to witness the events in the polling place that is we strive to achieve elections that are sufﬁciently auditable and witnessable that the public and the losing candidate can trust that the outcome is legitimate without having to trust the individuals who run the elections 154 vc advantage machines which can be hacked either inside or outside the warehouse cannot achieve this level of trust 16 the danger of fraudulent ﬁrmware is widely recognized by experts 161 we have explained that hidden changes to the software ﬁrmware of voting machine can indetectably change the outcome of an election many computer sci entists and election experts came to recognize the importance of this problem in the years 19992004 by which time it was wellestablished scientiﬁc consensus 162 the federal election assistance commission eac formulates standards for voting machines having taken this role over from nased37in 2005 in 2006 the eacs technical guidelines development committee tgdc asked the na tional institute of standards and technology nist to draft report explaining this concept and deﬁning appropriate terms this report38was then used as basis for discussion at december 2006 meeting of the tgdc of the eac 163 the report deﬁnes the term software independence voting system is softwareindependent if previously undetected change or error in its software 36see footnote 12 on page 28 also locations of replacement machines for presidential pri mary the delivery company delivered two machines to the wrong place bates number cam 0001 37national association of state election directors 38requiring software independence in vvsg 2007 sts recommendations for the tgdc draft report national institute of standards and technology november 2006 52cannot cause an undetectable change or error in an election outcome that is the votes should be countable auditable independent of the behavior of any computer software this is because 1 software is so complex in general that it is not pos sible to be conﬁdent that it is adding the votes correctly and 2 it is inherently difﬁcult or impossible to know what software is currently installed inside voting machine or computer 164 the report explicitly notes that software encompasses not only the ﬁrmware inside the voting machine but also other computer chips in the machine that is it addresses not only the romreplacement hack that we discussed in section 4 but also the fake z80 processor that we discussed in section 1239 165 the technical guidelines development committee of the eac at its decem ber 2006 meeting on the basis of the deﬁnitions in the nist report adopted resolution calling for software independence in the next generation of voting sys tems standards40 166 paperless dre voting machines such as the vc advantage41lack this crucial quality of software independence the results of the election in each precinct are reported at the complete discretion of the program which is in control of allof the records of the votes up until the time of the close of the polls that means that paperless dres are inherently susceptible to fraud and error 167 evidence for consensus experts in computer science who have also devel oped expertise in election technology have reached an overwhelming consensus that software independence is necessary in voting and that paperless dres are unacceptable we will explain the evidence for this statement 168 the election technology library is designed to serve as clearinghouse of information related to election technology and has policy agenda according 39it should be noted that in software independence software is really means complex tech nology which can be software implemented on hardware eg burned into proms or built into asics software independence should be interpreted to really mean complex technology indepen dence from nist report cited above 40resolutions adopted by the technical guidelines development committee at the december 4 5 2006 plenary session httpvotenistgovadoptedresolutions12040506pdf 41of course the vc advantage has paper printer inside the cabinet which does not operate while votes are being cast and the fullface voterpanel is covered by large sheet of paper on which the names of candidates are printed by paperless we mean that there is paper ballot for each individual voter that the voter can verify before casting and which can be recounted by humans without software programs interpreting the ballots to them 53to their website42they publish whos who in election technology com prehensive list of election technology professionals and those related to election technology that lists 52 individuals and several organizations in our examination of their list we found it to be representative and reasonably comprehensive of these 52 individuals we identiﬁed 25 as having education expertise and back ground in computer science or related technology as opposed to others who are primarily expert in election administration and political science 169 of these 25 election technology experts 22 of them43have joined this consen that paperless dres such as the vc advantage are unacceptable either by endorsing the resolution on electronic voting44or by publishing research papers or both one of them45has made public statement one way or the other per haps because as director of nist he feels it is inappropriate to do so only two of them46have made public statements indicating conﬁdence in paperless dres 1610 more evidence for consensus the association for computing machinery acm is the international scientiﬁc and professional society for computer sci ence computer scientists and computing professionals it publishes the leading journals and organizes the leading scientiﬁc conferences in the ﬁeld of computer science the us public policy committee of the acm recommended and the acm adopted this policy position v oting systems should also enable each voter to inspect physical eg paper record to verify that his or her vote has been accurately cast and to serve as an independent check on the result produced and 42httpwwwelectiontechnologycom 43andrew appel matt bishop matt blaze david chaum lorrie cranor david dill edward felten harry hochheiser rush holt harri hursti david jefferson doug jones rebecca mercuri ronald rivest avi rubin bruce schneier ted selker barbara simons warren smith roy saltman david wagner dan wallach 44computerized voting equipment is inherently subject to programming error equipment mal function and malicious tampering it is therefore crucial that voting equipment provide voter veriﬁable audit trail by which we mean permanent record of each vote that can be checked for accuracy by the voter before the vote is submitted and is difﬁcult or impossible to alter after it has been checked many of the electronic voting machines being purchased do not satisfy this re quirement v oting machines should not be purchased or used unless they provide voterveriﬁable audit trail when such machines are already in use they should be replaced or modiﬁed to provide voterveriﬁable audit trail providing voterveriﬁable audit trail should be one of the essential requirements for certiﬁcation of new voting systems httpwwwveriﬁedvotingfoundationorgarticlephpid5028 45hratch semerjian 46michael shamos brit williams 54stored by the system47 17 conclusion of part i 171 creation and installation of votestealing ﬁrmware in an vc advantage is straightforward and we have demonstrated it one approaching an ad vantage voting machine in new jerseywhether voter party challenger or an election ofﬁcialcan have any justiﬁable conﬁdence that the machine is legitimately counting the votes 47httpusacmacmorgusacmissuesev otinghtm 55part ii daughterboard and wineds viruses can disenfranchise voters 172 summary the audiokit daughterboard of the vc advantage 900 contains its own computer which is very susceptible to viruses we have installed new ﬁrmware the daughterboard simply by inserting an ordinary audioballot cartridge without changing any roms at all virus carried this way into the daughterboard can steal votes cause machines to fail in targeted ways and propagate itself both to other vc advantage voting machines and to wineds computers where votes are tabulated 173 in part i we described how malicious ﬁrmware can be installed on the vc advantage motherboard with tools as simple as screwdriver in this part we will describe how fraudulent ﬁrmware can be installed in another computer inside the vc advantage using tools at all in fact because this installation is done in the ordinary course of inserting an audioballot cartridge it can be done inadvertently by perfectly honest pollworker 174 in addition because this fraudulent ﬁrmware can then copy itself onto any new audioballot cartridge later inserted into the vc advantage the fraud can become acomputer virus that propagates itself from one vc advantage to another 175 we have found that such virus can jump to wineds computers that is com puters used in the election warehouse to prepare new ballot cartridges and to tab ulate election results such virus could then change vote data in the election database and modify the tabulated results we have found that the wineds com puters are very vulnerable to hacking from the internet 176 from wineds computers the virus can jump back to other vc advantage voting machines 5618 the audiokit daughterboard is second computer in the vc advantage 181 the vc advantage 900 has an audio kit containing its own computer any voter who wishes to vote by audio instead of on the large printed buttonsand lights voter panel is permitted to do so v oters might wish to vote by audio because of vision impairments mobility impairments inability to read or for any other reasonindeed voters are not required to state the reason they wish to vote by audio 182 the audiokit computer resides on daughterboard inside the cabinet but separate from the main circuit board of the vc advantage which is called the motherboard 183 unlike the motherboard ﬁrmware described in part i the ﬁrmware of the daugh terboard does not reside in rom it resides in ﬂash memory the ﬂash memory contains the election control program as well as ballot deﬁnitions and other ﬁles unlike rom which cannot be modiﬁed without removing and replacing physical computer chips ﬂash memory can be written and rewritten by the software or ﬁrmware inside the computer 184 therefore ﬁrmware in ﬂash memory is inherently more vulnerable to fraud ulent replacement than ﬁrmware in rom the fact that the election program can write to the very memory that stores the election program is potentially very dan gerous in fact sequoias design of the daughterboard is in violation of the federal election commission 2002 and 2005 v oting systems standards48 185 storing ﬁrmware in writable ﬂash memory opens the possibility that an attacker can install fraudulent ﬁrmware without anyphysical change to the voting machine in fact we have demonstrated that this is possible on the vc advantage in this part of the report we describe how computer virus can spread itself to many vc advantage machines once installed the virus can steal votes or selectively disable voting machines 48the electionspeciﬁc programming may be installed and resident as ﬁrmware provided that such ﬁrmware is installed on component such as computer chip other than the component on which the operating system resides fec 2002 v oting systems standards sec 641 fec 2005 v oluntary v oting systems guidelines sec 741 but in fact we have found that the same ﬂash memory chip on the daughterboard holds both the operating system and electionspeciﬁc programming 5719 one can install fraudulent daughterboard ﬁrmware by inserting cartridgeeven unwittingly 191 summary one can install fraudulent ﬁrmware into the daughterboard simply by inserting cartridge into the slot in the daughterboard this takes one or two minutes the person inserting the cartridge does not even need to know that the cartridge is perpetrating fraud 192 it is easy and straightforward to install fraudulent ﬁrmware into the daughter board memory there are at least two different ways it can be done 193 method 1 installing ﬁrmware by means of cartridge we have used this method to install ﬁrmware into the daughterboard and to remove it again figure 19 audio ballot cartridge front and back notwithstanding the text printed on the cartridge this is not results cartridge 194 the audiokit has slot on the top dimensions about 25 inches by 38 inches for the insertion of an audio ballot cartridge the cartridges that ﬁt in this slot as provided to us by union county nj are in the pcmcia format pcmcia cards are standard on laptop computers they are about the dimensions of credit card but 18 of an inch thick49 195 the audioballot cartridges are labeled results cartridge which causes some confusion because the sequoia 900h also accepts another cartridge called results cartridge of dimension 7x4x1 inch that ﬁts into different slot in fact the smalldimension audiokit cartridges do not hold results they usually hold audio ballot data that is sound recordings of the names of candidates and contests on other models of sequoia voting machines such as the vc edge and the ver 49the sequoia cartridges are in plastic packaging that makes them thicker about 516 inch so they dont ﬁt in normal computer pcmcia slot unless an extender card is used 58sion 10 vc advantage these pcmciaformat cartridges do serve to hold results among other things as we will explain in section 61 196 in fact pcmciaformat cartridges can hold any kind of data at all including audio data ballot data and executable programs the cartridge is formatted as standard microsoft fat ﬁle system just like ordinary computer ﬂoppy disks hard drives and in fact just like ordinary pcmcia memory cards 197 the daughterboard ﬁrmware is stored in 2megabyte ﬂash memory which is also formatted as fat ﬁle system this runs doscompatible operating system when the voting machine is turned on the operating system executes au toexecbat just as on any 1990sera personal computer that ran the microsoft operating systems 198 199 1910 in devices that contain ﬁrmware in ﬂash memory where it is desired to be able to update the ﬁrmware later it is common industrial practice to use an au toexecbat design similar to what sequoia has done in the vc advantage at left generic pcmcia memory card inserted into the side of laptop computer the sequoia audioballot cartridges are pcmcia memory cards but made thicker by being encased in plastic so they do not ﬁt into the standard slot unless an extender is used of the type shown at right 59daughterboard however this design makes it extremely easy to install fraud ulent ﬁrmware into the daughterboardsigniﬁcantly easier than replacing rom chips therefore this practice is not recommended for securitysensitive equipment that can be accessed by malicious attackers appel has informed new jerseys v oting machine examination committee chaired by richard wood bridge esq of his concern about this problem in relation to certiﬁcation of vc advantage version 10 machines with printer attachments50 1911 to install fraudulent ﬁrmware in an vc advantage 900g or h one has to perform the following steps note that all but the ﬁrst step are routinely performed by honest election workers in the normal course of preparing avc advantage ma chines for elections 1 prepare pcmcia cartridge with new programs in the install folder it can be generic pcmcia memory cartridge cartridge from sequoia is not needed this preparation can be done on any ordinary laptop computer 2 open the back door of the voting machine using the key or by picking the lock see section 9 3 remove any installed pcmcia cartridge if any by simply pulling it out seal is used on this cartridge screws need to be unscrewed 4 insert the new cartridge 5 turn on the voting machine the ﬁles will be automatically copied from the cartridge into the daughterboard this whole process takes just minute or two it is easier than replacing roms because tools are needed at all 1912 before each election election workers insert an audioballot cartridge into ev ery vc advantage voting machine to inform the computer how to pronounce the names of the candidates on the ballot if an attacker has put fraudulent ﬁrmware into the install folder of the audioballot cartridge then the election worker will then be unwittingly installing that ﬁrmware into the vc advantage this means that the attacker never even needs physical proximity to an vc advantage voting machine to perpetrate this attack we will discuss this further in section 20 50letter from andrew w appel to richard woodbridge emailed via robert giles director division of elections nj department of state may 27 2008 httpwwwcsprincetonedu appelvotingappel22may08hearingpdf 601913 even if sequoia were to ﬁx the very severe vulnerability in its autoexecbat second method of installing fraudulent ﬁrmware in the daughterboard would still exist there is straightforward method of mitigating this second method 1914 it is common and necessary industrial practice to provide means to install ﬁrmware into the ﬂash memory of computer such as the daughterboard this is because when the daughterboard is ﬁrst manufactured its ﬂash memory contains program that could perform copying via the autoexec method also such second method would be necessary if the contents of ﬂash memory gets scrambled by hardware or software failure so that the autoexec method longer works 1915 to use this second method one would have to unscrew 5 screws to open the sheetmetal box containing the daughterboard and one would plug the daughter board into special equipment in 1999 this equipment compulab 486base was available for 3051this vulnerability cannot be mitigated 20 votestealing computer viruses can infect vc advantage and wineds 201 summary not only is it easy to install fraudulent ﬁrmware in the daugh terboard worse yet there is very severe vulnerability to ﬁrmware viruses that propagate through audioballot cartridges we have demonstrated the feasibility of virus that propagates from vc advantage voting machines onto wineds computer carried on the cartridge single virus can propa gate onto all the wineds computers and the vc advantage voting machines used in county or state this means that an attacker can install fraudulent ﬁrmware without needing physical access to voting machines 202 computer virus is program that can copy itself from one computer to an other either through computer networks or through removable media such as car tridges in addition to merely copying itself the virus may also have payload that performs some malicious act such as stealing money via fraudulent ﬁnancial transactions forwarding spam email or stealing votes inside election ﬁrmware 203 we have found that virus can propagate through the vc advantage to other vc advantage machines from vc advantage machines to wineds comput 51peewee pc sports pintsized price electronics design news august 19 1999 httpwwwedncomindexasplayoutarticlearticleidca46087 fetched august 25 2008 61ers from wineds computers to other wineds computers and from wineds computers to vc advantage machines 204 the wineds software sold by sequoia is used by county election workers to prepare ballot deﬁnitions and to tabulate votes wineds runs in an ordinary desktop or laptop pc running the microsoft windows operating system 205 election workers use wineds to to write ballot deﬁnitions into results car tridges and audio ballot cartridges before an election these cartridges are then inserted into voting machines before the machines are transported to the polling places after the election the cartridges are removed from the machines and trans ported back to county election workers who then use the wineds software to extract the election results and cumulate the results from all the precincts 206 propagation happens as follows 1 when an infected audioballot cartridge that is one containing the virus is inserted into an vc advantage voting machine the virus propagates into the internal ﬂash memory of the audiokit daughterboard 2 after that time the virus resides in the internal memory of the daughter board if any uninfected cartridge is later installed into that voting machine the virus copies itself onto that cartridge that cartridge is now infected 3 when an infected audioballot cartridge is inserted into wineds computer eg to prepare audioballots for the next election the virus copies itself into the microsoft windows operating system on that computer by mech anism we will describe in section 22 4 after that time when an uninfected cartridge is inserted into the wineds computer the virus will copy itself into the cartridge thus infecting the car tridge 5 also while the virus resides on the wineds computer it can copy itself onto other wineds computers on the same network 6 viruses can also infect the wineds computers when they are connected to the internet and used for web browsing we found that the union county wineds computer had been used for substantial amount of internet surf ing see section 234 62207 like any computer virus the votestealing virus has two parts the propagation part which copies the virus from one computer to another and the payload which accomplishes the attackers goals the payload of personalcomputer virus might steal ﬁnancial data or be platform for sending spam votingmachine viruss payload changes vote data either in the voting machine during elections or in the election management system wineds in the next two sections we will describe propagation then we will describe the harm the viruss payload can cause 21 viruses can propagate through the vc advantage 211 summary the design of of the audio kit and its cartridge interface causes very severe security vulnerability the ability to virally propagate fraudulent software from one voting machine to another52 212 although the attack propagates through audioballot cartridges it works even if voters ever use the audiovoting feature 213 52a similar design ﬂaw was found in 2006 on diebold accuvote machines by hursti and by feldman et who also demonstrated how an attacker can use this vulnerability to propagate votestealing viruses similar design ﬂaw was found on the sequoia vc edge in 2007 by blaze et diebold tsx evaluation security alert may 11 2006 critical security issues with diebold tsx by harri hursti httpwwwblackboxvotingorgbbvreportiiunredactedpdf security analysis of the diebold accuv otets v oting machine by ariel j feldman j alex halderman and edward w felten in proceedings 2007 usenixaccurate electronic voting technology workshop evt 07 august 2007 source code review of the sequoia v oting system by matt blaze arel cordero so phie engle chris karlof naveen sastry micah sherr till stegers and kaping yee report commissioned by the secretary of state of california released july 20 2007 httpwwwsoscagovelectionsvoting systemsttbrsequoiasourcepublicjul26pdf 63214 the fraudulent subsysexe program does not need to limit itself to audio voting as we will explain in section 24 it is computer program with complete control of what the daughterboard does 215 216 to verify experimentally that all of this works as we have described it we wrote program and copied into an audioballot cartridge using an ordinary desktop pc then we inserted the audio ballot cartridge and veriﬁed that the vc advan tage installed our program as ﬁrmware in the daughterboard we veriﬁed that our program took control of the daughterboard and copied itself into an audioballot cartridge these are all the steps that virus would need to take 217 one can start the propagation of votestealing viruses through wineds and vc advantage machines very easily with access to any one of the following sequoia audioballot cartridge that will be used in some future election an unattended vc advantage voting machine with or without the audio ballot cartridge installed an unattended wineds computer web site that user of the wineds computer visits any computer on the internet that can send message to the wineds com puter if that computer is conﬁgured to accept such connections as union countys machine is see section 236 218 conclusion an attacker can easily inject virus into the winedsadvantage system that infects all the vc advantage machines in county or state 22 viruses can propagate through wineds computers 221 summary viruses can easily propagate through wineds either from the internet or through audioballot cartridges one virus can propagate onto all 64figure 20 at left results cartridge readerwriter at right wineds computer the wineds computers and vc advantage voting machines used in county or state this is very severe vulnerability 222 the wineds software runs on ordinary personal computers running microsoft windows union county new jersey provided to us for examination one computer with the wineds software installed the computer is dell latitude 110l laptop computer running microsoft windows xp sp3 and with wineds 31 installed the computer is identiﬁed in the computer description of its system properties as warehouse laptop 1 therefore we will assume it is one of several laptop computers that union county uses in the warehouse in which it also stores its vc advantage voting machines wineds computers are used by new jersey counties not only in warehouses storing voting machines but in other locations as well53 223 the computers that run wineds in union county are severely vulnerable to viruses from cartridges and to attacks from the internet as we will explain in this section and the next as there is there is reason believe that the union county computers are in any way different from votingmachine warehouse com 53in telephone discussion august 2008 with james j v okral administrator middlesex county board of elections appel learned that middlesex uses wineds computers in its election warehouse in edison nj as well as in the board of elections ofﬁce in new brunswick nj 65puters used in other counties in new jersey our conclusions generalize to the entire state 224 the wineds computer is equipped with reader for largeformat results car tridges this reader connects to the computer by usb port smallformat audio ballot cartridges connect into the standard pcmcia port of the laptop computer using standard pcmcia extender card 225 when pcmcia ﬂash memory card such as an audioballot cartridge is plugged into the pcmcia port of standard microsoft windows laptop computer the windows operating system views the data on the card as removable disk this is the case on the union county computer we examined and we will presume that other electionwarehouse computers in union county and other counties are conﬁgured similarly 226 the sequoia audioballot cartridges which are standard pcmcia cartridges in nonstandard plastic case operate exactly in the standard way when plugged into microsoft windows computer on microsoft windows when one inserts cdrom disk the folders in that disk become visible just like folders on the internal hard drive similarly when one inserts the audioballot cartridge into windows computer that runs wineds the cartridge is automounted as folder that is visible to windows applications and to windows explorer 227 in microsoft windows when removable media such as pcmcia or cdrom is inserted and automounted windows normally searches it for ﬁles such as au toruninf which cause program from the removable media to be executed as windows application this is the case on the union county computer 228 it is well known to hackers and to computersecurity experts that the autorun feature is way that viruses can be propagated54this feature means that the pc unsafely runs an arbitrary program that is stored on any cartridge inserted into the pc if this program is virus the audioballot cartridge it will easily infect the wineds computer when that cartridge is inserted such insertion normally occurs before an election for the purpose of copying the audioballot ﬁles into hundreds of audioballot cartridges for all the countys voting machines 54even if autorun were to be disabled the automount feature of windows sometimes contains exploitable vulnerabilities that permit malicious software on insertable media such as pcmcia cartridges to take control of the host pc and install viruses 66229 once the virus propagates onto the wineds computer it can do many things 1 cause wineds to fraudulently miscount votes when it accumulates the re sults from different precincts 2 cause wineds to write fraudulent ballot deﬁnitions into largeformat re sults cartridges 3 propagate itself into other audioballot cartridges either within the county or in different county and thereby infect other vc advantage voting machine daughterboards 4 propagate itself through the internet or through county or state internal net works to other wineds computers these wineds machines are routinely connected to the internet already even if that were not the case as the state of new jersey moves towards centralized voterregistration database the election computer networks of the counties will be inevitably connected to each other or to state network this increases the risk that viruses can spread throughout the state 2210 ineffectiveness of antivirus although the wineds computer used by union county is equipped with an antivirus program55this kind of antivirus provides useful protection against specialized votestealing virus the reason is that antivirus programs work by recognizing known viruses and are ineffective against newviruses when personalcomputer virus propagates around the world to mil lions of pcs the makers of antivirus software eventually notice it and rush to mod ify their antivirus software to detect the new virus however if virus propagates just to few dozen machines in the internal network of state or county election ofﬁcials then the makers of antivirus software will never see it thus they will not be able to update their antivirus program to detect and remove the votestealing virus 23 wineds computers have severe security vulnerabilies and are routinely connected to the internet 231 summary votestealing viruses can propagate into wineds computers from the internet union countys wineds computer and the wineds election management program and data on it is severely vulnerable to attack from the 55symantec antivirus v10022000 updated june 25 2008 delivered to us 1 july 2008 67internet the general security conﬁguration of the machine is wide open in addition there is an enormous amount of casual internet browsing by election employees this means outsiders can interfere with preparation of the ballots can modify the results as they are added up and change the data stored in the database 232 wineds runs on standard windows pc the union county system that we studied runs windows xp release sp3 with normal complement of programs like microsoft ofﬁce internet explorer 7 ie windows media player and so on 233 any system has security vulnerabilities and both windows and ie are known to have problems the fec guidelines require that if computer used to manage election information also includes browsers compilers database systems and the like they are governed by the requirements as well unless the software can be disabled or removed when voting system functions are enabled56 234 in general securitysensitive computers should not be used for extensive ca sual webbrowsing because untrustworthy web sites can cause spyware and viruses to be downloaded onto the computer however the union county machine has been used extensively for browsing on the web using internet explorer the list of temporary internet files maintained by ie shows large number of web sites visited for mail shopping personal banking streaming music pictures and checking news and sports results only small fraction relate to the ofﬁcial union county web site ucnjorg each of these visits typically triggers host of downloaded images and tracking information from advertising sites like doubleclick tacoda advertisingcom and so on the temporary internet files folder main tained by ie contains well over thousand such temporary ﬁles related to casual websurﬁng with dates over period of years including periods immediately be fore and after the february 2008 election and even visit to banking site on election day 235 at least one of the frequentlyused online services aols ampx music stream ing service is known to have serious vulnerabilities because of buffer overrun er rors this has been known for several years symantec describes this threat as hav ing high severity and observes that successful attack would corrupt process memory allowing arbitrary code to run in the context of the client application57 56vvs section 413 57symantec corporation httpwwwsymanteccomavcenterattack sigss50125html visited august 23 2008 symantec is well respected maker of antivirus and other security software 68that is the attacker using the ampx security vulnerability would produce mali cious music stream when user of the wineds computer listend to that music the malicious music stream would install virus on the wineds computer then the attacker could do practically whatever he wants on union countys wineds computer including modiﬁcations to the wineds vote database or the wineds votecounting program 236 computers running the microsoft windows operating system communicate with the outside world through huge variety of services and protocols each of these constitutes vector through which attackers on the internet can insert malicious software into the computer 237 computers that handle information whose integrity needs to be protected should have their operatingsystem services conﬁgured to minimize the number of attack vectors however the union county computer has large number of services au tomatically enabled and running including sql server universal plug and play net logon and remote registry each of these is potential vector for an attack on windows andor wineds the windows ﬁrewall is disabled as well port scan of the machine reveals several tcp ports and dozen udp ports open 238 one common vector that internet scammers use to infect pcs with malware is by email attacks opening bogus email attachment can cause malicious program to run on your computer the pc we examined is apparently not used for email but it may be routinely installed on the same network at the voting machines warehouse as other pcs that are used for email viruses can easily hop from machine to machine in the same local network it is extremely difﬁcult to truly secure the wineds computers 239 sequoia provides to its customers computing infrastructure hardening guide lines58that describe the necessary steps to assist clients in securing their infor mation systems infrastructure 2310 these steps are supposed to show how jurisdictions like union county can make their windows computers secure enough to run election management soft ware on this document describes very long very intricate sequence of steps some of the steps in the hardening process like editing the windows registry have the potential to disable the machine many of them imply level of expertise 58computing infrastructure hardening guidelines release version 2 sequoia v oting systems june 2008 69that would be scarce even in sophisticated computing environment eg step 98 enable ipsec to protect kerberos rsvp trafﬁc 2311 it would be difﬁcult for county to comply with these guidelines they require high level of sophistication to appreciate and apply consistently and correctly even according to system administrators should be highly skilled in the appropriate technologies of windows administration and security59 2312 based on our examination of union countys warehouse wineds computer union county has not even come close to complying with these guidelines and in fact has left open variety of security holes even according to sequoia this guide is not adequate to even begin to protect the infrastructure if the network is allowed to be connected to external networks60but union county has rou tinely connected its computer to the internet and we found other ways in which the guidelines were not followed 2313 even if county did fully comply vulnerabilities would remain sequoia says this guideline provides only portion of the information needed to fully protect the jurisdictions election computing infrastructure61 2314 in addition following these guidelines to the letter risks disabling some of the necessary functionality of wineds or other legitimate electionmanagement applications 2315 in conclusion wineds is highly vulnerable to tampering and there is sim ple way to make it invulnerable the cost of doing so would be prohibitive it would require the counties to have information security ofﬁcers with substantial expertise and would require substantial time and constant vigilance by these ofﬁ cers and would require substantial training of users election workers 2316 once virus or internet attack has infected either wineds computers or vc advantage voting machines it can change votes and selectively disenfranchise vot ers as we will explain in section 24 2317 on wineds computers malicious software can change ballot deﬁnitions before elections and change vote data after elections these changes will not 59idstep 5 the document is unpaginated 60idstep 5 61idstep 5 70always be detectable by auditing especially the kind of ballot manipulation that we describe in section 43 24 the daughterboard can steal votes or selectively disable voting machines 241 in addition to the z80 computer on the vc advantage motherboard the vc advantage version 900 contains second computer called the daughterboard which is used in audio voting 242 on vc advantage voting machines fraudulent ﬁrmware in the daughterboard 1 can steal the votes of blind voters or of any voters who use audio voting 2 can selectively cause voting machines to fail on election day in precincts chosen by the attacker see section 24 243 on the version 9 vc advantage the daughterboard does not directly write votes to the results cartridge the motherboard controls the results cartridge and communicates with the daughterboard via messages sent through cable62 when voter votes using audio the daughterboard presents the ballot aurally to the voter and communicates candidate selections to the motherboard 244 audio voters use an input device that is connected to the daughterboard not the motherboard thus it is very easy for fraudulent daughterboard ﬁrmware to steal the votes of audio voters simply by conveying different candidate choices to the motherboard the votes of disabled voters are even more at risk on the vc advantage than the votes of those who use the fullface voter panel 245 in addition the attacker can cause voting machines to fail in selected set of precincts for example if he disables dozen or two voting machines in heavily democratic election districts across the state then long lines of voters may form and some voters may leave the polling place before voting the signiﬁcance of doing this attack via daughterboard virus is that single person can disable voting machines in hundreds of precincts that he chooses without ever going near any of those machines 62a threewire rs232 serial connection 71246 to do this the attacker then programs an audioballot virus replacing the audiovoting software on the daughterboards of all vc advantage voting ma chines in new jersey 247 on election day when each machine is turned on one of the ﬁrst things that the motherboard does is to send message to the daughterboard saying paraphrase load the audio ballot and the daughterboard normally responds saying phrase ok however the fraudulent daughterboard software responds with different message either one of the following cannot load ballot then the vc advantage motherboard will display an error message on the operator panel and the election cannot start specially crafted message that triggers the buffer overrun bug described in appendix b this causes the machine to reboot in an inﬁnite loop or for as many repetitions as the daughterboard chooses in either case the vc advantage will fail to start up on the morning of election day or will be delayed for chosen number of minutes 248 the audioballot cartridge loaded in the daughterboard contains the name and number of the election district in which the machine will be used thus the daugh terboard ﬁrmware has enough information for an attack on speciﬁc precincts this allows selective denial of service to speciﬁc demographic groups 249 this general means of manipulating elections is well understood in ohio in the 2004 presidential election the misallocation of voting machines led to precedented long lines that disenfrachised scores if not hundreds of thousands of predominantly minority and democratic voters63selective disabling instead of misallocation could produce similar result 25 genius required for daughterboard attacks 251 the daughterboard virus is very elementary attack virus programming is not much taught in schools but unfortunately there are many practitioners of it 63what went wrong in ohio the conyers report on the 2004 presidential election ed by anita miller produced at the request of representative john conyers jr by the democratic staff of the house judiciary committee 2005 72nonetheless there tens of thousands of known computer viruses64 252 for this particular virus programming not even bachelorsdegree level of skill is necessary the daughterboard is an intel486compatible computer running dos operating systemjust like the hardware and software of the ibm pcs from about 1990 millions of pc users gained familiarity with its scripting tools that would be helpful in creating viruses for the vc advantage daughterboard reverseengineering the daughterboard ﬁrmware 253 we found that it is also possible to reverseengineer the daughterboard ﬁrmware65 the daughterboard computer is made by compulab we were able to ﬁnd docu mentation for this computer on the internet compulab sold this computer for many applications not just voting machines and development tools are available for it using these development tools an attacker could extract the ﬁrmware and reverse engineer it then using the results of this analysis he could devise fraudulent ﬁrmware of the kind that we described in section 24 26 the motherboard is vulnerable to malicious daughterboard ﬁrmware 261 election workers prepare ballots for the vc advantage on wineds comput ers at the election warehouse or at the board of elections or other locations the electronic ballot deﬁnition loaded into the results cartridge speciﬁes not only the names of the candidates but several other options about the election in preparing ballot deﬁnition for the vc advantage one can choose the option to disable audio voting the largeformat results cartridge with this option setting is then loaded into the motherboard of the of the vc advantage this tells the motherboard not to use the daughterboard 262 one might hope that disabling audio voting would make the motherboard im mune to harmful effects from daughterboard virus unfortunately this is not the case because of mistake sequoia made in programming the motherboard 64az listing of threats and risks symantec inc httpwwwsymanteccombusinesssecurity responsethreatexplorerazlistingjsp 65note that in order to perform the romreplacement hack that is described in part i of this report the attacker does not need to know anything at all about the internals of the daughterboard or its ﬁrmware 73ﬁrmware the vc advantage is vulnerable even if the ballot deﬁnition says not to use audio voting 263 the programming error is known as buffer overrun and it occurs in the part of the motherboard program that reads input from the daughterboard delib erately malicious message from the daughterboard to the motherboard can trigger this bug causing the z80 computer on the motherboard to restart 264 when the vc advantage is ﬁrst turned on the z80 motherboard computer attempts to communicate with the daughterboard even if audio voting is disabled malicious message from the daughterboard can cause restart and then as the powerup sequence runs again to restart again in an inﬁnite loop if this occurs in polling place the voting machine will not be usable 265 the vc advantage can be made immune to daughterboard viruses only by removing the audio kits this removal is not difﬁcult and could be done by county election technician in few minutes 266 even so removing the audio kits is problematic for two reasons first it means that the vc advantage will not be usable by certain disabled voters without per to assist them which means that the advantage machines would not be v compliant second it cuts off the upgrade path to voterveriﬁed paper ballot since sequoias vvpat printer in its version 10 vc advantage is connected through the audio kit and not directly to the z80 motherboard 27 security vulnerabilities in wineds 31 271 summary the wineds electionmanagement software is known to be insecure based on studies done by the state of california in our examina tion we noticed some of the same weaknesses in wineds that were previously reported elsewhere 272 wineds is an election data system used for preparing ballot deﬁnitions for sequoia voting machines before elections and for cumulating results from sequoia voting machines after elections 273 in the summer of 2007 the secretary of state of california commissioned toptobottom review of the hardware and software of the voting machines then in use in california team led by professor matt blaze of the university of penn 74sylvania examined the source code of several sequoia products including wineds and the vc edge voting machine blaze did not study the vc advantage be cause it is not used in california 274 blazes team found many security vulnerabilities in wineds66such as wineds creates administratorlevel database accounts for all users does not encrypt or authenticate database communication does not remove database access for deactivated users changes account usernames incorrectly does not encrypt password change requests retrieves the default password in the clear on every login places the password sufﬁx in password entry ﬁeld displays the password sufﬁx when resetting passwords changes the password for the administrator incorrectly lets any user export data from the database data wizards import function does not work does not validate format string read from the database accepts negative vote totals from the database fails to check some function return codes contains many small buffer overﬂows trusts the list of precincts for which results cartridge claims to report votes and several more 275 it was not necessary for us to repeat the entire california study of wineds as that study was conducted in scientiﬁc manner by top computersecurity experts and we agree with their conclusions but we will comment here on speciﬁc in security that we observed experimentally in wineds that is speciﬁcally relevant to the security of the vc advantage voting machine the california study scribes it as integrity checking of results cartridges by wineds is not adequate to detect tampering and wineds fails to check the integrity of election results we found that one can change the vote totals andor audit trail in results car tridge and wineds will not notice anything amiss we will describe this further in section 40 28 conclusion of part ii 281 vc advantage voting machines and wineds votetabulation software are both severely vulnerable to viruses that can alter election results we have demonstrated the feasibility of creating computer virus that propagates from vc advantage machines to each other and to wineds computers such virus can 66source code review of the sequoia v oting system by matt blaze arel cordero sophie engle chris karlof naveen sastry micah sherr till stegers and kaping yee report commissioned by the secretary of state of california released july 20 2007 httpwwwsoscagovelectionsvoting systemsttbrsequoiasourcepublicjul26pdf pages 4356 75carry payloads that modify votes inside the vc advantage and modify election and vote databases in wineds the virus can also be programmed to erase itself from voting machines just before the polls close so as to avoid detection after the fact 282 the wineds system is very vulnerable to of cheating and manipulation an attacker could access the wineds computer either physically inside the voting machine warehouse or remotely from the internet internet attacks are feasible by all the means that ordinary windows pcs are successfully attacked every day on todays internet internet viruses websites containing spyware email phishing port scanning and viral propagation through audioballot cartridges 76part iii userinterface inaccuracies and insecurities can disenfranchise voters 283 the user interfacethe physical and logical design of how the computer inter acts with the human userof the vc advantage is ﬂawed in several ways that can cause votes not to be counted allow pollworkers to collude with voters to perpetrate vote fraud and cause other problems 284 the consequence as we demonstrate in the video that accompanies this report is that voters can be disenfranchised either unintentionally or maliciously 29 how we vote in new jersey 291 in most of new jersey the normal mode of voting is as follows67a voter ap proaches table where electionboard workers sit with pollbooks the pollbooks contain the names addresses and signatures of all voters registered in this election district precinct there are two electionboard workers at this table one from each political party at the same table there may also be challengers pollwatch ers representing the candidates or the parties the voter tells the board worker her name and address and signs the poll book in the space provided the voter also signs v oting authority ticket which is piece of paper approximately 4 inches square taken from bound pad of 100 tickets each ticket has serial number as does the stub remaining in the booklet when the ticket is removed at the perfo rations in some counties the voter also prints her name on the v oting authority ticket the pollworker removes the ticket from the pad and gives it to the voter 292 then the voter waits in line for voting machine there may be several voting machines serving the same precinct when she reaches the front of the line she hands her ticket to an electionboard worker who is standing next to the voting 67polling place procedures in this sections taken generally from ofﬁcial instructions for the dis trict board of elections middlesex county board of elections revised jan 2008 bates number middlesex 1048 from ofﬁcial instructions for members of the district boards of elections presi dential primary election february 5 2008 mercer county bates number mercer 004642 and from personal observation of polling place procedures in mercer county 77figure 21 small tion of the voter panel without the printed pa per ballot overlay machine he takes this ticket in some counties eg mercer but not others eg union he threads this ticket on string of tickets attached to the machine68in this way one can reconstruct exactly which voters voted on each voting machine and in which order 293 then the operator the electionboard worker at the voting machine presses the green activate button on the operator panel of the vc advantage voting ma chine if it is primary election he presses another button ﬁrst see section 565 this causes the machine to be activated ie to be ready to accept votes the vc advantage indicates this in three ways it emits barely audible chirping sound for 14 second it turns on the ﬂuorescent light on the inside of the top panel of the machine illuminating the inside of the booth and optionally it lights green x next to the name of each contest to be voted this last option is enabled in mercer county and disabled in union county at least in the february 5 2008 presidential primary 294 the voter panel dimensions 38x28 inches has 42 rows and 12 columns of buttons each about halfinch square just to the left of each button is green led light in the shape of an x 14 inch square the entire panel is covered by large sheet of paper on which the names of contests and candidates are preprinted one for each buttonlight that will be in use this paper is covered by transparent mylar sheet on the paper sheet next to each candidate name is printed box about halfinch square directly over button thus when voter presses this place on the mylar sheet the button underneath the paper is pressed when the advantage illuminates green x it shines through the paper and the mylar 68in general we have found it remarkable how different counties in new jersey have such different procedures for using the same voting machines they use different format of voting authority they use different ballotdeﬁnition options they have different procedures for announcing inprecinct elec tion results to the public different procedures for communicating these results to party challengers different practices with regard to emergency ballots and so on 78295 the z80 computer in the vc advantage can at any time read buttons and illuminate lights however the control ﬁrmware for the z80 does not actually interpret these buttons to indicate votes unless the machine has been activated by the operator 296 so after the operator has activated the machine the voter selects candidates by pressing on the buttons through the paper at spots indicated by printed squares green x appears by each candidate that the voter selects figure 22 green x appears by selected candidate if the voter presses the wrong button she can deselect the candidate by pressing the button again and the x disappears so that another candidate may be selected 297 also when button is pressed to select candidate an lcd display at the bottom of the voter panel about 30 inches from the ﬂoor displays the name of the contest and the name of the candidate this panel is about 375 inches wide and slightly over half an inch high it displays two rows of 24 gray letters on yellowgreen background 298 writein votes are cast by process described in section 36 figure 23 cast vote button 79299 after at least one vote is selected for at least one contest the machine illumi nates the cast v ote button in bright red this button about 78 inch by 12 inch is below the voter panel at the righthand side 2910 when voter is satisﬁed with her choices she presses the cast v ote button this causes the votes to be recorded the overhead light to extinguish the cast v ote button to darken and all the xs to disappear from the voter panel at the same time the machine emits chirping sound and the little lcd display under the voter panel changes to read vote recorded thank you figure 24 vote recorded thank you 2911 at time when candidates are selected either because the voter has not selected any or has selected and then deselected some the cast v ote button is unlit inactive and will not have any effect when pressed69 30 vc advantage falsely indicates votes are recorded when they are not 301 summary the vc advantage gives the false impression that it is record ing votes even when it is not doing so if voter tries to vote when the vc advantage is not activated then it will give three different kinds of visual feed back that the vote is recorded even though it did actually record the vote at all even though vote is recorded the advantage lights the x by each selected candidate button it illuminates the cast vote button when pressed 69this is the behavior when the ballot description programmed into the results cartridge specif ically prohibits blank ballots this is the setting used by union county in its 2008 presidential primary election 80and it displays vote recorded thank you on the lcd panel visible to the voter 302 this behavior can cause voters to believe that they have voted when in fact they have not voted the average voter is not intimately familiar with the modes of behavior of the vc advantage if the voter presses button and green x lights up by that button and the voter presses cast v ote and the cast v ote button lights up and the lcd display says vote recorded then the voter can easily believe that her vote has been recorded 303 this behavior which we found in our examination of the vc advantage vot ing machine is consistent with experiences reported by voters in certiﬁcations ﬁled with the court70 304 this behavior is consistent with the evidence of 1 lostvote rate in pennsauken election district 6 camden county where there were 283 democratic voting authority stubs but only 279 or 280 votes cast see figure 36 305 if the voter enters the booth when the operator has notpressed activate on the operator panel then the vc advantage will not count votes but the vc advantage gives three different visual cues that can easily mislead the voter into believing her vote was counted even if the operator has not pressed activate the vc advantage behaves as follows if the button for candidate eg john smith is pressed then the green x by the candidates name is illuminated for about one full second for one second the lcd display under the voter panel displays the message v oter panel e13 where in place of e13 there is whatever the rowcolumn letternumber pair corresponding to the button pressed then the lcd displays vote recorded thank you continuously this happens whether or not the cast v ote button is then pressed 306 when the machine is in this unactivated state the cast v ote button is normally dark but if pressed it glows red for about 1 second voter may easily interpret this illumination to mean that vote has been castbut vote has been cast71 70certif of stephanie harris october 1 2004 certif of glenn cantor october 17 2004 71sequoia is aware of this behavior according to the vc advantage operator manual the system allows the v oting switches and the cast v ote switch to be tested when the machine is in the 81307 this design leads to the possibility of vote fraud by electionboard workers the operator simply fails to activate the machine for some voters because dre gives three different types of visual indications that vote has been cast many voters will be misled into thinking their votes have been recorded when they have not72 308 even though the vast majority of pollworkers are good citizens with this design ﬂaw there is still the very real danger that pollworker will inadvertently fail to press the activate button correctly in this case many votes can be lost because of the bad design of the vc advantage which gives extremely misleading feedback through its user interface when not activated 31 pressing an option switch deactivates the advantage so that votes are recorded 311 summary an inadvertent or deliberate buttonpush by the operator can cause the vc advantage not to record votes figure 25 operator panel v oter inactive mode to test the switch press it it will light and the switch name will be displayed in the v oter panel lcd this description is incomplete the operator manual does not describe the behavior we observed which is that the lcd display shows vote recorded thank you regardless of the original reason for this design in practice it causes confusion and can disenfranchise voters 72a corrupt pollworker even has plausible deniability in this fraud if some voters understand that because the overhead light in the booth is not lit the machine has not been activated they will protest in that case the election worker can simply apologize for failing to press the activate button and activate the machine for this voter 82312 in primary election after the pollworker activates the voting machine by pressing one partys button eg 6dem or 12rep followed by activate he can deactivate the machine by pressing the other partys button 12rep or 6dem respectively 313 this behavior leads to inadvertent or deliberate disenfranchisement of voters first the pollworker may inadvertently deactivate the machine and the voter may not notice since the symptoms will be the same as in section 30 314 second this behavior permits vote fraud by corrupt board worker or an unintended denial of the franchise by an inexperienced or tired board worker the operator ﬁrst presses dem or rep then activate as usual this causes the chirp ing noise that signals that the machine is activated to accept votes as we will scribe in section 32 then he immediately presses rep or dem respectively this causes sound but deactivates the machine the voters votes will not be recorded 315 unlike the case where corrupt pollworker deliberately fails to press the ac tivate button this method of fraud is even harder for voters or other witnesses to detect because the vc advantage makes its normal voteactivation chirping noise 32 sound on activation is not an effective signal for voter pollworkers or witnesses to determine when votes are cast 321 summary the vc advantage makes sound when the machine is ac tivated for voter to vote it makes the same sound when the voter presses the cast vote button this sound is too quiet for its intended purposes to alert all relevant witnesses that vote is being cast to prevent unauthorized votes and to signal to the voter and the pollworker that the vote is recorded to reduce uncertainty furthermore using the same sound for both signals invites confusion and fraud 322 one method of vote fraud that is over century old is this the voter puts more than one ballot into the ballot box or pollworker puts ballots into the ballot box 83when voter is near or with voting machine the pollworker allows the voter to vote several times or the pollworker votes several times when voter is near 323 to defend against this kind of fraud ballot boxes for paper ballots are put in full view of many witnesses for example in view of the pollworkers and pollwatchers sitting at the registration desk some ballot boxes are equipped with lever that opens the slot to accept ballots whenever this lever is pulled bell rings thus everyone in the room is aware of every time ballot is inserted into the ballot box 324 similarly the leveraction machines used in new jersey throughout most of the 20th century make fairly loud and prolonged noise when the voter switches the cast vote lever in addition the machines used from 1961 to 2003 in mercer county automatically closed curtain when the machine was activated and opened this curtain when the voter switched the cast vote lever this was visual indi cator to anyone in sight 325 the vc advantage emits chirping sound when the operator activates the machine for voting and the same chirping sound when the voter presses cast v otenoteheadss2noteheadss2 41clefsgnoteheadss2prestissimo meccaniconoteheadss2noteheadss2noteheadss2noteheadss2noteheadss2 1 4second if this sound were effective it could prevent collusion between the voter and the operator of the kind where the operator repeatly activates the machine and the voter repeatedly votes the sound if effective would also prevent the operator at times when voter is near from activating the machine and then voting himself 326 pollworkers and party challengers sitting at the signin table should be vigilant to outoftheordinary activity in the polling place but the vc advantage pro vides visual signal visible from that distance that vote has been cast and its aural signal the chirping noise is not loud enough to be reliably heard from sev eral feet away where the pollworkers and challengers are sitting this is especially true in polling places that are large rooms such as school gymnasiums some times with more than one election district each with two advantage machines with difﬁcult acoustics where there will be cacophony of chirps as several voting machines are activated and voted since 2004 we have heard from many voters that they did not hear the chirping sound 327 furthermore exactly the same chirping sound is made for the activate function and the cast v ote function this needlessly causes additional confusion especially 84when there are several vc advantage machines in the same room 328 finally the advantage makes sound at all if it is deactivated accidentally or intentionally by the pollworker 329 in summary the vc advantages inadequate aural signals cause confusion prevent the detection of fraud and permit fraud 33 the vc advantages lack of feedback leads voters to undervote 331 summary the fullface buttonsandlights design of the vc advantage does not give adequate feedback to voter who may have forgotten to vote in some of the contests on the ballot 332 computer scientists study user interface design so that their computer pro grams can better understand and carry out the intent of the user userinterface issues are also important in voting machines and ballot design where both com puter scientists and social scientists study these issues 333 professor david kimball political scientist recently studied the undervote rates in the 2006 new jersey general election73he found that the vc advantage has very high undervote rate on public questions about 29 he found that the undervote rate increased for voters with lower incomes 334 in our examination we found several reasons that can explain the high under vote rate of the vc advantage 335 the vc advantage does not have video screen for communication to the voter to alert the voter that he has forgotten to vote in certain contests thus the voter may be inadvertently disenfranchised 336 in our examination of the vc advantage we have studied all the mechanisms by which sequoia and election ofﬁcials attempt to remind voters not to undervote in doing so they attempt to overcome the inherent inexpressiveness of the vc advantages user interface in our opinion these mechanisms do not succeed we describe this in detail in appendix i 73v oting equipment and residual v otes on ballot initiatives the 2006 election in new jersey david kimball university of missourist louis february 28 2007 8534 voter cant tell which primary is activated 341 summary the vc advantage gives inadequate information to voters in primary elections about which ballot is activated this feature of the machine may interact with the primaryelection optionswitch bug to disenfranchise voters 342 in primary election the voter hands to the pollworker v oting authority ticket that informs the pollworker which partys primary the voter is eligible to vote in 343 inside the booth there is indication on the fullface preprinted ballot of which partys primary is activated74therefore the voter is presented with two complete primary ballots on the same panel the democratic and the republican primary with visual prompt indicating which one to vote in 344 this is particularly problem in connection with the optionswitch bug see section 56 in that situation which occurred on 37 machines in 8 counties on february 5 2008 the computer program in the vc advantage presented the wrong partys primary ballot to the voter the lack of visual indication of which primary was enabled may have contributed to the confusion on the part of both voters and pollworkers and thus contributed to the disenfranchisement of those voters 35 pollworker can see who the voter votes for 351 the purpose of privacy curtain and other technological measures to protect the secret ballot is to protect voters from being coerced to vote certain way and to prevent vote buying the vc advantage does not provide effective voter privacy 352 in normal use of the vc advantage machine75an electionboard worker presses button on the operator panel to activate the machine for each voter the operator panel is on the side of the machine towards the rear 74from our examination of union countys vc advantage machines as they were set up for the presidental primary election of february 5 2008 75unless the votersmartcard activation option is installed which it is not in new jersey the vc edge voting machine also uses smartcard activation studies commissioned by california and ohio found security vulnerabilities associated with smartcard activation such as the possiblity that voter could use hacked smart card to vote repeatedly 86figure 26 peeking through the slot at the position of the voters ﬁnger here the pollworker can see that the voter is voting for candi date at the left side of the fullface ballot this shows more clearly in the video that accompanies this report 353 in principle the voter has privacy in the act of voting because the vc advan tage has side doors and top panel that unfold to form voting booth curtain shields the voter from the rear 354 however there is an open slot on each side where the top panel joins the back of the machine these slots are 8 inches by 14 inch at each side of the machine about 54 inches from the ﬂoor poll worker of average height anyone at least 64 inches tall can easily see through slot to where the voters ﬁnger is pressing the buttons to select candidates this can be done by standing in normal position and attitude at the operator panel 355 looking through the slot it is fairly easy to tell the horizontal position of the voters ﬁnger ie which column is the candidate voted for it is somewhat more difﬁcult to tell the vertical position ie which row the candidate is in since in new jersey each contest is laid out as one horizontal row 1 where there are few races on the ballot such as the presidential primary of february 5 2008 the poll worker can tell how each voter voted 2 if the voter votes the contests from top to bottom as most voters presumably do its often possible to tell whether theyre voting straight party ticket and for which party 356 corrupt pollworker can combine this fraud with the one we describe in sec tion 31 he can deactivate the vc advantage as soon as he sees the voters ﬁnger aiming for candidate that the pollworker does not favor 8736 cant undo writein vote in violation of fec guidelines 361 summary voter cannot undo writein vote after pushing enter but before casting vote the consequence of this userinterface problem is that the vc advantage may fail to record the intent of the voter if the voter discovers after entering writein vote that she has placed this writein in the wrong contest on the ballot there is way for her to correct this contest and vote her true intent in this contest 362 the fec guidelines for voting machines section c8e says means for cor recting vote response should be readily available for nonpaper based systems this should be built into the design of the system76 363 on the vc advantage writein votes are cast as follows for some contest the voter selects candidate marked personal choice then she uses an alpha betic keyboard below the voter panel to type name with feedback from an lcd display below the voter panel after typing the letters she presses enter on this keyboard 364 while the machine is activated voter can select candidate by pressing the button for that candidate if she changes her mind she can deselect the candidate by pressing the button again this causes the x by that candidate to go out and she can now select different candidate for that contest 365 however if the voter has selected personal choice for given contest then after pressing enter it is not possible to deselect the personal choice lection or to change the writein vote this appears to be violation of the fec guidelines 37 procedures for ﬂeeing voter leave opportunities for violating the privacy or integrity of the ballot 371 summary if voter leaves the booth without pressing cast vote on the vc advantage then the procedure for pollworkers to follow is very clumsy the procedure is difﬁcult to follow while respecting the voters privacy and leaves opportunities for changing votes 76vvs 2002 appendix c section c8 paragraph 88372 this issue slightly impairs the accuracy of the vc advantage in recording the voters intent and slightly impairs the security against pollworker manipulation however we judge this issue to be of somewhat less import than the others that we discuss in the body of this report therefore we have relegated discussion of this issue to appendix j 38 conclusion of part iii 381 the fullface buttonsandlights design of the vc advantage user interface has an inherent design weakness it is unable to give certain kinds of feedback to the voter in particular really effective feedback about undervotes is difﬁcult to achieve and there is an inherent possibility for confusion about whether the machine is activated 382 however even given that inherent limitation sequoia has made certain avoid able design mistakes that greatly increase the risk that the intent of the voter will not be recorded the behavior of the machine when not activated is inexcusable pushing button lights the green xs even when vote is being recorded the machine is too easily deactivated either inadvertently or surreptitiously before the voter has chance to vote and there is voterprivacy violation that could have been avoided with better physical design 383 these ﬂaws have the effect of disenfranchising voters either inadvertently with malicious intent on the part of pollworkers or on purpose thus they compromise both the accuracy and the security of the vc advantage 89part iv design errors and programming bugs make the avc dvantage insecure 384 the attacks that we describe in parts i and ii are so deadly because they succeed even if every election worker is honest and because they are undetectable by audits 385 in our examination of the source code we found many other design ﬂaws that an attacker could exploit in order to steal votes in contrast to the attacks described above the vulnerabilities that we will describe in this section may require coop eration from dishonest election worker could in principle be detected by well designed audit methods or could compromise only the privacy of the ballot in stead of stealing votes 39 vote data is not electronically authenticated making it vulnerable to tampering 391 summary in its promotional literature sequoia claims the advantage is using cryptographic means to guarantee authenticity integrity and conﬁ dentiality of votes this is simply not true 392 sequoias promotional literature77makes many claims about the use of cryp tographic signatures to validate the integrity of vote data indeed the source code has many mechanisms that purport to ensure the authenticity integrity and conﬁ dentiality of votes the mechanisms that sequoia uses are completely inade quate for this purpose 393 cryptographic signature is an informal term for the standard term digital signature digital signatures are used to protect computer data so that accidental ordeliberate modiﬁcation can be detected we will use this standard term of art as it is used by computer scientists and as speciﬁed by the national institute of 77a vc advantage security overview sequoia v oting systems inc 2004 90standards and technology78 394 digital signature algorithm authenticates data ﬁle by applying the signers secret key to produce signature the signature is short string of just few dozen characters only someone in possession of the key someone who intends to authenticate this data can produce this signature string therefore the signature string proves the authentication of this data 395 one could imagine using digital signatures to authenticate votes coming from voting machine in such way that only this voting machine could have produced this vote data but sequoia did not design the vc advantage to do this in our examination of sequoias source code we found that 396 there is use of digital signatures or cryptographic signatures at all79there is not single piece of data or ﬁrmware that is protected against deliberate fraud by the use of digital signatures 397 hash functions are weaker than digital signaturesthey can detect acciden taldata changes but not deliberate falsiﬁcation in the vc advantage hash functions at all are used to protect actual vote data the ballot image ﬁle and the candidate totals stored in results cartridges and in internal memory are not protected by any kind of overall hash function or checksum this makes it very easy for an attacker to change ballot images and candi dates totals in results cartridges80 398 some of the hash functions used are even too weak to protect reliably against inadvertent data modiﬁcation some kinds of data in the vc ad vantage are protected by crc cyclic redundancy check hash functions which are adequate to catch inadvertent changes to data but other kinds of data such as the contents of roms are protected by naive checksum computed by simply adding up the bytes this method has been obsolete for forty years81since it fails to catch even inadvertent errors reliably 78digital signature standard federal information processing standards publication 1862 na tional institute of standards and technology january 27 2000 79there is some use of sha1 in technician cartriges but the technician cartridge feature is disabled 80each individual ballot image has checksum this is much weaker defense against fraudulent or accidental change than using an overall hash signature on the whole ﬁle this is because individual ballot images can be duplicated checksum and all without detection 81peterson w w and brown d t january 1961 cyclic codes for error detection pro ceedings of the ire 49228 91399 in conclusion any authentication that the vc advantage performs is use less against deliberate fraud in all cases where we examined an attack on vote data or ﬁrmware either there was authentication mechanism or we were easily able to defeat whatever mechanism was present 40 manipulating results cartridges 401 summary results cartridges are used for transmitting the ballot deﬁ nition to the vc advantage and transmitting the election results from the vc advantage to wineds computer it is easy to physically and electron ically manipulate results cartridges either to turn them into other types of cartridges or to change the votes in them results cartridges are very insecure against tampering with the votes stored inside 402 the vc advantage uses data cartridges called results cartridges which are about the size of vhs tape the data in the cartridge is organized into simple ﬁle system there is protection either via hardware or via cryptography against reading and writing the data in the cartridge 403 the cartridge contains the ballot deﬁnition as well as the votes cast at the close of the polls the results cartridge is normally removed from the vc advantage by pollworker then the cartridge is put into zipperbag sealed and sent back to election ofﬁcials for tabulating in wineds 404 we wrote simple program that runs on an ordinary personal computer to change votes inside the candidatetotal ﬁles and ballotimage ﬁles stored in results cartridge when the altered results cartridge is inserted into wineds for tabulation wineds notices nothing amiss about the fraudulent data figure 27 tiny computer sold for 99 by gumstixcom that could be the brains of cigarettepack size vice to alter the contents of results cartridges 92405 it is possible to make simple device that changes the votes in results car tridge this device could be as small as package of cigarettes one would plug figure 28 nonfunctional mockup of device in cigarette pack to alter the contents of results cartridges this device into the results cartridge and remove it after 2 or 3 seconds the whole process could be done unobtrusively in 5 seconds in that time the device could read the votes candidate totals andaudit trail from the cartridge and write fraudulent data candidate totals and audit trail to the cartridge figure 29 nonfunctional mockup 406 this could be done at any of the following times by the pollworker who removes the cartridge from the machine before bringing it to the table where the other pollworkers witness putting it into the bag by pollworker at the table while the other workers are busy with other tasks stowing the curtains attending to the other vc advantage in the same precinct etc by person who transports the cartridge to county election ofﬁcials for tab ulation by person who removes the cartridge from the bag before tabulating in wineds 407 as we explained above in section 39 means of cryptographic signature or authentication protects the vote data in the results cartridge from modiﬁcation sequoia claims in its vc advantage security overview 93after polls are closed the vc immediately calculates and stores cryptographic signatures of each of the totals data ﬁles ballot images write in names candidate summary totals and selection code sum mary totals the cryptographic signature values are stored in both the audit trail and results cartridge memories82 however this is not true for two different reasons 1 sequoia does not use true cryptographic signatures the important property of cryptographic signature is that one can check the authenticity of sig nature without knowing the secret necessary to sign document the vc advantage calculates checksum that does not have this property that is anyone such as the wineds program that can check the authenticity of results cartridge also has enough information to forge fake one this information is identical in all vc advantage machines and in all wineds installations so that anyone with access to single one of these has the abil ity to forge results cartridge as if it came from any other 2 the checksum protects the ballot deﬁnition but checksum at all pro tects the election results therefore candidate totals can be changed without knowing anything about checksums 408 in summary once results cartridge leaves the voting machine it is immedi ately susceptible to modiﬁcation of vote data 41 some nj county clerks use the less trustworthy source of data in tabulating ofﬁcial election results 411 summary sometimes the vc advantage prints different vote totals on its printer than are stored electronically in its results cartridge the paper reports are less susceptible to fraud and error although they are still suscepti ble in case of disagreement county clerks should rely on the paper printout in their tabulation of ofﬁcial election results however some clerks unwisely use the electronic data instead of the printed data 412 sections 40 46 47 48 explain how the data in results cartridges are vulner able to fraudulent manipulation therefore the paper resultsreport printouts made 82a vc advantage security overview sequoia v oting systems page 9 94by the vc advantage immediately when the polls close in the presence of wit nesses and signed by those witnesses is more trustworthy section 57 explains how when the vc advantage loses votes because of hardware failure the paper resultsreport printouts are more likely to be accurate than the results cartridges 413 even the paper resultsreport can be fraudulently changed by electionstealing ﬁrmware inside the voting machines as described in parts i and ii of this report here we are talking about sources of fraud and error other than that kind of hacking 414 when there is disagreement between the paper and the results cartridge the paper record should be considered more reliable in the absence of speciﬁc other evidence however unfortunately election ofﬁcials often ignore the paper records entirely and rely entirely on the electronic data 415 this is true even in case where there is speciﬁc red ﬂag indicating the unreliability of the data in the results cartridge in camden county when re sults cartridge failed in way that we describe in section 57 the county clerk apparently used data that was extracted by other than the usual means from this partially failed cartridge even though this data disagreed with the paper printout from the machine signed by witnesses 416 an extremely conscientious county clerk will review the paper records to compare them with the electronically transmitted numbers this is what joanne rajoppi clerk of union county did in february 2008 which led her to discover the partyafﬁliation error made by vc advantage machines described in sec tion 56 417 however to the extent that ms rajoppis exemplary practice is not widespread among the county clerks of new jersey errors and fraud in results cartridges will inﬂuence ofﬁcial election results 42 the advantage can print paper report from fraudulent results cartridge 421 suppose someone fraudulently changes votes in results cartridge using the method we describe in section 40 he can then change the paper resultsreport printout as well so that discrepancy is noticed using the following method 95422 we have found that one can reinsert the results cartridge into the voting ma chine and print phony results report from it to do this one inserts the results cartridge into the auxiliary report of the vc advantage then one selects from menu on the operator panel to print report from results cartridge 423 dishonest pollworker could perform this manipulation he would print an extra fraudulent results report which would then match exactly the fraudulent contents of the results cartridge if the other pollworkers are not paying atten tion they would not notice the extra buttons he pressed on the voting machine to accomplish this 424 one might think that an alert and honest pollworker might notice the extra manipulation of the voting machine performed by the dishonest one however some pollworkers have less experience with exactly how the machine works83and what technical procedures are supposed to occur at the closing of the polls 425 also there are other distractions while the polls are being closed in fact mid dlesex county explicitly recommends that pollworkers perform other tasks at the very time the results report is printing middlesexs pollworker manual instructs while the results are printing begin closing the front of the machine remove privacy curtain and return it to the storage tube unlatch the top privacy panel and fold down fold in the side privacy panels lock the door with the yellow key and remove the key84 426 furthermore pollworkers print several copies of the results report85it would thus be possible for pollworker to make the original legitimate copy disappear and have all the witnesses sign the report printed from manipulated cartridge 43 one can confuse the vc advantage with fraudulent ballot deﬁnition that yields two votes for one button 431 cleverly designed ballot deﬁnition can cause single button on the voter 83based on appels observations of pollworkers in two different precincts as they closed the polls in november 2004 in princeton nj in one precinct the head pollworker was clearly very experienced and knew exactly what she was doing in the other the pollworkers made some procedural mistakes 84from page 34 of ofﬁcial instructions for the district board of elections middlesex county board of elections revised jan 2008 bates number middlesex 1048 85when all reports are printed if more are needed push the blue print more button note you must use the blue print more button to produce another copy of the results tape to post for the public to see id 96panel to add two votes for candidate or to have an invisible button add extra votes the trick is to abuse the endorsement feature of the vc advantage even though endorsement is not practiced in new jersey that does not prevent an attacker from taking advantage of its existence in the vc advantage 432 endorsement is used principally in new york where for example the same candidate can run on the democratic party ticket and on the liberal party ticket thus the candidate appears twice on the ballot once in each party column 433 in the electronic format of the ballot deﬁnition in the results cartridge there is data structure with links from each candidate to the place on the ballot where he appears the same candidate can occur in several places in fact this ballot deﬁnition data structure is so complex that it is very vulnerable to fraudulent ma nipulation however the vc advantage does not thoroughly check the ballot deﬁnition data structure to make sure it is wellformed for example the ballot deﬁnition can have candidates in nonexistent contests and the voting machine will not notice 434 the vc advantage printer permits special printer control characters such as cancel printing of this entire line the ﬁrmware in the vc advantage unwisely permits these control characters to be present in candidate names contest names and votingmachine serial numbers in combination with the complex ballot deﬁni tion structure this leads to two different security vulnerabilities as we will explain here and in section 46 435 by manipulating these data structures one can design ballot deﬁnition that plays the following trick it puts john smith on the ballot at two different locations one in the expected place and one invisible it is easy to make button invisible since all the buttons are behind the paper overlay on the voter panel and they figure 30 buttons behind paper ballot on voter panel become visible only by the fact that the printed paper has an indication of which buttonpositions are meant to be pressed the tricky ballot deﬁnition also needs 97to manipulate the way the results report is printed which can be done with printer control codes that suppress printing of lines containing the duplicate candidate names86 436 whenever new ballot deﬁnition is fed into anyvoting machine the machine should check the ballot deﬁnition for sanity and wellformedness ballots struc tured in ways unanticipated by the programmer can lead to hacks of which the twovotesforone that we describe here is just one example 437 even though the vc advantage does have some checks for ballot sanity we found others that were missing the complexity of the ballot deﬁnition format in the vc advantage leaves it potentially vulnerable to this kind of attack 438 conclusion the vc advantages failure to perform sufﬁcient sanity checks on the the ballot deﬁnition constitutes security vulnerability 44 results cartridges can be easily converted into other kinds of cartridges and used for fraud 441 sequoia makes many types of cartridges that have the same size shape and ap pearance to results cartridges consolidation cartridges technician cartridges program cartridges simulation cartridges audittrail transfer cartridges and so on these cartridges were designed in the early 1980s before ﬂash memory was invented they have typically 96 kilobytes of static ram and two aa batteries to maintain enough power to preserve the data in the ram 442 we found that it is easy to convert results cartridge into any of the other types we cut certain traces printed wires on the circuit board of the results 86the fraudulent ballot design is constructed with the following technical details 1 build multiple candidates as endorsement ring 2 leave last of the instances in the ring to be part of the race one wants to manipulate 3 change the other instances to be members of nonexistent race which omits those from reports 4 make the other instances to point to switches already in use for example in other races 5 manipulate the party description ﬁeld to contain combination control characters like cancel line to omit the extra lines on report caused by endorsement reporting then if voter pushes the candidates button the candidate gets votebut also one can bind the invisible button to award second vote the invisible button can even be made the same button as another legitimate candidate in the race for example gubernatorial candidate can be bound to get second vote from every voter who votes for statesenate candidate c this will not affect the votes tallied in the senatorial race it will just generate extra votes for governor 98cartridge and installed 24pin header for repluggable jumpers this took about 15 minutes depending on the pattern of jumpers we were able to make any of the different cartridge types 443 in the next few sections we will describe ways to fraudulently manipulate elec tions using these other types of cartridges 45 early voting cartridges permit fraud in states that use them 451 summary the vc advantage contains an early voting feature this mechanism is insecure and subject to manipulation and fraud new jersey does not currently permit early voting on vc advantage machines because of these insecurities new jersey should not adopt early voting on the vc advantage 452 the vc advantage permits early voting as follows on each of the early voting days pollworker unfolds the voting machine and inserts an early v oting cartridge v oters cast their votes at the end of the day the pollworker removes the early v oting cartridge thus the cartridge contains several sessions of early voting data 453 states that use early v oting are subject to many severe vulnerabilities in this process especially the following in contrast to the process at the end of an ordi nary election day where results report is printed out by the voting machine and witnessed results report is printed at the end of each early voting session this results report when it exists can serve as an important check to detect manipula tion of cartridges after they leave the voting machine if an attacker changed the data in an early v oting cartridge one could detect it 46 manipulating consolidation cartridges 461 summary there is mechanism for consolidating the votes of several vc advantages in precinct into one cartridge this mechanism is insecure and subject to manipulation and fraud to the extent that counties in new jersey do use this mechanism they open vulnerabilities for fraud 462 the vc advantage has the ability to do pollingsite consolidation that is if there are several vc advantage machines in the same precinct the totals from these machines can be accumulated at the polling place immediately after the close 99of the polls so that only one set of candidate totals is reported for the whole precinct 463 on the vc advantage the process uses consolidation cartridge that looks just like largeformat results cartridge in fact we easily converted one of ap pels own results cartridges to consolidation cartridge by simple rewiring after the close of the polls blank consolidation cartridge is inserted into the auxiliary port of the ﬁrst vc advantage in the precinct this ﬁrst voting ma chine writes its candidate totals to the cartridge87then the cartridge is removed and inserted into the next vc advantage this second voting machine adds its candidate totals to the cartridge as the cartridge is inserted into each subsequent machine the totals are similarly accumulated 464 there are two ways an attacker could manipulate this process to steal votes 1 start with consolidation cartridge that is not blank but contains negative votes for candidate and an equal number of positive votes for candidate b then when legitimate votes are added from the voting machines the negative votes will cancel out some of the legitimate votes for candidate leaving only positive totals because of the balance of negative and positive votes all the totals will be consistent with the public counters ie with the number of voters who voted on the machines when the considation car tridge is inserted into wineds the wineds system will read the candidate totals and will not check the ballot images even if they are present88 one might think that the voting machine would reject consolidation car tridge with negative votes but in fact it does not this is very dangerous the consolidation fraud works by adding votes if one can only add positive votes then one risks being detected because the vote total will exceed the number of voters but if one can add negative votes to one candidate and an equal number of positive votes to another then one can avoid detection 2 one could use handheld device as described in section 405 to change votes in the consolidation cartridge just as in results cartridge 87optionally depending on setting in the ballot deﬁnition the voters ballot images are also copied to the consolidation cartridge 88to complete this attack it is useful to suppress from the printer paper consolidation report any mention of the votingmachine serial number from which the fraudulent negativeandpositive votes were loaded into the consolidation cartridge this can be done by putting suppressprint line control character into the ascii string that holds the serial number of this voting machine as we describe in 434 of course this voting machine used to prepare the fraudulent consolidation cartridge need not be real vc advantage and ordinary personal computer or cigarettepack sized handheld device will do 100465 in summary consolidation cartridges allow many opportunities for stealing votes 47 wireless access to results cartridges opens avenues to manipulation 471 summary inexpensive and readily available technology would permit an attacker to make fake audioballot cartridge that can be radiocontrolled from several feet away this is bad for the vc advantage 900 and disas trous for the version 10 advantage 472 as discussed in section 194 the audioballot cartridge of the sequoia vc advantage 900 is pcmcia card that plugs into the daughterboard also known as the audio kit processor the vc advantage model 10 uses the same hardware architecture but on that machine the daughterboard is called the main processor and the pcmcia card is called the results cartridge 473 this pcmcia card is used for audio ballot ﬁles on the version 9 machine and for ballot deﬁnitions audit trails and election results on the version 10 machine but it is also used for loading software updates into the daughterboard processor figure 31 at left eyeﬁ card designed for digital cameras at right adapter that converts eyeﬁ card or any sdcompatible camera card to pcmcia format photo at left by scott beale laughingsquidcom creative commons license attribution noncommercial derivativeworks photo at right from wwwuniversmobilenet 101474 although sequoias audioballot cartridge is the size of credit card inside it is actually much smaller compact flash card of the kind that plugs into digital cameras sequoia encases the cartridge in plastic casing that obscures this arrangement when i plug the audioballot cartridge into the pcmcia card slot of microsoft windows computer the card identiﬁes itself as sandisk sdcfj32 or sdcfj64 compact flash89 475 one can easily purchase90a wiﬁenabled compact ﬂash card brandname eyefi one uses this card in digital camera in place of the standard sd ﬂashmemory card then one can use wiﬁenabled computer or cellphone to downloadupload picture ﬁles fromto the digital camera to enable compatibility with existing digitalcamera operating systems the sd card presents to the slot its plugged into the appearance of perfectly ordinary sd card however ﬁles from the sd card can be read or written remotely even while the digital camera is in operation and the camera is completely unaware of this activity 476 sdformat ﬂash memory cards are much smaller than pcmcia cards and an sdtopcmcia adapter is readily available it would be very easy to make fake sequoia pcmcia cartridge that contains radioenabled sd card but looks identical to the real thing 477 therefore it is easily possible with very little technical skill to produce fraudu lent audio ballot cartridges for the advantage model 9 or results cartridges for the model 10 that can be modiﬁed remotely from distance of several feet from the voting machine the attacker can be pollwatcher or electionboard worker if he wishes to perform the attack before the polls are opened or voter if he wishes to perform the attack while the polls are opened 478 this mechanism can be used to modify audioballot ﬁles on the version 9 ma chine so that disabled voters are presented with fraudulent set of choices this mechanism can be used to modify ballotdeﬁnition ﬁles and electionresults ﬁles on the version 10 machine 479 this mechanism can also be used to entirely replace the program in the daugh terboard with fraudulent program that steals votes see section 19 89the capacity of the card is variously 32 megabytes or 64 megabytes 90wwweyeﬁ 7999 102wireless access to version 9 results cartridge 4710 the largeformat results cartridge of the version 9 vc advantage does not contain compact flash instead it contains typically 96 kb of static ram with two aa batteries to power the ram continuously so that it does not forget the contents 4711 the cartridge is 7x4x1 inches in dimensions with room to spare inside the opaque plastic case it would be simple exercise suitable for an undergradu ate student of electrical engineering or computer science to design fraudulent results cartridge containing wiﬁenabled compact ﬂash this would permit ma nipulation of ballot data and election results either while the results cartridge is installed in the vc advantage or after its removal 48 fraudulent intelligent results cartridges could steal votes 481 summary another way to steal votes in the vc advantage is to make smart results cartridge that fools the motherboard computer 482 standard sequoia results cartridge the largeformat cartridge from the ver sion 9 machine contains 96 kb of static ram with two aa batteries to power the ram continuously so that it does not forget the contents and 8 bits set by hard wired jumpers to indicate the cartridge type 4 bits and the memory size 4 bits when this cartridge is plugged into the vc advantage motherboard through the results port the z80 accesses the memory by doing inputoutput instructions 483 it would be simple exercise suitable for an undergraduate student of electrical engineering or computer science to design fraudulent results cartridge contain ing computer such computer could easily simulate normal results cartridge when talking to the z80 or to the wineds system that collects election results from it however the program in this cartridgeresident computer could easily manipulate election results or ballot deﬁnitions 484 this attack does not require any access to the internal circuitry of the vc advantage voting machine to replace results cartridge when the machine is turned off at most requires picking the lock and defeating seal see section 10 however election insiders can insert fraudulent intelligent results cartridges into the election process without any access to the vc advantage voting machine at all this can be done when results cartridges are being programmed with ballot 103deﬁnitions when they are being read to extract results after an election when they are stored in warehouses when they are being manufactured or at other points 485 these fraudulent cartridges are not easily detected by pollworkers because they have the same appearance as ordinary cartridges 486 the computer program in such cartridge can be programmed to steal votes in election after election with human intervention the results cartridge contains enough ballot data to tell which candidates are republican and which are demo cratic what ofﬁces they are running for and the date of the election thus it can be programmed to generically steal few votes only in presidential elections for example from one partys candidate to the other 487 unlike the rom replacement described in part i of this report the voteswitching results cartridges can be detected by careful audit of the paper results printouts the paper results printout is usually printed from the vc advantages internal memory which would not be affected by voteswitching in the cartridge therefore this attack is most dangerous when county clerks are inattentive or when politi cal parties have have insufﬁcient resources to send pollwatchers to witness and record copies of the printed results and compare them with published precinctby precinct result totals 488 designing such cartridges would require several weeks of effort by someone with bachelorslevel training in electrical engineering once designed they could be produced in quantity 49 electronically stored ballot images compromise privacy of the ballot 491 summary in its internal memory and results cartridges the vc ad vantage stores record of every ballot cast this list of ballots is shufﬂed to at tempt to preserve voter privacy the shufﬂing algorithm is inadequate and list can be unshufﬂed revealing each voters ballot in the original sequence 492 the secret ballot was introduced over hundred years ago to combat vote buying and voter coercion but even as late as the mid 20th century voter coercion via violation of the secret ballot was still taking place in cities such as jersey 104city91 493 because the sequence of voters who use voting machine is observed by wit nesses pollworkers and party challengers if one could learn the exact sequence of ballots cast then one could learn how each voter voted therefore any record of all the ballots that preserves this sequential order compromises privacy it is for that reason that one would not want to use reeltoreel mechanism for recording voterveriﬁed paper ballots for example 494 as each voter completes her ballot by pressing cast v ote the vc advantage stores an electronic record of that ballot as ballot image the advantage keeps one copy of the list of ballot images is kept in its internal memory and it writes the other copy to the results cartridge92 495 if the ballot images were stored in sequential order then one could learn how each voter voted therefore sequoia has written the vc advantage software to shufﬂe the order of the ballot images in the internal memory and in the results cartridge so that the order is obscured 496 we have found procedure that can be used to learn the unshufﬂed order of ballot images and therefore learn the votes of every voter it requires knowing the exact time each voter pressed the cast vote button to the nearest two seconds 497 our attack works in four stages as follows 1record the sounds coming out of the voting machine an electionboard worker carries pocketsize digital voice recorder he sets it down unobtru figure 32 digital voice recorder 100 sively on the voting machine behind the little speaker that makes the chirp ing noises the chirps made when cast v ote is pressed are recorded along 91personal eyewitness report of ed kessler told to appel in 2004 in the 1930s mr kessler accompanied his father to the polling place in jersey city and watched as some voter showed their completed ballots to pollworkers before depositing them into the the ballot box 92each ballot image is string of bits one bit for each active ballot position in this election packed into few bytes for example in the presidential primary of february 5 2008 with 7 democratic and 7 republican candidates each ballot image occupies 5 bytes 105with other ambient sounds after the election the audio ﬁle can be uploaded to computer for automatic processing which will separate the chirps from the noise and calculate the exact time at which each voter voted 2extract the ballot images anyone can walk up to the vc advantage after an election when it is unattended and use menus on the operator panel to write copy of the ballot images to cartridge 3run another election inside the memory of the machine is the 32bit random seed of the random number generator to undo the shufﬂing it is sufﬁcient to know the value of the seed either before or after the election one proce dure for learning the seed is this while the machine is unattended turn it on and install fresh ballot deﬁnition by inserting fresh results cartridge into the results port cast known sequence of votes the machine will write to the results cartridge an audit trail shufﬂed using the algorithm described above 4 bring the audiorecording the ballotimage cartridge and the postlat re sults cartridge to computer and upload the data specially prepared computer program analyzes all the data and unshufﬂes the ballot images this program is not as simple to write as the votestealing ﬁrmware we have described writing the program would be project of several months for computerscience graduate student the computerscience analysis behind this program is described in appendix d listening for the sounds the machine makes was the basis for known attack on voter privacy in the days of lever machines the lever machines used by new york state in the 20th century permitted voting straight party ticket by pulling single lever and this was easy to distinguish from voting split ticket by listening from outside the booth93 50 conclusion of part iv 501 v ote data in results cartridges is not authenticated by digital signatures there fore vc advantage results cartridges can be easily manipulated to change votes after the polls are closed but before results from different precincts are cumu lated together or the results cartridge can be manipulated before the polls open to install ballot deﬁnition that confuses the vc advantage and permits fraud 93email message from douglas kellner cochair new york state board of elections august 6 2008 106other kinds of cartridges early v oting cartridges consolidation cartridges can also be manipulated to steal votes the shufﬂing of the individual voters ballots is reversible permitting attacks on the secrecy of the ballots 107part v insufficiently rigorous design and certification processes leave the firmware vulnerable 51 sequoias sloppy software practices can lead to error and insecurity 511 summary in many places the source code of the vc advantage does not follow best software engineering practices we found many places where the source code and is violation of the speciﬁc technical rules for source code of the fec voting system standards for election software violations of these practices and rules increase the chances that programmers will make takes and the chances that these mistakes will slip through review and certi ﬁcation processes mistakes in the program can either directly miscount votes or can open security vulnerabilities that allow attackers to steal votes 512 the vc advantage version 900h software consists of almost 130000 lines of source code including comments and empty lines in over 700 source ﬁles somewhat over 25000 lines are in z80 assembly language and the rest are in c if comments and blank lines are excluded the corresponding numbers are approxi mately 38000 and 12000 lines respectively this source code contains comments describing myriad changes from 1987 through october 2005 by at least dozen different people 513 the vc code is commented and each major routine includes pseudocode description of what it does at the same time the code is complicated and difﬁcult to follow and there are signiﬁcant number of questionable software practices this is not surprising for program that has undergone continuous modiﬁcations for two decades and must operate on tiny and longobsolete machine 514 the code suffers from among other infelicities multiple versions of compu tations inconsistent naming conventions frequent use of literal numeric values magic numbers subtle linkages among status values numerous global vari ables generic and undescriptive names names that differ in only single charac ter inconsistent declarations for external data objects and subtle dependencies on 108datatypes and other properties we give speciﬁc examples in appendix 515 violations of fec guidelines according to comments in the source ﬁles at least one third of the source ﬁles were revised mostly in 2001 to satisfy fec standards94however these changes appear to have been done incompletely and many parts of the source code are in direct violation of the standards 516 for instance there are about ﬁfty occurrences of the explicitly prohibited do while false construct the fec standards prohibit this manner of phrasing computer program because it leads to program that is harder to understand both by those who write the program and those such as examiners and certiﬁers who have to read it hardtounderstand programs are more likely to mask errors insecurities and vulnerabilities in the logic of the program many of the other fec rules have similar aimmake the logic of the program easier to understand and less prone to design ﬂawsand sequoias source code breaks many of these other rules as well 517 other ways in which the programming style increases the probability of error comments in the code hint that the standards have sometimes cost precious memory space which can lead to an uncomfortable tradeoff ignore the rules or adopt other potentially risky techniques to recoup the use of an older obsolete version of the c programming language95makes it harder for compilers and other automatic tools to help catch programming errors standard library routines for tasks like memory allocation copy and comparison are written from scratch pre sumably for efﬁciency but this can lead to confusion and potentially to errors96 the use of homegrown operating system and ﬁle system required because the z80 is so restricted increases the size of the code base often leads to complicated programming and may limit the use of standard tools for analysis of code and data the amount of assembly language is problem as well since it is much harder to work with than is higherlevel language 518 the combination of all these problems can lead to complex and fragile code in which it is hard to ﬁnd errors by inspection or with mechanical aids and in which it has been difﬁcult to make changes to adapt to new requirements such as the fec 94presumably the v oting system standards of 2002 and the similar v oluntary v oting system guidelines of 2005 95that is function prototypes are written in 1970s style 96for example the order of arguments differs between the standard function memset and the sequoia equivalent memfill there are two functions called fsize one the usual standard library version and one version for the internal vc ﬁle system 109coding standards this is serious problem because errors in the program can miscount votes or open security vulnerabilities that permit fraud 52 wyle laboratories examines ﬁrmware only superﬁcially 521 summary our analysis of the wyle laboratories ita reports in conjunc tion with the actual sequoia vc advantage source code shows that the ita reports are not very useful for ascertaining the security or reliability of the voting machine 522 many states in their decisions about whether to certify voting machines for use rely on reports from socalled independent test authority ita in this sec tion we will show that the sections of these reports that assess the votingmachine ﬁrmware are inadequate to provide meaningful guarantees of the security of the voting machines from technical point of view new jersey should not rely on such reports to assess the security of voting machines proposed for certiﬁcation 523 in this section we will evaluate the quality of the ita reports on the vc advantage votingmachine ﬁrmware in the next section we will explain why it is important to do so 524 the sequoia vc advantage models 900g and 900h were examined by wyle laboratories an ita in huntsville wyles report on this examination97 says that wyle performed indepth source code review and functional tests of the advantage ﬁrmware the source code was reviewed to ensure it followed the recommended programming guidelines as contained in the fec standards page 18 525 wyles ita report is inadequate in two ways sequoia did not provide to wyle and therefore wyle did not examine sev eral ﬁrmware components installed in the vc advantage voting machine one of components that wyle did not examine98was extremely signiﬁcant 97test report 4876103 change release report of the vc advantage dre voting machine firmware version 900g april 27 2004 page 5 98we know this in two ways first the written wyle report includes ﬁle manifest that lists every ﬁle that they did examine second the way in which sequoia responded to the courts order to provide all of their ﬁrmware was to have wyle laboratories prepare disk of all the ﬁrmware they examined as we will explain in section 54 this disk did not contain some ﬁrmware components that sequoia later provided to us and that we conﬁrmed are present in the vc advantage 110because it was the pathway for the votingmachine virus that we explained in sections 1921 this component is the autoexecbat indeed wyle did not report on this problem on the ﬁrmware components wyle did examine their report is too superﬁcial and perfunctory to be meaningful the ﬁrmware would not be in compliance with the fec 2002 standards as we will describe 526 attachment b of the wyle report on the advantage 900gh is about 70 pages long and is entitled source code reports review and file listings it reviews the vc advantage version mainbd 1011 iobd 15 software as of january 30 2006 the document claims to include information from revision 809d through revision 101115 there is mention of 809 in any of the sequoia code we have access to but 800 is from december 1997 and 810 originally called 81 is may 2001 another comment in the report says that the assessment of version 800d through 900a is contained in wyle report 4473307 which we obtained later through court order 527 the attachment lists the names of ﬁles that were changed from each version to the next typically there are handful to few dozen the comparison between versions 900g and 900h is accurate in its list of ﬁles that have changed as we can determine since sequoia provided those two versions to us 528 for few of these ﬁles in few of the versions of the software the report lists handful of failures to meet fec standards most of these source file speciﬁc notes are perfunctory for instance citing function that does not have all the required sections in its header comments variable declaration that does not have comment or an occasional singlecharacter variable name 529 only small number of the comments ever suggest that the examiner at wyle did anything more than skim through the program pro forma appendix gives speciﬁc technical support for this conclusion either the wyle examiner does not have proper training in software engineering and computer security and so does not know what to look for or he is not looking in enough depth to ﬁnd the problems that are there or both 5210 what this means is that the ita software examination process permits errors and security vulnerabilities to slip through the certiﬁcation process such vulner abilities include the ones in the vc advantage that we describe in sections 3 1921 24 26 39 40 43 45 46 49 51 56 and 57 111wyles report on the version 10 vc advantage is also inadequate 5211 the criteria that wyle uses for its examination of the version 10 vc advan tage99 are speciﬁed in the 2002 fec v oting systems standards the technical source code rules in those standards are not very speciﬁc nor likely to be very effective even if wyle followed those rules to the letter the report would not be very useful in assessing the security of the voting machines however it appears that wyle does not even follow those rules in its report 5212 the transition from 900h to x1 appears to have involved signiﬁcantly larger number of changed ﬁles almost 130 are listed as changed however the report says half of the ﬁles are brand new which is inexplicable first 900h has over 700 ﬁles 130 ﬁles is less than 20 percent not half second many of the ﬁlenames listed are identical to names in 900h perhaps it is their contents that are different in that case one would have expected more substantive commentary on the changed code 5213 we believe that either the examination is simply too superﬁcial or that once some ﬁle has been deemed acceptable it is not examined again unless it changes and even then only the changed parts are examined 53 new jersey ofﬁcials neglected to read the ita reports and thus had opportunity to notice how their inadequacies 531 we do not know whether the state of new jersey relied on wyles ita report or any report from any ita in certifying the vc advantage 900g or h for use in new jersey in response to plaintiffs request to the defendant for all ita reports in the possession of the state of new jersey that describe any version of vc advantage the defendant produced only some reports on version 10 vc advan tages and none for version 9 or earlier the defendant asserted that these were all the ita reports that they had on the vc advantage100 532 either the vc advantage 900 was put into use in new jersey without being certiﬁed by state election ofﬁcials or it was certiﬁed without any new jersey of ﬁcial examining the ita reports suppose it is the case that the vc advantage 900 was purchased and put into service in new jersey based in part on sequoias 99test report 5188408 hardware qualiﬁcation testing of the sequoia vc advantage dre voting machine firmware version 1015 april 12 2006 100statement by donna kelly to the court july 2008 112assurance that this voting machine had received ita approval in january 2006 that is the voting machine got its nased number then the failure of new jersey ofﬁcials to read wyles ita report deprived these ofﬁcials of the opportunity to observe how inadequate the ita examinations are as assessments of the curity of votingmachine ﬁrmware if on the other hand the state of new jersey had had computersecurity expert involved in the certiﬁcation process he would have wanted to see this report an expert would have made the observation that wyles examination of the ﬁrmware is so superﬁcial that it cannot be relied upon as basis for certifying that the ﬁrmware of the vc advantage is secure 54 sequoia does not keep track of what ﬁrmware is installed in its dres 541 summary sequoia does not appear to keep track of what ﬁrmware is installed on its vc advantage voting machine this is serious problem for product in which fraudulent ﬁrmware can steal elections 542 sequoia v oting systems complied in very haphazard way with court or der to deliver its votingmachine source code and firmware in the process we learned that sequoia apparently does not keep good track of what ﬁrmware is in its own voting machines the ﬁrmware is supplied from wide variety of sub contractors and suppliers many of the components sequoia has not examined or inspected 543 any one of these components could contain an innocent programming error that an attacker can exploit to insert vote stealing ﬁrmware or malicious ﬁrmware that steals votes to the extent that sequoia does not have tight control over what ﬁrmware is in stalled sequoia leaves avenues for the installation of vulnerable or malicious ﬁrmware during the manufacture of the voting machines 544 evidence that sequoia does not keep good track of what is installed in the vc advantage in march 2008 the court ruled that it would enforce subpoena for materials including the following 4 for each sequoia vc advantage dre v oting machine sup plied pursuant to requests no2 and no3 above the complete source 113code in electronic form including libraries and all related technical documentation for all the software or ﬁrmware as the case may be in the voting machine complete with all conﬁguration ﬁles and build tools your production pursuant to this request must be such that would allow the recipient to reproduce the binary images currently loaded into the voting machines in use in new jersey and sufﬁcient to enable the building and execution of modiﬁcations to the software made for testing and analysis purposes 545 we will describe the haphazard and disorganized way in which sequoia complied with this request to support our conclusions that sequoia did not have wellorganized inventory of what ﬁrmware is in its vc advantage voting machine 546 on may 20 2008 the court issued an order for sequoia to produce these items for examination on june 20 2008 the court issued modiﬁed orderbut not modiﬁed with respect to what materials should be produced thus sequoia had several months to prepare its production of source code firmware and build tools by the courtordered delivery date of june 30 2008 547 on june 30 sequoia supplied cdrom created by wyle laboratories labeled 90g source and firmware 90h source and firmware wyle job t55627 01101this disk contained the complete ﬁrmware for the motherboard z80 the source code for the motherboard z80 except for the sources to certain library ﬁles for which only the linkable object code was present this library was later identiﬁed as coming from greenleaf software inc of richardson tx the source code and ﬁrmware for ﬁle subsysexe which is the voting program that runs on the daughterboard build tools eg compiler source code or ﬁrmware for the operating system on the daughterboard computer which appeared to be 1990sera doscompatible operating sys tem 101recall that we are using the term ﬁrmware to indicate the compiled program as it is loaded in the voting machine wyles label also uses the word in that sense 114no conﬁguration ﬁles execution environment for the daughterboard such as configsys or autoexecbat that would be expected to be present 548 we brought these omissions to sequoias attention and after some delay they provided on july 14 cdrom created by wyle laboratories labeled sequoia advantage 90g 90h source code compiler and reports wyle job t55023w013 this repeated much of the earlier material but also contained the build tools for the motherboard only that is the lattice c compiler and associated makeﬁles however still missing were build tools eg compiler makeﬁles for daughterboard source code and ﬁrmware for the operating system on the daughterboard computer execution environment for the daughterboard configsys autoexecbat etc 549 we brought these omissions to sequoias attention and after some delay they told us on july 14 that they had assembled the missing components and were preparing to send them to us in telephone telephone conversation that day be tween appel and mr david allen v p of development for sequoia v oting sys tems inc mr allen said that sequoia had not previously had the ﬁles in its own possession but had just ﬁnished gathering them from sunrise labs company that had built the daughterboard under contract to sequoia however during this conversation mr allen told appel that configsys and autoexecbat were not among the ﬁles that he had gathered mr allen said he would again contact sunrise labs to obtain these missing ﬁles 5410 on july 16 sequoia delivered disk that they described as the missing operating system and executionenvironment components it contained execution environment for the daughterboard configsys autoexecbat etc some operatingsystem components in firmware form certain components from datalight romdos 50su certain components from datalight romdos version 6 or 7 himemsys 115certain components from microsoft msdos 6 memexe modecom and moveexe component from an unidentiﬁed source njramdxsys however the bios components of the operating system were missing ibmbiocom and ibmdoscom mr allen said that they did not have this component be cause it was preinstalled on the daughterboard by the manufacturer of the daugh terboard processor 5411 we were able to extract the bios from the daughterboard of an vc advan tage belonging to union county and found that it was from general software inc 5412 in summary the ﬁrmware on sequoias vc advantage voting machine is an assemblage of components from sequoia itself and fewer than 6 different ven dors sunrise datalight microsoft ibm general software and one unknown furthermore it appears that before we engaged in them in the process of submit ting their entire ﬁrmware for examination sequoia did not have any organized records of what ﬁrmware was in their own voting machine and had never exam ined the bios components of the operating system to this day sequioa claims it does not have source code for any of the operating systems components running in the daughterboard 5413 therefore sequoia has effective way of knowing whether they have in stalled tainted ﬁrmware in the vc advantage this is serious problem for product in which fraudulent ﬁrmware can steal elections 55 conclusion of part v 551 sequoias sloppy software practices can lead to error and insecurity such pro gramming errors can miscount votes and permit fraud wyles ita reports are not rigorous so that programming errors and security vulnerabilities can and do slip through the ita examination process new jersey ofﬁcials who certify voting machines do not sufﬁciently examine even these inadequate ita reports 116part vi computer programming errors have actually disenfranchised nj voters 552 certain county clerks and others noticed inconsistencies in the printed pa per results reports from new jerseyss presidential primary election of february 5 2008 we have found that these were caused by two distinct design ﬂaws or programming errors in the vc advantage voting machine as consequence of these ﬂaws voters were disenfranchised 553 abugis computerprogramming error that causes the program to operate incorrectly needless to say bug in computer program that counts votes is serious issue 56 primary election partyafﬁliation bug disenfranchised voters 561 summary programming error in the vc advantage caused at least 37 and likely more primary voters to be given the wrong partys ballot to vote this was noticed because the resultsreport printouts from the machines were internally inconsistentthe number of votes cast in each primary did not match the number of voters in that primary stray optionswitch button press can interact with the programming error to cause the problem observed in 37 different vc advantage voting machines in the 2008 presidential pri mary the problem is signiﬁcant because it caused voters to be disenfran chised by denying them the ability to vote in their own partys primary in addition it wrongly permitted them to vote in the other partys primary 562 in the new jersey presidential primary of february 5 2008 anomalies were noticed on 38 different voting machines in 8 counties102our examination shows that one of these machines103experienced an error that is qualitatively different 102an opra open public records act request to all counties for copies of resultsreport print outs that exhibited anomalies yielded the following results bergen 4 machines burlington 1 camden 1 cape may 4 gloucester 2 hudson 16 ocean 1 union 8 103machine serial number 25249 in pennsauken election district 6 camden county 117from all the others we discuss this error separately in section 57 here we discuss the other 37 machines 563 in primary election the vc advantage counts the number of voters from each party that voted on the machine each voter permitted to vote only for candidate from her own party and the number of votes each candidate received and the total number of ballots cast on the machine the ﬁrmware of the machine the computer program is supposed to make sure that each voter votes only for candidate in her own partys election 564 the anomaly was that on several machines the number of votes for democratic candidates exceeded the number of democratic voters who had voted according to the results report printed by the machine just after the close of the polls on other machines the number of votes for republican candidates exceeded the number of republican voters the results report printed by the machine was inconsistent with itself 565 how primary elections work on the vc advantage before approaching the voting machine the voter signs the pollbook at the signin table the voter receives paper ticket called voting authority the voter them approaches the voting machine she hands the voting authority ticket to pollworker standing next to the voting machine in general election the pollworker would take the ticket and press the green activate button on the operator panel of the voting machine104 566 the procedure is slightly different in primary election the voter may vote either in the republican primary or the democratic primary but not both105how ever each vc advantage can accept ballots of either party when the voter enters the booth all the candidates of both parties would be shown in two separate rows the vc advantage does not have the capability to show only the candidates for just one of the parties at time because the display is just large paper sheet 104sources of information for ﬁrst three paragraphs of this section mercer and middlesex poll worker manuals sequoia vc advantage operator manual and from personal observation of elec tion procedures in mercer county 105to simplify the discussion we assume that only these two parties are holding primary elections as was the case in the 2008 new jersey presidential primary 118preprinted with candidate names in such way that they are placed by the appro priate buttons under the paper 567 only one partys ballot is enabled for each voter using the following process depending on the voters registered party afﬁliation she receives either republi can or democratic voting authority these are colored differently to avoid fusion in the next step in primary election the pollworker must ﬁrst tell the machine which partys ballot to activate he does this by pressing an extra button before pressing activate figure 33 operator panel 568 the operator panel of the vc advantage has an alphanumeric display 14 buttons and 16 red lights yellow button is labeled test green button is labeled activate and 12 buttons are labeled 1 through 12 in two columns see figure 33 the numbered buttons are called option switches depending on the ballot deﬁnition programmed into the results cartridge these option switches perform certain functions in an election outside of an election they also serve other purposes the panel has plastic window under which paper sheet may be inserted to label the functions of the buttons106 569 as the ballot deﬁnition used by union county for the 2008 presidential pri mary election was conﬁgured the lowerleft option switch number 6 selects the 106from our examination of vc advantage voting machines 119democratic primary and the lowerright option switch number 12 selects the re publican primary as the voting machines were used in the polling place the paper label sheet had the word democrat printed by switch 6 and republican by switch 12 switches 15 and 711 were unlabeled 5610 so when voter approached the voting machine and handed voting authority labeled democrat to the pollworker the pollworker was supposed to press 6 then activate conversely if the voter hands in republican voting authority and the pollworker is supposed to press 12thenactivate 5611 the results report printed by vc advantage serial number 17627 in ward 3 district 2 of the municipality of hillside in union county on february 5 2008 is shown in figure 34 the candidate totals are democrats obama 182 kucinich 0 edwards 0 biden 0 richardson 0 clinton 179 this adds up to 361 republicans giuliani 1 thompson 0 romney 13 mccain 40 paul 3 huckabee 4 this adds up to 61 5612 in this results report the number of democratic voters is listed as 362 and the number of republican voters is listed as 60 there are more votes than voters in the republican primary this should be impossible 5613 also there are more voters than votes in the democratic primary in some kinds of elections this situation should be possible because voters are not com pelled to select candidate in every contest but in this election union countys ballot deﬁnition required each voter to cast exactly one vote in the primary election the cast v ote button had effect if the voter had not chosen candidate thus it should have been impossible to have 361 democratic votes by 362 democratic voters 5614 the record of how many voters were enabled to vote in the democratic primary and how many in the republican primary is called the option switch totals as it is printed on the ofﬁcial election results report the record of how many votes were cast for each candidate is called the candidate totals in principle the candidate totals for the democratic candidates should add up exactly to the option switch totals for button number 6 labeled 1dem in the printout and similarly for the republican candidates and the republican optionswitch total but on this printout there are erroneous and inconsistent numbers as we have explained 120figure 34 results report tape from ward 3 district 2 of the municipality of hillside in union county presidential primary election of february 5 2008 1215615 this discrepancy was noticed by the union county clerk joanne rajoppi she then examined results reports printed by other voting machines in union county and found several more such discrepancies she alerted the county clerks of other counties and they found dozens more similar discrepancies these county ofﬁcials then requested the attorney general to conduct an investigation into the cause 5616 subsequently sequoia v oting systems sent memo entitled to vc ad vantage customers using series 90 ﬁrmware dated march 4 2008 containing sequoias explanation of how this anomaly arose it explains that software programming error bug was triggered when the pollworker pressed different button than 6 or 12 on the operator panel sequoia makes the claim that notwith standing the incorrect optionswitch totals the votes were added correctly what sequoia leaves out is that this programming error disenfranchised voters by denying them the ability to vote in their own partys primary 5617 if the election worker on being handed voting authority labeled demo crat presses the 6 button then presses an unlabeled button 15 or 711 then activate the software bug caused the machine to behave as follows the red light next to operatorpanel button 6 would stay illuminated the optionswitch total would count as 6 but the republican ballot would be enabled on the voter panel and the machine would accept votes only for republican candidates 5618 it would be easy and natural for pollworker to make this mistake button 7 is directly under the activate button pressing 6then7 instead of 6thenactivate would be natural then attempting to correct the problem by pressing activate leads to the sequence 67activate 5619 in other counties where button 6 was assigned to republican and button 12 to democrat the pattern was reversed as to party voter would hand republican voting authority to the pollworker the pollworker would press 6x activate where x is any button 15 or 711 then the voter would ﬁnd that only democratic candidates could be voted for but the optionswitch total counted as republican 5620 one might think that the voter would complain to the pollworker that the ma chine was not working properly this may have happened perhaps far more than 37 times in that case there is way for the pollworker to deactivate the vc advantage and reactivate it for the right party in any case we know that 37 voters did not successfully complain and ended up voting in the wrong primary election 1225621 in our examination of the source code of the vc advantage we found soft ware bug consistent with sequoias explanation in their memo of march 4 2008 this bug almost certainly caused most of the anomalies noticed in results reports printed on february 5 2008 however one machine demonstrated an anomaly that cannot be explained this way see section 57 5622 loss of the franchise and unauthorized votes it is important to consider what this means in union county for some particular voter pollworker pressed the option switch for democratic and did notpress the option switch for repub lican then he inadvertently pressed another button neither democratic nor re publican then he pressed activate this means that almost certainly he had been handed voting authority labeled democrat the voter however was not able to vote in the democratic primary as was her right futhermore the voter then cast ballot in the republican primary which she was not permitted to do by law and this vote was recorded and counted 5623 appendix c gives more technical explanation of sequoias computerprogramming error that led to the disenfranchisement of voters 57 hardware malfunctions can disenfranchise voters 571 summary hardware errors in the vc advantage can cause votes to be lost when results cartridge fails the voting machine indicates an error but it is not possible for either the voter or pollworkers to determine whether or not the vote was recorded this occurred in the 2008 presidential primary and can occur in general elections as well 572 the vc advantage is supposed to have doubleredundant storage for votes it is supposed to record votes in an internal memory as well as in removable results cartridge in case hardware failure during an election causes one memory to be lost 573 however there is design ﬂaw in the vc advantage if one of these mem ories fails while voter is in the booth it is not possible to know whether that voters vote has been recorded in the other memory therefore even the most knowledgeable and alert pollworker would have way of knowing whether to permit the voter to use different voting machine to cast her vote 123574 this situation actually arose in the february 5 2008 primary election an vc advantage voting machine in the town of pennsauken in camden county107 experienced an anomaly that cannot be explained by the optionswitch bug ex planation experienced by 37 other machines on that day on this dre the public counter printed as 29 meaning that 29 voters have voted on this dre in this elec tion the results report printed by the vc advantage at the close of the polls showed the following tally democrats clinton 14 obama 7 richardson 0 edwards 0 kucinich 0 biden 0 republicans mccain 5 paul 2 giuliani 0 huckabee 0 romney 2 thomp 0 this adds up to 30 votes thus the number of votes recorded exceeds the number of voters this should not happen the option switch totals are dem 20 rep 9 adding up to 29 575 according to our examination of the vc advantage source code this error cannot be caused by the optionswitch bug described in section 56 therefore it must have different cause 576 in our examination of the source code and in our examination of the behavior of an actual machine108we have identiﬁed the following source of error 577 after the voter presses cast v ote the vc advantage does the following book keeping in this order 1 play the chirping sound and wait for it to complete 2 write ballot image few bytes that record 1bit in each votedfor po sition and 0bit in each unvoted ballot position to the internal memory and to the results cartridge the internal memory is batterybacked mem ory on the motherboard the results cartridge contains small circuit board with batterybacked memory 3 if the voter cast writein votes store them in the internal memory and in the results cartridge 4 add this voters votes to the candidate totals and write the updated candidate totals to the internal memory and the results cartridge 107machine serial number 25249 in pennsauken election district 6 camden county 108a vc advantage serial number 17926 owned by union county nj 1245 if in primary election add 1 to the optionswitch totals for the selected option switch both in the internal memory and in the results cartridge 6 add 1 to the public counter which maintains count of the total number of votes cast during the election 7 add 1 to the protective counter which maintains count of the total number of votes ever cast on this machine 578 if the machine is interrupted during this process then the ﬁrst few steps will complete but not the rest an error message will appear on the operator panel and the machine will not accept any more votes 579 the interrupts that cause the cast v ote process to suspend include failure of communication to the results cartridge whether or not audio voting is in progress failure of communication to the audiovoting keypad when audio voting is in progress in our experiments we deliberately caused these failures of communication by unplugging the results cartridge or the audiovoting keypad just after casting the vote the results are shown in figure 35 depending on how exactly when the results cartridge fails or is disconnected the list of ballot images disagrees with the candidate totals this error is not observable from the resultsreport printout alone but can be seen by wineds in the results cartridge or the candidate totals disagree with the optionswitch totals or the candidate totals and optionswitch totals agree but disagree with the public counter 5710 we presume that in pennsauken camden county on february 5 nobody yanked out results cartridge from the back of the machine just as voter pressed cast v ote however an electrical failure in the results cartridge or in the socket of the results port could also cause this problem 5711 there were two advantage machines in pennsauken district 6 that morning 25574 and 25249 it must be the case that some component of machine 25249 125a b c figure 35 three resultsreport printouts from avc advantage machines demon strating inconsistencies an ofﬁcial report signed by election board workers at the polling place from camden county on feb 5 2008 the candidate totals exceed the public counter b report that we produced july 12 2008 on avc advantage 17926 owned by union county the candidate totals exceed the public counter c report that we produced july 12 2008 on avc advantage 17926 owned by union county the candidate totals exceed the optionswitch totals 126failed on the 30th ballot cast at or before 820 am and then more ballots were cast on that machine on february 5th then camden county delivered replacement vc advantage 25690 to this polling place109 5712 the results cartridge failed to capture vote data camden countys log110 states cartridge was loose 5713 other evidence hints that the results cartridge of this machine failed since this information was relayed to us at third or fourth hand we will take it as sug gestive but we will not rely on it in making our conclusions111an examination of the original results cartridge in its original state would help clarify how exactly this voting machine failed this cartridge although requested in subpoena has not been made available to the plaintiffs or to our team 5714 some evidence hints that even though the results cartridge failed camden county was able to read some information from it onepage report112apparently printed by wineds perhaps from this results cartridge indicates votes of democrats clinton 14 obama 6 richardson 0 edwards 0 kucinich 0 biden 0 republicans mccain 5 paul 2 giuliani 0 huckabee 0 romney 2 thomp 0 109records of replacement machines delivered to precincts bates number cam 00010002 cam 000297000299 1102008 presidential primary machine report bates number cam 000450 as follows pennsauken 6 25249 820 am system error 31 could not be cleared check upon return cartridge was loose once pushed in error cleared 111email from deputy attorney general jason postelnik to penny venetis july 30 2008 due to the issue that machine 25249 experienced on feb 5 the ballot cartridge reader in conjunction with the wineds software could not read this voting machine cartridge this meant that its results information was not uploaded onto the server and was not saved the results from that cartridge had to be manually entered into wineds from the election results report retrieved using the cartridge utility function in this email mr postelnik appears to be conveying information given to him by the camden county superintendent of elections we ﬁnd the last sentence suggestive of many possibilities if the cartridge could not be read at all then it would not have been possible to retrieve anything from it using the cartridge utility function of wineds we suppose it is possible that the cartridge could be partially read but not completely read so that normal uploading into wineds failed but one of the cartridge utility functions did work in this case examination of the cartridge in its original state would shed some light on the general accuracy of cartridge data 112bates number cam 000301 127this adds up to 29 votes if this information is from the results cartridge then the results cartridge does not agree with the printed results report from the machine signed by witnesses listing 7 votes for obama and 30 votes overall 5715 we analyzed the election totals reported by the camden county clerk for this precinct113figure 36 summarizes the printouts from the results tapes along with the totals reported by the clerk 5716 in that table the boxed pair indicates an inconsistency produced we clude by failure of the voting machine or the results cartridge probably the results cartridge 5717 the doublyboxed pair in the table indicates an inconsistency the results report signed by witnesses in the polling places add up to 95 votes for obama but the clerk reports 94 votes for obama the county clerk has subtracted one vote for barack obama apparently he was relying on the data extracted from the failed results cartridge as we described in 5714 5718 in summary when the vc advantage experiences hardware failure voters are disenfranchised next we will explain how design ﬂaw in the vc advantage contributes to this disenfranchisement how voters are disenfranchised by results cartridge failures 5719 when an vc advantage fails in the cast v ote process it is impossible at that time before the close of the polls to know whether the last vote has recorded in the machines internal memory or in the results cartridge or both or neither114 this can only be deduced later after the polls are closed and the results are printed and the results cartridge has been extracted 5720 but it is essential to know whether to permit the voter to recast the vote on another voting machine if the vote has already been recorded in the results car tridge then the voter must not cast another vote or else she will have voted twice 113a document obtained by opra open public records act request from the clerk of camden county listing precinctbyprecinct totals for all democratic candidates in the presidential primary of february 5 2008 114we conclude this from our examination of the source code and from experiments performed on an vc advantage machine 128tape reported results v oting 25574 25690 25249 total by clerk cartridge authorities clinton 868114181 18114 obama 4543795 946 richardson 1102 20 edwards 1001 10 kucinich 0000 00 biden 0101 10 dem 1331262020 total 133 126 21 280 27920 283 figure 36 inconsistent data from pennsauken 6 in camden county tape total is the sum of number reported by the voting machines on their printed paper resultsreport tapes signed by witnesses results cartridge is the data that may have been extracted from the results cartridge of 25249 the evidence is ambiguous see 5714 and footnote 111 dem is the optionswitch total printed on the results reports that is the number of voters the machine reports in the democratic primary the asteriskindicates data printed onto paper results reports by the voting machine whose serial number is given at the top of the column and signed by witnesses the daggerindicates data reported by the county clerk as the ofﬁcial election results for this precinct 3 voting machines cumulated together the doubledaggeris the number of democrat voting authority slips collected in this precinct copies delivered by donna whiteside assistent county counsel camden county august 8 2008 all numbers without we calculated from the raw datain the same row or column the boxed pairs should agree with each other but do not see 57165717 even aside from the one lost vote on the malfunctioning vc advan tage there appears to be an undervote of 3 votes there are 283 voting authority stubs but only 279 or 280 votes see section 30 129if the vote has not already been recorded then the voter must be permitted to cast another vote 5721 the behavior of the vc advantage when results cartridge fails constitutes design ﬂaw the design of the machine makes it impossible to know whether the vote has been recorded this risks disenfranchising voters or erroneously permit ting voters to vote twice 5722 usefulness of opticalscan ballots widely used form of v oterveriﬁed paper ballot is the opticalscan ballot in places where precinctcount optical scan ners are used to satisfy the requirement for voterveriﬁed paper record of each vote cast the confusion about did the machine record vote can be entirely avoided because the ballot was physically marked by the voter herself and physi cally deposited through the optical scanner into the ballot box by the voter in the presence of witnesses there is doubt about whether the ballot is in the ballot box 58 conclusion of part vi anomalies noticed by county clerks in the new jersey 2008 presidential primary were caused by two different design errors on the part of sequoia the option switch error was caused by computerprogramming bug in the ﬁrmware of the vc advantage that had the effect disenfranchising voters by presenting the wrong partys primary ballot to them the error that occurred in camden county was design error in the ﬁrmware that causes the vc advantage not to accu rately report whether or not vote has been recorded as we explained this also has the effect of disenfranchising the voter 130part vii different versions of the avc dvantage have different vulnerabilities 581 the vc advantage has been produced in many versions since it was intro duced in the 1980s these version differ in what ﬁrmware is loaded into their roms in this part we explain what machines we examined and how these ma chines relate to other machines that have been used or might be used in new jersey 59 advantage versions 900g and 900h have identical vulnerabilities 591 in july and august 2008 we examined source code ﬁrmware115and the phys ical hardware of the sequoia vc advantage directrecording electronic voting computer the machines and software116that we examined were version 900h of the vc advantage series dated october 5 2005117the state of new jersey provided to us two voting machines owned by union county new jersey contain ing the 900h ﬁrmware therefore we studied primarily the 900h version of the softwareﬁrmware version 900g and 900h differ only slightly in their ﬁrmware so our conclusions apply to both versions most new jersey counties use version 900h but hudson and mercer counties have version 900g machines118 592 versions of the avc advantage both before and after 900h differ signiﬁcantly in vulnerability to hacking and in other respects see sections 60 62 and 61 unless stated otherwise conclusions in this report about the security and accuracy 115in this document we use the term ﬁrmware to mean executable object code installed in rom or in flash memory on the voting machine 116in this document we use the term software to encompass source code and executable object code 117sequoia provided to us version 900g and 900h of both the software and ﬁrmware with source code missing for some components ﬁle within the source code which lists the software revision history indicates date for 900g of january 19 2004 and date for 900h of october 5 2005 some ﬁles of the audio subsystem are dated october 20 2005 118statement of assistant attorney general donna kelly to the court july 22 2008 131of the avc advantage should be taken to apply only to versions 900g and 900h and not to earlier or more recent versions 60 the vc advantage has changed great deal in successive versions 601 summary the vc advantage has had many substantial ﬁrmware rewrites since its introduction in the 1980s the hardware from 1984 to 2002 had just z80 motherboard computer since 2003 it also has more powerful daugh terboard computer the version 9 machine currently in use in new jersey uses the daughterboard just for audio voting in the version 10 machine proposed for use in new jersey the daughterboard is the main processor 602 the vc advantage was ﬁrst produced in the 1980s perhaps as early as 1984 and has been product of sequoia since about 1987 throughout the 1990s and to the present sequoia has continued software development between 1994 and 2003 the size of the ﬁrmware more than doubled this is very signiﬁcant change different version numbers eg 500 600 etc of the vc advantage are signiﬁcantly different voting machines that differ in their security accuracy and reliability 603 new jersey statutes prescribe that any voting machine used in the state must be examined by committee and approved by the chief election ofﬁcial however njsa 1953a4 reads when such device has been improved or any improvement or change which does not impair its accuracy efﬁciency or ability to meet such requirements shall not require reexamination or reapproval thereof 604 we am not lawyers and we will not attempt to interpret the exact legal meaning of this sentence however we can say as technical experts that each of the changes made between major version numbers119of the vc advantage eg from version 5 to version 8 or version 8 to version 9 are substantial enough that they can be expected to affect or impair the accuracy efﬁciency or ability to meet the technical requirements imposed by njsa 19 we will give some examples in the next two sections of this report 119for this analysis and for the table in 605 we are relying on version history summary that we found in the source code of the version 900h vc advantage provided to us for exam ination for information on vc advantages versions 10x we are relying on reports from wyle laboratories 132605 the following table demonstrates that the vc advantage ﬁrmware is mov ing target it differs substantially in functionality from year to year version date notable added features 500 1994 multiple ballots 600 1995 postqat 700 1996 expanded option switches early voting 800 1997 dozens or hundreds of bug ﬁxes and minor changes 800a 1998 mostly documentation changes 800b 1998 bug ﬁx 900 2003 fec modiﬁcation requests audio voting 900c 2003 bug ﬁxes update to fec coding standards 900d 2003 900f g 2004 900h 2005 few changes related to audio voting andor fec requirements 10 daughterboard computer now main cpu 105 v oterveriﬁed paper ballot although some of these changes have rather cryptic names eg postqat the main point is that there have been many changes to the computer program different vc advantage models use different methods to handle ballots and count votes 606 in approximately 2003 sequoia added the audio voting feature to accommo date disabled voters who cannot use the fullface visual interface this was ma jor change because the 1976vintage z80 computer used in the 1980s design is not powerful enough to handle audio therefore sequoia added an audio kit contain ing second processor to drive the headphones used by disabled voters the audio kit comprises daughterboard inside the cabinet containing second computer and handheld unit containing yet third computer 607 the daughterboard processor is much more powerful than the z80 it is an amd elan sc400 processor intel 486 compatible with 2 megabytes of ﬂash memory and 8 megabytes of ram 608 the z80 motherboard communicates with the daughterboard via threewire connection that implements the rs232 serial protocol the motherboard taining the z80 is directly connected to the voter panel the operator panel and the results cartridge the daughterboard has direct connection to these devices in addition the daughterboard can connect to an external io device the audio v oting assembly 133609 the audio v oting assembly is black plastic box that the disabled voter can hold in his or her hand and into which one plugs the headphones or other devices it has several userinterface buttons and contains dsp digital signal processor chip that plays pcm pulsecode modulation audio ﬁles sent to it by the daugh terboard computer 6010 in version 9 which we examined the z80 is considered the main computer and the audiokit daughterboard contains smaller granddaughterboard with 486 compatible processor the source code refers to the audio kit as the subsystem 6011 starting from version 10 also known as d10 the intel 486compatible pro cessor on the daughterboard is considered the main processor while the z80 on the motherboard is relegated to the role of io processor120from our exami nation of version 900h we can say that this characterization main 486 io processor z80 does not apply to version 9 in the version 9 vc advantage the motherboard z80 is clearly the main processor and the 468compatible daugh terboard just handles audio ballots the software changes to move the main functionality of the machine from the motherboard to the daughterboard are likely to be very substantial and this change introduces severe security vulnerabilities see section 61 6012 conclusion from technical point of view each version of the vc ad vantage is sufﬁciently different that one cannot examine one of these versions and from that draw conclusions that different version securely and accurately counts the votes therefore we believe that each version of the vc advantage should be separately examined for security and accuracy before it is used 61 version 10 vc advantage is extremely vulnerable to fraud 611 summary the new sequoia vc advantage version 10 has very similar hardware to the version 9 but the ﬁrmware has been completely overhauled evidence shows that the ﬁrmware has not just been modiﬁed but is mostly new because most of the functionality is now on the daughterboard and the daugherboard is less secure than the mother board this model should be considered signiﬁcantly more vulnerable to fraud than the version 9 machines 120hardware qualiﬁcation testing of the sequoia vc advantage dre v oting machine firmware version 1015 wyle laboratories report 5188408 april 12 2006 134612 sequoias successor to the version 9 vc advantage is called the vc ad vantage d10 this is the only version of the vc advantage to which sequoia is able to attach its proposed voterveriﬁed paper ballot printer mr cramer of sequoia testiﬁed before this court in 2006 that the new printer does not attach di rectly to the z80 motherboard instead it attache through the daughterboard all of the different prototype advantagewithballotprinter machines that sequoia has provided to the state for testing or to the new jersey v oting machine examina tion committee are version 10 vc advantage machines the wyle laboratories reports that sequoia has provided to the state in connection with these advantage withballotprinter machines describe it as version 10 613 wyle laboratories report121on one version of the d10 characterizes its in ternal architecture as follows main cpu this is an embedded amd elan sc400 based system run ning romdos it contains 8 mb of dram 2 mb of flash rom used for application program storage ballot deﬁnition and vote data storage pcmcia slot used for the results cartridge battery backed real time clock and serial port for communication with the io board io board cpu this is the original z80 cpu with ﬁrmware version 10 it manages io devices and communicates via dedicated serial port with the main cpu it contains program rom system rom conﬁguration rom time and date clock backup batteries timers and counters speaker beeper and additional circuits for selfmonitoring connecting the other assemblies and controlling vc power consumption 614 this hardware conﬁguration is almost the same as the hardware conﬁguration of the version 9 model however the largeformat batterybacked results cartridges plugged into the z80 motherboard are longer used instead the pcmcia car tridge that plugs into the daughterboard computer which is now the main cpu is now called the results cartridge in the version 9 model this pcmcia car tridge was used primarily for audio ballot ﬁles and for installing new software into the daughterboard computer 615 although the hardware is much the same the software conﬁguration is very different sequoia has migrated much of the election functionality to the intel486 121hardware qualiﬁcation testing of the sequoia vc advantage dre voting machine firmware version 1015 wyle laboratories report number 5188408 april 12 2006 135figure 37 this cartridge used only for audio ballots on avc advantage 900 is used as results cartridge on avc advantage 10 compatible daughterboard computer the wyle ita report on this machine in the section on the ﬁrmware says the sequoia vc advantage x1 was signiﬁcant change from 900h1 with half of the ﬁles being brand new change log was supplied122 the signiﬁcance of change log is this when making modiﬁcations to piece of software it is standard industry practice to keep change lognot just for outside examiners but for the use of the engineers developing the software if one considers some piece of software to be mostly or completely new one might discard the change log therefore we conclude that the sequoia engineers consider the vc advantage version 10 to be new votingmachine control program not principally modiﬁcation of an old one 616 the architecture of the d10 model is cause for concern because the control program for the main cpu is kept entirely in ﬂash memory in contrast to the version 9 vc advantage in which some of the most dangerous attacks required the use of screwdriver to physically replace roms in the d10 the virus attacks described in section 20 will be able to install votestealing programs directly into the main processor where they have direct access to all vote data 617 this is severe vulnerability and the vc advantage d10 model should be considered extremely insecure pending detailed study of that machine this design is also in violation of fec standards123 122idwyle 5188408 p b27 123see footnote 48 on page 57 136618 the severe insecurities in the vc advantage version 10 are signiﬁcant because the version 10 is the only upgrade path that sequoia proposes for added voterveriﬁed paper ballots vvpat to the vc advantage 619 on may 22 2008 the new jersey v oting machine examination committee chaired by mr richard woodbridge held hearing on the vc advantage model d10 dre with voterveriﬁed paper ballot printer appel attended this hearing mr woodbridge made it clear that this was not certiﬁcation hearing for the vc advantage voting machine itself but only for the printer attachment 6110 in letter of may 27 2008 to mr woodbridge appel explained the risk in the d10 version of the advantage of viral propagation of fraudulent ﬁrmware he explained that the design change to the vc advantage between version 9 and version 10 are very substantial he explained that this change does impair the accuracy of the vc advantage for that reason he urged mr woodbridge to hold full certiﬁcation hearing on the vc advantage d10 voting machine not just on the printer attachment 6111 the basic information in wyles report on the vc advantage d10 613 was enough for appel to be able to deduce the existence of this problem and alert mr woodbridge his conclusions have been strengthened by the subsequent ex amination we made of the vc advantage 900 the fact that the wyle examiners did not report on the security vulnerabilities caused by this design is evidence of the inadequacy of ita reports the fact that mr woodbridge did not notice this problem in reading the wyle report on the d10 is evidence of the inadequacy of the current examinationcertiﬁcation process in new jersey 6112 on june 25 2008 mr woodbridges committee recommended to the secretary of state the approval of the vc advantage model d10 they did so without per forming certiﬁcation examination of the voting machine but only of the printer attachment certiﬁcation examination or hearing on the entire d10 machine not just on its printer has been done in new jersey 62 version 8 vc advantage is vulnerable to fraud in some ways that version 9 is not 621 summary mercer county owns 50 of the version 8 vc advantage ma chines these earlier models of the vc advantage before version 9 are vul 137nerable to fraud in certain ways that do not apply to the version 9 machine 622 most of mercer countys vc advantage machines are version 900g in ad dition mercer county has 50 version 800 vc advantage machines that are used as backup spares during elections and for high school elections124it is our under standing that backup spares are used in real elections especially as replacements for machines that fail in the polling places125 623 we examined version 900h vc advantage machines source code and ﬁrmware from the source code we can make inferences about version 800 vc advantage machines and prior versions the evidence for these inferences includes 1 revision histories and change logs 2 vestigial inactive program code 3 inconsistencies between comments and code providing evidence of previous functionality in the code from this evidence we conclude the following execution from program ram permits fraudulent ﬁrmware to be eas ily installed 624 in version 8 and before insertion of program cartridge into the auxiliary port would cause z80 executable code to be transferred to program ram and then this program ram could be mapped to the z80 program address space and executed comment in the source code dated april 23 2002 ie after version 8 during the development of version 9 indicates the removal of this functionality in the program code itself we ﬁnd some vestigial remainders of this functionality such as the designation of certain numbers as program ram bank numbers 625 execution of programs from ram constitutes serious security vulnerability it can permit votestealing ﬁrmware to be installed simply by plugging program cartridge into the auxiliary port appendix f describes how the version 8 vc advantage was designed to permit execution of programs in ram from program cartridges 124statement of assistant attorney general donna kelly to the court july 22 2008 125as is the practice for example in camden county bates number cam 00010002 138626 therefore we conclude that version 8 and prior releases of the vc advan tage are potentially severely vulnerable to the installation of votestealing software simply by inserting cartridge into the auxiliary port without removal of the cir cuit board cover the ability to reprogram ballots on the version 8 vc advantage stitutes another security vulnerability 627 in normal use county uses the eds or wineds program to program ballot deﬁnitions into results cartridges then these results cartridges are inserted into the vc advantage voting computers 628 however in version 8 and prior it was possible to program ballot deﬁnitions into results cartridges directly from an operatorpanel menu of an vc advantage machine this may have provided way to manipulate elections and was criticized by election security experts this feature of the vc advantage was removed apparently in 2001 and is longer present in version 9 63 conclusion of part vii 631 the vc advantage has been produced in many versions the ﬁrmwarethe computer program that decides how to count the votesfunctions signiﬁcantly dif ferently from one version to another the accuracy of one version may be therefore quite different from the accuracy of another version the fact that one version may have been examined for certiﬁcation does not give grounds for conﬁdence in the security and accuracy of different version new jersey should not use any ver sion of the vc advantage that it has not actually examined with the assistance of skilled computersecurity experts 139part viii conclusions and recommendations 64 new jersey should not continue to use the vc advantage 900 because it is insecure 641 summary paperless dres in general and the vc advantage in particu lar lack the crucial quality of software independence therefore the choice of election results in each precinct is entirely at the discretion of the computer softwareﬁrmware and not independently checked therefore they cannot be trusted to count the votes 642 in section 16 we explained the scientiﬁc consensus with which we concur that paperless dre voting machines are inherently susceptible to fraud because they lack software independence that is how the votes are recorded and counted depends on the software ﬁrmware inside the dre machine and is not indepen dently checkable 643 not only is the vc advantage 900 used throughout new jersey inherently susceptible to fraud and error because it is paperless dre but we found in our examination that it is particularly and speciﬁcally susceptible in this report we have explained those speciﬁc vulnerabilities 644 this makes the vc advantage unsafe for use in elections it cannot be trusted to count the votes legitimately 65 new jersey should immediately remove the audio kits 651 summary the audio kits are grossly insecure making it easy to steal the votes of disabled voters their insecurity makes the rest of the machine less secure as well 652 as we explained in 244 on the vc advantage 900 the votes of disabled voters are even more vulnerable to theft by computer virus than the votes entered on the fullface voter panel therefore with great respect for the rights of disabled 140citizens to be accommodated but with particular concern for the protection of the votes of disabled voters we recommend that new jersey remove the audio kits from all its vc advantage voting machines 653 removing the audio kits is simple and immediate matter even after they are removed the vc advantage will have severe insecurities and sources of in accuracy however removing the audio kits also removes the possibility of viral propagation of fraudulent ﬁrmware 654 removing the audio kits can be done safely as little as one month before an election counties will have to set one option differently in their ballotdeﬁnition programming the option to enabledisable audio ballots if the audio ballot is disabled then the motherboard will not even attempt to communicate with the audio kit 655 even so removing the audio kits is problematic for two reasons first it means that the vc advantage will not be usable by certain disabled voters with out person to assist them which means that the advantage machines would not be v acompliant second it cuts off the upgrade path to voterveriﬁed paper ballot since sequoias vvpat printer is connected through the audio kit and not directly to the z80 motherboard 66 there is way to safely use computers to count votes 661 software independence does not mean that computers and computerized vot ing machines cannot be involved in elections it means that any calculations done by the computers must be veriﬁable independently of the computer program in fact it is reasonable and often desirable to have computers involved in elections as long as software independence can be achieved 662 the only currently available technology that combines computer technology with software independence is the voterveriﬁed paper ballot that means an in dividual paper record of each vote cast seen and veriﬁed by the voter at the time the vote is cast collected in ballot box so that it can be recounted by hand if necessary 663 not every precinct must be recounted by hand only very small statistical sample of precincts or ballots needs to be audited just to defend against the possi 141bility of systematic widespread fraud or error in the computercounting ﬁrmware new jersey law passed in 2008 now requires just this kind of audit 664 combining computer count of the ballots with hand audit gives the best of both worlds because the modalities of fraud or error are very different for computer softwareﬁrmware and for hand counting each kind of count will serve as check on the other someone who wishes to cheat will have to ensure that fraudulent ﬁrmware miscount comes out exactly the same as the fraudulent paper recount and this is not easy to accomplish 665 none of what we say in this section would come as news to the new jersey legislature which in 2005 passed law requiring voterveriﬁed paper ballots and in 2008 passed law requiring statistical audits of those ballots for the reasons discussed throughout this report those laws should be implemented immediately in order to protect the votes of new jersey voters not only is the vc advantage 900 noncompliant with those laws from technical point of view but it is substan tively insecure as we have explained in this report therefore we recommend that the vc advantage be replaced with more secure technology as we will explain in the next section 67 forms of voterveriﬁed paper ballots 671 v oterveriﬁed paper ballots are available in three forms using currently avail able technology hand counted paper ballots opticalscan ballots counted by com puter and paper ballots automatically printed by dre voting machines 672 it is the overwhelming consensus of those computer scientists who have studied voting technology that the most trustworthy robust and reliable form of voterveriﬁed paper ballot is the precinctcount opticalscan ballot we will explain what this means and why this is 673 an opticalscan ballot is paper ballot printed with contests and candidates the voter ﬁlls in an oval or connects an arrow by the candidates she chooses in centralcount optical scan the voter then deposits the ballot into ballot box at the close of the polls the ballot box is taken to central location where high speed optical scanner counts the ballots for many precincts 674 in contrast in precinctcount optical scan the voter feeds the opticalscan ballot directly into scanning machine this machine counts the ballot and 142posits it into ballot box immediately at the close of the polls the election results for that precinct are printed by the scanning machine the sealed ballot box full of opticalscan ballots is available for hand recounts which can be done to audit the count made by the scanning machine 675 opticalscan voting has very signiﬁcant advantages over dres equipped with paperballot printers 676 the more voters actually examine and verify the choices written on their paper ballots the more useful statistical audit is there is quite bit of doubt about how closely voters examine the paper ballots printed for them by dre machines after they make their choices electronically in contrast voters who ﬁlled out an opticalscan form made the marks themselves which means they are much more likely to know what marks are there 677 v oting machines of all kinds can malfunction or fail to turn on at all in the case of dre even with ballotprinter the voters cannot vote with optical scan ballots voters can still use pencil to mark their ballots without any difﬁculty if precinctcount machine fails to operate voters can simply deposit their ballots into the ballot box for counting later 678 only one person can use dre at time if the ballot is very lengthy or complex this can take several minutes especially with the review of the dreprinted paper ballot in contrast several voters using opticalscan bal lots can fan out into several cheap voting booths and use several cheap pencils to ﬁll out their ballots when each voter has taken as long as she wants to ﬁll out and review the ballot she can emerge from the booth and deposit the ballot into the machine 679 fewer opticalscan machines are needed per precinct than dre voting ma chines this is mainly for the reason described in the previous paragraph but also for another reason it is best to have two dre machines in every precinct even if there are not very many voters just in case one failsit takes two hours or more to dispatch spare by truck if one machine fails126 in contrast opticalscan ballots are still very usable by voters even if the scanner fails 6710 with dreplusprinter there is difﬁcult and ambiguous situation if the voter claims that the machine is printing choices that do not correspond to the voters choices either the machine is cheating or malfunctioning or the 126records of replacement machines delivered to precincts bates number cam 000297000299 143voter is lying or mistaken the pollworker cannot know which is the case without violating the privacy of the ballotand in any case resolving this kind of touchy situation is one that we should not have to ask of pollworkers in contrast there can be doubt about the selections written on an optical scan ballot because the voter and only the voter wrote those selections with pencil 6711 the userinterface of opticalscan ballots is simple and intuitive that is not to say it is perfectlike the sequoia vc advantage dre opticalscan ballots have difﬁculty giving the voter feedback about undervotes see sec tion 33 but the system is understandable by voters and they have difﬁ culty knowing whether their ballot has been cast 6712 precinctcount preferred to centralcount of the two forms of opticalscan voting it is the overwhelming consensus of experts not just computer scientists but others as well who have studied these technologies that precinctcount optical scan is preferable to centralcount opticalscan this is for two main reasons 1 precinctcount opticalscanners can practically eliminate the rate of over voted and otherwise voided ballots by giving immediate feedback to the voter if the voter feeds an overvoted or otherwise invalid ballot into precinctcount opticalscan machine the machine spits it back out with message informing the voter about the problem the voter then has chance to correct the problem either win an eraser or by having his ballot destroyed and receiving fresh ballot from election workers127 2 precinctcount opticalscanners deliver total immediately at the close of the polls in the presence of witnesses before there is any question of chainof custody in contrast when ballot box that is to be centrally counted leaves the polling place it is subject to manipulation stufﬁng and replacement before it reaches the centralcount facility 6713 in conclusion it is our own opinionand that of the overwhelming consen of election technology expertsthat precinctcount optical scan is the most trustworthy robust and costeffective method of voting that is now available we recommend that new jersey adopt precinctcount optical scan technology 127usually there is an override available if the voter is in hurry to leave he can cast the ballot anyway the overvoted contest will be void but all the other contests she voted in will count 14468 summary of conclusions reached in this report 681 part i the vc advantage 900 is easily hacked by the installation of fraudulent ﬁrmware this is done by prying just one rom chip from its socket and pushing new one in or by replacement of the z80 processor chip we have demonstrated that this hack takes just 7 minutes to perform the fraudulent ﬁrmware can steal votes during an election just as its criminal designer programs it to do the fraud cannot practically be detected there is paper audit trail on this machine all electronic records of the votes are under control of the ﬁrmware which can manipulate them all simultaneously 682 part ii without even touching single vc advantage an attacker can in stall fraudulent ﬁrmware into many vc advantage machines by viral propaga tion through audioballot cartridges the virus can steal the votes of blind voters can cause vc advantages in targeted precincts to fail to operate or can cause wineds software to tally votes inaccurately 683 part iii design ﬂaws in the user interface of the vc advantage disenfran chise voters or violate voter privacy by causing votes not to be counted and by allowing pollworkers to commit fraud 684 part iv vc advantage results cartridges can be easily manipulated to change votes after the polls are closed but before results from different precincts are cumulated together 685 part v sequoias sloppy software practices can lead to error and insecurity wyles ita reports are not rigorous and are inadequate to detect security vulnera bilities programming errors that slip through these processes can miscount votes and permit fraud 686 part vi anomalies noticed by county clerks in the new jersey 2008 pres idential primary were caused by two different programming errors on the part of sequoia and had the effect of disenfranchising voters 687 part vii the vc advantage has been produced in many versions the fact that one version may have been examined for certiﬁcation does not give grounds for conﬁdence in the security and accuracy of different version new jersey should 145not use any version of the vc advantage that it has not actually examined with the assistance of skilled computersecurity experts 688 part viii the vc advantage is too insecure to use in new jersey new jer sey should immediately implement the 2005 law passed by the legislature requir ing an individual voterveriﬁed record of each vote cast by adopting precinctcount opticalscan voting equipment 146part ix appendices memory devices a1 in evaluating the security of the vc advantage we considered all of its memory devices in which executable softwareﬁrmware could in principle reside these are the ones that are relevant to the installation of fraudulent votestealing ﬁrmware of these memories we mark with those memories from which in structions are directly executable z80 program rom three 128 kb eprom chips located on the z80 moth erboard mappable in 16 kb segments into the lower 32 kb of the z80 address space z80 program ram one 32 kb sram chip optional located on the z80 moth erboard mappable in 16 kb segments into the lower 32 kb of the z80 address space was not installed in the 900h machines we examined from union county nj was not installed in the 800d machine we purchased from buncombe county nc conﬁguration rom one 8 kb eprom chip located on the z80 motherboard accessible to the z80 by io instructions directmapped data memory one 32 kb sram located on the z80 mother board mapped into the upper 32 kb of the z80 address space except that the highest 1 kb may of the z80 address space may be mapped to other devices audit trail memory one or two 128 kb srams located on the z80 mother board mappable in 1 kb segments into the highest 1 kb of the z80 ad dress space 8 kb sram one 8 kb sram located on the z80 motherboard accessible to the z80 by io instructions realtime clock chip few tens of bytes of storage accessible to the z80 by io instructions results cartridge removable cartridge containing 96 kb or other amounts of batterybacked sram that plugs into the port on the motherboard marked results cartridge accessible to the z80 by io instructions 147auxiliary cartridges removable cartridge that plugs into the port on the moth erboard marked auxiliary cartridge these may be results cartridge simulation cartridge technician cartridge or other see section 44 on the 900h model but not on the 500d model this auxiliary port can also connect to other devices including but not limited to the audiokit daughter board all these devices are accessible to the z80 by io instructions daughterboard ram the daughterdaughterboard is compulab 486core printed circuit board approximately 2x3 inches containing an 80486compatible processor an 8 mb dram and 2 mb ﬂash memory we refer to the 8 mb dram as the daughterboard ram it is directly mapped into the address space of the 486compatible computer daughterboard ﬂash memory the 2 mb ﬂash memory on the daughterboard vc advantage versions 9 and 10 is formatted as microsoft standard fat ﬁle system this ﬂash memory is not directly executable but the daughterboard operating system probably has bootstrap loader that auto matically copies from the onboard flash memory andor the audio ballot cartridge to the dram on startup audio ballot cartridge pcmcia cartridge typically 64 mb that plugs into pcmcia slot on the top of the audio kit daughterboard formatted with fat ﬁle system most probably accessible to the 486core processor as virtual disk drive dsp ﬂash memory on the audio v oting assembly there is probably dsp processor with probably ﬂash memory containing executable program as well as data b buffer overrun reading messages from daughterboard 3 pages redacted 148c technical details of the optionswitch bug that disenfranchised some primary voters 2 pages redacted d how the ballot images can be unshufﬂed thereby violating voter privacy 2 pages redacted the source code violates the fecs softwareengineering guidelines for votingmachine ﬁrmware 45 pages redacted f installing fraudulent software into z80 program ram 25 pages redacted g the security measures in technician cartridges are easily defeated 15 pages redacted 149h printer inaccuracy can change vote totals in results report h1 summary the vc advantage printer does not have mechanism to overcome transmission errors in the printer cable this could in principle cause erroneous vote totals to be printed but we do not believe it is very signiﬁcant source of inaccuracy h2 the vc advantage has printer mounted inside the cabinet accessible by opening the rear door this printer is used to print results reports after the close of the polls listing the vote totals for each candidate these reports are signed by the electionboard workers h3 the vc advantage z80 computer communicates with the printer using stan dard parallel printer cable of the kind that was used on personal computers in the 1980s and 1990s there is errorchecking on this cable neither parity checking nor checksums of any kind if at any time localized electrical failure radio in terference or other transient signal causes 0 signal to be transmitted as 1 or vice versa the wrong character would be printed on the results report such intermit tent failures could be also caused by corroded contact on the connector plug for example h4 we performed the following experiment to demonstrate the lack of errorchecking on the printer cable we simulated bad connection by unplugging the centronics style parallel connector from the printer and putting tiny piece of paper over one of the connectors corresponding to the loworder bit in the ascii code then we plugged the connector back in with the paper in place therefore electrical signal could ﬂow through this pin of the 36pin connector h5 the printer did not detect any error and did not report any error to the vc advantages z80 computer all characters were transmitted with loworder bit 1 that is the letter b printed as c the number 6 printed as 7 and so on h6 therefore it is possible that bad connection could cause intermittent failures of this type such connection could be caused by corroded contact in the plug at either end of the printer cable or by bad solder joint depending on which wire of the cable had an intermittent failure it is possible for the digit 1 to change to 9 or 0 to 8 or 3 to 7 or 2 to 3 and so on in general numbers could be misprinted as too large by any of the following amounts 1 2 4 8 10 20 40 80 100 200 400 800 150h7 thus the printer can print erroneous numbers and the vc advantage ma chine is incapable of detecting the error however at present we cannot say that this kind of error is likely to happen i inadequate indications of undervotes i1 in section 33 we explain that the vc advantage has been found to have high rate of undervotes in this appendix we explain what mechanisms vc advantage permits election ofﬁcials to use to try to prevent undervotes and why these are not very successful i2 computer scientists study user interface design so that their computer pro grams can better understand and carry out the intent of the user userinterface issues are also important in voting machines and ballot design i3 the election ofﬁcial should design the printed ballot on the paper covering the voter panel so as to clearly lay out the contests in this respect at least in the elections we have observed in new jersey the election ofﬁcials as users of this software lay out the ballots as clearly as this fullface technology permits how ever when there are many races especially when there mix of partisan contests and nonpartisan contests the voter will inevitably be presented with large amount of information at once she must ﬁnd all the contests on the ballot see figure 2 on page 11 in general we would not fault the way that election ofﬁcials in union county and mercer county lay out the ballots they are doing the best they can within the limitations of the technology of the voting machine i4 the cast v ote button does not light and remains inactive until at least one contest has been voted but this solves the problem only partially it mostly pre vents 100 percent undervote by voter but does not help remind the voter to vote every contest i5 as another reminder the bottom right portion of the printed ballot says followed by the same message in spanish the entire display occupies space of about 10 inches by 5 inches there is similar message shorter and smaller to the 151left of the button itself in english only in fact the large fullface ballot is densely printed with textual instructions which in itself becomes problem i6 the green x lights up by each candidate selected this is useful feedback but may not help the voter who has overlooked one part of the large voter panel for example suppose the ballot is laid out such that all the candidate contests are in one large grid at the centerleft of the voter panel and all the public questions are at the right it is easy for voters to overlook the public questions i7 green x can be made to light up in the contest header of each undervoted contest we describe this below i8 xs in contest headers suppose there are three races on the ballot for presi dent for senator and for representative the printed page looks like this democratic republican green president smith 2jones 2johnson 2 senator bobkin 2dobkin 2froomkin 2 representative harman 2fenwick 2menn 2 i9 if the xsincontestheaders feature is enabled in the ballot deﬁnition then when the machine is initially activated the ballot will be presented like this with the xs illuminated in green democratic republican green presidentsmith 2jones 2johnson 2 senatorbobkin 2dobkin 2froomkin 2 representativeharman 2fenwick 2menn 2 152i10 if the voter presses the box next to smith then the x by president goes out and the x by smith illuminates democratic republican green president smith2jones 2johnson 2 senatorbobkin 2dobkin 2froomkin 2 representativeharman 2fenwick 2menn 2 i11 the xs by senator and representative are still lit indicating that these contests are not yet voted however at this time the cast v ote button illuminates indicating that the voter is permitted to cast this ballot and thereby undervote in the senator and representative races i12 although the purpose of this userinterface design that is illuminate the x in the contest header to indicate undervote is supposed to help the voter avoid undervoting in fact some voters ﬁnd it confusing we have informally interviewed voters after elections about their use of these machines many voters do not really understand what the userinterface is trying to tell them this is especially true when this method is applied to public questions the x in some cases appears right in the middle of the text of the public question which some voters ﬁnd mysterious i13 in general the prompting of the voter to avoid undervotes by those not expert in the operation of the machine is barely adequate and not completely effective this can lead to undervoting and thus impairs the accuracy of the vc advantage in recording the voters intent j cumbersome procedure for dealing with ﬂeeing voters j1 summary in section 37 we explained that the vc advantages proce dures for handling ﬂeeing voters leave opportunities for violating the privacy or integrity of the ballot here we describe those procedures j2 voter who makes one or more selections and then leaves the booth without pressing cast v ote is known as ﬂeeing voter j3 as we explained in the previous section the user interface of the vc ad vantage is not completely intuitive in addition on the vc advantage the cast v ote button is far below and to the right of the voters line of sight and focus of 153attentionthe contests and candidates printed on the fullface ballot therefore some voters forget to press the cast v ote button j4 in the old days of mechanical lever machines the cast vote lever caused the curtain to open behind the voter thus the voter was gently physically restrained from leaving the booth by the curtain the vc advantage does not have such an automatic curtain and it would not be practical to add one j5 if the voter leaves an vc advantage without pressing cast v ote the operator can tell from indications on the lcd display on the operator panel that the vote has not been cast and also the barely audible chirp has not been heard the operator is supposed to remind the voter to press cast v ote j6 if the voter has already left the polling place then the operator must follow certain procedure as dictated by the regulations of the county or state etc for ﬂeeing voters usually the intent of this procedure is to record the voters selections already made on the machine as if she had pressed cast v ote j7 the procedure that pollworkers have to follow in order to clean up after ﬂeeing voter is very cumbersome j8 the procedure requires the pollworker to reach into the booth without looking and to press the enter button followed by cast vote but the ter button is set nearly ﬂush in panel with many other buttons and is very difﬁcult to press without looking in practice to accomplish this procedure the pollworker may ﬁnd it necessary to enter the booth where the voters lections are visible and changeable j9 the sequoia vc advantage operators manual prescribes procedure for ﬂeeing voters j10 from our examination of the machines we have found that the following pro cedure works unlock the back door of the machine with the key press the print more button this records the selections made by the voter up to the point where she ﬂed as if cast vote were pressed and records fleeing v oter for subsequent printed reports actually print more is more powerful than cast vote for the following reasons if the voter has made selections at all and if the ballot deﬁnition pro grammed into the results cartridge prohibits blank ballots then cast vote 154will not do anything128 if audio v oting is in use eg by disabled voter then the voter panel including cast vote may be inactive j11 even so the print more button is not completely effective way of han dling ﬂeeing voters if personal choice writein has been selected and the writein name has not been completed by pressing the enter key below the voter panel then the cast vote button has effect and neither does print more j12 consequently more complicated procedure is prescribed to pollworkers by mercer county129is as follows first ask the voter to return to the booth to press the cast vote button but if the voter has left the polling place perform the following steps 1 reach underneath the curtain without going into the voting unit and press the enter button on the writein keypad130and then press the cast vote button if the four signals131listed in assuring the v oter v oted prop erly occur the voting unit is ready for the next voter if these signals do not occur it means the previous voter left the voting booth without making any selections known as ﬂeeing voter 2 when the next voter arrives allow them to vote at the booth 3 make note of the voter ﬂeeing in the ofﬁcial documents j13 somewhat different set of instructions is also found in mercer countys man ual for pollworkers for the presidential primary of february 5 2008132that is 128note that in this case the mercer county instructions below will lead to different result this may be deliberate on the part of mercer county election ofﬁcials perhaps in order to comply with new jersey election laws or it may be that mercer county ofﬁcials are unaware of the print more feature for ﬂeeing voters since it is not described in the vc advantage operator manual 129mercer county board worker manual revised november 25 2003 page 18 bates number mercer 004647 in gusciora et v corzine et 130footnote mine pressing enter is difﬁcult to do by feel alone 131footnote mine paraphrase summary 1 chirping noise 2 light on operator panel next to ac tivate button goes off 3 display on operator panel lcd reads voter inactive 4 overhead booth light goes off 132a document entitled what to do if presidential primary election february 5 2008 ellipsis in original bates number mercer 004641 page 13 part of package of information given as instructions to pollworkers 155mercer county gives several different instructional documents to its election work ers and two of the documents disagree about procedures for ﬂeeing voters j14 mercer countys what to do if documents instructions echo the process of reaching under the door to press the cast vote button though they do not mention pushing enter ﬁrst the next step is to wait two minutes and repeat if the machine still does not cast the ballot then two board workers one from each party are to look inside to see if any contests are voted and if not the next voter can enter the machine and cast ballot the instructions do not specify what to do if the ﬂeeing voter had voted some contests k bug in wineds causes ballot programming to be extremely slow k1 summary bug in wineds causes the software to be extremely slow in preparing vc advantage cartridges before each election this limits the ﬂexibility of election ofﬁcials in dealing with lastminute ballot changes k2 wineds fails to remove temporary ﬁles that are generated during the audio ballot preparation process the temp directory of union countys wineds com puter contained over 7000 useless ﬁles this bug in wineds slows down the pro cess of preparing ballotdeﬁnition results cartridges with accompanying audio ballot cartridges enormously we found by examining the dates of these ﬁles that union county election workers were able to use this machine to prepare only an average of 8 audioballot cartridges per day in the weeks before an election in county that has hundreds of voting machines this must be extremely frustrating and inefﬁcient for election workers k3 in addition to costing the taxpayers money to pay employees or contractors for the extra time it takes to prepare the vc advantage voting machines for each new election this wineds bug causes another problem it means that these employees of the board of elections will need weeks more time than necessary to prepare bal lot cartridges before an election in the event that county clerk or court orders change in the ballot just few weeks before an election the board of elections will not have enough time to install the new ballot into the vc advantage voting machines 156l the court order in the fall of 2004 the rutgers law school constitutional litigation clinic ﬁled lawsuit seeking to decommission of all of new jerseys voting computers ap proximately 10000 voting computers are used in new jersey all of them are direct recording electronic computers dres and the vast majority of these dres are sequoia vc advantages none of those dres can be audited they do not pro duce voter veriﬁed paper ballot that permit each voter to create durable paper record of her electoral choices before casting her ballot electronically on dre the legal basis for the lawsuit is quite simple because there is way to know whether the dre voting computer is actually counting votes as cast there is proof that the voting computers comply with the constitution or with statutory law that require that all votes be counted as cast critical part of every lawsuit is discovery ie the exchange of information by adversaries in lawsuit discovery is designed to give parties access to their ad versaries documents and other information that is relevant to lawsuit discovery provides litigants with crucial information needed to prove their case when that information is in the sole custody of their adversaries in this case the plaintiffs did not have access to information that would help them prove their case that dres were unreliable and insecure the plaintiffs did not even have the ability to test the dres they suspected were constitutionally inﬁrm the dre voting computers belong to new jerseys 21 counties those counties also have information about dre malfunctions additionally the attorney general and secretary of state133 also have information about dre malfunctions as well as information related to the application for certiﬁcation of every dre used in the state as part of the discovery process the court ordered the defendants ofﬁcials of the state of new jersey to provide to the plaintiffs sequoia vc advantage voting machines the source code to those voting machines as well as other infor mation that would enable them to support their legal claims the sequoia v oting systems company which had not been party to the lawsuit objected to the exami nation of their source code by the plaintiffs experts on the grounds that the source code contained trade secrets the court recognized that concern and crafted protective order that permitted the plaintiffs experts to examine the source code while protecting the trade secrets within it however the court order does permit the plaintiffs experts to release this report to the public at speciﬁed time we delivered our report to the court and to the defendants on september 2 133respectively the former and current state chief election ofﬁcer until april 2008 the chief election ofﬁcer of new jersey was the attorney general the legislature modiﬁed this effective april 2008 to conform with the practice in many other states where the chief election ofﬁcer is the secretary of state 1572008 30 days after that date on october 2 we were to have been permitted by the court order to release our report but not the source code itself into the public realm however in late september sequioa ﬁled motion alleging that this report revealed protected trade secrets on october 17 2008 the court permitted release of the report as redacted here later this year the court will rule on the substance of the trade secret issue and we expect that she will permit release of the full unexpurgated report at that time 158