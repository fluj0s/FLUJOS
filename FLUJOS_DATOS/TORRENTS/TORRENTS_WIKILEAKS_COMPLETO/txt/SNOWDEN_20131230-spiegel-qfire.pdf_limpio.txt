getting close to the forwardbased defense with qfire june 3 2011 qfire pilot lead nsatechnology directorate derived from nsacssm 152 dated 20070108 declassify on 20360401 abstract tssirel the goal of forwardbased defense is to detect and mitigate malicious threats in realtime as close to the source as possible it is part of layered defense strategy with four concentric zones endpoint perimeter aggregation and forward based defenses the quantumtheory mission leverages nsas vast system of distributed passive sensors to detect target traffic and tip centralized commandcontrol node this node assesses the tip and injects response towards the target using active tao assets tssirel extremely powerful cnecndcna network effects are enabled by integrating our passive and active systems re settin g connections red irec tin g ta rg ts fo r exp itatio n ta kin g co ntrol f irc bots co rrupting file uploadsdow nloads more tssirel the success rate of these effects is largely determined by the latency from tiptotarget ofire is consolidated quantumtheory platform under development that reduces latencies by colocating 1 existing passive sensors with 2 local decision resolution and 3 the ability to locally inject traffic to achieve the desired network effect topics layered defense model nsa turbulence rchitecture turmoil passive sigint sensors turbine active sigint commandcontrol quantumtheory integrating passiveactive systems for cnecndcna qfire consolidated lowlatency quantumtheory capability under development for forwardbased defense forwardbased defense nsa turbulence archit distributed sensors passive u r w r r r ssirel highspeed passive collection systems intercept foreign target satellite microwave and cable communications as thev transit the alobe 11 r f i r accesses turmoil i tutelage turbine active mission management tssirel turbine provides c n tra liz d automated commandcontrol of large network of active implantsaccesses turmoil tutelage implants tao quantumtheory tssirel extrem ely powerful cnecndcna netw ork effects are enabled by integrating our passive and active systems r ttin g co nn ctio ns quantumsky r ed irectin g ta rg ts fo r x p ita tio n quantuminsert taking c n tro l f irc b ts quantumbot c rru p tin g file u p dsdo w n ds quantumcopper t5sirel quantumtheory dynam ically injects packets into targets netw ork session to achieve cnecndcna netw ork effects d etect turmoil passive sensors detect target traffic tip turbine com mandcontrol d ecide turbine mission logic constructs response forwards to tao node 1 in je c t tao node injects response onto internet towards target tssirel the propagation delay from tip to ta rg t determ ines the success rate of the netw ork effect less l n c m re s u cce ss to p sec r etco m intrel to usa aus can gbr nzl qfire consolidate for i t l dntjcpacific latency quantumtheory path s ite nsaw turbine ta rg t tssirel qfire collocates at site sensor decision logic and localregional injection capability to achieve low latency use existing sigint sensors fo r alerting local decision resolution local turbine localregional injection capability qfire path s ite ta rg t tssirel low latency capability substantially increases the variety of achievable cnecndcna network effects and improves their overall effectiveness top secretcomintrel to usa aus can gbr nzl qfireforwardbased defense n c s conduct tim trials evaluate operational effectiveness developdeploy qfire for highspeed sso cable sites d p ndencies grow regional shooter infrastructure more pointsofpresence 3 develop localregional insertion capability at sso cable accesses enhance cloud analytics and quantum missions botnet m itigation pilot effort qfire components eve turbineinject i scs site scif 5 u c regional inject node is on internet local inject node is collocated with relaynode in d io d relaynodein rn t ption scs site rms rftx cooperative rf rx in rn t option b scs site rm s i n j cnoncooperative wireless access point wap in m tnat gw injectcomma ndinjectcomm and r i l rpca or bwireless clientswired clients top sec r etco m intrel to usa aus can gbr nzl qfire scs physicalvirtual network architectureitx w c2straig htbizz w an 1 t sw itcjfo tifg site restructuresw itch w c l iblindda rrtop secret s c 5 iw t unclassified tao rt netw ork vmware esx servericover t vswitc h5m bladecenter hs2 vsvvitc v m l turm oil itx local r vm 2 turbinewl ac lsvm 3 turbinedb vm 4 shh ighproxy jmsto chmrpc uditloggervlan vpn j r ac lslow highke t m w r s r r virtual process esr network interface iwwoneway acl top sec r etco m intrel to usa aus can gbr nzl top secretcomintrel to usa aus can gbr nzl izm u rsp c itim c n tm u u m m ip ttm g llw u rib ra viiya n d lu n m s n d stuffs i nsaicg top secretcomintrel to usa aus can gbr nzl http web clientserver c lie n t in itia s request th n rve r replies tcp socket client tcp syn server tcp synack http 11 p ersistent c onnection client http get1 server http responsel client http get2 server http response2 quantum insert racing ttaserver w it for client to initiate new connection observe servertoclient tcp synack s hoot http payload hope to beat servertoclient http response the c hallenge can only win the race on some linkstargets for many linkstargets too slow to win the race top sec r etco m in tr to usa aus can gbr n zl quantum insert racing clienterec synack tcp synshot http geton servertoclient tcp nl_ losewin server tcp synackhttp response q l h t t p p w l n r l c r etc m in tr to usa aus top secretcomintrel to usa aus can gbr nzl quantumtheory node f u n ctio nm irim m latency to total reach next node ms latencyms sas ste access system front end layer 01 tumult demux layer 2 sensor turmoil layer 3passive sensorevent detection 10 10 nx islandtranspopt enterprise message service 120 130 cc turbine gornrrendcontrol decision logc 20 150 diode surpuushangar hiitolow dode 20 170 gownet tao covert network middleman 70 240 inject tao injection implant 75 315 target destination for cndcndcna network effect 686 timing measurements quantumtheory workshop october 2010 top secretcomintrel to usa aus can gbr nzl