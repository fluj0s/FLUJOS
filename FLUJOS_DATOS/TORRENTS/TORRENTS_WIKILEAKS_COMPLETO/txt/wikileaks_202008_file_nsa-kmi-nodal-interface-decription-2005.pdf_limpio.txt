unclassifiedfor official use only unclassifiedfor official use only u kmi ci2 nodal interface description september 30 2005 draft version 16 information assurance mission attainment iamac contract mda 90403c1074 technical task order 2104 bah tto 2104 prepared by 900 elkridge landing road linthicum maryland 21090 unclassifiedfor official use only 2 unclassifiedfor official use only this page left blank intentionally unclassifiedfor official use only i unclassifiedfor official use only u revision page u this page lists the document versions that have been issued requests for changes to this document should be submitted in writing to the kmi office of primary responsibility listed in section 14 date version description of changes 31 dec 2004 15 first widely distributed working draft 30 sep 2005 16 revised to correct technical errors and add for official use only unclassifiedfor official use only ii unclassifiedfor official use only u table of contents 1 u introduction 1 11 u purpose 1 12 u document structure 1 13 u system overview 1 14 u office of primary responsibility 2 2 u kmi ci2 nodes 3 21 u central services node csn 3 22 u product source nodes psns 4 23 u primary services nodes prsn 5 24 u client nodes 7 25 u ekms translator 8 3 u kmi ci2 nodal interfaces 11 31 u prsncsn interface 12 32 u prsnpsn interfaces 16 321 u prsnlegacy central generation psn syst ems interface 16 322 u prsnpki psn interface 18 323 u prsnpsn pin generator interface 19 33 u prsnclient node interfaces 19 331 u prsn omemanager client node interface 20 332 u prsn pdemanager client node interface 24 333 u prsn pdedeliveryonly client interface 26 334 u prsn pdekmiaware device otnk 27 34 u prsntranslator interface 28 35 u translatorekms interface 28 36 u translatorcsn interface 29 37 u csnpsn interface 30 38 u psnpsn interface 31 39 u clientclient interface 31 4 u kmi ci2 interfaces to external systems 33 41 u defense courier service interface 33 42 u directory interfaces 33 421 u ci2 to global directory system interface 33 422 u foreign directories 33 43 u dod pki interface 33 44 u incident reporting center interface 33 5 appendix ekms transactions supported by kmi c i2 3 4 u table of figures unclassifiedfor official use only iii unclassifiedfor official use only u figure 11 kmi ci2 system nodal architecture 2 u figure 21 csn functionality 3 u figure 23 psn functionality 4 u figure 23 prsn functionality 5 u figure 25 ekms translator interface 9 u figure 3 kmi ci2 nodal and external interface s 11 u table 31 prsncsn interface data types 16 u table 321 prsntier 0systems interface data types 18 u table 322 prsnpki psn interface data types 18 u table 323 prsnpin generator interface data types 19 u figure 33 prsnclient node interfaces 20 u table 331 prsn omemanager client node inter face data types 24 u table 332 prsn pdemanager client node inter face data types 2 6 u table 333 prsn pdedeliveryonly client node interface data types 26 u table 334 prsn pdekmiaware device interfac data types 27 u table 34 prsnpki psn interface data types 28 u table 35 translatorekms interface data types 29 u table 36 translatorcsn interface data types 30 u table 37 csnpsn interface data types 31 u table 38 csnpsn interface data types 31 u table 39 clientclient interface data types 32 unclassifiedfor official use only 1 unclassifiedfor official use only 1 u introduction u this document provides data flow information fo r capability increment two ci2 of the key management infrastructure kmi the intent of ci2 is to build foundation for management and electronic distribution of all key m anagement products and services in generalpurpose networking environment 11 u purpose u the nodal interface description nid describes the interfaces and types of data that move between kmi ci2 nodes and between the kmi and ext ernal systems kmi nodes can be widely distributed or collocated within central or regional sites that may be connected by variety of dod and commercial communications networ ks u version 10 of this document is to be considere d as model for the final version since significant revisions are to be expected due to des ign and implementation decisions 12 u document structure u this document is organized into four sections the following presents highlevel description of each section section 1 introduction this section provides brief introduction to the kmi ci2 nid section 2 kmi ci2 nodes this section presents an overview of the kmi ci2 nodal architecture section 3 kmi ci2 internal interfaces this section provides description of the data types that traverse the kmi ci2 nodal interfaces section 4 kmi ci2 external interfaces this section provides description of the external systems with which the kmi ci2 interfaces 13 u system overview ufouo the kmi ci2 nodal architecture supports unified infrastructure that provides key management products and related services to wide variety of clients operated by kmi users kmi users can be kmi managers koa agents or kmie nabled devices the users are either consumers that depend on the k for products and services or managers that allocate and control resources within the kmi the kmi ci2 nodal architecture is presented in figure 11 and include sthe central services node csn oversees the security of system operations and stor and replicates common data for prsns product source nodes psns are dedicated to generation of various key product s unclassifiedfor official use only 2 unclassifiedfor official use only primary services nodes prsns are dedicated to key management the ekms translator facilitates interoperability with the electronic k ey management system ekms client nodes provide access to the prsn and include the followi ng akp equipped manager client nodes supporting key or dering and management deliveryonly client nodes supporting retrieval of key and kmi products from prsn pdes kmienabled cryptographic devices that are capable of directly retrieving key and kmi products from the prsn including seed key conversion and rekey via over the network keying otnk akp dod commonuse and public networkskmi private networks ecukmi ci2 central services node csn catalog management and distribution data archive and analysis center security and operations oversight product source nodes psns cryptographic material generation product packaging product vault rekey conversion of seed key kmi naming authority type 1 ia certificates pin generation primary services nodes prsns user registration roles privileges request processing distribution tracking customer support kmiekms interface client nodes productservice request retrieval use productcrypto device management operating account managementekms translator reenveloping of transactions defined by ekms standards csn ecu ecupsns psns client nodes for managementclient nodes for distribution fill devicehumanfill devicehumanekms translator prsns prsns akp dod commonuse and public networkskmi private networks ecukmi ci2 central services node csn catalog management and distribution data archive and analysis center security and operations oversight product source nodes psns cryptographic material generation product packaging product vault rekey conversion of seed key kmi naming authority type 1 ia certificates pin generation primary services nodes prsns user registration roles privileges request processing distribution tracking customer support kmiekms interface client nodes productservice request retrieval use productcrypto device management operating account managementekms translator reenveloping of transactions defined by ekms standards csn ecu ecupsns psns client nodes for managementclient nodes for distributionclient nodes for managementclient nodes for distribution fill devicehumanfill devicehumanekms translator prsns prsns prsns prsns u figure 11 kmi ci2 system nodal architecture 14 u office of primary responsibility ufouo this document is issued by the national s ecurity agency nsa deputy director for information assurance comments on the content should be addressed as follows national security agency ste 6751 kmi program management team 9800 savage road ft meade md 207556751 ufouo for ease of automated mail sorting the bove address should be all upper case and 10pitch or 12pitch type unclassifiedfor official use only 3 unclassifiedfor official use only 2 u kmi ci2 nodes 21 u central services node csn ufouo the csn oversees the security of system perations and stores and replicates common data for prsns the csn monitors the system s security state by analyzing state and event information received from the other core node s and responses to security incidents affecting multiple nodes are coordinated at the csn the csn manages the kmi product ordering catalog and provides catalog information to the prsns ufouo the csn maintains archives for data backu p registration enrollment tracking and audit functions the csn coordinates the replicati on of information among prsns to support providing equivalent service at multiple prsns and manages the synchronization of kmi information with equivalent data in the ekms direct ory service the csn is the point of interface between the kmi and the ekms directory rvice and coordinates synchronization of directory information both among the kmi prsns and between the kmi and the ekms ufouo the functions and primary components of t he csn are presented in figure 21 csnsecurity management security status audit analysis ids analysisdata management registration data enrollment data product catalog configuration performance data aswr audit data data synchronization ekms directory synchronization product management role privilege standards master product catalogcomponent management configuration performance operational health data management component managementsecurity management product managementcsn psn psn prsn prsn client nodeclient node csnsecurity management security status audit analysis ids analysisdata management registration data enrollment data product catalog configuration performance data aswr audit data data synchronization ekms directory synchronization product management role privilege standards master product catalogcomponent management configuration performance operational health data management component managementsecurity management product managementcsn psn psn prsn prsn client nodeclient node u figure 21 csn functionality ufouo the ci2 csn provides management services that ensure functional consistency across all kmi nodes components platforms and si tes the ci2 csn is separate from prsns and psns csn functionality is grouped into the fol lowing four general categories ufouo data management the csn supports operations by maintaining databa ses for important types of data that are handled by the prs ns and psns including registration and enrollment data product ordering catalog data rol and privilege data performance and unclassifiedfor official use only 4 unclassifiedfor official use only aswr data the csn also coordinates the synchronization of inf ormation across prsns so that user can receive equivalent service from any prsn they connect to this csn function also include synchronization of kmi data with the quivalent information maintained in the ekms directory service ufouo security management the csn provides both operational managers and administrative managers with an overview of securit conditions across the kmi including management of the intrusion detection systems and r eview of audit trail data ufouo component management the csn performs configuration performance and system health monitoring functions to support manag ers in controlling kmi applications platforms internal networks and sites ufouo product management the csn supports the production and delivery of products and services by providing oversight of reg istration and enrollment processes setting system role and privilege standards maintaining th master product catalog and distributing tailored subsets of the catalog to prsns 22 u product source nodes psns ufouo the psns generate format and package km i products as directed by orders from prsns and according to the specifications of the pr oduct catalog ci2 incorporates psn capabilities to produce electronic and physical key material in variety of formats and also to support over the network keying otnk for future nd cryptographic units ecus psns produce products that range in classification from unclassified to top secret special compartment information tssci however psns co nnect to prsns at the secret level and each product package that psn delivers to prsn is wrapped for the intended consumer device and can be handled as unclassified ufouo the functions and primary components of t he psn are presented in figure 22 csn psns psns prsns prsns client nodeclient nodekey generation physical key production printed product key production electronic delivery physical delivery internal management functions psn request processing generation distributionproductionpsn functions csn psns psns prsns prsns client nodeclient nodekey generation physical key production printed product key production electronic delivery physical delivery internal management functions psn request processing generation distributionproductionpsn functions csn psns psns prsns prsns client nodeclient nodekey generation physical key production printed product key production electronic delivery physical delivery internal management functions psn request processing generation distributionproductionpsn functions u figure 23 psn functionality unclassifiedfor official use only 5 unclassifiedfor official use only ufouo psns generate and produce cryptographic k ey material type 1 x509 certificates and other types of credentials each psn supports one or more cryptographic product types psns are modular in structure and make use of exist ing updated and new generation and production capabilities ufouo psn receives product or service request s from prsn which provides all relevant information management functions and inter faces associated with the product or service all keys and products that originate at psn for lectronic distribution are encrypted for specific kmiaware device for client node with n akp or for interim storage in the electronic vault before transmission psns never ou tput electronic products in form that can be unwrapped by anyone other than the intended recipie nts products packaged for distribution in this manner will require special handling as the pass through intermediate components of the kmi 23 u primary services nodes prsn ufouo the prsns manage the flow of system event s provide the interfaces for client nodes and provide interfaces for communicating with systems external to the kmi client nodes connect to prsns via widearea transmission control protocolinternet protocol tcpip networks secret internet protocol router network siprnet unclassified but sensitive internet protocol router network formerly called t he nonsecure internet protocol router net niprnet and the public internet the internal arch itecture of the prsn protects the kmi against threats posed by these connections while pr oviding client nodes with access to network based kmi services prsns enable clients to request receive and manage kmi products and services for customer organizations each prsn is divided into security enclaves and each enclave operates at either the unclassified or the secret level the functions and primary components of the prsn are presented in figure 23 prsn electronic key repository pde key locker management directory message services compromise recovery services securitycritical package repository realtime rekey processing prsnprsn transactions external system interactions local enclave maintenance system network lf border protection suite request validation approval event management user enrollment registration role privilege mgmt access control psn order negotiation psn order fulfillment coordination status tracking requests accounting product distribution enclaveproduct distribution enclave pdeordering management enclaveordering management enclave omeproduct distribution enclaveexternal systems enclave esecsn psn psn prsn prsn client nodeclient nodecommon service enclave cse common management functions prsn electronic key repository pde key locker management directory message services compromise recovery services securitycritical package repository realtime rekey processing prsnprsn transactions external system interactions local enclave maintenance system network lf border protection suite request validation approval event management user enrollment registration role privilege mgmt access control psn order negotiation psn order fulfillment coordination status tracking requests accounting product distribution enclaveproduct distribution enclave pdeordering management enclaveordering management enclave omeproduct distribution enclaveexternal systems enclave esecsn psn psn prsn prsn client nodeclient nodecsn psn psn prsn prsn client nodeclient nodecommon service enclave cse common management functions u figure 23 prsn functionality unclassifiedfor official use only 6 unclassifiedfor official use only ufouo prsns provide services to client nodes ov er various communications networks ci2 is deploying prsns that enable users to perfor m key management functions and to request and receive products and services using webbased t echnology ufouo prsn offers single point of access to all products services and information required by the kmi user community except for prod ucts that are produced locally by akp equipped client nodes prsns provide product manage ment and distribution services device and koa registration services user and manager reg istration and enrollment services directory services support for compromise recovery transact ions are either processed by prsn directly or forwarded to other nodes for processing ufouo prsns interface with psns to order and re ceive key products and with the csn to receive catalog and privileging information report status and performance data and provide data necessary to maintain the csn master d atabases each prsn also interfaces with other prsns to share data and with external system s eg the dod global directory services gds to obtain information necessary for kmi oper ations prsns are located regionally as necessary to meet requirements for connectivity av ailability survivability and performance ufouo prsns are composed of the following ufouo common services enclave each prsn contains common services enclave cse within the cse exist the functions nd databases needed to support the prsns ordering and management enclaves omes and product distribution enclaves pdes and to communicate with other kmi core comp onents the cse operates as classified system high system and communicates wi th multiple omes and pdes which can be either classified or unclassified the cse p rovides connectivity with the external systems enclaves eses csn and ekms translator ufouo ordering and management enclave kmi managers connect to an ome to request products and services or to perform relate d operational and administrative duties each prsn will have multiple omes which support co nnections from authorized managers in particular user community each ome s ervices specific group of managers at specific security level for instanc one ome may support dod classified managers while another supports nato unclassified managers both within single prsn yet both omes would communicate with and rel upon single cse within their prsn ufouo product distribution enclave the client nodes of koa agents and also user devices that are kmiaware connect to pdes to receive products and services that have previously been ordered or authorized for them by managers each prsn is able to be configured with multiple pdes each pde operates at single security level and supports one type of authentication eg manager credentials user device firefly credentials dod pki credentials or identifierpass word pair when koa agent or user device logs into pde it is allowed to access and retrieve key material from all koas with which it has been registered for instance user may be registered as koa agent with three different koas when that user logs into pde the user will be able to see and retrieve wrapped key directed to all three koas unclassifiedfor official use only 7 unclassifiedfor official use only ufouo external system enclave eses the kmi uses information from some external systems to support its operations the implement the functionality needed for the kmi to communicate securely with external s ystems for example to validate dod x509 publickey certificates of some koa agent s who access pdes the kmi needs the certificates of dod pki certification aut horities cas and also needs their certificate revocation lists crls or access to re vocation status services this may require the to act as client to access directory rver to get certificates and crls or to access an online certificate status protocol ocsp server each prsn is able to configured with multiple eses each used to support interactions with particular type of external system at particular security level ufouo boundary protection suite whenever components with different security levels must communicate boundary protection suit bps will be employed between the prsns security zones for instance bps will be deployed between prsn and csn and also within the prsn between the cses com mon private zone and the ome and pde buffer zones the bps is intended to counte r generic attacks such as distributed denialof service attacks involving lowerlayer pr otocols ufouo kmi protected channel kmi clients connect to prsns using kmi protected channels kpcs kmi prsns also connect t other prsns using kpcs kpc is communications path that provides informat ion integrity data origin authentication using kmi managers credentials or peer entity authentication service and in most cases data confidentiality the secur ity mechanisms used within given kpc depend on the channels purpose and environment basic kpc such as would be used between coalition koa agent and pde may nly use webbased encryption between the prsn pde and the kmi client on the oth er hand managers will add type 1 encryptor such as haipe device to secure the kpc between the managers client and the prsn ome since the protocols and curity features of connections to external systems are typically constrained by the c apabilities of those systems prsn connections to external system are through kpcs tha t are specific to the requirements of both the kmi and the external system to which the k is connecting ufouo given the risk inherent in operating in networked environment maintaining access control is critical prsns regulate access via role rule and approval based access control concepts 24 u client nodes ufouo client nodes enable human users to intera ct with the system through the prsns and operate independently of the prsn for local gen eration production and distribution of symmetric key products the client architecture is modular and each client node incorporates computing platform and features that support some s et of basic kmi interactions manager client nodes with an advanced key processor operate in support of variety of kmi managers including product managers koa managers registrat ion managers and enrollment managers deliveryonly clients docs support the retrieval of wrapped products from the prsn by koa agents unclassifiedfor official use only 8 unclassifiedfor official use only ufouo within the kmi the term client node re fers to any version of kmi component that allows human users to perform kmi functions c lient node functionality to support human users is provided by application software executing on various types of computing platforms any computing platform supporting such client node application software is referred to as client host there are three major types of client nodes they are management client mgc the specific configuration of client host whic h operates in conjunction with an akp to perform management of products and services for the kmi eg the kmi equivalent of an lmdkp deliveryonly client doc specific configuration of client host that perates without an akp and is limited to handling wrapped k ey packages tracking data and transport of credentials from kmiaware devices kmiaware device user device that is registered with the kmi an d that can receive products from the kmi that have been wrapped for th at specific device eg an akp or kmiaware device ufouo wrapped key products can be exchanged bet ween mgcs and existing ekms lmdkp workstations the mgss akp can wrap and wrap black and benign key packages and it can generate symmetric keys the akp archit ecture is modular so that capabilities can be included or omitted as necessary to match the needs of kmi customers mission mgcs in various configurations support variety of kmi us ers including controlling authorities responsible for managing type 1 products managers of kmi operating accounts and kmi registration managers and enrollment managers kmi operating accounts are the kmi representation of comsec accounts ufouo the mgc computing platform running config urable application software support the following functions ufouo identity authentication authenticating the identity of the client user to the prsn through the use of the users kmi credentials or identifierpassword pair ufouo data integrity protection protecting transactions submitted from the client host to prsn when required through the use of digital signature created with managers signature key ufouo data integrity verification checking the integrity of data downloaded to the client host from the prsn through the verification of digital signatures applied by the prsn 25 u ekms translator ufouo the ekms translator figure 24 below is the interface between the kmi ci2 and the ekms the purpose of the translator is to supp ort interoperability between alreadyfielded ekms components and ci2 clients by supporting requ ired exchanges of accounting transactions distribution management transactions bulk encrypted transactions bet and formatted plain text messages between kmi and ekms the translator can be seen as temporary bridge between the kmi ci2 and the exist ing ekms that can be removed from the unclassifiedfor official use only 9 unclassifiedfor official use only kmi when it is longer required for interoperabil ity with legacy ekms components while the translator is utilized it will provide mechan ism through which the kmi user community can communicate with the ekms as well as facilitate the transition of ekms users to kmi u figure 25 ekms translator interface ufouo when messages arrive from either the kmi or ekms the translator accepts responsibility for the message readdresses and re envelopes the message and forwards it to the other system the content of an ekms message is ex tracted from the ekms message envelope format rewrapped as kmiformatted message and the recipients x400 address is replaced by the recipients kmi address obtained from the km i directory service in the same fashion the content of kmi message is extracted rewrappe d as valid ekms message and the recipients kmi address is replaced with the correc t ekms x400 address ufouo the kmi directory service contains the id entity information addresses and credentials of all kmi and ekms users and must be m ade available for use by the translator directory information will be created or modifie d in the translator so it only receives read only copy of the current kmi directory service info rmation ufouo the connectivity from the translator to t he kmi is supported by the prsn the prsn consists of the ome pde and cse which provi connectivity to the translator the ekms translator supports the following system c apabilities ufouo symmetric key generated and wrapped at ek ms tier 1 or tier 2 can be sent to kmi for delivery to akps or retrieval by authori zed kmi operation account agents koa the ekms message containing the bet is route d to the translator where the bet is extracted reformatted and forwarded to the kmi prsn which then places it into the appropriate pde for retrieval by koa manager using mgc with attached akp type 1 prsnekmskmi translatorekms message server client nodes tier 2 lmdkpekms tier 0 client nodes tier 2 lmdkpsekms tier 1accepts ekms messages converts them to kmi messages and forwards them to kmi accounts accepts kmi messages converts them to ekms messages and forwards them to ekms accounts messages can include status messages bulk encrypted transactions accounting transactionstranslator functions unclassifiedfor official use only 10 unclassifiedfor official use only ufouo symmetric key generated by kmi koas ak p can be sent to an ekms lmdkp by routing it through the translator which converts the message to ekms format for routing and distribution by the ekms mes saging system ufouo ekms transactions related to key manageme nt and accounting can be sent through the translator to koa managers ufouo accounting information generated by kmi c omponents are sent through the translator to the appropriate central office of rec ord cor andor to ekms lmdkps with which they are involved in key transfer ufouo plaintext messages can be exchanged betw een kmi managers and ekms lmdkp operators of like classification level th messages flow through the translator which converts them to the correct form at and forwards them to the intended recipients ufouo kmi audit trail data that is generated by the translator is maintained at the translator and is periodically archived reduced and sent to the kmi csn as required for storage unclassifiedfor official use only 11 unclassifiedfor official use only 3 u kmi ci2 nodal interfaces ufouo the kmi ci2 will support several nodeto node interfaces for each of these interfaces discussion of types of transactions an d data that traverse the interface is provided all transactions that will be exchanged between the nodes will support source authentication the nodal to nodal ci2 interfaces are shown above in figure 3 include csn prsn prsnpsn psn ekms msclient node client node translatorprsncsn 31 prsncsn 31 psncsn 37 psncsn 37 prsntranslator 34 prsntranslator 34prsnclient 33prsnclient 33prsnclient 33prsnclient 33 clientclient 39prsnpsn 32 prsnpsn 32 prsnpsn 32prsnpsn 32 translatorekms 35psnpsn 38ekms directory csntranslator 36external systemscsn prsn prsnpsn psn ekms msclient node client node translatorprsncsn 31 prsncsn 31 psncsn 37 psncsn 37 prsntranslator 34 prsntranslator 34prsnclient 33prsnclient 33prsnclient 33prsnclient 33 clientclient 39prsnpsn 32 prsnpsn 32 prsnpsn 32prsnpsn 32 translatorekms 35psnpsn 38ekms directory csntranslator 36external systems u figure 3 kmi ci2 nodal and external interface s prsncsn interface 31 prsnpsn interfaces 32 prsntier 0 systems interface 321 prsnpki psn interface 322 prsnpin generator interface 323 prsnclient node interfaces 33 prsn omemanager client node interface 331 prsn pdemanager client node interface 332 prsn pdedeliveryonly client node interface 3 33 prsn pdekmiaware device otnk interface 33 4 unclassifiedfor official use only 12 unclassifiedfor official use only prsntranslator interface 34 translatorekms interface 35 translatorcsn interface 36 csnpsn interface 37 psnpsn interface 38 clientclient interface 39 31 u prsncsn interface u the csn oversees the security of kmi operations and stores and replicates common data for the prsns the csn is the source of the kmi produc t and services catalog providing product catalog information to the prsns it is also the so urce of role and privilege data required by the prsn both to support enforcement of rolebased acce ss control robac and to provide enrollment managers the current list of system role s the prsncsn interface supports system backup and restoration services and consolidates curity data gathered from other nodes the types of data that will be exchanged between the cs n and prsn include product catalog management role and privilege management configur ation management registration data enrollment data tracking data attack sensing warn ing and response archive and performance analysis appropriate event data and udit records will be generated by the prsn and forwarded to the csn for analysis and archival storage u the vpn employed between the prsn and csn is li kely to be cots vpn product or protected circuit if prsn and csn are colocated ra ther than type 1 haipe device u the csn will act as the hub in hubandspoke replication strategy between kmi prsns each prsn will upload local changes to kmi database s to the csn those changes will be applied to the affected databases by the csn which will then transmit those changes out to all the other prsns u description of the data types that traverse t he csn and prsn interface are found in the table below u table 31 prsncsn interface data types data type description data items vpn session establishment the csn and prsn exchange vpn session establishment data the vpn used between prsn and csn is likely to be cots product instead of type 1 haipe the vpn session establishment transaction data includes appropriate keying for the vpn connection request transaction package signed transaction location information for each prsn vpn configuration management the csn distributes authorized security configurationsupdates the configuration management transaction data includes unclassifiedfor official use only 13 unclassifiedfor official use only u table 31 prsncsn interface data types data type description data items csn to prsn and node configurations including the systemwide policy rules for the composition and arrangement of kmi components policy rules for configuration systemwide rules for composition arrangement of components authorized configuration for nodes security configuration parameters network performance management prsn to csn the csn gathers network performance information from the psn and prsns and measures internodal network performance this information is analyzed to determine the baseline for the network and establish thresholds when performance threshold is exceeded an alert is generated and sent to network fault management the performance analysis transaction data includes system state health data system metrics data reduced audit data network fault management prsn to csn the csn will detect log alert and where possible automatically fix network problems to keep the network running effectively the fault management transaction data includes network problem symptoms problem isolation data possible problem resolutions solution testing data product catalog management prsn to csn csn to prsn the csn receives incoming transactions from the prsns containing updates to products in the product catalog updates are applied to the product catalog and the revised copy is distributed the product catalog transaction data includes but is not limited to product names short title additions product types product classifications revisions role and privilege management csn to prsn the csn provides the tools for the role manager to create modify delete store and distribute role definitions for use by the enrollment manager the role and privilege management transaction data includes privilege association definitions role descriptions role name manager registration prsn to csn csn to prsn the csn archives and analyzes registration data that is extracted from the manager registration process received from the prsn new or updated manager the registration transaction data for managers include unique identity data core data unclassifiedfor official use only 14 unclassifiedfor official use only u table 31 prsncsn interface data types data type description data items new or updated manager information is provided to the other prsns core name token type registration date associated identifier associated authentication material koa registration prsn to csn csn to prsn the csn archives and analyzes data that is extracted from the koa registration process new or updated koa information is provided to the other prsns the registration transaction data for koas include unique account id associated identifiers administrative configuration account clearances account address registration date koa agent registration prsn to csn csn to prsn the csn archives and analyzes registration data that is extracted from the koa agent registration process received from the prsn new or updated koa agent information is provided to the other prsns the registration transaction data for nonmanagers include unique identity data associated identifier associated authentication material registration date responsible koa manager kmiaware device registration prsn to csn csn to prsn the csn archives and analyzes data that is extracted from the kmiaware device registration process new or updated kmi aware information is provided to the other prsns the registration transaction data for kmiaware devices include unique identity data associated identifier with koa registration date enrollment for managers prsn to csn csn to prsn the csn receives updates to the enrollment database from the prsns the new or updated enrollment information is then provided to the other prsns the enrollment transaction data for managers include associate management role with registered manager identity rulebased attributes clearance security category national affiliations organizational domain compromise recovery prsn to csn csn to prsn the prsns send data that regarding any certificate or credential related data compromises to the csn for analysis and archiving new or updated information is sent to the the compromise recovery data being exchanged includes ckl crl credential unclassifiedfor official use only 15 unclassifiedfor official use only u table 31 prsncsn interface data types data type description data items updated information is sent to the other prsns directory services prsn to csn csn to prsn the prsns exchange directory services data that need to be retrieved for kmi users and kmi nodes the directory services data being exchanged includes identity information for kmi human users and user devices routing information for koa managers akps and ekms kme accounts credentials associated with kmi managers koas kmi aware devices role privilege compromise data revocation information crls and possibly ckls messages prsn to csn csn to prsn text messages created by managers and kmi system notifications can be routed through the csn in order to distribute them to multiple prsn omes in order to provide them to multiple prsns to ensure survivability and availability of service the data being exchanged in the text messages and notifications can include product status compromise notification registration enrollment attack sensing and warning notification notification of suspended items or events expired tokens andor certificates attack sensing warning response aswr prsn to csn the csn consolidates and merges the data collected from the prsns for analysis to provide an overview of the results to the sso the aswr transaction data includes security configuration parameters abnormal activity ids sensor data archive and backup prsn to csn the prsn pushes the requested data to be archived from the csn archive and backup data can either be stored in bulk or placed it on appropriate portable media the archive and backup transaction data includes registration data privilege management data help desk report data system backup information cryptographic products services performance analysis the csn reduces and merges the performance analysis unclassifiedfor official use only 16 unclassifiedfor official use only u table 31 prsncsn interface data types data type description data items prsn to csn data collected from the prsns for analysis of the health of the kmi transaction data includes system state health data system metrics data reduced audit data security management prsn to csn the csn consolidates and merges the security data collected from the prsns for analysis the security management transaction data includes consolidated aswr ids auditable event audit prsn to csn the csn reduces and merges securitycritical system data collected from the prsn for analysis and archive as available the data used in an audit collection includes product generation data delivery data internal management functions u table 31 prsncsn interface data types 32 u prsnpsn interfaces u the psns generate format and package kmi prod ucts as directed by requests from prsns within the ci2 will be three different types of ps ns these are legacy central generation systems the prsns will include an interface to the current tier 0 systems that produce symmetric and firefly p roducts orders from kmi product managers and requestors will flow from the prsn to this interface and the requested wrapped key products will flow back throu gh this interface for distribution by the prsn type 1 pki registration authorities will request type 1 certificates for authorized managers validated requests will flow from the pr sn to the type 1 pki which will generate the required certificates and pass them ba ck to the prsn for distribution pin generator ci2 will include psn specificall for the generation of personal identification numbers pins and passwords whene ver pinpassword is required by the kmi the prsn will make the request of the pin generator and receive valid pinpassword the requested pinpassword can be re turned in the clear for instances such as provisioning koa agents who will use only u ser id and passwords wrapped for transmission to specific entity or loaded ont tokens or cryptographic ignition keys ciks 321 u prsnlegacy central generation psn syst ems interface u the types of data that will traverse the prsnp sn legacy central generation systems interface will include production request product generation and audit data unclassifiedfor official use only 17 unclassifiedfor official use only u table 321 prsnlegacy central generation sys tems psn interface data types data type description data items vpn session establishment the prsn and tier 0 exchange vpn session establishment data the vpn implemented between the psn and the tier 0 gateway is likely to be cots rather than type 1 haipe device the vpn session establishment transaction data includes connection request transaction package signed transaction symmetric production request prsn to psn the prsn forwards request for symmetric products to be generated by the psn the types of data included in symmetric product ordering transaction include koas client encryption credential short title product type product name transaction status query asymmetric production request prsn to psn the prsn forwards request for asymmetric ff eff products to be generated by the psn the types of data included in symmetric product ordering transaction includes type 1 credential of receiving device or delivering akp product type product name transaction status query provide product psn to prsn the psn generates and provides symmetric and asymmetric products from requests sent by the prsn the types of data included in product generation transaction includes product type quantity product name transaction provisioning projections status information firefly rekeyseed conversion request prsn to psn the prsn forwards firefly rekeyseed request to the psn the firefly rekey seed conversion request transaction data includes type 1 credential product type product name status query firefly rekeyseed conversion return psn to prsn the prsn receives completed firefly rekeyseed conversion from the psn the firefly rekey seed conversion return transaction data includes unclassifiedfor official use only 18 unclassifiedfor official use only u table 321 prsnlegacy central generation sys tems psn interface data types data type description data items ff key material status query tracking psn to prsn the prsn receives tracking and audit data from the psn to integrate data into status reports for the requesting manager the tracking and transaction data includes orderdelivery data product typeidentifier product quantity date product requester tracking status data auditable events event id date time node performing event transaction id u table 321 prsntier 0systems interface data types 322 u prsnpki psn interface u the local type 1 registration authority lt1ra will request identity certificates for authorized managers from the pki psn these request s will be routed from the prsn to the pki psn the resulting certificates will be sent b ack to the prsn where they will be placed into the kmi directory and also provided back to the reg istration manager u table 322 prsnpki psn interface data types data type description data items vpn session establishment the prsn and pki psn exchange vpn session establishment data the vpn session establishment transaction data includes connection request transaction package signed transaction certificate request in processing lt1ras request for preregistered user type 1 identity certificate the prsn passes the request including the public key to be used in creation of the certificate to the pki psn the certificate request transaction data includes key materials to be used in creating the certificate wrapped for ca registration authority signature new certificate the resulting certificate is sent back to the prsn where it is inserted into the kmi directory and routed back to the requesting registration authority the new certificate transaction data includes new identity certificate pki ca signature u table 322 prsnpki psn interface data types unclassifiedfor official use only 19 unclassifiedfor official use only 323 u prsnpsn pin generator interface u the pin generator psn provides pins and passwor ds as requested by the prsn if required it can also wrap newly generated pin an d password for distribution to specific entity u table 323 prsnpin generator interface data types data type description data items vpn session establishment the prsn and psn pin generator exchange vpn session establishment data the vpn session establishment transaction data includes connection request transaction package signed transaction pinpassword request manager requests new pin r password the manager can also request that the pinpassword be wrapped for receipt by specific kmi user the pinpassword request transaction data includes request for pin or password requesting manager signature identity for which result is to be wrapped if applies new pinpassword the resulting pinpassword is sent back to the prsn where it is routed back to the requesting registration authority the new pinpassword transaction data includes new pin or password possibly wrapped for specific kmi user pki pin generator signature u table 323 prsnpin generator interface data types 33 u prsnclient node interfaces u the prsns manage the flow of system events and provide the interface for client nodes client nodes connect to prsns via widearea transmi ssion control protocolinternet protocol tcpip networks siprnet niprnet and the public internet the internal architecture of the prsn protects the kmi against threats posed by these connections while providing client nodes with access to networkbased kmi services pr sns enable clients to request receive and manage kmi products and services for customer organ izations there are three interfaces presented in figure 35 that support the prsnclien t node interface capability they include prsn omemanager client node supporting key ordering and management prsn pdemanager client node supporting delivery of key and key management services prsn pdedeliveryonly client node supporting deliv ery of wrapped key products prsn pdekmiaware device client node capable of re trieving wrapped key products or performing over the network keying otnk unclassifiedfor official use only 20 unclassifiedfor official use only u figure 33 prsnclient node interfaces 331 u prsn omemanager client node interface u table 351 describes the types of data that wi ll be exchanged between the ome of the prsn and the client node u table 331 prsn omemanager client node inter face data types data type description data items session establishment the prsn ome and client node exchange tls or comparable kpc session establishment data the session establishment transaction data includes connection request transaction package signed transaction location information for each prsn kpc directory synch messages kmi client identification and authentication the prsn ome verifies and validates kmi client identification data in order to gain access to the prsn ome the data used to identify and authenticate kmi client includes type 1 credential access and privilege database credential signature integrity signature signature validation information kmi directory cklcrl koa registration the prsn ome analyzes registration data that is the registration transaction data for koas include unclassifiedfor official use only 21 unclassifiedfor official use only u table 331 prsn omemanager client node inter face data types data type description data items extracted from the koa registration process received from the client unique identity data core data core name common access card cac registration date associated identifier associated authentication material kmiaware device registration device registration manager provides the manufacturers device information to the prsn the prsn provides device name and seed key obtained from psns to be loaded onto the specified device copy of the credentialing data is stored on the prsn the device registration transaction data for kmi aware devices include device identity data core data core name ia mechanism used for kmiaware device registration date associated identifier associated authentication material kmiaware device endorsement lt1ra provides sponsor and token data to prsn and requests type 1 identity the kmiaware device has its seed key converted to operational key using otnk the devices identity certificate obtained from pki psn is associated with sponsor data and stored on the token the endorse device transaction data for manager tokens include device identity data core data core name registration date associated identifier associated authentication material kmiaware device activation the koa manager receives device and adds it to the local koa device distribution profile making it read to be rekeyed this information is provided to the prsn the activate device transaction data includes proof of device identity koa and koa manager data manager token registration device registration manager provides the manufacturers token information to the prsn the prsn provides token name and seed key obtained from psns to be loaded onto the specified the register token transaction data for manager tokens include unique identity data core data core name registration date associated identifier unclassifiedfor official use only 22 unclassifiedfor official use only u table 331 prsn omemanager client node inter face data types data type description data items loaded onto the specified device copy of the credentialing data is stored on the prsn associated authentication material manager token endorsement lt1ra provides sponsor and token data to prsn the tokens seed key is converted to operational infrastructure key the tokens identity certificate obtained from pki psn is associated with sponsor data and stored on the token the endorse token transaction data for manager tokens include unique identity data core data core name registration date associated identifier associated authentication material manager registration the prsn ome analyzes registration data that is extracted from the manager registration process received from the client the registration transaction data for managers include unique identity data core data core name type 1 credential registration date associated identifier associated authentication material manager token activation provisioning the registration authority provides information verifying the identity of the kmi user and the kmi manager token to be activated the prsn binds this information together stores it and returns the manager identity credentials to be stored on the token the activate manager transaction data include manager identity proof of identity token identity sponsor identity manager credentials to be installed on token manager enrollment the prsn ome analyzes data from the client node that is created during the enrollment process for managers the enrollment transaction data for managers include associate management role with registered manager identity rulebased attributes clearance security category national affiliations organizational domain nonmanager koa agent registration the prsn ome analyzes registration data that is the registration transaction data for koa agents include unclassifiedfor official use only 23 unclassifiedfor official use only u table 331 prsn omemanager client node inter face data types data type description data items extracted from the koa agent registration process received from the client note that koa agents are special case and are granted the role of koa agent at time of registration unique identity data core data core name username password registration date associated identifier associated authentication material product ordering the prsn ome verifies and validates kmi client identification data and product order requests the exchange of data between these nodes will be interactive to support the kmi ordering capability the product ordering transaction data includes type 1 credential product type product template quantity role and privilege establishment of new product requirement for symmetric key the controlling authority dialogues with the prsn obtaining and updating the product characteristics the prsn acknowledges the addition the controlling authority can then establish an account distribution profile or authorize product requestors the establish new symmetric key product requirement transaction data includes controlling authority identity credentials role and privilege product catalog data product characteristic data establishment of partitiondao codes command authority requests product catalog then supplies partition and dao codes for specific product optionally the command authority can specify product requestors the establish partitiondao codes transaction data includes koa manager identity credential kmi manager identity to be enrolled as requestor product catalog data partition and dao code data establishment of product requestor controlling authority requests enrollment of kmi manager to become product requestor for specific product the establish product requestor transaction data includes koa manager identity credential kmi manager identity to be enrolled as requestor product identitification account distribution profile the prsn ome verifies and validates kmi client identification data and product standing order requests or modifications to the account distribution profile transaction data includes type 1 credential product type unclassifiedfor official use only 24 unclassifiedfor official use only u table 331 prsn omemanager client node inter face data types data type description data items requests or modifications to standing order product template quantity frequency of standing order role and privilege product catalog management view information from ome product catalog the kmi client can view product catalog information based on manager privileges and attributes the data that is transacted in this process includes type 1 credential product type product template role and privilege establish device distribution profile ddp the koa manager provides information about devices that are to be added to device distribution profiles for specific products the establish ddp transaction includes the following data koa manager credentials product identifier device identifier client software update the prsn ome notifies the kmi client that updates are available to downloaded the data used to conduct software updates includes type 1 credential client software list software update log privilege database messaging the prsn ome receives and stores system messages for the kmi client that can connect to an ome to retrieve create and respond to messages the data used in message transactions includes type 1 credential message text comsec accounting the prsn ome receives accounting transactions required of koa that are independent of an electronic product delivery the accounting for physical delivery transactions includes inventory reconciliation transfer reports destruction reports possession reports u table 331 prsn omemanager client node inter face data types 332 u prsn pdemanager client node interface u table 332 describes the types of data that wi ll be exchanged between the pde of the prsn and the mgc u table 332 prsn pdemanager client node inter face data types data type description data items type 1 credential identification and authentication for kmi the prsn pde receives identification authentication data from the the type 1 credential identification and authentication for kmi manager transaction data unclassifiedfor official use only 25 unclassifiedfor official use only u table 332 prsn pdemanager client node inter face data types data type description data items managers kmi client to verify and validate the privilege database is queried for ia data status includes type 1 credential id format access privilege database credential signature signature validation information client update the prsn pde interrogates client configuration to determine if it is current if not the user may choose to download updated software the client update transaction data includes client configuration process configuration latest sw configuration information download estimates sw downloads interactive web services rekeyseed conversion request the prsn pde provides an interactive capability for the kmi client to create rekeyseed conversion transaction request the data used to ensure successful transaction includes ia mechanism role and privilege process selection selection on interactive screen forwarded generated screen key packages labeled with destination koa and device identities transaction format interactive web services koa folder request and receipt the prsn pde authorizes koa manager access to queried koa folders in the prsn pde user access privilege database the data used to validate users to the database includes ia mechanism role and privilege community of interest coi related credential koa identifiers folder content messaging receives and delivers system generated messages using type 1 credential the prsn pde receives and delivers system generated messages addressed to kmi clients the data used in this transaction includes type 1 credential messages key delivery the prsn pde supports the delivery of key material to kmi client the key delivery transaction data includes ia mechanism product list fill group profile unclassifiedfor official use only 26 unclassifiedfor official use only u table 332 prsn pdemanager client node inter face data types data type description data items distribution profile key material rekey the prsn pde supports the rekey of kmi client the rekey transaction data includes ia mechanism prsn certificates session key u table 332 prsn pdemanager client node inter face data types 333 u prsn pdedeliveryonly client interface u table 333 describes the data flows between th pde and the doc u table 333 prsn pdedeliveryonly client node data types data type description data items vpn session establishment the csn and psn exchange vpn session establishment data the vpn session establishment transaction data includes connection request transaction package signed transaction kmi authorized class 3 or 4 credentials eg cac identification and authentication for koa agents the prsn pde receives identification authentication data from the kmi client to verify and validate the privilege database is queried for ia data status the kmi authorized class 3 or 4 credentials identification and authentication transaction data includes kmi authorized class 3 or 4 credentials request format access privilege database credential signature signature validation information usernamepassword identification and authentication for non managers the prsn pde receives identification authentication data from the kmi client to verify and validate the privilege database is queried for ia data status the usernamepassword identification and authentication for nonmanager transaction data includes usernamepassword id format access privilege database signature validation information u table 333 prsn pdedeliveryonly client node interface data types unclassifiedfor official use only 27 unclassifiedfor official use only 334 u prsn pdekmiaware device otnk u table 334 describes the types of data that wi ll be exchanged between the pde of the prsn and kmiaware device u table 334 prsn pdekmiaware device interfac data types data type description data items kmiaware device identification and authentication the prsn pde receives identification authentication data from the kmiaware device to verify and validate the privilege database is queried for ia data status the data used in this transaction includes ia mechanism used for kmi aware device id format access privilege database credential signature signature validation information credential validation the prsn pde verifies the technical correctness expiration and revocation of credentials supplied by the kmiaware device the data used in credential validation transaction include ia mechanism used for kmi aware device date ckl trust path validation information key delivery the prsn pde supports the delivery of key material to kmiaware device the key delivery transaction data includes ia mechanism used for kmi aware device product list fill group profile distribution profile key material seed key conversion kmiaware device requests conversion of its seed key to operational or infrastructure key the prsn passes the request to the grfe and provides the result to the device the seed key conversion transaction data includes device identity seed key converted operational or infrastructure key rekey the prsn pde supports the rekey of kmiaware device the rekey transaction data includes ia mechanism used for kmi aware device prsn certificates session key u table 334 prsn pdekmiaware device interfac data types unclassifiedfor official use only 28 unclassifiedfor official use only 34 u prsntranslator interface ufouo to support communications between kmi and ekms translator will be used to support the interface each system will be respons ible for maintaining its own audit data however the translator will be able to record an udit trail for the exchange of information between the two systems u the types of data that will traverse the prsnt ranslatorekms message server ms interface include distribution management text mes sages accounting and bulk encrypted transaction data u table 34 prsntranslator interface data type s data type description data items vpn session establishment the prsn and translator exchange vpn session establishment data the vpn session establishment transaction data includes appropriate keying for the vpn connection request location information for each prsn vpn kmi sends formatted message to ekms ms the prsn sends the translator signed transaction validates the source strips header information checks directory for recipient address repackage transaction in x400 and sends it to the ekms ms and an event record is generated the kmi sends formatted message to ekms ms transaction data includes kmi formatted transaction appendix sender identity recipient identity message data signature tracking data tracking events will be collected formatted signed and provided to the prsn cse through the prsn vpn interface from the translator the tracking data transaction data includes sender identity recipient identity message identifier u table 34 prsnpki psn interface data types 35 u translatorekms interface ufouo to support communications between kmi and ekms translator will be used to support the interface each system will be respons ible for maintaining its own audit data however the translator will be able to record an udit trail for the exchange of information between the two systems u the types of data that will traverse the prsnt ranslatorekms message server ms interface include distribution management text mes sages accounting and bulk encrypted transaction data unclassifiedfor official use only 29 unclassifiedfor official use only u table 35 translatorekms interface data type s data type description data items ekms session establishment the ekms and translator establish secure session using type 1 link encryption the vpn session establishment transaction data includes appropriate keying for the session connection request ekms ms sends formatted message to kmi the ekms ms sends an ekms transaction to the translator the directory checks for recipient address the transactions protocol is converted to kmi format and an event record is generated the ekms ms sends formatted message to kmi transaction data includes ekms x400 formatted message sender identity recipient identity message data signature tracking data tracking events will be collected formatted signed and provided to the prsn cse through the prsn vpn interface from the translator the tracking data transaction data includes sender identity recipient identity message identifier u table 35 translatorekms interface data types 36 u translatorcsn interface u the ekms translator will provide audit securit management and performance management information to the csn for analysis and archiving the vpn employed between the translator and the csn is likely to be cots p roduct rather than type 1 haipe u table 36 translatorcsn interface data types data type description data items vpn session establishment the csn and psn exchange vpn session establishment data the vpn session establishment transaction data includes connection request transaction package signed transaction configuration management csn to translator the csn establishes and manages authorized nodal configurations including the policy rules for the composition and arrangement of components the configuration management transaction data includes policy rules for configuration systemwide rules for composition arrangement of components audit translator to csn the csn reduces and merges securitycritical system data collected from the psn for analysis and archive as available the data used in an audit collection includes product generation data unclassifiedfor official use only 30 unclassifiedfor official use only u table 36 translatorcsn interface data types data type description data items analysis and archive as available delivery data internal management functions security management translator to csn the csn consolidates and merges the security data collected from the psns for analysis as available the security management transaction data includes security configuration parameters consolidated aswr ids performance management translator to csn the csn reduces and merges data collected from the psns for analysis of the health of the kmi the performance analysis transaction data includes system state health data system metrics data u table 36 translatorcsn interface data types 37 u csnpsn interface u the csn provides configuration management the kmi product catalog and provides catalog infor mation to the psn as required for the production of products u table 37 csnpsn interface data types data type description data items vpn session establishment the csn and psn exchange vpn session establishment data it is likely that this will use cots vpn technology instead of type 1 haipe devices the vpn session establishment transaction data includes connection request transaction package signed transaction configuration management csn to psn the csn establishes and manages authorized nodal configurations including the policy rules for the composition and arrangement of components the configuration management transaction data includes policy rules for configuration systemwide rules for composition arrangement of components audit psn to csn the csn reduces and merges securitycritical system data collected from the psn for analysis and archive as available the data used in an audit collection includes product generation data delivery data internal management functions security management psn to csn the csn consolidates and merges the security data collected from the psns for analysis as available the security management transaction data includes security configuration unclassifiedfor official use only 31 unclassifiedfor official use only u table 37 csnpsn interface data types data type description data items available parameters consolidated aswr ids performance management psn to csn the csn reduces and merges data collected from the psns for analysis of the health of the kmi the performance analysis transaction data includes system state health data system metrics data u table 37 csnpsn interface data types 38 u psnpsn interface u the tier 0 key generation systems eg psns currently share specific historical transaction information with each other to facilitate load bal ancing and other operational requirements details of these transactions is not available at p resent but notation is being made in order to ensure completeness u table 38 psnpsn interface data types data type description data items vpn session establishment the tier 0 psns will establish secured connection either by use of vpn or by link encryptors the vpnlink session establishment transaction data includes connection request transaction package signed transaction psn historical data historical transaction and stat data is shared amongst psn systems format and specifics tbsl tbsl u table 38 csnpsn interface data types 39 u clientclient interface u kmi client nodes will be able to communicate di rectly with each other in order to facilitate local key management in environments where reachba ck to the kmi infrastructure may be intermittent or unavailable clientclient interfa ces will be simple peertopeer connections over tcpip networks or via dialup link encryption wi ll be used on this connection to to prove the identity of the remote client prior to establishing connection and to prevent unauthorized disclosure of data u table 39 clientclient interface data types data type description data items session establishment the koa managers client establishes connection with another client using protocol session establishment will require the exchange of information such as unclassifiedfor official use only 32 unclassifiedfor official use only u table 39 clientclient interface data types data type description data items such as ppp or slip based on preexisting addressing and configuration information connection request and response identity credentials cooperatively generated session key send bulk encrypted transaction koa manager will create bet encrypted for the remote clients akp or possibly kp and will send that bet over the active session tbsl receive bulk encrypted transaction koa manager will receive bet sent by remote koa manager and store the bet on the managers client node for future use tbsl acknowledge receipt when the receiving koa manager unpacks the bet and acknowledgement is sent back to the sending koa manager this may be stored and shipped when connectivity exists tbsl query for receipt koa manager can query remote koa manager for the status of bets transmitted tbsl u table 39 clientclient interface data types unclassifiedfor official use only 33 unclassifiedfor official use only 4 u kmi ci2 interfaces to external systems ufouo the kmi ci2 will interface with several external systems these systems may include defense courier service dcs external directory systems global directory system gds foreign directories dod pki incident reporting center helpdesk ufouo the kmi will interface to these systems v ia prsn external systems enclave specific configuration of will be cre ated and deployed to interface with each of these external systems the interface specificatio n for each must be defined for each specific system with which the kmi must interoperate 41 u defense courier service interface u the kmi will interface with defense courier ser vice dcs to support physical delivery of products the products are requested through ci2 nd directed into dcs for delivery product managers will be allowed to query the dcs for track ing data regarding the delivery status of physical material 42 u directory interfaces u the directory interfaces supported by the ci2 include both the dod global directory system gds and the foreign directories 421 u ci2 to global directory system interface u the kmi will rely on the dod gds for making cer tificate related information eg crl available to the kmi ci2 user community for certif icate validation 422 u foreign directories u the kmi will interface with foreign directories to receive selected user certificate related information eg crls to support communications w ith foreign users 43 u dod pki interface u this interface is tbd 44 u incident reporting center interface ufouo the kmi will manage monitor assess and report information on attacks mounted against it at both the prsns and csn when such in cidents occur they will be reported to dod ia incident and response system via telephone messaging or email or other communications methods at present automated i nterface with the kmi ci2 is planned unclassifiedfor official use only 34 unclassifiedfor official use only appendix ekms transactions supported by kmi ci 2 ufouo the interface between the ekms message rver and kmi ci2 translator will support the following required exchanges of accounting transactions dist ribution management transactions electronic key packages and formatted plain text messages between kmi and ekms provides mechanism through which the kmi user com munity can communicate with the ekms facilitates the transition of ekms users to kmi ci 2 ufouo table includes the ekms transactions th at are supported by ci2 and traverse the interface between the ekms message server and trans lator u table ekms transactions supported by kmi ci 2 ekms formatted transactions description ekms formatted transaction conversion report describes change in item identifiers or alc for equipment keyaids ekms formatted transaction destruction report sent by comsec account to its cor to notify of destruction of an accountable item ekms formatted transaction generation report sent by generating element to its cor when centrally accountable material is generated or by sub account to its parent for all alc 6 or 7 material ekms formatted transaction inventory report sent by comsec account to its cor to notify of current holdings as believed by the account sent by cor to an account to notify of current holdings as believed by the cor ekms formatted transaction key conversion notice from cff or tier 1 to comsec accounts notifying of firefly 9 seed key converted to operational key and initial rekey of operational key ekms formatted transaction possession report from comsec account to its cor notifying of unexpected possession of material also can be used cor to cor ekms formatted transaction cancel distribution transaction used to cancel transfertransfer report initiating for centrally accountable material ekms formatted transaction relief from cor to comsec account notifying it of relief from accountability for an unclassifiedfor official use only 35 unclassifiedfor official use only accountability report item eg following an inve stigation ekms formatted transaction tracer notice sent subsequent to transfer report initiating when receipt is received sent from sender of key cor where appropriate to the key recipient ekms formatted transaction transfer report initiating from an element shipping key to the element receiving the key and its cor for centrallyaccountable material giving the details of the shipment also referred to as the advance shipping notice ekms formatted transaction transfer report receipt mechanisms for key recipient to receipt for received key shipments sent from the key recipient to the sender of key or cor where appropriate ekms formatted transaction inventory reconciliation status refers to an initial inventory report list of all unreconciled items sent from the recipient of an inventory report to the sender of the inventory report ekms formatted transaction request inventory sent by cor to an account or parent account to sub account requesting an inventory report ekms formatted transaction bulk encrypted transaction body used to send multiple encrypted keys can be created by an lmdkp cff cffm and tier 1 ekms formatted transaction free form text from any ekms element to any other ekms email