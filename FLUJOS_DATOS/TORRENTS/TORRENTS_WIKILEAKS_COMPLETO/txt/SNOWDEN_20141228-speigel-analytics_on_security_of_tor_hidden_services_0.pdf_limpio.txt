tor hidden services how hidden is hidden ictr network expl this information is exempt under the freedom of information act 2000 foia and may be exempt under other uk n information legislation refer any foia queries to gchq on uk top secret strap1 comint tor is an implementation of 2nd generation onion routing originally sponsored by the us naval research laboratory later became an electronic frontier foundation project helps to prevent network traffic analysis surveillance open network with over 2000 nodes anonymity tool uses multiple layers of encryption multihop proxy crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 2 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint general tor research homing troll bridge discovery capability hidden services helped with few deanonymisation techniques worked with jtrig mcr maths crypt research provided support to op superiority crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exerrmtion under other uk information leaislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 3 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the m tor copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemntion under other uk information leoislation refer disclosure requests to gchq on uk top secret strap1 comint is ah ltn crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act sb 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 5 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint the good people living in oppressive countries circumvent firewalls access to free media instead of state propaganda people can say what they want without it being linked to their public profile the bad bot herders use tor to give instructions to their bots allows paedophiles access content without linking themselves to it state actors can launch attacks without being attributable anonymous lulzsec crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated throughout the recipient organisation bicygpagçsor mustttjir dissemination outside the uk top secret strap1 comint any traffic between the client tor is heavily encrypted we can only really see traffic from an exit node to website but we dont know where this traffic originated from still could link up aliases though m somebody could still visit dodgy forum and log in with an alias or even send an email using known target email address assuming they dont use ssl phew at least there is some intelligence gain right crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated throughout the recipient organisation bicygpafjor mustttjir dissemination outside the uk top secret strap1 comint hides the ip address of web service protects content providers by anonymously hosting content publication of undesirable content both client and server are anonymous to an observer and to each other user normal tor clear text hidden services website user website encrypted contains intellectual property owned andor managed by ownership gchq the material may be disseminated g throughout the recipient organisation bicljtgjpermisor must jjttjir dissemination outside the olluë rtirti rt icirt n uk top secret strap1 comint not much all hidden service traffic is heavily encrypted most we can gather is that one tor node talks to another ip level hiding in the crowd at its best crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exerrmtion under other uk information leaislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 9 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the whats this onion business tld tor uses to initiate connection to hidden service example onion domain w 16 characters in base32 few characters are actually missing oqznfi3tdo6nwg3fonion dns l tor uses something similar to dns to resolve an onion domain onion domains resolve to 3 ip addresses called introduction points ipt crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated throughout the recipient organisation bicygpagçsor mustttjir dissemination outside the uk top secret strap1 comint pieces of the jigsaw the actual hidden service hs where the service actually originates from user the user who wishes to access the hidden service hidden service directory hsdir directory server that hold information on hidden service introduction point ipt j hidden services front door relay rendezvous point rp clients front door relay crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act sptl 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 11 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 12 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs hsdir ipt t hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 13 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint fitting it together 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs client njgr 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs hsdir ipt hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 14 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint fitting it together 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs client 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs ipt hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 15 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint fitting it together 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp client l3l ipt 8 rp relays between client and hs hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act sjo 2000 and may be subject to exemdtion under other uk information leaislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 16 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint fitting it together 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs client hp ipt rp hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to expmn1inn iinrlpr nfhpr uk infnrmatinn ipriklatinn rpfpr riidrlosure requests to gchq on i contains intellectual property ownea anaor managea oy uwnersnip uuiig i ne material may be disseminated slide 17 throu9hout the recipient organisation bicperm5on musttjlr dissemination outside the uk top secret strap1 comint fitting it together 1 hs selects random i pts 2 hs uploads descriptor to hsdir 3 client finds out about hs 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs hsdir client hi ipt hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemdtion under other uk information leaislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 18 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint 1 hs selects random ipts 2 hs uploads descriptor to hsdir 3 client finds out about hs 4 client requests descriptor from hsdir 5 client selects random rp 6 client contacts one ipt 7 hs replies to rp 8 rp relays between client and hs clien hsdir ipt rp hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 19 throu9hout recipient organisation bitj0lpaj3son must dissemination outside the omanicatinri uk top secret strap1 comint rendezvous point rp what if we owned the rp traffic still encrypted although only single layer of encryption still only content dont know who the user is or where the hs is located clients randomly select their rp so unlikely to be picked anyway hidden service directory hsdir if we take hsdir down there are still many left could potentially collect onion domains if we acted as hsdir client real way to distinguish between tor user accessing the web or hs crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property ownea anaor managea dy uwnersnip jlhu i ne material may be disseminated throughout the recipient organisation bicygpbon musthjjfjltjflvjr dissemination outside the uk top secret strap1 comint introduction points ipt all hidden service ipts are listed on its descriptor the thing thats stored on hsdir potential for an attack on ipts to stop them accepting connections for the hs this could be done using coil attack doesnt stop hs selecting another set of ipts hs can encrypt their ipts in their descriptor but not many do crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exerrmtion under other uk information leaislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated throughout the recipient organisation bicygpafjor mustttjir dissemination outside the uk top secret strap1 comint hidden service hs what about exploiting the hs directly potential to identify the ip addresses hidden services but cant really say which one identified beaconing pattern from hs dependant on collection posture great for preston crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act fë 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 22 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exprnntïnn unrlpr nthpr i ik infnrmatinn ipnklatinn rpfpr disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 23 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the imwjititi éémh 0 0 crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 24 throughout the recipient organisation bi0fgpaf9sjvori must ljttjir dissemination outside the uk top secret strap1 comint tor helps people become anonymous very naughty people use tor hidden services hide the fact web content even exits near impossible to figure out who is talking to who its complicated some areas for further research until then doesnt stop us from using them crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exemption under other uk information legislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 25 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the uk top secret strap1 comint questions crown copyright all rights reserved this information is exempt from disclosure under the freedom of information act 2000 and may be subject to exerrmtion under other uk information leaislation refer disclosure requests to gchq on contains intellectual property owned andor managed by ownership gchq the material may be disseminated slide 26 throughout the recipient organisation bicljtgjpjsror must fjffcjflftflvjff dissemination outside the