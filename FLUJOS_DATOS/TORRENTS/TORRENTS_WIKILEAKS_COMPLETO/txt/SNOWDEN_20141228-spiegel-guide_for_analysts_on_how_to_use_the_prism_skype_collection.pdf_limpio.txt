top secretcomintnoforn tssinf users guide for prism skype collection august 2012 poc for document s3531 l tssinf introduction prism skype collection can be identified by the following ai sigad us984xn this sigad is used for all prism collection not just skype collection aii case notation p7 where the represents wildcard b sustained skype collection began in feb 2011 against in and out modes this is the mode in which one end of the call is using skype application and the other end is using landline or cell phone without skype application this is audio only prism collection added exploitation against peertopeer skype applications in july 2011 in this mode bothall users are using the skype application this can be mixture of audio video chat and file transfers prism collection can be from both modes of communication however there is distinction made in the case notation c prism collection is available for surveillance tasking in utt there is stored comms or search capability for tasking 2 tssinf questions on tasking skype selectors to prism can i task something other than skypeuser ai this is your only option for skype selectors in prism you cannot task skypemailtoken b do i need to include vseries zipcode bi yes when you submit faa skype requirements please remember to include vseries zipcode otherwise voice content will not be routed to nucleon derived from nsacssm 152 dated 20070108 declassify on 20361001 top secretcomintnoforn top secretcomintnoforn c can skype user have more than one skypemailtoken ci yes they can link 2 or more email addresses to their account each has corresponding skypemailtoken you can query decodeordain to find out what email address they correlate to d is there any benefit or harm to tasking both the skyuser and skypehash for the same user to prism di tasking skypeuser automatically tasks the skypehash to utt the only time you need to explicitly task skypehash is when you dont know what the correlated skypeuser is ie querying decodeordain with the skypehash fails to return correlated skypeuser and after youve contacted ind they fail to find correlated skypeuser 3 tssinf questions on locating skype prism data how do i find skype data in pinwale ai best way to query in pinwale is by decodeordain enriching your targets skype username as follows ail enter the skype username in the pinwale query form right click on the username that youve typedin and click decodeordain then apply ai2 pick skypeuser from the choose realm pulldown list and click ok ai3 youll now see screen like the one attached pick which ever permutations you want or just leave them all checked to get everything and click ok ai4 submit your search b how do i locate skype collection using decodeordain bi attached is screenshot of how you can use decodeordain to find skype video chat content top secretcomintnoforn top secretcomintnoforn ulsr d ecooeor dain pflrmulalion solictor secret ttc omut ii decooeordain wurrted 5hnvililmfdrwikf0tuir ftum on monjiil 25 162s55 edt zoii usiflfftimtluhed ftifiti slfllljjii mullsi fjtrnlipri ftlnclbw im k pr co seer in traffic cusnl 114 5tyiitl5trl inj internet general skjfet clltnt b and eikyihtrj and internet ifcfpt ubilm pi nd fvpiviirj ihj lattralf siiypi lt hi it 1 tor elect ai anamm ft j i tunrtl i bil by selecting the general skype permutation you will query all skype prism traffic regardless of whether there is any content or not bi2 by selecting only the skype chat permutation you will narrow the query to only skype prism traffic that contains instant messaging content bi3 by selecting only the skype webcam permutation you will narrow the query to only skype prism traffic that contains at least one visible video stream bii please note that when marina says that skypeuser webcammed with another user that event did actually happen but the content may not be visible in pinwale because part of the video stream may have been lost prohibiting us from being able to reconstruct the video if you want to look for pinwale documents that have webcams that are actually visible you can use the decodeordainenabled pinwale query option described above c my skype pinwale cut says printaura skype what does that mean ci the display name is printaura skype for both the uis text presenter and the dni presenter the dni presenter and uis text presenter both have the capability to display skype chat file transfers and video the dni presenter has single combined display for skype webcam that allows the user to play the video and audio together in synchronized mode or individually within uis the user will need to use uis hotzone to play the corresponding audio cuts d how do i search for skype data in nucleon top secretcomintnoforn top secretcomintnoforn di you can query by case notation p7 where wildcard or you can query by username in the telephone_numbers field note that if your target has long username you may have trouble searching by username due to length limitations in nucleon but you wont have any trouble searching by case notation in nucleon dii another way to pull up the audio in nucleon is to pull on the zipcode that the audio was sent to if you pull it up this way the skype audio displays along with the rest of the faa audio that was sent to the same zipcode wheres the other side of my voice cut in nucleon ei ces has added great new service for opis on prism and fbi fisa voice collection all voice cuts will now be autopaired and you will not have to hunt down the other side of phone calls you will automatically be presented with both sides of the conversation in nucleon previously analysts would have to search through nucleon to find both sides by looking at the targets and the timestamps to guess which ones are paired f wheres the audio to go with my skype video fi within the dni presenter dnip the user can utilize the view associations service to find the associated nucleon audio of the pinwale document or find the associated pinwale document of the nucleon audio in other words you can find the mam andor tam associations to any associated skype data and then display them within the dnip skype combined display or the dnip composite display also from the uis text presenter you can launch the dni presenter to utilize this viewassociations service g how do i tell when storedsearch comms arrive from prism gi there is collection capability for storedsearch comms in skype prism h why do i receive multiple copies of skype chat sessions hi you might get chats in segments and then get the whole chat in third collect this is how skype works depending upon what your target is doing copy of his chat history can be sent inbulk which can span multiple chat sessions if you target for example has 3 separate chat sessions with another individual on his laptop then logsinto his skype account on his desktop the chathistory of those 3 separate chat sessions will be transmitted from this laptop to his desktop so that both his computers have log of the whole conversation top secretcomintnoforn top secretcomintnoforn what does 0 frames available mean in my skype video results whenever you see this in pinwale stream 1 has 0 frames available or stream 2 has 0 frames available it means that we know that videofeed was taking place but we didnt get enough traffic to reconstruct any video frames either the target was unable to get video feed up or too much traffic was lost during the collection process to reconstruct any images j why are so many email addresses correlated to one skype user account ji these are probably all valid associations skype does not require that user enter valid email address when creating skype account which establishes their skypemailtokens simple email address like abedhotmailcom is likely to be randomly picked by large population of skype users when creating their accounts so its not unreasonable to find lot of correlations you will likely find similarly high correlation count for something like abchotmailcom or asdfhotmailcom or bobhotmailcom these are not false hits these users did enter this email address when creating their skype account but lot of them probably did so to maintain their anonymity by typing in something simple random rather than their true email address k whats wrong with the timestamps in my skype data ki this is due to 2 reasons 1 skype sends chunks of old conversations to synchronize conversation histories across multiple skype installations dni presenter uis attempt to detect historic conversation dumps and label them as such but keep in mind these conversation histories can be quite old days or weeks so its important to pay close attention to the timestamps 2 there are 2 timestamps displayed in uis dni presenter for skype the first is the collection time and the second is the targets local computer time dni presenter displays them properly as collection time gmt and user workstation time gmt please note that nsa has control over the user workstation time target could decide to set his local computers clock months or years off from the true time i why do i sometimes have to piece together lot of chat sessions from skype top secretcomintnoforn top secretcomintnoforn li the reason why youre seeing pieces of skype chats in different documents is for 3 reasons 1 the data is too big and is being fragmented into multiple documents this isnt that common however 2 skype sends chunks of old conversations to synchronize conversation histories across multiple skype installations these old conversations are sent piecemeal across multiple chat sessions 3 every time skype user disconnects from skype and reconnects again they being new session its common to see skype users disconnect reconnect frequently whenever skype stops performing well for them ie if their video or audio messes up its common to see skype user disconnect reconnect to get it working again every time they do this new pinwale document is started items 2 and 3 are based entirely on target behavior its not collection problem and is not being introduced by nsa m why does my skype playback get out of sync the main issue is dataloss causing the audio to skip and fallbehind ces is working on few techniques to help keep the audio insync between channels and with the video the video should always be insynch since we timestamp each video frame 4 tssinf questions on miscellaneous issues how do i find out the email address of my skype target the collection only gives the skypeuser skypenode and skypemailtoken ai email addresses are not included in skype collection skypemailtokens which are derived from email addresses are you can search marina for skypemailtoken to skypeuser correlations to detect username change in order to put new skypeuser selectors up on faa coverage you can also transform any email address into skypemailtoken using decodeordain decodeordain can also transform some skypemailtokens back into email addresses for cases where decodeordain cannot transform skypemailtoken into an email address please send an email toand request that they attempt to recover the email address from the skypemailtoken however please only do this if decodeordain fails to return the email address b can we collect skype voicemail bi if target connects via peertopeer connection we will not be able to collect any voicemail he receives or sends if target connects via pstn connection and uses his inout number to communicate with another users top secretcomintnoforn top secretcomintnoforn inout number then we will collect voicemails both of these scenarios only apply to surveillance collection we do not have any stored comms collection from skype at this time bii io is telephone number assigned by skype you can use either your skype id or your io number to makereceive calls if youre only making p2p calls you dont need an io assigned you only need an io number if you want to make calls tofrom the pstn note you can also make io to io calls which must hit pstn switch of some type what happens when both sides of skype call are tasked selectors ci prism should collect two copies of the communication this is true unless one of the users skype communications falls into one of couple of technical limitations which prevents us from currently collecting via prism why did i receive small and incomplete files from skype collection di the first 256 bytes of document for transfer are sent so that the skype client can figure out what type of file it is pdf verses jpeg it showsup on the users skype chat window as message that says something like so and so is attempting to sent you file click here to download etc if the user doesnt choose to download it then you will not receive the entire file but only this first nibble of data which might include the filename dii also due to known limitations in our collection process some larger size files being transferred by targets may be not be fully collected there is stored comms capability to go back and retrieve these files how does the skype credential crc work and what will i see in collection ei the way skype works users in the raw data are represented by their skype credential crc skypecredcrc usually the data contains enough information such that we can figure out what skypeuser maps to the skypecredcrc but sometimes this isnt possible skypecredcrcs are temporary identifiers so theyre not targetable normally analysts dont top secretcomintnoforn top secretcomintnoforn have to worry about skypecredcrcs because ces protocol exploitation is able to map them to skypeusers but there are handful of edge cases where they dont have enough information to do so also skypeuser can have more than 1 skypecredcrc associated with them so the possibility that skypecredcrc showsup in your collection and is associated with one of the alreadyexisting communicants in the collection is very possible although its not universally true ces only holdsup collection for certain period of time before they giveup trying to figureout how to map an unknown skypecredcrc to skypeuser 12 hours would be too long that would buildin 12hour delay into all skype collection before you got to see it if you rurnntskvpecredcranannot figure out who it is just send an email to and someone either in pe or sso can try and figureout if we or the fbi has learned the correlation afterthefact it is not possible for you to see the correlation in the raw data encryption is used to mask the correlation f how does skype work fi skype is true peer to peer service communications are not routed between central servers they are only routed between skype users ie peers nsa receives skype collection via prism when one of the peers is faa702 tasked target there are 3 collection scenarios target other_person b other_person target c target same_target scenario and b occur when target is communicating with another individual this communication may not be very interesting ie it might not be an im voice or video it may just be request to retrieve that individuals avatar to display but there was some type communication between these two users and the target is party to that communication top secretcomintnoforn top secretcomintnoforn scenario c is an interesting case it implies that the target is talking to himself in fact he is this scenario occurs when the target uses 2 different devices ie laptop and mobile phone or laptop desktop etc and is logged in from both devices at the same time these 2 devices will automatically synch with each other and transmit information between them including past communications that the target was party to now when it comes to multiparti communications conference calls multi person ims etc skype is still peertopeer protocol 1tol skype creates meshnetwork where users are connected together through multiple peertopeer links instant messages sent to this group of meshed participants can be routed through any participant for example if b and c are chatting together in conference chat the peertopeer network may look like this b c in this scenario ims from to b and c will all be routed through b if b is our target we will see these ims but b is party to these ims because theyre multiparty ims not private ims between and c 5 tssinf other useful resources instructional videos on kapshare learning portal ai go to this link and type in skype in the search box you will see list of short videos which describe different aspects of skype exploitation as of nov 2011 the list includes primer on how skype works how to analyze skype metadata skype in xkeyscore and other topics b email the prism technical help team with any skype question dl bl_prism_help c visit the prismfaaweb site and search the faq section for skype answers and tips top secretcomintnoforn