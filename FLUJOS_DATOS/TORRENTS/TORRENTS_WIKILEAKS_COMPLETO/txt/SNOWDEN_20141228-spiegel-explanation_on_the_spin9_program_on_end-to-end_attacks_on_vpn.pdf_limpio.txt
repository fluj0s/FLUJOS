the overall classification for this brief is topsecretcomintrel usa aus can gbr nzl20320108 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u current fielded capability tssirel all current turmoil virtual private network vpn capabilities are fielded as spin 6 red architecture software running on red architecture hardware vpn metadata red tec capability after blue transition on 17sep yrs sso mhs live mhs dev capability capability red capability vpn decryption red capability after blue transition on 17sep capability capability red capability tdp rfnrftnnmimtrfi usa aijs ham hrr n71 pmnioft 2 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u spin 9 objectives ssirel the spin 9 objective for the turbulence vpn private capability is to transition to the blue architecture ssirel spin 9 vpn will implement redesign of the decryption flow that reallocates some functionality between turmoil the vpn attack orchestrator vao and the vpn metrics service u deliver all capabilities as deployable at the end of spin 9 tdp rfnrftnnmimtrfi usa aijs ham hrr n71 pmnioft 3 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u capabilities tssirel the vpn capability will implement an operational capability to detect and decrypt selected communications that are encrypted using ip security ipsec algorithms and protocols it will forward the unencrypted content to follow on processing systems tssirel the vpn capability will collect metadata about ipsec internet key exchange ike events and forward the metadata to followon sigint development sigdev systems tdp rfnrftnnmimtrfi usa aijs ham hrr n71 pmnioft 4 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade ufouo exploited protocols tssirel ipsec automatic key management protocols establish security associations between communicants security association sa is relationship between source and destination that includes session key and other parameters the vpn capability exploits the following key management protocols u isakmp internet security association and key management protocol rfc2407 rfc2408 provides the authentication and key exchange framework u ike internet key exchange rfc2409 provides the authentication and key exchange mechanisms tdp rfnrftnnmimtrfi usa aijs ham hrr n71 pmnioft 5 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade ufouo exploited protocols continued tssirel ipsec security protocols provide integrity confidentiality and authentication for higher layer ip protocols ipsec security protocols use security associations previously established either manually or by automatic key management protocols ike the vpn capability targets sas that are established by ike the vpn capability exploits the following security protocol u esp encapsulating security payload rfc2406 provides traffic confidentiality via encryption and optionally provides authentication and integrity protection tdp rfnrftnnmimtrfi usa aijs ham hrr n71 pmnioft 6 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u ipsec operation alices bob isakmpike phasel unencrypted handshake n i1 isakmpike phasel isakmpike phase2 encrypted handshake isakmpike phase2 alice ip source security association database security association database cleartext bob ip destination u an sa is identified by a4tuple srclp dstip spi securityprotocol where the spi security parameter index is chosen by dstip for sa uniqueness u the bidirectional isakmp sa is negotiated in phasel and protects the esp key negotiations in phase2 u unidirectional esp sa is negotiated in phase2 and is used to protect the users cleartext u reverse communication bob alice requires separate esp sa and is negotiated using the same isakmp sa as used for alice bob top sfnrftnomintrfi usa aus ham hrr n71 pmnioft 7 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u ipsec modes internet ip hdr srca dstb esp header encrypted data esp trailer u transport mode u original ip header is preserved u esp header and trailer encapsulate and encrypt remaining ip packet n√¢ecurity gatewayxinternet security gateway i 1 ipfb ip hdr srcfa dstfb esp header encrypted ip hdr srca dstb encrypted data esp trailer u tunnel mode u security gateway at source encapsulates encrypts and adds new ip header to original packet u security gateway at destination recovers and forwards original packet u identities of traffic source and destination is concealed u extra padding also may be added to hide packet size top sfnrftnomintrfi usa aus ham hrr n71 pmnioft 8 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade ssirel vpn products x tssirel bundled decrypt are the decrypted packets from an esp security association prior to any session or application processing tssirel sessionized decrypted packets are the decrypted packets that have been recursively processed by the turmoil stage 1 sessionizer for sigdev ssirel selected application sessions are the recursed turmoil sessions that have been selected by keycard strong selection and subsequently processed by turmoil stage 2 application processing ssirel ipsec metadata are derived from ike events for vpn sigdev ssirel vpn metrics are produced by ces ca components for internal use top rfnrftcnmimtrfi usa aijs ham hrr n71 pmnioft 9 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade ssirel vpn product dataflows x tssirel bundled decrypt are delivered directly to wealthycluster 20 wc20 via tube from turmoil as packets for application processing that is not available in turmoil tssirel sessionized decrypted packets are delivered without selection fulltake to xkeyscore from turmoil for target sigdev ssirel selected application sessions are delivered to pressurewave via tube format conversion and exopump where data and metadata object are created and inserted into pwv for legacy analytics and analysis tools ssirel ipsec metadata are delivered to toygrippe via pwv where an analytic converts ipsec metadata to tgif format and pushes it to toygrippe ssirel vpn metrics are delivered to ca resources by the turmoil piq blade via ces firewall reference vpn spin 9 dataflows top rfnrftcnmimtrfi usa aijs ham hrr n71 pmnioft 10 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade ssirel vpn product retrieval mechanisms x ssirel wc20 an analyst uses the agility interface on wc20 to view selected traffic as the intended recipient would see it ssirel pressurewave the pressurewave analytic and standing query pulls reformats and pushes metadata objects to toygrippe ssirel toygrippe sigdev analyst uses the toygrippe query interface to pull vpn metadata top sfcrftoomintrfi usa aus can crr m7i 0 11 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade ufouo selection mechanisms ssirel protocol selection identify vpn traffic in ip traffic ike versioni 0x05hdrl_en0xff nxtprotocol17 srcport500 dstport500 esp version4 hdrl_en5 nxtprotocol50 ssirel session selection identify session packets in vpn traffic ike srclp dstip srcport desport nxtprotocol 5tuple esp srclp dstip spi tssirel target selection identify select and task target in vpn sessions keycard performs target selection lookup with ip selectors keycard lookup result determines tasking disposition not transform action transform decrypt transformsurvey decrvot and send to xkeyscore transformforwaridaakmj send to wc20 transformsurveyforward decrypt and send to xkey wc20 top rfnrftcnmimtrfi usa aijs ham hrr n71 pmnioft 12 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u design constraints tssirel spin 9 vpn will use the following components capability component vpn identification and decryption vpn metadata piqblade x wc20 vpn attack orchestrator vao toygrippe function extends the ces enclave to turmoil for decryption and other ca processing receive bundled decrypt for application processing provides ike esp matching functionality it communicates with the piqblade and is located behind the ces firewall receives vpn sotf metadata via pressurewave developer ceseso cessao txx ceseso top rfnrftcnmimtrfi ijfia aus ham hrr n71 pmnioft 13 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u delivery constraints tssirel spin 9 vpn will use the following delivery mechanisms capability vpn identification and decryption vpn metadata product x bundled decrypt for wc20 sessionized decrypted packets from turmoil data store to xkeyscore vpn ike setup metadata for pressurewave vpn ike setup metadata for toygrippe format sotf sotf sotf tgif mechanism mailorder socket socket via tube and exopump mailorder via vpn analytic top rfnrftcnmimtrfi ijfia aus ham hrr n71 pmnioft 14 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u management constraints ssirel all vpn deployments must be approved by chief ces top sfhrftcomimtrfi usa aus ham hrr n71 pmnioft 15 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u second and third party constraints tssirel spin 9 vpn identification and decryption capability will not deploy to third party sites ufouo spin 9 vpn metadata capability will deploy to all sites top rfnrftcnmimtrfi usa aijs ham hrr n71 pmnioft 16 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u what spin 9 vpn will do ssirel packet detection detect ike exchanges detect esp packets ssirel ipsec metadata flow bundle all detected ike with sri and send to pwv reference vpn spin 9 sequence diagram top sfhrftcomimtrfi usa aus ham hrr n71 pmnioft 17 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u what spin 9 vpn will do continued tssirel esp decryption flow when ike exchange is observed lookup ip addresses in keycard if tasked for collection forward to vao when esp is observed lookup ip addresses in keycard if tasked for collection request key from vao if decrypt key is provided by vao decrypt esp packet send vpn decrypt metrics to ces vpn metrics service in ca enclave recurse decrypted packets to find identifiers tasked for turmol processing send selected sessions to pwv via tube and exopump sessionize all decrypted packets and pass to xkeyscore for sigdev x forward all decrypted packets to wc20 for additional application processing process only tunnel mode esp packets top rfnrftcdmimtrfi ijfia aus ham hrr n7i fl3ri1 flfi 18 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u what spin 9 vpn will not do ssirel will not process ipsec in other protocol implementations will not perform patternbased ike esp detection will not process tcp500 udp4500 or tcp4500 implementations will not process ikev2 rfc4306 ssirel will not process nonipsec based vpns vpn capability will only process ipsec based vpns top sfrrftcomimtrfi usa aus ham grr n7i fl3ri1 flfi 19 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u endtoend test tssirel ike and esp test packets must use coordinated security associations ssirel use both synthetic lab generated and live collect test data ssirel live test data may only be processed through piq blade tssirel test data characterization must include 5tuples sourcelp destinationip protocol sourceport destinationport number of ike packets number of esp packets unencrypted esp payload content top sfrrftcomimtrfi usa aus ham grr n7i fl3ri1 flfi 20 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u test scenarios ssirel sunny day scenarios single vpn with all ikeesp packets available and vpn match exercise keycard tasking option combinations tssirel transform decrypt to pressurewave ike to toygrippe tssirel transform survey decrypt to pressurewave xkeyscore ike to toygrippe tssirel transform forward decrypt to pressurewave xwealthycluster 20 ike to toygrippe tssirel transform survev forward decrypt to pressurewave xkeyscore wealth ycluster 20 ike to toygrippe ssirel not transform ike to toygrippe top sfnrftcdmimtrfi usa aus ham hrr n7i fl3ri1 flfi 21 top secretcomintrel usa aus can gbr nzu20320108 vpn spin 9 fielded capability upgrade u test scenarios continued u failure scenarios tssirel esp decryption fails because bad key is returned by vao ssirel vao responds with key recovered ssirel vao key response timeout ssirel vao key response received after response timeout ssirel vao response received after tds hold time expires and esp is not available ssirel phase 1 and phase 2 ike is complete but esp is collected ssirel esp is collected but ike is collected top sfcrftrnmintrfi usa aus can firr n7i n3fl108 22 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 fielded capability upgrade u test scenarios continued ssirel miscellaneous scenarios ssirel multiple rapid 30 second phase 2 rekeys for same initiator responder pair ssirel two vpn sessions collected concurrently for same ip source tssirel decryption flow can be disabled ssirel ike metadata flow can be disabled top sfnrftcdmimtrfi usa aus ham hrr n7lnsmm 23 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 development integration activities decryption subflow ike esp sessions to tds ml lt tml app metadata flow decryption flow lt ft d legencml lttmll app tml lt decrypt app 19 oct vao icfm√† ppf app app sessionize v_ v 11 or ikejesp tivilj i vpn metrics ces tds tml top sfnrftcomimtrfi usa aus ham hrr n7i rttmr8 bridge tml tmi i√§t ftml appi 24 top secretcomint20320108 vpn spin 9 dataflows internet key exchange ike encapsulating security payload esp1 xkeyscore _vpn7 t socket connection c sessionized decrypted packets f sotf _vpn5 socket connection c ike records f sotf vpn6 t socket connection c selected application sessions f sotf vpn9 t mailorder c selected application sessons f sotf vpn8 t mailorder c ike records f sotf i note selected application sessions are identified and selected from the decrypted packets extracted from the vpn tunnel and inserted into the turmoil input stream exopump keycard interface key t transport c content f format vpn1 t socket connection c selector hit queryresponse f binary dataflow key selector lookup vpn metrics piq blade monitoring esp key requestresponse ike messages selected application sessions ike records sessionized decrypted packets _vpn2 _ t secure socket ssl c vpn metrics f soap vpn 18 t secure socket ssl c piq blade monitoring f websa vpn 3 t secure socket ssl c esp key requetresponse f soap vpn4 _ t secure socket ssl c ike messages f soap h t3 td to x co lll vpn metrics to cd w lll vao vpn11 t itx jms c selected appi sessions f xmlsotf _vpn10 t itx jms c ike records pressure wave metrotube toygrippe vpn12 t itx jms c ike records f sotf vpn analytic vpn 13 t mailorder c ike records f tgif top secretcomint20320108 25 top secretcomint20320108 vpn spin 9 metadata dataflows internet key exchange ike vpn 5 t socket connection c ike records f sotf vpn8 t mailorder c ike records f sotf l exopump turmoil interface key t transport c content f format dataflow key ike records vpn10 t itx jms c ike records f xmlsotf pressure wave metrotube vpn12 t itx jms c ike records f sotf vpn analytic toygrippe vpn13 t mailorder c ike records f tgif t top secretcomint20320108 26 top secretcomint20320108 vpn spin 9 decrypt dataflows xkeyscore internet key exchange ike t socket connection c sessionized decrypted packets f sotf vpn6 as t socket connection c selected application sessions f sotf vpn9 t mailorder c selected application sessons f sotf note selected application sessions are identified and selected from the decrypted packets extracted from the vpn tunnel and inserted into the turmoil input stream exopump i i n encapsulating security payload esp turmoil keycard interface key t transport c content f format vpn1 t socket connection c selector hit queryresponse f binary dataflow key selector lookup vpn metrics piq blade monitoring esp key requestresponse ike messages selected application sessions sessionized decrypted packets piq blade _vpn2 _ t secure socket ssl c vpn metrics f soap vpn18 t secure socket ssl c piq blade monitoring f websa tvpn3 t secure socket ssl c esp key requetresponse f soap vpn4 t secure socket ssl c ike messages f soap ro cd co x cd lu co cd w ili j vpn metrics ces watch vpn11 t itx jms c selected appi sessions f xmlsotf pressure wave top secretcomint20320108 27 top secretcomint20320108 stage 0 turmoil keycard tube xkeyscore exopump vao pwv m ike packet aggregatesessionize ike metadata 1 ike metadata transform or transform and surveys 0ike select query __l_ike selectj response ike metadati aggregate hd packet transform or transform and_survey h 1 h ike messages vpn metrics soap sp select query esp select response l aggregate ft 1 √∂ esp key request i i h vpn metrics soap key recovered esp key response decryption h vpn metrics soap if transform and survey recursion for sessionization i i i i sessionized decrypted packets i i i i i i if transform recursion for tunnel selection and application processing i i selected application sessions i selected h applicatio 1 1 1 n sessions 1 1 vpn metrics vpn analytic ces watch toygrippe ike metadata selected application sessions piq blade monitoring ty ike metadata 0 socket j mailorder islandtransport jms hi secure socket layer https top secretcomint20320108 28 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 metadata design details packet locftsslnfl fmeworit w in ev ppf stateti fvent cenerata fyp ieu√´m filter i stage √º dfid allocator sotf via socket sotf tdk component packet data ppf component keyword management mission application external servee omponent session data top sfnrftcdmimtrfi usa aus ham hrr n71 pmnioft 29 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 decryption design details application ornponent top rfnrftcdmimtrfi ijfia aus ham hrr n7i fl3ri1 flfi 30 top secretcomintrel usa aus can gbr nzl20320108 vpn spin 9 interfaces f source destination content format schema icd changes transport vpn1 turmoil keycard selector queryresponse binary cnsxsd socket vpn2 piq blade ces vpn metrics soaphttps vpnmetricsxsd yes socket ssl vpn3 piq blade ces vao esp cryptovariable requestresponse soaphttps vaoespxsd yes socket ssl vpn4 piq blade ces vao ike message soaphttps vaoikexsd yes socket ssl vpn5 tml home tube ike datametadata sotf databundleoutputxsd vpndatabundlexsd yes socket vpn6 tmlhome tube selected session decrypted recursively processed sotf turmoilcore vpndecryptxsd yes socket vpn7 tml home xkeyscore decrypted session sotf turmoilcore vpndecryptxsd yes socket vpn8 tube exopump ike datametadata sotf databundleoutputxsd vpndatabundlexsd yes mailorder vpn9 tube exopump selected session decrypted recursively processed sotf turmoilcore vpndecryptxsd yes mailorder vpn10 exopump pwv ike datametadata sotf databundleoutputxsd vpndatabundlexsd pwv schema yes itx vpn11 exopump pwv selected session decrypted recursively processed sotf turmoilcore vpndecryptxsd pwv schema yes itx vpn 12 pwv vpn analytic ike datametadata sotf databundleoutputxsd vpndatabundlexsd pwv schema yes itx vpn 13 vpn analytic toygrippe ike datametadata tgif tgif icd mailorder vpn14 tml home tec wc20 bundled decrypt sotf turmoilcore vpndecryptxsd yes mailorder top sfcrftoomintrfi usa aus can grr n7i n3mrr 31 top secretcomintrel usa aus can gbr nzl20320108 vpn specific bme tag vpnid id type 900791 string protocolnamespace 900667 string keyexchange espspi nextprotocol appid ikecookie ikepayload survey protocol 600533 string 55002 uint32 37007 uint8 114000 string 900683 string 900682 string 900790 string 2001 string value xxxxxxxxxxxx xxxxxxxx xxxxxxxxxxxx ipsecike ike xxxxxxxx iptunnel4 vpnesp 8 chars 68 chars vpnesp vpnesp context recursed packets xkeyscore session wc20 decrypt pwv metadata pwv metadata xkeyscore session wc20 decrypt xkeyscore session wc20 decrypt xkeyscore session wc20 decrypt pwv metadata pwv metadata description 16byte universally unique id that associates ipsec packets in processing history identify ipsec as transport protocol layer flags ipsec ike event 4byte spi from esp packet identifies ip tunnel in processing history identifies vpnesp in xkeyscore session destination cookie from ike packet raw pay load extracted from ike packet identifies vpnesp in protocol history as weakly xkeyscore session selected indicating session should not be forwarded to pressurewave recursed packets xkeyscore session identifies vpn in processing history wc20 decrypt top sfcrftcomintrfi usa aus can f√Ørr n7i ri3ri1 flr 32 top secretcomintrel usa aus can gbr nzl20320108 questions top sfnrftcdmimtrfi usa aus ham hrr n71 popoior 33 top secretcomintrel usa aus can gbr nzl20320108 background top rfnrftcdmimtrfi ijfia aus ham hrr n7i fl3ri1 flfi 34 top secretcomintrel usa aus can gbr nzl20320108 keycard u inputs u application id vpn ufouo raw selectors ip addresses of sessions carrying the ike exchange u context packet ip addresses both source and destination properly identified with realm derived from network universe u processing ssirel lookup raw selectors and report hitnohit results ssirel return tasking for hits u outputs ufouo evaluated selectors hit or nohit indicators target match data if necessary top sfrrftcomimtrfi usa aus ham grr n7i fl3ri1 flfi 35 top secretcomintrel usa aus can gbr nzl20320108 turmoil vpn metadata processing u inputs u raw packets u processing ssirel detect ike exchanges at udp source and destination ports 500 ssirel extract ip addresses responder cookie message id isakmp payload ssirel bundle all ike detect messages with sri u outputs ssirel sotf object containing metadata and ike packets top sfrrftrdmintrfi usa aus can grr w7i nsmn 36 top secretcomintrel usa aus can gbr nzl20320108 turmoil vpn decrypt processing u inputs u raw packets u selection results from keycard u processing ssirel detect esp packets and extract ip addresses and spi ssirel match tasked ike exchange packets with an esp packet stream ssirel generate uuid and assign to vpnid for unique exchange id ssirel send cryptovariable request to the ces vao tssirel if the key is returned decrypt the esp packets tssirel send decrypt metrics to the ces vpn metrics service tssirel recurse all decrypted packets from the vpn tssirel sessionize all decrypted packets pass sessions to xkeyscore x tssirel forward all decrypted packets to wc20 for application processing u outputs x tssirel decrypted packets to wc20 tssirel decrypt metrics to vao tssirel sessionized decrypted packets to xkeyscore ssirel selected application sotf top rfnrftcdmimtrfi ijfia aus ham hrr n7i fl3ri1 flfi 37 top secretcomintrel usa aus can gbr nzl20320108 xkeyscore u inputs ssirel sessionized collect in sotf format u processing ssirel recovers and archives session content databases metadata for query by analysts xkeyscore can also perform keyword scanning and optionally forward selected data back to pin wale presence tips can also be sent to trafficthief top sfrrftcomimtrfi usa aus ham grr n7i fl3ri1 flfi 38 top secretcomintrel usa aus can gbr nzl20320108 tube id and decryption u inputs u sotf objects u processing csirel defragments fragmented sessions creating an sotf object with the complete session csirel examines the bme to determine if the session should go to pwv csirel creates new sotf object placing the received or defragged sotf object into the data section the bme of the newly created object contains classification metadata as well as certain fields such as sessionid and signaluptime replicated from the bme of the original received sotf object note classification metadata needs more discussion to determine appropriate origination turmoil may assume some responsibilities u determines appropriate routing mailorder fdi and forwards the new sotf object to exopump via mailorder u optionally configurable wrap multiple objects destined for exopumppwv into one mailorder file to reduce the number of individual files transmitted u outputs u sotf objects top sfnrftcomimtrfi usa aus ham hrr n7i rttmm 39 top secretcomintrel usa aus can gbr nzl20320108 tube metadata u inputs u sotf objects u processing csirel examines the bme to determine if the session should go to pwv u determines appropriate routing mailorder fdi and forwards the new sotf object to exopump via mailorder u optionally configurable wrap multiple objects destined for exopumppwv into one mailorder file to reduce the number of individual files transmitted u outputs u sotf objects top sfnrftodmimtrfi usa aus gam grr n7i n3flinfi 40 hi exopump top secretcomintrel usa aus can gbr nzl20320108 u inputs u sotf object from tube via mailorder u processing u extracts metadata from sotf records for pwv xml metadata u inserts sotf objects and xml metadata into pwv u outputs u pressurewave metadata object top sfrrftcomimtrfi usa aus ham grr n7i fl3ri1 flfi 41 top secretcomintrel usa aus can gbr nzl20320108 pressurewave u inputs ssirel vpn metadata including ike payload objects with associated metadata represented in xml ufouo selected application data objects with associated metadata represented in xml u processing ssirel pwv hosts persistent or standing query created by the vpn analytic when new metadata arrives that matches the query the vpn analytic is notified and pulls the associated metadata and ike packets for further processing ufouo pwv serves as data store for analytics u outputs ssirel the metadata and ike packets are forwarded to vpn analytic via itx jms messaging service top rfnrftcdmimtrfi ijfia aus ham hrr n7i fl3ri1 flfi 42 top secretcomintrel usa aus can gbr nzu20320108 vpn analytic u inputs ssirel persistent query to detect vpn metadataike packets in pressurewave ssirel sotf files containing ike packets u processing ufouo convert sotf to tgif records u outputs ssirel mailorder files with tgif records containing intercepted ike packets top sfgrftggmintrfi usa aus can grr n7i 0301or 43 top secretcomintrel usa aus can gbr nzl20320108 toygrippe u inputs ufouo tgif the grand input format records based on tml collected metadata u processing ufouo toygrippe 32 system accepts tgif files sent by mailorder as bundled tar files tssirel toygrippe unbundles validates and stores the vpn metadata from the tgif files into database for later access by analysts primarily through web browser interface toygrippe supports data processing and storage for pptp and ipsec vpn metadata records top sfnrftcdmimtrfi usa aus ham hrr n7i n3flinfi 44 top secretcomintrel usa aus can gbr nzl20320108 vao u inputs ssirel ike packets ssirel esp cryptovariable cv requests u processing ssirel generates esp sa cvs from ike packets ssirel matches esp sa cv requests with generated cvs ssirel responds to esp sa cv requests u outputs ssirel esp cryptovariable response note vao requests that multiple esp packets also be sent for each session top sfgrftgnmimtrfi usa aijs gam grr n7i n3flinfi 45 top secretcomintrel usa aus can gbr nzl20320108 vpn metrics u inputs ssirel piq blade vpn processing metrics u processing ssirel internal to cesca enclave top sfcrftcomintrfi usa aus pan grr n7i r3m 08 46 top secretcomintrel wealthycluster 20 usa aus can gbr nzl20320108 u inputs ssirel bundled decrypted packets in sotf format via mailorder u processing u signal identification ssirel protocol recognition processing and sessionization csirel application identification and processing csirel link characterization aggregation ufouo filtering selection and forwarding ufouo strong selection ssirel persona session association ssirel session association ssirel ip decompression ssirel contact chaining top sfprftcomintrfi usa aus cam grr n7i pcmpnma 47