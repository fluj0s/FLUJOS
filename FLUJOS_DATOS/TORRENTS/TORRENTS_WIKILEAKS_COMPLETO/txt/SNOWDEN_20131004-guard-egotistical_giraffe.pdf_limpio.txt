top secretcomintrel to usa aus can gbr nzl tssirel peeling back the layers of tor with egotisticalgiraffe this briefing is classified top secretcomintrel usa fvey u what is tor ssirelthetor problem tssirel egotisticalgoat tssirel egotisticalgiraffe u future development u the onion router u enables anonymous internet activity d general privacy d nonattribution circumvention of nation state internet policies u hundreds of thousands of users dissidents iran china etc ssirel ssirel other targets too u what istor uwhat istor oconus internet site client browsing the web i tor client installed tor entry tor exit tor relay uwhat istor u tor browser bundle portable firefox 10 esr tbbfirefoxexe vidalia polipo n torbutton tor idiotproof ssir l th to r problem tssirel fingerprinting tor tssirel exploiting tor tssirel callbacks from tor windows xp firefox 1005 esr 32bit windows 7 firefoxioo 64bit mac x firefox 1004 esr 32bit windows 7 firefoxioo ubuntu 1110 firefox 1007 esr 32bit windows 7 firefoxioo 64bit windows 7 firefox 10010 esr 32bit windows 7 firefoxioo 32bit windows 7 firefoxioo tssirel build id gives timestamp for when the firefox release was built year month day hour min sec tssirel tbbfirefoxs buildid tssirel torbutton cares bout tor users being indistinguishable from tor users tssirel we only care bout tor users versus nontor users tssirel thanks to torbutton itseasy ssir l th to r problem t i i i i i r i i v i rn iyci pi ii im ly i ui tssirel exploiting tor tssirel callbacks from tor t5sirel tbbfirefox is barebones d flash is nono d noscript addon preinstalled but not enabled by default d tor explicitly advises against using any addons or extensions other than torbutton and noscript t5sirel need native firefox exploit t5sirel erroneousingenuity commonly known as erin d first native firefox exploit in long time only works against 1301602 t5sirel egotisticalgoat commonly known as eggo configured for 1101602 but the vulnerability also exists in 100 t5sirel type confusion vulnerability in e4x t5sirel enables arbitrary readwrite access to the process memory t5sirel remote code execution via the ctypes module t5sirel cant distinguish until on box n thats okay t5sirel cant distinguish firefox version until on box d thats also okay t5sirel cant distinguish 64bit from 32 bit until on box i think you see where this is going ssir l th to r problem t33irel fii iyci pi ii ilii iy tor t55 ir expiuiln iy tor t5sirel callbacks from tor t5sireltests on firefox 10 esr worked t5sireltests on tbbfirefox did not d gained execution didnt receive finkdifferent t5sirel defeated by prefilter hash requests eggi hashtor_exit_ip sessionjd requests fidi hashtarget_ip sessionjd j tssirel callbacks from tor t5sirel easy fix turn off prefilter hashing funnelout tssirelopsec concerns preplay attacks psps adversarial actors targets worth it t3sîrel fu ly i pi m lin ly tor t55ìrel expiuilii ly tor tssirel cdllbdckb frurntgr