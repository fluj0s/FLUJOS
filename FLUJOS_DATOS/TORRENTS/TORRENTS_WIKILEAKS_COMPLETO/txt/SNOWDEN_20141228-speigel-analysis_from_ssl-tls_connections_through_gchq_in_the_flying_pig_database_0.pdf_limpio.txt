tssirel tls trends at gchq tssirel tssirel source of data our tls events come from our tls app runs on special source approx 200 x 10g and comsat data produces unselected events about 10 billion server helios per week records details about the handshake ips hello messages certificate key exchanges events stored for 6 months in our clouds tssirel tssirel trends reports we summarise these events to produce weekly trends reports which record types of key exchange rsadhec top 40 tls services in use highlighting new services and changes in existing services details about the crypt eg dh moduli watchlist to keep an eye on widelyused services facebook gmail hotmail etc tssirel exam pie tssirel top 40 services 1 top certificates seer by common name common name modulus valid from valid until issuer org postion of total past raw count facebook com bdaf38fb408b8b337e1d 1024 13011q 110413 digicert inc 1 ill 9 291 10205 968772690 1127419008 a248 akamai net b40134f190aebe48066f 1024 010911 310812 gte corporation 2 2 7 695 7 046 802295227 778458790 wwfacebookcom b87bd0b4783df3cb4611 1024 171111 130712 verisign trust network 3 31 5 096 5443 531368555 601326037 apitwittercom 8abcc50a9c36696d9ab 2048 180510 170512 verisign inc 4 4 4 440 4839 463021773 534657717 hotmailcom 956f4c1d7b4904f9caa6 2048 130711 120713 verisign inc 5 5 2 728 2624 284430903 289947972 ursmicrosoftcom a7182fc26b834c47bfbc 1024 160511 150512 6 61 2 656 2584 276995437 285510909 channel facebook com c5386d6248b91de95a4 1024 231110 261113 digicert inc 7 7 2 242 2401 233793675 265316019 sstaticakfbcdnnet c8e627515e97a92b68ee 1024 010811 010812 akamai technologies inc 8 10 2 180 1 584 227382435 175019929 rnfacebookcom d10fc5ebfc66eb82d938 10241 290511 010613 equifax 9 14 2 046 1520 213407210 1679419771 datatoolbaryahoocom af227f382de62ffa4 5ee 1024 240610 2 50813 equifax 10 11 1 737 1573 181117743 173876822 loginyahoocom b4f12a8383c1c3cd6cce 1024 211210 030113 digicert inc 11 1 1 19 1409 179230294 15 5713115 icloud com b9053e899228403b6457 20481 020611 020813 entrust inc 12 9 1 714 1753 178784944 1936629021 googlecom a9619b9515b2af7884a5 1024 080312 080313 google ire 13 12 1 478 1542 154111639 17044 5646 wwupdatemicrosoftcom ac563853d7e933bd71f7 2048 190411 180413 google ire 14 15 1 296 1466 13 5141462 161960265 sstatic akfacebookcom ad58ea4811bd7ûedfc21 10241 290711 290712 akamai technologies inc 15 18 1 252 1354 13û543626 1496305451 apiloginicqnet c4b160abd2b025383df4 2048 300611 160817 verisign inc 16 35 f 18 0478 123931507 52863604 imapqmailcom 9afda9bef8573b238052 1024 181111 181112 google inc 17 25 u 160 0659 120963041 72889992 loginlive com c5483d383 594eac8b19 2048 280911 270912 verisign inc 18 21 1 094 09601 114138558 106107395 pop3live com a906aecb8eb6826c51be 2048 240311 230313 verisign inc 19 20 1 04 h 10241 109361276 113150224 twittercom 9a21aa930f4ûae99efbd 20481 070711 270712 verisign inc 20 19 0 969 1128 101088158 1246472481 httpmwsmobilelivecom f8b16f57a4 599c6f346f 1024 120810 300914 verisign trust network 21 16 0 955 1450 99584853 160275556 akfbcdn net ab42786db7e50e2efebf 1024 130112 130113 akamai technologies inc 22 22 0 931 0907 9715 5933 100210124 facebook com ae94b171e2deccc1693e 10241 140711 130712 verisign trust network 23 13 0 843 1525 87967311 168474280 imapmailyahoocom 4ebe5bec7f392cc63e2 2048 110511 150513 digicert inc 24 29 0 702 0584 73246541 64522656 itunesapplecom be929951748692edf512 1024 230609 220614 verisign inc 25 23 0 688 0739 71781445 81745924 trustedsourceserver imqaoi dab6beb776dcfbbd33ûb 1024 130210 010138 see 26 28 0 669 0614 69784882 67857652 wwgooglecom deb72643a69985cd38a7 1024 261011 300913 thawte consulting pty ltd 27 24 0 665 0738 69403948 81563480 whatsappnet da6040129f6d3c9ace3b 2048 311209 311212 godaddycom inc 28 27 0 627 0627 65465951 69350595 gamemet as ervicesmi cr osoftcom c83ûf15ad53ce2589378 2048 160511 150513 godaddycom inc 29 26 0 605 06301 63213853 696066261 cityvil zyrga com d5a3ee989786818e9ec2 2048 290611 280612 verisign inc 30 3 0 583 04 51 60885889 49891238 zyngacom lf2a2823980a14d70d9f 1024 010911 301213 digicert inc 31 33 0 569 0521 59409296 57599432 twittercom acbedf362314aû1e035e 2048 170711 170913 geotrust inc 32 30 0 5 54 05751 57778165 63623 5771 mailru afd70ca3e329e37b15a6 2048 120312 110514 thawte inc 33 42 0 530 0425 55267751 46962081 contacts tnsn com 965a1b80e8e656c1d69e 2048 120511 110513 34 34 0 514 0506 53694286 55968833 s3amazonawscom 93cd13 5cd0dbded5608c 1024 151210 181213 digicert inc 35 38 0 509 04501 53084116 497203391 addonsmozillaorg b612d697d0571afe9153 2048 271210 291212 geotrust inc 36 31 0 492 0550 51395280 60762021 securestudies com k1591dbûb316c39526b 2048 020312 190313 comodo ca limited 37 82 0 470 0143 49056755 15851007 sbolcysheievhtitprdmiyowa net 78b03fod9c9e8b94415 2048 190411 200413 the u5ertrust network 38 39 0 444 04471 46338349 493949881 castlezyngacom da8920sû6f8929e98631 10241 010911 301213 digicert inc 39 44 0 438 0396 45721029 43761752 gslocapplecom cc785dbda5e720fe810b 2048 041010 011012 entrust inc 40 43 0 419 0421 43766504 46590125 lalendaryahoocom c024e51q1caû4aab04f7 2048 130312 200313 digicert inc 41 63 if q 405 0205 42323610 22677002 tssirel tssirel trends reports findings rsadhec ratio roughly constant 9055 _ ec almost entirely google plus bit of whatsapp new certificates mostly use 2048bit rsa keys weve seen new services jump up the list summer 2011 googles switch to elliptic curves _autumn 2011 apples icioud service spring 2012 increase in mobile facebook encryption tssirel tssirel tls and targets trends reports not based on targeted data how do we judge interest in tls services and get analysts involved two ways weve tried associate tls events with targets and inform the relevant analysts targetls put tls data out there for analysts to search flying pig tssirel tssirel targetls reports broad oak gchqs repository of target info we match tls events against this is the server ip in broad oak does the certificates domain match url selector or number of email selectors email the relevant poc to ask if the traffic is of interest about 15 of the services weve identified in this way have been worth looking into further tssirel tssirel flying pig tls knowledge base summarises all tls events to answer multiple questions eg what certificates are present on given ip which client ips access given service which tdis can be associated with given service tssirel tssirel example search by domain flying pig tlbssl knowledge babe hra justification query flying pig general ssl toolkit query flying pig ip network certificate field mailm j query as q client ip q server ip both or network eg 123024 or server certificate eg examplecom use for wildcards run query certificate field search qomailru query quick ant tor everts qfd server certificate fields to search within subject common name subject organisation name issuer common name issuer organisation name rsa modulus prototype owner i all http requests matching your query 1 5 of 5dd items 10 1 25 1 50 1 100 12 3 4 5 6 7 1 h server ip hnst name first seen last seen count we 25th nov count all time 184105 swa mailru 20111013 1605530 20111125 21 11 590 6085663 42640739 184104 5wamailru 20111013 1729130 20111125 21 11 550 6073183 36825411 134201 fcefd4cfbdaltopmailru 20111013 2143100 20111125 21 10 490 4049743 19360920 13513 top5mailru 20111014 2000000 20111125 21 12 050 3006868 14168963 13512 top3mailru 20111014 2000000 20111125 21 10 480 2400950 12306999 server ips all certificates matching your query tip 1 right click on row to find all server ips that serve that certificate tip 2 click on the disk icon in the title bar to download data in csv format tip 3 doubl eclick on field to enable copy and paste tip 4 change displayed columns basic is default advanced adds rsa modulus and cipher suite distribution columns basic columns advanced columns tip 1 right click on server ip to explore it further 1 25 of 500 1 10 of 70 items full first seen certificate count vve 25th nov count all valid from time io i 25 i 50 i 100 valid to items server ip subject common name subject subject org issuer common country name name 1 2 3 4 5 6 7 issuer issuer org country name self signe 5 6 cert count we 25th nov 12 3 4 7 w cert count all time 308203cd3032i20110922 131732 20111125 190159 2952729 16633953 20110131 000000 20120327 235959 mailru ru lie mai ru ithawte ssl ca us thawte nc n 308203613082c20110922 140550 20111125 105b32 249926 1085232 20100121 000000 20110220 235959 mailru ru lie mai ru thawte premium server ca thawte cons u iti n g cc n 308203033082120111007 202955 20111125 185340 10059 30520 20110925 000000 20131123 235959 moneymailru ru lie mai ru thawte ssl ca us thawte nc n 3082035130b2c20110923 170153 20111125 154005 576 b517 20100125 154205 20120127 181259 maiiruis is maiiru 15 us equifax n 308202 c83o02c2o110 b22 081421 20110906 061535 0 14b2 20110304 064212 20120303 064212 maiirusibru us maiirusibru us 3002043b30b2c20111017 140952 20111125 185010 22 1236 20110527 000000 20120725 235959 mailrucomru maiiru comru thawte du ssl ca us thawte nc n 3oo2o3c43o0220111000 000524 20111125 170402 301 1150 20100213 141906 20121100 141906 nrixl5hogomanru ru shogo shogoru ru shogo n 3oo2o4153o02c2o111101 073653 20111125 142629 246 693 20110915 114751 20120914 114751 limgsmailru ru lspcegedimfr fr cegedim n 3oo2o2e43o02c20111014 182034 20111121 051334 201 306 20111005 080734 20141004 080734 mederfoto maiiru ru maiiru mederfotomailru ru mailru 308204153082c20111031 141412 20111125 154550 99 259 20110915 114751 20120914 114751 authmailru ru ispcegedimfr fr cegedim n explore this server ip further 1771 191213 18416 18417 18415 189160 16477 18474 18475 18476 13555 13556 134151 63121 13643 13498 17989 17590 13684 333592 330212 308599 297282 294437 168414 120533 113555 112574 110325 3779 3740 3564 2532 2523 2360 2227 2051 1981 10526 is 1300617 2496916 2226133 2395012 659037 560336 515169 538512 690090 6023 7350 8498 4ss7 9226 9165 7600 7320 8442 tssirel tssirel example search by server flying pig tlsssl knowledge base hra justification query flying pig general ssl toolkit query flying pig i n query quick ant tor events qfd prototype owner ip network certificate field 18414 query as client ip server ip both ori network eg 123024 ori server certificate eg eamplecom use for wildcards run query general ip info top 10 ssl client geos top 10 ssl server ports j top 10 ssl case notations ssl traffic state server ipspecific panels ssl server certificates seen on this ip ssl pattern of life j http requests to this ip top 100 ssl clients certificate field searchi ajmailru iserver pt 184141 general ip info for server ip 1b414 geolocation whois info i country ru m network 176d20 network type results city moscow l company moilru domain mailru as info advertised by as 47764 found within network 76d2d as name mailruas limited liability cnmpany mallru dns results tor node j matches top 10 ssl client geos top 10 ssl server ports top 10 ssl case notations ssl traffic stats f 1 overall j paired approximate d for week ending 2d111223 unique clients 104317 clientserver ips with traffic seen in both directions lnique clients with clients traffic only r j unique clients with s traffic only unique clients with bidirectional traffic ssl certificates seen on this ip f tip 1 right click on certificate to explore it further 1 3 of 3 items if 1 25 50 1 00 1 first seen on this ip last seen nn this ip count we 25th now count all time valid from valid to subject common name issuer common name 20110922 133106 20111125 190147 357643 2359179 20110131 000000 20120327 235959 rnailru thawte ssl ca 20110808 122345 20111125 075007 1441 1447304 20110131 000000 20120327 235959 mailru thawte ssl ca 20111116 141303 20111116 14 1303 2011obo5 103419 20140305 103419 go daddy secure certification authority average pattern of life for client seeded around ssl events to this server ip http requests to this ip top 100 u tip 1 filter by mir vb occurrences of event 1 8 of 233 items 10 25 50 100 11 apply filtering 1234567 correlated event event port percentage occurrences of event tip 1 right click on server ip to explore it as an ssl server 1 10 of 226 items id 25 i 50 i 1qq server ip host name requested 1234567h m count last week count all time get request to top3mailru 13512 00 201 get request to top5rnailru 13513 so 151 get request to doclbfaltopmailrlj 134253 80 142 get rpnnpsttn mw mail ru 1 04 40 ro 1 3 2 18414 emaikru 20111014 2011 1125 1989215 13sse636 18414 mmaikru 20111014 2011 1125 89268 664189 10414 10414 20111014 2011 1125 17426 100536 18414 auth mailru 20111014 2011 1125 11738 70020 1 öj 1 rd m 11 n oni 1 _1 n_i j oni 1 1 1 öüüd íqqjn tssirel tssirel contacts tls trends crypt operations bullrun team gchq gchq flying pig ictr network exploitation gchq tssirel