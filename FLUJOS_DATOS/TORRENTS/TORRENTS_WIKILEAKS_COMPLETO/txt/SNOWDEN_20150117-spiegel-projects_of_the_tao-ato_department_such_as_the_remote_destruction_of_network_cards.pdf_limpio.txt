s3285intern proj ec ts wikilnfo the accredited security level of this system is top secretsigammatalent keyholeorconpropinrelidorel to usa fvey top secretsirel to usa fvey u s3285internprojects top secretsirel to usa fvey from wikilnfo s3285 jump to navigation search tssirel this page contains ideas about possible future projects for the persistence division contents 1 tssirel cna team politerain 11 fu passionate polka 12 fuì argylealien 13 u barnfire 2 u hard drive recovery 3 fu iratemonk 31 tssirel ssd support 32 tssirel covert storage product 33 ufouoì saddleback 34 ufouq1 alteredcarbon support 35 ufouq1 fakedoubt support 36 ufouoì pluckhagen support 37 ufouoì easykraken support 38 tssirelì usb hard drive persistence 39 tssirelì iratemonk on serverraid systems 310 ufouo enhancment of testing capabilities 311 tssirelì selfencrvptingdrive sep persistence 4 tssirelì execution 41 ufouo castlecrasher 42 tssirelì alternate windows execution technique 43 tssirelì mac osx execution technique 5 fu sierramisttumpdollar 51 u extensibility application 52 fuì mopngo application 53 tssirelì ntfsd dos driver 54 fu full featured shell 55 tssirelì windows registry readavrite capability 56 tssirelì efi module 1 of 13 s3285intern proj ec ts wikilnfo 57 tssirelì linux app 58 tssirel file system support 581 tssirel btrfs 582 tssirel lvm 583 tssirel ext4 584 tssirel ufszfs 6 ufouoì berserkr 7 ufouo gqpherrage 8 ufouo windows tools 81 ufouoì wistfultoll 82 ufouoì centricdud 83 ufouoì stylishchamp 9 ìufouoì network infrastructure feditl tssirel cna team politerain tssirel fvey taoato persistence politerain cna team is looking for interns who want to break things we are tasked to remotely degrade or destroy opponent computers routers servers and network enabled devices by attacking the hardware using lowlevel programming it would be expected that our interns would learn to ufouo write drivers for linux windows solaris or apple ufouo use svn in group environment tssirel reverse engineer embedded systems tssirel deliver code that conforms to opsec and deniability reguirements tssirel recover eguipment that has been attacked ufouo work with multiple smes to build something unigue tssirel developing an attackers mind set tssirel fvey politerain always has backlog of smaller attacks than those listed below that need to be productized we are also always open for ideas but our focus is on firmware bios bus or driver level attacks the projects below an intern could be expected to produce results in 46 months most of the projects are unigue enough to allow for results to be briefed or published in classified venue edit u passionatepolka tssirel fveywe have discovered way that may be able to remotely brick network cards we need someone to perform research and develop deployable tool intern would have access to driver level developers mentors 2 of 13 s3285intern proj ec ts wikilnfo smes but would own the project and be responsible for it edit u argylealien tssirel fveythere is security feature built into many modern harddrives that allows for zeroization we want to use this feature to cause the loss of data intern would be working closely with politerain engineer to develop solution that would work on multiple vendors leveraging persistence divisions smes investigating via experimentation intern would learn about harddrive recovery reverse engineering harddrive architecture and much more edit u barnfire tssirel fveythis attack effort will erase the bios on brand of servers that act as backbone to many rival governments an intern working on this project would need to be nix expert with experience with lowlevel development experience of multiple types and reverse engineering experience intern would be working and learning from smes during this development first tour interns would not be considered for this project edit u hard drive recovery tssirel fvey when someone really needs the information off of damaged hard drive they call persistence this would be unique tour learning from worldclass expert how to fix hardware and firmware problems you would be working on targets extracting data troubleshooting hardware rebuilding scsi arrays and using analytical engineering skill to produce real collection position requires good hearing for some of the troubleshooting intern should know how to solder edit u iratemonk edit tssirel ssd support tssirel integrate ssd research into iratemonk products this will involve 4 different parts tssirel leveraging research to create armbased ssd implant this works involves reverse engineering ssd firmware and creating c and arm assembly code to place inside of firmware image to implement the iratemonk algorithm tssirel create version of the imbios code that supports the ssd implant this code runs on the x86 host and involves writing both c and 3 of 13 s3285intern proj ec ts wikilnfo x86 assembly this work will involve interacting with the firmware implant as well as the code that imbiqs bootstraps sierramist tssirel add support for the ssd to wickedvicar wickedvicar is the remote tool used to perform remote survey and installation this code is c and will involve interacting with the firmware implant from windows tssirel add the ssd vendor support to the iratemonk firmware and implant database tool this code is mostly python code that interacts with drive via linux driver tssirel the ssd support for iratemonk project currently offers the greatest variety of new work that an intern might be able to do edit tssirel covert storage product tssirel create covert storage product that is enabled from hard drive firmware modification the idea would be to modify the firmware of particular hard drive so that it normally only recognizes say half of its available space it would report this size back to the operating system and not provide any way to access the additional space the firmware would have special hook inside of it that on receipt of some custom ata command it would unlock the rest of the drive on the next boot of the drive when covert storage is locked only 1 partition would be present on the drive when unlocked the firmware would fix up the partition table to account for the second hidden partition whose space is now available on the drive when finished with covert storage special command can be sent back to the drive that will lock the drive again on the next boot the firmware will hide the extra space and fix up the partition table so only 1 partition exists edit ufouo saddleback tssirel utilizing hard drives serial port create firmware implant that has the ability to pass to and from an implant running in the operating system in practice the serial port will be connected to short hop radio that can communicate with another radio in system doing firmware modification eliminates the need to tap the sata bus as was done on other versions of saddleback performing firmware modification will allow for smaller saddleback in the form of laptop drive as opposed to the current version which only comes in 35 inch version edit ufouo alteredcarbon support tssirel develop iratemonk implants for the newest seagate drives including their hybrid drive products this work will primarily be reverse engineering effort but if successful will require updates to both imbios x86 code c and assembly wickedvicar x86 c and spitefulangel 4 of 13 s3285intern proj ec ts wikilnfo python edit ufouo fakedoubt support tssirel create an iratemonk implementation for armbased hitachi drives this includes firmware implant imbios code and wickedvicar and spitefulangel support edit ufouo pluckhagen support tssirel create an iratemonk implementation for armbased fujitsu drives this includes firmware implant imbios code and wickedvicar and spitefulangel support edit ufouo easykraken support tssirel add more drive support for armbased samsung drives edit tssirel usb hard drive persistence tssirel develop capability to install hard drive implant on usb hard drive since external hard drives are not normally boot from the new implant will need to be an improved version of madbishop so the hard drive implant will have the ability to manipulate the file system of the drive inside of the firmware itself development would consist of 3 main development areas tssirel reliable robust and portable ntfs c code other file systems could also be looked into such as fat ext2 etc tssirel hard drive implant tssirel remote installation over usb edit tssirel iratemonk on serverraid systems tssirel investigate the feasibility of developing hard drive persistence implant for serverraid systems this will primarily involve investigating what ata commands are allowed through various raid controllers also coming up with scheme to handle different raid configurations will be needed since the data on the drives will differ depending on the the raid setup it will be important to examine how raid controllers interact the drives and where data especially the mbr is stored if feasible this investigation could lead to the extension of iratemonktype 5 of 13 s3285intern proj ec ts wikilnfo hard drive implants into server spaces which provide increased covert storage and the capability to keep persistence logs which currently arent available on bios only techniques edit ufouo enhancment of testing capabilities tssirel iratemonk makes use of rogue samurai and actual hardware to perform its testing the downside of testing with actual hardware is that testing takes many hoursdays to complete someone with the right level of test development experience can help to improve the current iratemonk testing strategy edit tssirel selfencryptingdrive sed persistence tssirel sed drives provide additional security measures which often thwart iratemonk developer efforts to modify the firmware on these drives i highly skilled intern with reverse engineering skills and understanding of security in computing systems would be invaluable in tackling one of the persistence divisions more difficult problems feditl tssirel execution tssirel while lot of work in the persistence division involves modifying firmware there is still large need for kernel and usermode expertise the firmware modification done at the lowest levels of hardware needs way to obtain execution inside of running so that dnt payload can be either given execution or installed edit ufouo castlecrasher tssirel castlecrasher is the primary technique used in executing dnt windows payloads from all payload persistence techniques ie iratemonk and sierramistfree it is all windows native mode code built using visual studio castlecrasher has many advanced techniques in it including thread injection and antistack backtracing in many cases castlecrasher is closer to the dnt style kernel work than it is to traditional persistence work while the current version is quite robust there are several features that need to be added tssirel currently castlecrasher doesnt work against systems with 360 safe installed we need to find way around this even if it involves using the older windows service method of execution this 6 of 13 s3285intern proj ec ts wikilnfo will more than likely require refactoring of how the configuration data of castlecrasher is stored tssirel develop an automated test suite using the persistence divisions roguesamurai test framework to provide more robust testing for this important project edit tssirel alternate windows execution technique tssirel currently castlecrasher is the only production quality windows execution technigue that payload persistence technigues have another mechanism to execute dnt payloads is needed most preboot persistence techniques only have the ability to influence an through modifications to the target file system work needs to be done to investigate other ways to get execution inside of windows this work will start looking at other techniques that have been provided to the persistence division from other partners the feasibility of these techniques should be assessed if feasible the technique should be productized into deployable solution edit tssirel mac osx execution technique tssirel research needs to be done to investigate different ways that preboot persistence technique that can modify the target file system can get execution inside of osx maybe startup scripts can be modified or special files can be added that will get executed in order for payload persistence to work against osx execution technique is needed edit u sierramistjumpdollar edit u extensibility application tssirel create new extensibility application that checks for file on the file system that it will run to update the sierramist partition this application would replace the current one and would have list of configurable file paths to check this could be written for both sierramist and jumpdollar create roguesamurai test suite to test all aspects of this app edit u mopngo application 7 of 13 s3285intern proj ec ts wikilnfo tssirel update the mopngo application to remove the buffer overflow issue it has when more than 512 characters are configured also port this application to jumpdollar create roguesamurai test suite to test the application look into creating unit tests as well edit tssirel ntfsd dos driver tssirel the mx team has requested an upgrade of their ntfsd dos driver for their dosbased thumb drives used in interdiction deployments the newest fsm should be compiled into dos driver for their use this problem will be solved with the creation of mkusb utility for jumpdollar edit u full featured shell tssirel full featured shell should be written particularly for jumpdollar the ability to run scripts and have some sort of flow control logic would be desirable this could eventually be used by the mx team as means to deploy implants they have expressed desire to have one environment that can work on mac linux or windows machine provided we have the file system support this could eventually provide them what they want edit tssirel windows registry readwrite capability tssirel create the ability from sierramistjumpdollar to be able to read and write the windows registry this will provide new capability to apps to do whole host of new things it may be possible to install validator manually instead of relying on its installers this work may also allow some it geo applications as well if we can tweak some keys edit tssirel efi module tssirel build an efi module out of sierramistjumpdollar apps that can be loaded via normal efi mechanisms including an efi shell this is similar to what sandia can do with their mousetrap implant this work could provide new mechanism to achieve persistence and might prove to be easier than current patching techniques edit tssirel linux app tssirel rewrite the linux app to be configurable and add logging into it for use with iratemonk integrate build into borgerking investigate 8 of 13 s3285intern proj ec ts wikilnfo whether or not rogue samurai can be used to test edit tssirel file system support tssirel the following file systems need support by sierramistjumpdollar edit tssirel btrfs tssirel this file system is slated to become the default in fedora core 17 or 18 work can begin on supporting this now however this is applicable primarily for jumpdollar but maybe sierramist as well feditl tssirel lvm tssirel back port changes of the lvm code in jumpdollars ext4 fsm to sierramists ext3 feditl tssirel ext4 tssirel back port jumpdollars ext4 fsm to sierramist edit tssirel ufszfs tssirel create ufs and zfs fsms for jumpdollar feditl ufouo berserkr tssirel berserkr is persistent backdoor that is implanted into the bios and runs from smm although the core of the code is stable there are always new requirements against which to develop this includes new network interface card parasitic drivers as well as applications tssirel some notable applications that need development tssirel kirkbomb windows kernel examination to detect loaded drivers running processes as well there is prototype which works on windows 7 this needs to work on xp and 2008 including 64bit systems tssirel sodapressed linux application persistence given running installation of linux install some application or inject something into memory which will this currently works on certain versions of linux without selinux enabled tssirel there may also be requirements in the near future for 9 of 13 s3285intern proj ec ts wikilnfo tssirel bentwhistle collection tool that runs from berserkr tssirel berserkr is often looking to expand its target support big way this is done is via adding network card support currently berserkr does not support any wireless network cards feditl ufouo gopherrage tssirel gopherrage is project that seeks to develop hypervisor implant that would leverage both amd and intels virtualization technology in order to provide both dnt implant persistence capabilities and persistent back door tssirel develop hypervisor implant that would leverage both intels and amds virtualization technology in order to provide both dnt implant persistence capabilities and persistent back door access the idea would be similar to what berserkr can do from smm in that it should be able to use the machines network interface card nic to communicate independently of the host operating system also this hypervisor implant should have full readwrite access of host memory so it will be possible to change host behavior in ways that could allow code execution injection system survye vm breakin etc tssirel gopherrage is the persistence divisions pilot program to apply industry best practices and agile development processes to internal projects to this end the project is managed via the scrum process test driven development tdd practices are used as well in an effort to reduce code defects the project also is looking to incorporate ideas from dnt such as their scube build environment feditl ufouo windows tools feditl ufouo wistfultoll tssirel wistfultoll is the premiere target survey tool for windows that runs on almost all targets automatically it brings back information about the target systems machine and operating system that is invaluable for both the persistence division and analysts enterprise wide new features need to be added to wistfultoll as well as it being refactored edit ufouo centricdud tssirel centricdud is tool to read and writes bytes in the cmos 10 of 13 s3285intern proj ec ts wikilnfo it needs to be rewritten and productized so that it can be incorporated into proper ur plugin the driver associated with this tool also needs to be redone as it is being flagged by psps for unknown reasons this tool is used both by the bios team as well as the it geo team edit ufouo stylishchamp tssirel stylishchamp is tool that can create hpa on hard drive and then provide raw reads and writes to this area this tool should incorporate latest twistedkilt code so that it can support sata drives this will allow swap to be used on newer systems currently only ide drives are used fediti ufouo network infrastructure tssirel tornsteak is persistence solution for two firewall devices from particular vendor we need to port tornsteak from the existing two firewalls to several more from the same vendor this persistence effort would use ones reverse engineering computer architecture c programming and assembly language coding skills top secretsirel to usa fvey derived from si classification guide 0201 dated 20060711 and nsacssm 152 dated 20070108 declassify on 20320108 11 of 13 s 3 2 8 5internproj ec ts wikilnfo read edit view history actions move watch tag this page search go search navigation main page community portal recent changes random page help toolbox what links here related changes trackback upload file special pages printable version permanent link social software tools tournalnsa tapioca connexions linkup spvspace round table wikilnfonf partner wikis intellipedia csec wiki 12 of 13 s3285intern proj ec ts wikilnfo gchq wiki dsd wiki gcsb wiki derived from si classification guide 0201 dated 20060711 and nsacssm 152 dated 20070108 declassify on 20320108 top secretsirel to usa fvey the accredited security level of this system is top secretsigammatalent keyholeorconpropinrelidorel to usa fvey 13 of 13