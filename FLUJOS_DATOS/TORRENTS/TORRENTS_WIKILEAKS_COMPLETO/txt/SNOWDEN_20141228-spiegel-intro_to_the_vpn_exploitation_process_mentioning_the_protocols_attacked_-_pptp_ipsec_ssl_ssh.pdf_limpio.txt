intro to the vpn exploitation process otp vpn exploitation team v s31176 september 13 2010 top secretcomintrel usa aus can gbr nzl 1 top secretcomintrel usa aus can gbr nzl v overview ll i s31176 and the otp vpn exploitation team how can we help you i vpn and network encryption types i birth of the vpn adventure i sustained exploitation exploitation successes i conclusions top secretcomintrel usa aus can gbr nzl 2 top secretcomintrel usa aus can gbr nzl s31176 v sal branch name custom thread development for network encryption team name otp vpn exploitation team top secretcomintrel usa aus can gbr nzl 3 top secretcomintrel usa aus can gbr nzl mission statement s31176 provides cryptanalytic support services for many network encryption protocols including but not limited to ipsec ssl pptp ssh and proprietary protocols we are the frontdoor of ces for targeted vulnerability assessment and custom interim endtoend exploitation flows for these protocols in conjunction with various agency sigdev counterparts and target organizations we engage in discovery to find topi targets of interest by maintaining contact with field sites tao and ncsc we endeavor to guide and direct development and access through both active and passive means in order to make exploitation possible and enable full prosecution of the target top secretcomintrel usa aus can gbr nzl 4 top secretcomintrel usa aus can gbr nzl purpose in nutshell i act as your one stop shop for all vpn and network encryption exploitation related issues i act as liaison for sigdevers and topis to other areas of the vpn community perform some sigdev and target discovery top secretcomintrel usa aus can gbr nzl 5 top secretcomintrel usa aus can gbr nzl where are we positioned top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl s31176 branch members collection cmp intern team lead ipsec ssh ipsec branch chief diversity tour cadp intern pptp bleakinquiry ssl how to contact us may be changing soon go vpnxft top secretcomintrel usa aus can gbr nzl 7 top secretcomintrel usa aus can gbr nzl branches within otp 531171 prc n korea asia japan 531172 iran hamas iraq saudi arabia s31173africa levant latin america india pakistan afghanistan s31174 russia counterintel europe ftm 531175 crosstarget support branch 531176 custom thread development top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl gp exploitation in the otp branches each branch has vpn representative we inform them about attacks they inform us about targets if you have targetspecific inquiry they may be able to help s31171 eastern and southeast asia v target f prirsirit k s31172 iran iraq arabian peninsula s31173 levant central asia africa latin america s31174 russia europe international targets top secretcomintrel usa aus can gbr nzl 9 top secretcomintrel usa aus can gbr nzl how can we help you provide exploitation support provide vpn vulnerability analysis engage network security products tao etc convey meaningful feedback to customer develop sustained exploitation threads when possible suggest alternative approaches if passive exploitation is unrealistic decrypts decrypts decrypts top secretcomintrel usa aus can gbr nzl 10 top secretcomintrel usa aus can gbr nzl additional services we can assist with the following collection problems tasking data flow plaintext analysis metadata interpretation tipoff vulnerable vpn links vpn sigdev target discovery and development top secretcomintrel usa aus can gbr nzl 11 top secretcomintrel usa aus can gbr nzl how can you help you fp glad you asked familiarize yourself with appropriate search criteria get bleakinquiry account if you find vpnrelated data let us know the existence of vpn on network of interest configurationsetup information about the vpn top secretcomintrel usa aus can gbr nzl 12 top secretcomintrel usa aus can gbr nzl v bleakinquiry ip metadata database of potentially exploitable vpns data sources toygrippe metadata testing xkeyscore fingerprints daily vpn exploitation let us stresspotentlal want an account email or top secretcomintrel usa aus can gbr nzl 13 top secretcomintrel usa aus can gbr nzl bleakinquiry uta7 m m i bleakinquiry mozilla ffrvfox top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl v local ipsec processing attack script mailorder vulcan deathgrip genericlpsec_wrapperpl pinwale turtlepower top secretcomintrel usa aus can gbr nzl 15 top secretcomintrel usa aus can gbr nzl v type 1 ipsec fp ipsec ip security complete paired ike common udp ports 500 and 4500 preshared key psk router configuration good source for psks encrypted payload esp or ah next protocol 50 or 51 xkeyscore queries full log dni search appldfingerprints vpn vpnesp vpnisakmp vpnikev2 vpnikev2_content top secretcomintrel usa aus can gbr nzl 16 top secretcomintrel usa aus can gbr nzl v 1 type 2 pptp pptp pointtopoint tunneling protocol paired collect next protocol 47 pptp payload tcp port 1723 pptp tunnel set up payload onesided collect client side xkeyscore queries full log dni search enter your ipscasnetc of interest appldfingerprintvpnpptp_encr share your results with top secretcomintrel usa aus can gbr nzl 17 top secretcomintrel usa aus can gbr nzl v type 3 ssl ssl secure sockets layer renamed tls transport layer security but still often referred to as ssl paired collect compare ips and ports server certificates port numbers 443 465 989 990 992 993 and 995 xkeyscore queries full log dni search or use ssl plugin appldfingerprints encryptionssl or network encryptionssl top secretcomintrel usa aus can gbr nzl 18 top secretcomintrel usa aus can gbr nzl v type 4 ssh c ssh secure shell industrystandard networking protocol for securely logging into other machines via network complete paired traffic port number 22 potentially recover user names and passwords useful to tao to access boxes and gather cryptographic information xkeyscore queries full log dni search appldfingerprints terminalssh top secretcomintrel usa aus can gbr nzl 19 top secretcomintrel usa aus can gbr nzl birth of the vpn adventure we receive vpnrelated requests from across the globe topis sigdev analysts otp analysts cryptologie centers field sites second parties top secretcomintrel usa aus can gbr nzl 20 top secretcomintrel usa aus can gbr nzl the many flavors of requests i m pdfsu it b ip links ranges vpn metadata bleakinquiry accounts ipsec pptp sslt ssh vpn exploitation team network protocols router information xkeyscore fingerprints domain names interesting terms names vulnerability evaluations top secretcomintrel usa aus can gbr nzl 21 top secretcomintrel usa aus can gbr nzl 1 initial steps vpn info foundquestion arises tsol task assigned to team analyst gather background info about request top secretcomintrel usa aus can gbr nzl 22 top secretcomintrel usa aus can gbr nzl 2 consult repositories m bleakinquiry metadata database of potentially exploitable vpns s toygrippe vpn metadata repository pinwale longterm repository for tasked sigint collect xkeyscore processes and databases dni collect from various field sites fulltake feed tasked and untasked v vulcandeathgrip repository for tasked fulltake vpn collection fourscore pptp repository top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl 3 scripts ipsec focus format downloaded repository files create intermediate processing files check for potential vulnerabilities search for psks in coralreef run attacks to recover psk decrypt traffic 24 top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl 4 communicate results fl can we decrypt the vpn traffic if the answer is then explain how to turn it into yes if the answer is yes then top secretcomintrel usa aus can gbr nzl 25 top secretcomintrel usa aus can gbr nzl v happy dance top secretcomintrel usa aus can gbr nzl 26 top secretcomintrel usa aus can gbr nzl yes we have decrypt notify customer of success send decrypt through postprocessing and deliver to topi have topi determine the priority level of the resulting plain text get ips on sustained collect set up and transition sustained decryption process to otp vpn branch rep top secretcomintrel usa aus can gbr nzl 27 depends on why we couldnt decrypt it find preshared key locate complete paired collect locate both ike and esp traffic have collection sites do surveys for the ips find better quality collect with rich metadata top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl v t lcontact our friends for help kshhpojsf i b f target 5 j npflrsuit m r network security products develop decryption algorithms tailored access operations computer network exploitation to create access points collection sites perform surveys for the ips of interest top secretcomintrel usa aus can gbr nzl 29 top secretcomintrel usa aus can gbr nzl more friends nsacss commercial solutions center manage industrial relationships sigdev develops tools and methods to help you find the traffic you desire otp vpn representatives assist in locating traffic of interest target knowledge top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl sustained exploitation w develop sustained exploitation thread after the topi confirms the decrypts are interesting topi must task ip in cadence task port and ip utt does not have boolean logic categories ipsec 6640 protocols and 6648 ports pptp 6648 ports ssl 6647 ports get the crypt system title work with the otp vpn regional branch representative top secretcomintrel usa aus can gbr nzl 3l top secretcomintrel usa aus can gbr nzl v j establish the data flow establish the correct corporate data flow ces data flow guru make sure the correct routing tags and categories are appended to the data direct tasked traffic to correct data repository pinwale vulcandeathgrip ipsec vulcanmindmeld ssl fourscore pptp try to avoid relying on xks workflows due to legal and logistical issues xkeyscore ssh using xks workflows directed to file directory top secretcomintrel usa aus can gbr nzl 32 top secretcomintrel usa aus can gbr nzl data flow integrity evaluate data integrity quality quantity different collectors produce different metadata formats need rich metadata need all the pieces ike and esp for ipsec ensure that the data is not garbled and headers attached appropriately check that the data volume is what is expected top secretcomintrel usa aus can gbr nzl 33 top secretcomintrel usa aus can gbr nzl v collection sites contact collection sites if there are data issues malformed headers missing metadata missing payload garbled data low volume singlesided traffic collection sites sometimes only collect one side of the vpn traffic need to collaborate with both sites top secretcomintrel usa aus can gbr nzl 34 top secretcomintrel usa aus can gbr nzl v decrypt processing decrypt the vpn traffic create sri files for decrypts send the decrypt and sri files to turtlepower ipsec pptp or capri ssl ssh for postprocessing decryption of payload decompression unrar files route to appropriate data repository according to the crypt system title and type of decrypt text voice etc top secretcomintrel usa aus can gbr nzl 35 top secretcomintrel usa aus can gbr nzl decrypt repositories g pinwale tasked ipsec pptp and ssl must be placed in the correct partition according to classification rel fvey noforn fi sa xkeyscore ssh often have router configurations and user credentials which are easier to view in xks than pinwale still developing the process top secretcomintrel usa aus can gbr nzl 36 top secretcomintrel usa aus can gbr nzl v topi evaluation ip analyst locates the decrypts in pin wale andor xkeyscore viewing the decrypts pinwale xkeyscore agility dnipresenter contact turtlepower or capri if there are file rendering issues also try the unidentified protocols team in s s31122 for help identifying unknown protocols top secretcomintrel usa aus can gbr nzl 37 top secretcomintrel usa aus can gbr nzl ij thread monitoring ip responsibility for monitoring these exploitation threads are transferred to the otp vpn regional branch representative after the thread is established and stabilized trouble shoots decryption and collection issues set up cron job to run the decryptor every day hopefully the topi continues to identify and report missioncritical intelligence from these decrypts top secretcomintrel usa aus can gbr nzl top secretcomintrel usa aus can gbr nzl v success 1 ipsec followthemoney and tao targets topi s2c22 has had close relationship with tao for quite some time z ftm target 1 x not susceptible to any of nsps implants tao got the configuration files which provided us the psks to enable passive exploitation top secretcomintrel usa aus can gbr nzl 39 top secretcomintrel usa aus can gbr nzl v success 1 ipsec lip ftm target 2 tao got on the router through which banking traffic of interest flows nsp had an implant which allows passive exploitation with just esp successful exploitation for the past two years top secretcomintrel usa aus can gbr nzl 40 top secretcomintrel usa aus can gbr nzl v success 2 pptp airlines iran air irtaa royal jordanian air jotaa transaero airlines rucac telecommunications mir telematiki pending system title afghani wimax pending system title government mexican diplomatic mxdbb pakistani general intelligence pkraq turkish diplomatic tudat afghanistan government afyad top secretcomintrel usa aus can gbr nzl 41 top secretcomintrel usa aus can gbr nzl v success 2 pptp banking and financial zaad financial ewallet transactions of principal financial node for somali terrorist activity followthemoney customer kabul bank bni banking indonesia formed and owned by the indonesian government banking transactions over flexy telkom indonesias fixed wireless network other s irgc cyber attacker nigerian power companys internal network top secretcomintrel usa aus can gbr nzl 42 top secretcomintrel usa aus can gbr nzl v reminders if its not exploitable now that doesnt mean it wont be later we collaborate and communicate with our friends to produce decrypts traffic must be both good quality and the correct type top secretcomintrel usa aus can gbr nzl 43