top secret top secret ipprofilinganalytics missionimpacts tradecraftdeveloper csecnetworkanalysiscentre may102012top secret 2exampleipprofileproblem targetappears on ip addresswish to understand networkcontext more fully examplequova lookup responsefor lat6000 long 9500 in frozen tundra w of hudson bay cityunknown country canada operator bell canada sympatico issueswith ip lookup data isit actually revealing or is it opaque isthe data even current or is it outofdate wasthe data ever accurate in the first placetop secret 3objectives develop new analytics to provide richer contextual data about network address apply analytics against tipping cueing objectives build upon artefact of techniques to develop new needleinahaystack analytic contact chaining across airgapstop secret 4analyticconceptstartwithtravelnode beginwithsingleseedwifiipaddressofintlairport assemblesetofuseridsseenonnetworkaddress overtwoweekstop secret 5profilingtravelnodesnextstep followidsbackwardandforwardinrecenttime lateripclusters of otherintlairports domesticairports majorintlhotels etcearlieripclustersof localhotels domesticairports localtransportationhubs localinternetcafes etctop secret 6iphoppingforwardintime followidsforwardintimeto nextipnotedeltatime Î´time 1hr 2hr 3hr 4hr 5hr nextipsorted bymostpopular manyclusterswillresolvetootherairports canthentakeseedsfromtheseairportsand repeattocoverwholeworld dittoforgoingbackwardintimecanuncover roaminginfrastructureofhostcityhotels conferencecenterswifihotspotsetctop secret 7datareality theanalyticproducedexcellentprofilesbutwasmore complexthaninitialconceptsuggests datahadlimitedaperturecanadianspecialsource majorcdnispsteamwithusemailmajorslosing travelcoverage behaviouratairports littlelingering onarrival arrivalsusingphonesnotwifi stillsomewifiusewhenwaiting forconnecting flightbaggage differentterminals domesticinternational alsoprivatelounges verymanyairportsandhotelsservedbylargeboingo privatenetwork notseeninaperture trafficseemstoreturnvialocalakamainodetop secret 8tradecraftdevelopmentdataset havetwoweeksworthofidipdatafromcanadianspecial source hadprogramaccesstoquovadatasetconnectingintoatlas database hadseedknowledgeofasinglecanadianairportwifiip addresstop secret 9 hopgeoprofilefromcdnairportintlterminal long longitudescaleisnonlinear t profiledseed ip location hoppedto ip locationsquare geographic location lineheight numbers of unique hoppedto ips atlocation plotof where elseids seenatseediphavebeen seenin twoweeks plotshowsmosthopped toipsare nearby confirming reported seedgeodatamostfarflung sitesarewireless gateways withmanyotherwireless gatewaysinsettop secret effectofinvalidgeoinformation 10profiledseed iplocation hoppedto iplocationsquare geographic location lineheight numbers ofunique hoppedto ipsatlocation effectofinvalidseedgeoinformation readilyapparentgeoincongruence displacementofseed location fromdistributioncenter stronglysuggestsdataerrorlong longitudescaleisnonlinear ttop secret 11hopoutdestinationsseen otherdomesticairports otherterminalsloungestransporthubs hotelsinmanycities mobilegatewaysinmanycities etctop secret 12 discoveredothercdnairportip domesticterminal closenessofmajorityofhoppedtoipsconfirmsgeodata butdomesticairportcanalsolooklikeabusyhoteltop secret 13idspresenceprofileatdiscoveredairport dominantpatterniseachidisseenbrieflyjustonceasexpectedeachhorizontallineshowspresencepatternofoneidsortedbyorderofappearancetimedays top secret 14 profilesofdiscoveredhotel manyidspresentoverafewdays timedaystop secret 15profilesofdiscoveredenterprise regulartemporal presence mfwithlocalgeographic span contrastswellagainsttravelroamingnodes timedaystop secret discoveredcoffeeshoplibrary coffee shop library similarpatternsofmixedtemporal localgeographic presence timedaystimedaystop secret 17discoveredwirelessgateway wirelessgatewaynotunlike ahotel except timedaystop secret 18partialrangeprofileofwirelessgateway 0100200300400500 1 2 3 4 5 6 7 8 idtotalonip commonids individualipnumber inrangeof8numberof idsseen oneachip forwirelessgatewayrangebehaviourisrevealing mostidsseenonanipare alsoscatteredacrossentirerange idtotalstrafficacrossfullrangeisveryhightop secret 19missionimpactofipprofiling tippingandcueingtaskforcetctf a5eyesefforttoenablethesigintsystemtoproviderealtimealertsof eventsofinterest alerttotargetcountrylocationchangeswebmailloginswithtimelimited cookiesetc targetsenemiesstilltargetairtravelandhotels airlinesshoeunderwearprinterbombs hotelsmumbaikabuljakartaammanislamabadegyptiansinai analyticcanhopsweepthroughipaddressspacetoidentify setofipaddressesforhotelsandairports detectingtargetpresencewithinsetwilltriggeranurgentalert aimtoproductizeanalyticstoreliablyproducesetofipsforalertingtop secret 20ipprofilingsummary differentcategoriesofipownershipuseshowdistinct characteristics airportshotelscoffeeshopsenterpriseswirelessgatewaysetc clearcharacteristicsenableformalmodelingdevelopments clearidentification ofhotelsandairportsenablescriticaltippingcueing tradecraft geohopprofilecanconfirmrefuteipgeolookup information latercouldfoldin timedeltasforenhanced modeling cansweeparegioncityforroamingaccesspointstoip networks leadstoanewneedleinahaystackanalytictop secret 21tradecraftproblemstatement akidnapperbasedinaruralareatravelstoanurbanareato makeransomcalls cantriskbringingattentiontolowpopulationruralarea wontusephoneforanyothercommsorusespayphones assumptionhehasanotherdevicethataccessesip networksfrompublicaccesspoints havingadeviceisntnecessarycoulduseinternetcafeslibrariesetc heisalsoassumedtouseipaccessaroundthetimeofransomcalls questionknowingthetimeoftheransomcallscanwe discoverthekidnappersipiddevice contactchainacrossairgapnotacorrelationofselectorstop secret 22solutionoutline withearlieripprofilinganalyticswecansweepa cityregiontodiscover anddeterminepublicaccesses wecanthenselect whichipnetworkidsareseenasactive inalltimessurroundingtheknownransomcalls reducesettoashortlist thenweexaminethereduced setofipnetworkidsand eliminatebaseline heavyusersintheareathatfallintothe setintersection justbecause theyarealwaysactive thatiseliminatethosethatarehighly activeoutsidethetimesoftheransom calls hopefullyleavesonlytheoneneedlefromthehaystacktop secret 23firstproofofconcept swepta modest size city and discovered two high traffic public access ranges with 300000active idsover 2 weeks used for initial expediency due tocomputational intensity presumedthat there were 3ransomcalls each 50 hours apartduring daytime looked for ids within 1 hr of calls reduce large settoa shortlist of just 19 ip network ids examinedactivity level of 19 ipnetwork ids howmany presences each had in 1 hr slots over two weeks mainworry as the computation was running there would be lot of idsthat showedjust handful of appearances eg3 4 5 instancestop secret 24idpresenceofshortlist happy result least active id had appearances in 40 hourslots thus could eliminate all leaving just the kidnapper if he was there each horizontal line shows presence of id over timehourslots postulated presence of kidnappertargettimehourslots top secret 25bigdatacomputationalchallenge all the previous analytics while successful experimentally ran much too slowly to allow for practical productization care collaborative analytics research environment bigdata system being trialed at csec with nsa launch assist nonextraordinary hardware minimal impedance between memory storage and processors highly optimized inmemory database capabilities columnar storage high performance vector functional runtime powerful but challenging programming language derived from apl result of first experiments with care gamechanging runtime for hopprofiles reduced from 2 hrs to several seconds allowsfortradecrafttobeprofitablyproductizedtop secret 26overallsummary ipprofilingshowingterrificvalue significantanalyticassetforipnetworksandtargetmobility enablescriticalcapabilitywithintippingcueingtaskforce workingtoproductizeonpowerfulnewcomputationalplatform broaderssoaccessesaperturescomingonlineatcsec looktoformalizemodelsfoldintimingdeltas anewneedleinahaystackanalyticisviablecontact chainingacrossairgaps enabledbysweepcapabilityofipprofiling shouldtestfurthertounderstandrobustnesswithrespecttoloosening assumptionsoftargetbehaviour beyondkidnappingtradecraftcouldalsobeusedforanytargetthatmakes occasionalforaysintoothercitiesregionstop secret 27tradecraftstudioexample possiblerouteforproductizinganalytics